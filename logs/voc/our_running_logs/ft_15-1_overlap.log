nohup: ignoring input
30
kvoc_15-1_FT On GPUs 2\Writing in results/seed_2023-ov/2023-03-07_voc_15-1_FT.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: None
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch 1, Class Loss=1.8387805223464966, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=1.8387805223464966, Class Loss=1.8387805223464966, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.0807112455368042, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=1.0807112455368042, Class Loss=1.0807112455368042, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.6984665393829346, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.6984665393829346, Class Loss=0.6984665393829346, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5023195147514343, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.5023195147514343, Class Loss=0.5023195147514343, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4077705144882202, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.4077705144882202, Class Loss=0.4077705144882202, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3131299912929535, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.3131299912929535, Class Loss=0.3131299912929535, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.8561333417892456, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=1.8561333417892456, Class Loss=1.8561333417892456, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.1324869394302368, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=1.1324869394302368, Class Loss=1.1324869394302368, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7719147205352783, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.7719147205352783, Class Loss=0.7719147205352783, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.523424506187439, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.523424506187439, Class Loss=0.523424506187439, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4393787980079651, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.4393787980079651, Class Loss=0.4393787980079651, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.31923818588256836, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.31923818588256836, Class Loss=0.31923818588256836, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.845938801765442, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=1.845938801765442, Class Loss=1.845938801765442, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.093959927558899, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=1.093959927558899, Class Loss=1.093959927558899, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7182106971740723, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.7182106971740723, Class Loss=0.7182106971740723, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5119032859802246, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.5119032859802246, Class Loss=0.5119032859802246, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4062133729457855, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.4062133729457855, Class Loss=0.4062133729457855, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3186163008213043, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.3186163008213043, Class Loss=0.3186163008213043, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.9438798427581787, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=1.9438798427581787, Class Loss=1.9438798427581787, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.1691919565200806, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=1.1691919565200806, Class Loss=1.1691919565200806, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7892726063728333, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.7892726063728333, Class Loss=0.7892726063728333, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5414854884147644, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.5414854884147644, Class Loss=0.5414854884147644, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4174206256866455, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.4174206256866455, Class Loss=0.4174206256866455, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3331969678401947, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.3331969678401947, Class Loss=0.3331969678401947, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.9519253969192505, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.767569
Mean Acc: 0.369351
FreqW Acc: 0.600327
Mean IoU: 0.326047
Class IoU:
	class 0: 0.75185627
	class 1: 0.8288592
	class 2: 0.0719893
	class 3: 0.53808236
	class 4: 0.5182821
	class 5: 0.5303692
	class 6: 0.7143616
	class 7: 0.49319264
	class 8: 0.14580153
	class 9: 0.043951955
	class 10: 0.19911675
	class 11: 0.036805905
	class 12: 0.10755407
	class 13: 0.30323613
	class 14: 0.03565457
	class 15: 0.0076607843
	class 16: 0.2160303
Class Acc:
	class 0: 0.9835387
	class 1: 0.85422504
	class 2: 0.07651256
	class 3: 0.56975025
	class 4: 0.56443983
	class 5: 0.5804598
	class 6: 0.72366357
	class 7: 0.5081048
	class 8: 0.14587545
	class 9: 0.044913016
	class 10: 0.20040949
	class 11: 0.036811993
	class 12: 0.11301886
	class 13: 0.32044095
	class 14: 0.035745755
	class 15: 0.0076672854
	class 16: 0.5133876

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3310282528400421, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.3310282528400421, Class Loss=0.3310282528400421, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.31346017122268677, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.31346017122268677, Class Loss=0.31346017122268677, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.2867116928100586, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.2867116928100586, Class Loss=0.2867116928100586, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.27547672390937805, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.27547672390937805, Class Loss=0.27547672390937805, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.23293888568878174, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.23293888568878174, Class Loss=0.23293888568878174, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.20989686250686646, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.20989686250686646, Class Loss=0.20989686250686646, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.33827006816864014, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.33827006816864014, Class Loss=0.33827006816864014, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.32433244585990906, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.32433244585990906, Class Loss=0.32433244585990906, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.28012341260910034, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.28012341260910034, Class Loss=0.28012341260910034, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.24501819908618927, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.24501819908618927, Class Loss=0.24501819908618927, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.23464329540729523, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.23464329540729523, Class Loss=0.23464329540729523, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.22032703459262848, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.22032703459262848, Class Loss=0.22032703459262848, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3295641243457794, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.3295641243457794, Class Loss=0.3295641243457794, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3100108206272125, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.3100108206272125, Class Loss=0.3100108206272125, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.2777714133262634, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.2777714133262634, Class Loss=0.2777714133262634, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.23910318315029144, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.23910318315029144, Class Loss=0.23910318315029144, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.22190356254577637, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.22190356254577637, Class Loss=0.22190356254577637, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.19323909282684326, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.19323909282684326, Class Loss=0.19323909282684326, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3171088397502899, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.3171088397502899, Class Loss=0.3171088397502899, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.29182928800582886, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.29182928800582886, Class Loss=0.29182928800582886, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.2429341822862625, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.2429341822862625, Class Loss=0.2429341822862625, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.23118595778942108, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.23118595778942108, Class Loss=0.23118595778942108, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.21627870202064514, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.21627870202064514, Class Loss=0.21627870202064514, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.19167903065681458, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.19167903065681458, Class Loss=0.19167903065681458, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.0762336254119873, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.737613
Mean Acc: 0.272791
FreqW Acc: 0.555596
Mean IoU: 0.225664
Class IoU:
	class 0: 0.7293889
	class 1: 0.7462462
	class 2: 0.027745489
	class 3: 0.19545226
	class 4: 0.45286235
	class 5: 0.38847116
	class 6: 0.44641095
	class 7: 0.26087373
	class 8: 0.048272252
	class 9: 0.024587639
	class 10: 0.062187
	class 11: 0.024788633
	class 12: 0.02555946
	class 13: 0.18635441
	class 14: 0.0037370208
	class 15: 0.0070120506
	class 16: 0.20634504
Class Acc:
	class 0: 0.9829597
	class 1: 0.7561072
	class 2: 0.028347913
	class 3: 0.19588281
	class 4: 0.48261866
	class 5: 0.40430334
	class 6: 0.4490261
	class 7: 0.26515096
	class 8: 0.048283488
	class 9: 0.02481613
	class 10: 0.062206805
	class 11: 0.024790566
	class 12: 0.025868714
	class 13: 0.19175436
	class 14: 0.0037374606
	class 15: 0.007015015
	class 16: 0.6845838

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.21216073632240295, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.21216073632240295, Class Loss=0.21216073632240295, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.19720660150051117, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.19720660150051117, Class Loss=0.19720660150051117, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.18439516425132751, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.18439516425132751, Class Loss=0.18439516425132751, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.17980335652828217, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.17980335652828217, Class Loss=0.17980335652828217, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.16665689647197723, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.16665689647197723, Class Loss=0.16665689647197723, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.1550774872303009, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.1550774872303009, Class Loss=0.1550774872303009, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22761428356170654, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.22761428356170654, Class Loss=0.22761428356170654, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.21569913625717163, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.21569913625717163, Class Loss=0.21569913625717163, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.1895619034767151, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.1895619034767151, Class Loss=0.1895619034767151, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.1839597225189209, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.1839597225189209, Class Loss=0.1839597225189209, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.20400193333625793, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.20400193333625793, Class Loss=0.20400193333625793, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.17189547419548035, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.17189547419548035, Class Loss=0.17189547419548035, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2174837291240692, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.2174837291240692, Class Loss=0.2174837291240692, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.20456910133361816, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.20456910133361816, Class Loss=0.20456910133361816, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.18998999893665314, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.18998999893665314, Class Loss=0.18998999893665314, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.19262738525867462, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.19262738525867462, Class Loss=0.19262738525867462, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.14975352585315704, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.14975352585315704, Class Loss=0.14975352585315704, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.1524924486875534, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.1524924486875534, Class Loss=0.1524924486875534, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2133946418762207, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.2133946418762207, Class Loss=0.2133946418762207, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.20094087719917297, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.20094087719917297, Class Loss=0.20094087719917297, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.1903243213891983, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.1903243213891983, Class Loss=0.1903243213891983, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.17834889888763428, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.17834889888763428, Class Loss=0.17834889888763428, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.16628503799438477, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.16628503799438477, Class Loss=0.16628503799438477, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.14912836253643036, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.14912836253643036, Class Loss=0.14912836253643036, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.2419790029525757, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.720813
Mean Acc: 0.204840
FreqW Acc: 0.528859
Mean IoU: 0.159331
Class IoU:
	class 0: 0.71679413
	class 1: 0.56941897
	class 2: 0.012509049
	class 3: 0.05803751
	class 4: 0.3612679
	class 5: 0.23411137
	class 6: 0.2420613
	class 7: 0.0974073
	class 8: 0.017953321
	class 9: 0.015055527
	class 10: 0.018169753
	class 11: 0.008060783
	class 12: 0.012033547
	class 13: 0.123694785
	class 14: 0.00070561183
	class 15: 0.004435131
	class 16: 0.21690561
Class Acc:
	class 0: 0.98522943
	class 1: 0.5724811
	class 2: 0.01266955
	class 3: 0.058063053
	class 4: 0.37716362
	class 5: 0.23947808
	class 6: 0.24242796
	class 7: 0.097978525
	class 8: 0.017953686
	class 9: 0.015135589
	class 10: 0.018169804
	class 11: 0.008061047
	class 12: 0.01210429
	class 13: 0.12582141
	class 14: 0.0007056835
	class 15: 0.0044358578
	class 16: 0.69440335

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.17622286081314087, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.17622286081314087, Class Loss=0.17622286081314087, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.1680511087179184, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.1680511087179184, Class Loss=0.1680511087179184, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.1576787680387497, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.1576787680387497, Class Loss=0.1576787680387497, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.169126957654953, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.169126957654953, Class Loss=0.169126957654953, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.15626657009124756, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.15626657009124756, Class Loss=0.15626657009124756, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.1418992280960083, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.1418992280960083, Class Loss=0.1418992280960083, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.18729181587696075, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.18729181587696075, Class Loss=0.18729181587696075, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.17186270654201508, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.17186270654201508, Class Loss=0.17186270654201508, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.16723091900348663, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.16723091900348663, Class Loss=0.16723091900348663, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.16729173064231873, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.16729173064231873, Class Loss=0.16729173064231873, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.14424434304237366, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.14424434304237366, Class Loss=0.14424434304237366, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.14082403481006622, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.14082403481006622, Class Loss=0.14082403481006622, Reg Loss=0.0
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.16927239298820496, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.16927239298820496, Class Loss=0.16927239298820496, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.16618403792381287, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.16618403792381287, Class Loss=0.16618403792381287, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.1641898900270462, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.1641898900270462, Class Loss=0.1641898900270462, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.158056378364563, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.158056378364563, Class Loss=0.158056378364563, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.1553039848804474, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.1553039848804474, Class Loss=0.1553039848804474, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.14845988154411316, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.14845988154411316, Class Loss=0.14845988154411316, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.16652439534664154, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.16652439534664154, Class Loss=0.16652439534664154, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.15334372222423553, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.15334372222423553, Class Loss=0.15334372222423553, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.15912006795406342, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.15912006795406342, Class Loss=0.15912006795406342, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.15339048206806183, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.15339048206806183, Class Loss=0.15339048206806183, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.15062189102172852, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.15062189102172852, Class Loss=0.15062189102172852, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.13717202842235565, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.13717202842235565, Class Loss=0.13717202842235565, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.2975026369094849, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.716164
Mean Acc: 0.186079
FreqW Acc: 0.521887
Mean IoU: 0.139765
Class IoU:
	class 0: 0.7136805
	class 1: 0.4877077
	class 2: 0.006151672
	class 3: 0.029158907
	class 4: 0.3154365
	class 5: 0.18553098
	class 6: 0.18856111
	class 7: 0.06961599
	class 8: 0.010128585
	class 9: 0.011230262
	class 10: 0.015444436
	class 11: 0.005694862
	class 12: 0.008095277
	class 13: 0.10792427
	class 14: 0.00022353312
	class 15: 0.004422006
	class 16: 0.21699888
Class Acc:
	class 0: 0.9853693
	class 1: 0.48940966
	class 2: 0.0062025394
	class 3: 0.029163277
	class 4: 0.32750818
	class 5: 0.18856746
	class 6: 0.18877551
	class 7: 0.07002473
	class 8: 0.010128623
	class 9: 0.011270766
	class 10: 0.01544446
	class 11: 0.0056950157
	class 12: 0.008135999
	class 13: 0.10923753
	class 14: 0.00022354217
	class 15: 0.00442247
	class 16: 0.7137674

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.15180736780166626, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.15180736780166626, Class Loss=0.15180736780166626, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.15486910939216614, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.15486910939216614, Class Loss=0.15486910939216614, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.15127654373645782, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.15127654373645782, Class Loss=0.15127654373645782, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.14259211719036102, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.14259211719036102, Class Loss=0.14259211719036102, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.14666680991649628, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.14666680991649628, Class Loss=0.14666680991649628, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.14147056639194489, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.14147056639194489, Class Loss=0.14147056639194489, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.14020662009716034, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.14020662009716034, Class Loss=0.14020662009716034, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.14365354180335999, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.14365354180335999, Class Loss=0.14365354180335999, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.1439702957868576, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.1439702957868576, Class Loss=0.1439702957868576, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.14396332204341888, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.14396332204341888, Class Loss=0.14396332204341888, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.13626790046691895, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.13626790046691895, Class Loss=0.13626790046691895, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.1402292102575302, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.1402292102575302, Class Loss=0.1402292102575302, Reg Loss=0.0
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.16111409664154053, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.16111409664154053, Class Loss=0.16111409664154053, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.14778576791286469, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.14778576791286469, Class Loss=0.14778576791286469, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.15221945941448212, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.15221945941448212, Class Loss=0.15221945941448212, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.14520932734012604, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.14520932734012604, Class Loss=0.14520932734012604, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.1519845426082611, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.1519845426082611, Class Loss=0.1519845426082611, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.14301781356334686, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.14301781356334686, Class Loss=0.14301781356334686, Reg Loss=0.0
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.1462881714105606, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.1462881714105606, Class Loss=0.1462881714105606, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.13701680302619934, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.13701680302619934, Class Loss=0.13701680302619934, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.13338987529277802, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.13338987529277802, Class Loss=0.13338987529277802, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.14123991131782532, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.14123991131782532, Class Loss=0.14123991131782532, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.14696571230888367, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.14696571230888367, Class Loss=0.14696571230888367, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.13143490254878998, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.13143490254878998, Class Loss=0.13143490254878998, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.3061546087265015, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.715175
Mean Acc: 0.181514
FreqW Acc: 0.520291
Mean IoU: 0.134847
Class IoU:
	class 0: 0.7129768
	class 1: 0.46508595
	class 2: 0.0043614726
	class 3: 0.023610104
	class 4: 0.30666032
	class 5: 0.15712677
	class 6: 0.18224055
	class 7: 0.06675486
	class 8: 0.009262544
	class 9: 0.010007701
	class 10: 0.013457485
	class 11: 0.004456558
	class 12: 0.0075089266
	class 13: 0.10492456
	class 14: 0.00017073662
	class 15: 0.0037594044
	class 16: 0.22002764
Class Acc:
	class 0: 0.9854904
	class 1: 0.46657425
	class 2: 0.0043791905
	class 3: 0.023612738
	class 4: 0.31786746
	class 5: 0.15927818
	class 6: 0.18239833
	class 7: 0.067118235
	class 8: 0.009262575
	class 9: 0.01003896
	class 10: 0.013457485
	class 11: 0.0044566626
	class 12: 0.0075411256
	class 13: 0.10627366
	class 14: 0.00017074034
	class 15: 0.0037597346
	class 16: 0.7240578

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.0597875118255615, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=2.0597875118255615, Class Loss=2.0597875118255615, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.780316948890686, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=1.780316948890686, Class Loss=1.780316948890686, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5666619539260864, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=1.5666619539260864, Class Loss=1.5666619539260864, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1101710796356201, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=1.1101710796356201, Class Loss=1.1101710796356201, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9568732380867004, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.9568732380867004, Class Loss=0.9568732380867004, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6868930459022522, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.6868930459022522, Class Loss=0.6868930459022522, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.962948203086853, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=1.962948203086853, Class Loss=1.962948203086853, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.7503832578659058, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=1.7503832578659058, Class Loss=1.7503832578659058, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.4023358821868896, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=1.4023358821868896, Class Loss=1.4023358821868896, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.2132980823516846, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=1.2132980823516846, Class Loss=1.2132980823516846, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9441235661506653, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.9441235661506653, Class Loss=0.9441235661506653, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6673016548156738, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.6673016548156738, Class Loss=0.6673016548156738, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.142246961593628, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=2.142246961593628, Class Loss=2.142246961593628, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.6992080211639404, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=1.6992080211639404, Class Loss=1.6992080211639404, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.419004201889038, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=1.419004201889038, Class Loss=1.419004201889038, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1407597064971924, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=1.1407597064971924, Class Loss=1.1407597064971924, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8932324051856995, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.8932324051856995, Class Loss=0.8932324051856995, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7226908206939697, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.7226908206939697, Class Loss=0.7226908206939697, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.818082332611084, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=1.818082332611084, Class Loss=1.818082332611084, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.506323218345642, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=1.506323218345642, Class Loss=1.506323218345642, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.3453099727630615, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=1.3453099727630615, Class Loss=1.3453099727630615, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0131142139434814, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=1.0131142139434814, Class Loss=1.0131142139434814, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8722573518753052, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.8722573518753052, Class Loss=0.8722573518753052, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6454688906669617, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.6454688906669617, Class Loss=0.6454688906669617, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.9560710191726685, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.753012
Mean Acc: 0.274001
FreqW Acc: 0.596809
Mean IoU: 0.220968
Class IoU:
	class 0: 0.77458537
	class 1: 0.45019567
	class 2: 0.0124989925
	class 3: 0.19891599
	class 4: 0.447046
	class 5: 0.2879989
	class 6: 0.32197762
	class 7: 0.237754
	class 8: 0.14487816
	class 9: 0.015224648
	class 10: 0.08001207
	class 11: 0.0
	class 12: 0.4212446
	class 13: 0.45846754
	class 14: 0.029273
	class 15: 0.008329998
	class 16: 0.07563619
	class 17: 0.013391037
Class Acc:
	class 0: 0.9855216
	class 1: 0.45168686
	class 2: 0.012555591
	class 3: 0.20301592
	class 4: 0.4838847
	class 5: 0.29811898
	class 6: 0.3235491
	class 7: 0.24700916
	class 8: 0.14512816
	class 9: 0.0152709205
	class 10: 0.080436096
	class 11: 0.0
	class 12: 0.5058147
	class 13: 0.55905604
	class 14: 0.029307611
	class 15: 0.008495569
	class 16: 0.5693178
	class 17: 0.013857097

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.6304935812950134, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.6304935812950134, Class Loss=0.6304935812950134, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.5676786303520203, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.5676786303520203, Class Loss=0.5676786303520203, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.48427051305770874, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.48427051305770874, Class Loss=0.48427051305770874, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.39470523595809937, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.39470523595809937, Class Loss=0.39470523595809937, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3351014256477356, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.3351014256477356, Class Loss=0.3351014256477356, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.28632646799087524, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.28632646799087524, Class Loss=0.28632646799087524, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6111800074577332, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.6111800074577332, Class Loss=0.6111800074577332, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5837107300758362, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.5837107300758362, Class Loss=0.5837107300758362, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4822304844856262, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.4822304844856262, Class Loss=0.4822304844856262, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3431159555912018, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.3431159555912018, Class Loss=0.3431159555912018, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2774937152862549, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.2774937152862549, Class Loss=0.2774937152862549, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.25308218598365784, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.25308218598365784, Class Loss=0.25308218598365784, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6414754986763, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.6414754986763, Class Loss=0.6414754986763, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5340243577957153, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.5340243577957153, Class Loss=0.5340243577957153, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.48948541283607483, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.48948541283607483, Class Loss=0.48948541283607483, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.34276139736175537, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.34276139736175537, Class Loss=0.34276139736175537, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.313610702753067, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.313610702753067, Class Loss=0.313610702753067, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.22692528367042542, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.22692528367042542, Class Loss=0.22692528367042542, Reg Loss=0.0
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5632894039154053, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.5632894039154053, Class Loss=0.5632894039154053, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5407487154006958, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.5407487154006958, Class Loss=0.5407487154006958, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.42972156405448914, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.42972156405448914, Class Loss=0.42972156405448914, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.36762380599975586, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.36762380599975586, Class Loss=0.36762380599975586, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.29405298829078674, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.29405298829078674, Class Loss=0.29405298829078674, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.24383383989334106, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.24383383989334106, Class Loss=0.24383383989334106, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.0095399618148804, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.753322
Mean Acc: 0.271568
FreqW Acc: 0.603323
Mean IoU: 0.211616
Class IoU:
	class 0: 0.78967565
	class 1: 0.43565625
	class 2: 0.00603184
	class 3: 0.12238438
	class 4: 0.45090136
	class 5: 0.26982105
	class 6: 0.38717315
	class 7: 0.25397173
	class 8: 0.10550591
	class 9: 0.013759959
	class 10: 0.023271477
	class 11: 0.0
	class 12: 0.31132996
	class 13: 0.4531653
	class 14: 0.023197468
	class 15: 0.0056090676
	class 16: 0.03467194
	class 17: 0.12296002
Class Acc:
	class 0: 0.9896303
	class 1: 0.43670988
	class 2: 0.006067078
	class 3: 0.12275585
	class 4: 0.4814195
	class 5: 0.2778757
	class 6: 0.38964865
	class 7: 0.25795537
	class 8: 0.10558482
	class 9: 0.013775524
	class 10: 0.023294792
	class 11: 0.0
	class 12: 0.31969967
	class 13: 0.5001695
	class 14: 0.023210516
	class 15: 0.0056295036
	class 16: 0.037465367
	class 17: 0.8973245

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.22444425523281097, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.22444425523281097, Class Loss=0.22444425523281097, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.23352988064289093, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.23352988064289093, Class Loss=0.23352988064289093, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.26855987310409546, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.26855987310409546, Class Loss=0.26855987310409546, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.2111852765083313, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.2111852765083313, Class Loss=0.2111852765083313, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.20487728714942932, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.20487728714942932, Class Loss=0.20487728714942932, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.16406701505184174, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.16406701505184174, Class Loss=0.16406701505184174, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22097215056419373, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.22097215056419373, Class Loss=0.22097215056419373, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.1879810094833374, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.1879810094833374, Class Loss=0.1879810094833374, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.18731184303760529, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.18731184303760529, Class Loss=0.18731184303760529, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.17754127085208893, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.17754127085208893, Class Loss=0.17754127085208893, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.14846384525299072, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.14846384525299072, Class Loss=0.14846384525299072, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.13996754586696625, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.13996754586696625, Class Loss=0.13996754586696625, Reg Loss=0.0
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.21284225583076477, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.21284225583076477, Class Loss=0.21284225583076477, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.19672954082489014, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.19672954082489014, Class Loss=0.19672954082489014, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.23642489314079285, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.23642489314079285, Class Loss=0.23642489314079285, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.18302403390407562, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.18302403390407562, Class Loss=0.18302403390407562, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.18676646053791046, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.18676646053791046, Class Loss=0.18676646053791046, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.1642516851425171, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.1642516851425171, Class Loss=0.1642516851425171, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2345733940601349, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.2345733940601349, Class Loss=0.2345733940601349, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2685813009738922, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.2685813009738922, Class Loss=0.2685813009738922, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2253062129020691, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.2253062129020691, Class Loss=0.2253062129020691, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.1826818734407425, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.1826818734407425, Class Loss=0.1826818734407425, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.1566454917192459, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.1566454917192459, Class Loss=0.1566454917192459, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.15958935022354126, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.15958935022354126, Class Loss=0.15958935022354126, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.1244951486587524, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.741651
Mean Acc: 0.234469
FreqW Acc: 0.591825
Mean IoU: 0.174734
Class IoU:
	class 0: 0.7895305
	class 1: 0.3646564
	class 2: 0.0018445732
	class 3: 0.033785842
	class 4: 0.408362
	class 5: 0.21937686
	class 6: 0.35985327
	class 7: 0.20208454
	class 8: 0.059113406
	class 9: 0.007527153
	class 10: 0.01352394
	class 11: 0.0
	class 12: 0.1813278
	class 13: 0.38624763
	class 14: 0.0072980192
	class 15: 0.0023071556
	class 16: 0.00049675116
	class 17: 0.10787526
Class Acc:
	class 0: 0.9896494
	class 1: 0.36513615
	class 2: 0.0018462839
	class 3: 0.033800937
	class 4: 0.42485243
	class 5: 0.22391143
	class 6: 0.36120582
	class 7: 0.20322432
	class 8: 0.059120234
	class 9: 0.007530988
	class 10: 0.013526983
	class 11: 0.0
	class 12: 0.18234731
	class 13: 0.4064516
	class 14: 0.007299204
	class 15: 0.002309978
	class 16: 0.0004971177
	class 17: 0.9377299

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.15940067172050476, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.15940067172050476, Class Loss=0.15940067172050476, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.15358707308769226, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.15358707308769226, Class Loss=0.15358707308769226, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.15216811001300812, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.15216811001300812, Class Loss=0.15216811001300812, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.14432939887046814, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.14432939887046814, Class Loss=0.14432939887046814, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.13271018862724304, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.13271018862724304, Class Loss=0.13271018862724304, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.1320100724697113, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.1320100724697113, Class Loss=0.1320100724697113, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1507774144411087, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.1507774144411087, Class Loss=0.1507774144411087, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.14401160180568695, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.14401160180568695, Class Loss=0.14401160180568695, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.16478008031845093, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.16478008031845093, Class Loss=0.16478008031845093, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.1499820500612259, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.1499820500612259, Class Loss=0.1499820500612259, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.1343792974948883, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.1343792974948883, Class Loss=0.1343792974948883, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.13996900618076324, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.13996900618076324, Class Loss=0.13996900618076324, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14781758189201355, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.14781758189201355, Class Loss=0.14781758189201355, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.1449947953224182, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.1449947953224182, Class Loss=0.1449947953224182, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.13602034747600555, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.13602034747600555, Class Loss=0.13602034747600555, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.14562352001667023, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.14562352001667023, Class Loss=0.14562352001667023, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.14079400897026062, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.14079400897026062, Class Loss=0.14079400897026062, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.14125442504882812, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.14125442504882812, Class Loss=0.14125442504882812, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.21001125872135162, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.21001125872135162, Class Loss=0.21001125872135162, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.1872430443763733, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.1872430443763733, Class Loss=0.1872430443763733, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.16921859979629517, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.16921859979629517, Class Loss=0.16921859979629517, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.1554245948791504, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.1554245948791504, Class Loss=0.1554245948791504, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.18176484107971191, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.18176484107971191, Class Loss=0.18176484107971191, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1427386999130249, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.1427386999130249, Class Loss=0.1427386999130249, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.1871137619018555, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.737790
Mean Acc: 0.224962
FreqW Acc: 0.590902
Mean IoU: 0.164500
Class IoU:
	class 0: 0.79324186
	class 1: 0.36871374
	class 2: 0.001149622
	class 3: 0.009672496
	class 4: 0.41171175
	class 5: 0.18958654
	class 6: 0.36114395
	class 7: 0.19132525
	class 8: 0.041994173
	class 9: 0.0065751495
	class 10: 0.011531921
	class 11: 0.0
	class 12: 0.13395485
	class 13: 0.3335181
	class 14: 0.005505528
	class 15: 0.00141957
	class 16: 0.0
	class 17: 0.099964045
Class Acc:
	class 0: 0.9890224
	class 1: 0.36932513
	class 2: 0.0011503438
	class 3: 0.009673276
	class 4: 0.42934364
	class 5: 0.19274211
	class 6: 0.36249655
	class 7: 0.19226351
	class 8: 0.041995455
	class 9: 0.0065759527
	class 10: 0.011534117
	class 11: 0.0
	class 12: 0.13425046
	class 13: 0.34436876
	class 14: 0.0055065383
	class 15: 0.0014205124
	class 16: 0.0
	class 17: 0.95764905

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.12640470266342163, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.12640470266342163, Class Loss=0.12640470266342163, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.12786711752414703, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.12786711752414703, Class Loss=0.12786711752414703, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.1263754963874817, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.1263754963874817, Class Loss=0.1263754963874817, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.12643083930015564, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.12643083930015564, Class Loss=0.12643083930015564, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.13057385385036469, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.13057385385036469, Class Loss=0.13057385385036469, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.1279098242521286, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.1279098242521286, Class Loss=0.1279098242521286, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1276768296957016, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.1276768296957016, Class Loss=0.1276768296957016, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1160193458199501, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.1160193458199501, Class Loss=0.1160193458199501, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.11745279282331467, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.11745279282331467, Class Loss=0.11745279282331467, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.1187489777803421, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.1187489777803421, Class Loss=0.1187489777803421, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.10800955444574356, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.10800955444574356, Class Loss=0.10800955444574356, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.121188223361969, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.121188223361969, Class Loss=0.121188223361969, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.13047458231449127, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.13047458231449127, Class Loss=0.13047458231449127, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1361001878976822, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.1361001878976822, Class Loss=0.1361001878976822, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.16172048449516296, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.16172048449516296, Class Loss=0.16172048449516296, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.11436037719249725, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.11436037719249725, Class Loss=0.11436037719249725, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.12639713287353516, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.12639713287353516, Class Loss=0.12639713287353516, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.11024705320596695, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.11024705320596695, Class Loss=0.11024705320596695, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.17370834946632385, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.17370834946632385, Class Loss=0.17370834946632385, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1454392671585083, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.1454392671585083, Class Loss=0.1454392671585083, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.16591966152191162, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.16591966152191162, Class Loss=0.16591966152191162, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.14771002531051636, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.14771002531051636, Class Loss=0.14771002531051636, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.1348424106836319, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.1348424106836319, Class Loss=0.1348424106836319, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.13626739382743835, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.13626739382743835, Class Loss=0.13626739382743835, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.1951332092285156, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.736534
Mean Acc: 0.219067
FreqW Acc: 0.587684
Mean IoU: 0.158896
Class IoU:
	class 0: 0.79105777
	class 1: 0.33563852
	class 2: 0.00056030997
	class 3: 0.006073732
	class 4: 0.41747728
	class 5: 0.17852831
	class 6: 0.3574393
	class 7: 0.1782138
	class 8: 0.041379932
	class 9: 0.0051517477
	class 10: 0.011159122
	class 11: 0.0
	class 12: 0.11412878
	class 13: 0.3171656
	class 14: 0.0034710586
	class 15: 0.0013431619
	class 16: 0.0
	class 17: 0.101336114
Class Acc:
	class 0: 0.9897655
	class 1: 0.33597192
	class 2: 0.00056047906
	class 3: 0.0060739475
	class 4: 0.43530333
	class 5: 0.18141069
	class 6: 0.35870227
	class 7: 0.17893535
	class 8: 0.04138095
	class 9: 0.0051519186
	class 10: 0.011160909
	class 11: 0.0
	class 12: 0.11433135
	class 13: 0.32571575
	class 14: 0.003471504
	class 15: 0.001344022
	class 16: 0.0
	class 17: 0.95392656

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.276109457015991, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=2.276109457015991, Class Loss=2.276109457015991, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.598832130432129, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=1.598832130432129, Class Loss=1.598832130432129, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1164188385009766, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=1.1164188385009766, Class Loss=1.1164188385009766, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7780513763427734, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.7780513763427734, Class Loss=0.7780513763427734, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5483864545822144, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.5483864545822144, Class Loss=0.5483864545822144, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4290323555469513, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.4290323555469513, Class Loss=0.4290323555469513, Reg Loss=0.0
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.3165793418884277, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=2.3165793418884277, Class Loss=2.3165793418884277, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.667551875114441, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=1.667551875114441, Class Loss=1.667551875114441, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1676760911941528, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=1.1676760911941528, Class Loss=1.1676760911941528, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7814357280731201, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.7814357280731201, Class Loss=0.7814357280731201, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5533339977264404, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.5533339977264404, Class Loss=0.5533339977264404, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4034886658191681, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.4034886658191681, Class Loss=0.4034886658191681, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.3645479679107666, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=2.3645479679107666, Class Loss=2.3645479679107666, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.6154853105545044, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=1.6154853105545044, Class Loss=1.6154853105545044, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.133896827697754, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=1.133896827697754, Class Loss=1.133896827697754, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7581596970558167, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.7581596970558167, Class Loss=0.7581596970558167, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5228143930435181, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.5228143930435181, Class Loss=0.5228143930435181, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.41022029519081116, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.41022029519081116, Class Loss=0.41022029519081116, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.3236780166625977, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=2.3236780166625977, Class Loss=2.3236780166625977, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.62712824344635, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=1.62712824344635, Class Loss=1.62712824344635, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1481196880340576, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=1.1481196880340576, Class Loss=1.1481196880340576, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7954239845275879, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.7954239845275879, Class Loss=0.7954239845275879, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5555070042610168, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.5555070042610168, Class Loss=0.5555070042610168, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4205656051635742, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.4205656051635742, Class Loss=0.4205656051635742, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.1769641637802124, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.689420
Mean Acc: 0.197051
FreqW Acc: 0.522129
Mean IoU: 0.148614
Class IoU:
	class 0: 0.71089363
	class 1: 0.5811072
	class 2: 0.0013209169
	class 3: 0.03238386
	class 4: 0.4232623
	class 5: 0.08735599
	class 6: 0.42772073
	class 7: 0.083513975
	class 8: 0.0055759437
	class 9: 0.04701737
	class 10: 0.039366156
	class 11: 0.017413178
	class 12: 0.0046596304
	class 13: 0.23905349
	class 14: 0.00094733795
	class 15: 0.006250897
	class 16: 0.0
	class 17: 0.0011225024
	class 18: 0.11469212
Class Acc:
	class 0: 0.93678325
	class 1: 0.5874357
	class 2: 0.0013223579
	class 3: 0.032412983
	class 4: 0.46138394
	class 5: 0.08751238
	class 6: 0.4298155
	class 7: 0.083918
	class 8: 0.0055780793
	class 9: 0.048054893
	class 10: 0.03939261
	class 11: 0.017598953
	class 12: 0.00466162
	class 13: 0.26388365
	class 14: 0.0009504329
	class 15: 0.006329753
	class 16: 0.0
	class 17: 0.0011288448
	class 18: 0.73579675

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4000532031059265, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.4000532031059265, Class Loss=0.4000532031059265, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3465564548969269, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.3465564548969269, Class Loss=0.3465564548969269, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.32953712344169617, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.32953712344169617, Class Loss=0.32953712344169617, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.27828603982925415, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.27828603982925415, Class Loss=0.27828603982925415, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2500014305114746, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.2500014305114746, Class Loss=0.2500014305114746, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.24209098517894745, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.24209098517894745, Class Loss=0.24209098517894745, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.43033701181411743, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.43033701181411743, Class Loss=0.43033701181411743, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.38466987013816833, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.38466987013816833, Class Loss=0.38466987013816833, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.35065895318984985, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.35065895318984985, Class Loss=0.35065895318984985, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3131752014160156, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.3131752014160156, Class Loss=0.3131752014160156, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.28954437375068665, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.28954437375068665, Class Loss=0.28954437375068665, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.2549075186252594, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.2549075186252594, Class Loss=0.2549075186252594, Reg Loss=0.0
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4238266050815582, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.4238266050815582, Class Loss=0.4238266050815582, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.39771193265914917, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.39771193265914917, Class Loss=0.39771193265914917, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.33604171872138977, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.33604171872138977, Class Loss=0.33604171872138977, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2946443557739258, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.2946443557739258, Class Loss=0.2946443557739258, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2988491654396057, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.2988491654396057, Class Loss=0.2988491654396057, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.2651428282260895, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.2651428282260895, Class Loss=0.2651428282260895, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.429246187210083, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.429246187210083, Class Loss=0.429246187210083, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.37491634488105774, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.37491634488105774, Class Loss=0.37491634488105774, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3318660855293274, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.3318660855293274, Class Loss=0.3318660855293274, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.29783955216407776, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.29783955216407776, Class Loss=0.29783955216407776, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2797430157661438, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.2797430157661438, Class Loss=0.2797430157661438, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.26879218220710754, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.26879218220710754, Class Loss=0.26879218220710754, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.4690977334976196, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.664443
Mean Acc: 0.151429
FreqW Acc: 0.492813
Mean IoU: 0.101220
Class IoU:
	class 0: 0.6863042
	class 1: 0.39790604
	class 2: 0.00019853088
	class 3: 0.0029309297
	class 4: 0.3081228
	class 5: 0.012457483
	class 6: 0.31271213
	class 7: 0.016384294
	class 8: 0.00045921942
	class 9: 0.008855635
	class 10: 0.006638071
	class 11: 0.008155472
	class 12: 4.835599e-05
	class 13: 0.05001456
	class 14: 0.00010961171
	class 15: 0.00065805065
	class 16: 0.0
	class 17: 0.0
	class 18: 0.11121765
Class Acc:
	class 0: 0.9174184
	class 1: 0.39868194
	class 2: 0.00019853287
	class 3: 0.0029309297
	class 4: 0.3233014
	class 5: 0.012457744
	class 6: 0.313747
	class 7: 0.016407046
	class 8: 0.00045922637
	class 9: 0.008919984
	class 10: 0.006638827
	class 11: 0.008160679
	class 12: 4.8356604e-05
	class 13: 0.05037988
	class 14: 0.00010971528
	class 15: 0.00065939967
	class 16: 0.0
	class 17: 0.0
	class 18: 0.81664085

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2753719687461853, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.2753719687461853, Class Loss=0.2753719687461853, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.25956660509109497, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.25956660509109497, Class Loss=0.25956660509109497, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.25782325863838196, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.25782325863838196, Class Loss=0.25782325863838196, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.22286884486675262, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.22286884486675262, Class Loss=0.22286884486675262, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.2250942885875702, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.2250942885875702, Class Loss=0.2250942885875702, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.22684331238269806, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.22684331238269806, Class Loss=0.22684331238269806, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.27423617243766785, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.27423617243766785, Class Loss=0.27423617243766785, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.25030142068862915, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.25030142068862915, Class Loss=0.25030142068862915, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.2597718834877014, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.2597718834877014, Class Loss=0.2597718834877014, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.23547017574310303, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.23547017574310303, Class Loss=0.23547017574310303, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.22894716262817383, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.22894716262817383, Class Loss=0.22894716262817383, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.21230381727218628, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.21230381727218628, Class Loss=0.21230381727218628, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.27089980244636536, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.27089980244636536, Class Loss=0.27089980244636536, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.2573419511318207, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.2573419511318207, Class Loss=0.2573419511318207, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.24676384031772614, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.24676384031772614, Class Loss=0.24676384031772614, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.24240779876708984, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.24240779876708984, Class Loss=0.24240779876708984, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.2219095081090927, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.2219095081090927, Class Loss=0.2219095081090927, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.20818695425987244, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.20818695425987244, Class Loss=0.20818695425987244, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2593425512313843, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.2593425512313843, Class Loss=0.2593425512313843, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2392697036266327, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.2392697036266327, Class Loss=0.2392697036266327, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2331462800502777, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.2331462800502777, Class Loss=0.2331462800502777, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.21503467857837677, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.21503467857837677, Class Loss=0.21503467857837677, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.22450965642929077, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.22450965642929077, Class Loss=0.22450965642929077, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.20226261019706726, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.20226261019706726, Class Loss=0.20226261019706726, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.6539297103881836, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.663935
Mean Acc: 0.134193
FreqW Acc: 0.484966
Mean IoU: 0.084306
Class IoU:
	class 0: 0.6813092
	class 1: 0.27535877
	class 2: 2.0068304e-05
	class 3: 0.0010167378
	class 4: 0.24971376
	class 5: 0.005919962
	class 6: 0.23228315
	class 7: 0.006515881
	class 8: 5.4134376e-05
	class 9: 0.0015769724
	class 10: 0.0024212366
	class 11: 0.005722744
	class 12: 2.613862e-06
	class 13: 0.015322829
	class 14: 2.8333594e-05
	class 15: 7.374134e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.12448299
Class Acc:
	class 0: 0.9233142
	class 1: 0.2756517
	class 2: 2.0068304e-05
	class 3: 0.0010167378
	class 4: 0.25787655
	class 5: 0.005919962
	class 6: 0.23282705
	class 7: 0.006520965
	class 8: 5.4134376e-05
	class 9: 0.0015805817
	class 10: 0.00242124
	class 11: 0.005722744
	class 12: 2.6138705e-06
	class 13: 0.015359038
	class 14: 2.8348522e-05
	class 15: 7.379465e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.82128465

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22442808747291565, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.22442808747291565, Class Loss=0.22442808747291565, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.22037917375564575, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.22037917375564575, Class Loss=0.22037917375564575, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2143075168132782, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.2143075168132782, Class Loss=0.2143075168132782, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.20844164490699768, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.20844164490699768, Class Loss=0.20844164490699768, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.19821316003799438, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.19821316003799438, Class Loss=0.19821316003799438, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.19070449471473694, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.19070449471473694, Class Loss=0.19070449471473694, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.25030630826950073, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.25030630826950073, Class Loss=0.25030630826950073, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.24363423883914948, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.24363423883914948, Class Loss=0.24363423883914948, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.21007823944091797, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.21007823944091797, Class Loss=0.21007823944091797, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.21948453783988953, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.21948453783988953, Class Loss=0.21948453783988953, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.21984201669692993, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.21984201669692993, Class Loss=0.21984201669692993, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.207377627491951, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.207377627491951, Class Loss=0.207377627491951, Reg Loss=0.0
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.23024258017539978, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.23024258017539978, Class Loss=0.23024258017539978, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.23089522123336792, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.23089522123336792, Class Loss=0.23089522123336792, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.21966314315795898, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.21966314315795898, Class Loss=0.21966314315795898, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.20679669082164764, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.20679669082164764, Class Loss=0.20679669082164764, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.2068406343460083, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.2068406343460083, Class Loss=0.2068406343460083, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.18750086426734924, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.18750086426734924, Class Loss=0.18750086426734924, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.23059965670108795, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.23059965670108795, Class Loss=0.23059965670108795, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.21980297565460205, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.21980297565460205, Class Loss=0.21980297565460205, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.21771450340747833, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.21771450340747833, Class Loss=0.21771450340747833, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.22655943036079407, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.22655943036079407, Class Loss=0.22655943036079407, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.2038259357213974, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.2038259357213974, Class Loss=0.2038259357213974, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.1988430768251419, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.1988430768251419, Class Loss=0.1988430768251419, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.7549465894699097, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.662417
Mean Acc: 0.125371
FreqW Acc: 0.480294
Mean IoU: 0.075758
Class IoU:
	class 0: 0.67774296
	class 1: 0.22178374
	class 2: 0.0
	class 3: 0.00052957766
	class 4: 0.2056701
	class 5: 0.003937679
	class 6: 0.18274489
	class 7: 0.0028022202
	class 8: 4.2737665e-06
	class 9: 0.00056575204
	class 10: 0.000854001
	class 11: 0.004041215
	class 12: 0.0
	class 13: 0.008813684
	class 14: 6.0577345e-06
	class 15: 2.8954297e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.12988184
Class Acc:
	class 0: 0.9244842
	class 1: 0.2219406
	class 2: 0.0
	class 3: 0.00052957766
	class 4: 0.21047297
	class 5: 0.003937679
	class 6: 0.18311429
	class 7: 0.0028032213
	class 8: 4.2737665e-06
	class 9: 0.00056607777
	class 10: 0.000854001
	class 11: 0.004041215
	class 12: 0.0
	class 13: 0.008823453
	class 14: 6.0592265e-06
	class 15: 2.896954e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.8204359

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2088458240032196, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.2088458240032196, Class Loss=0.2088458240032196, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.20031216740608215, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.20031216740608215, Class Loss=0.20031216740608215, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19204925000667572, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.19204925000667572, Class Loss=0.19204925000667572, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18737035989761353, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.18737035989761353, Class Loss=0.18737035989761353, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.19205819070339203, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.19205819070339203, Class Loss=0.19205819070339203, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.18794158101081848, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.18794158101081848, Class Loss=0.18794158101081848, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19494834542274475, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.19494834542274475, Class Loss=0.19494834542274475, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19199292361736298, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.19199292361736298, Class Loss=0.19199292361736298, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.18550774455070496, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.18550774455070496, Class Loss=0.18550774455070496, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18575523793697357, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.18575523793697357, Class Loss=0.18575523793697357, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.17585138976573944, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.17585138976573944, Class Loss=0.17585138976573944, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.18277661502361298, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.18277661502361298, Class Loss=0.18277661502361298, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.20306210219860077, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.20306210219860077, Class Loss=0.20306210219860077, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.20229722559452057, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.20229722559452057, Class Loss=0.20229722559452057, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.20020703971385956, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.20020703971385956, Class Loss=0.20020703971385956, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.2111164927482605, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.2111164927482605, Class Loss=0.2111164927482605, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.19201365113258362, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.19201365113258362, Class Loss=0.19201365113258362, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.1857476383447647, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.1857476383447647, Class Loss=0.1857476383447647, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.21210657060146332, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.21210657060146332, Class Loss=0.21210657060146332, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.20851369202136993, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.20851369202136993, Class Loss=0.20851369202136993, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19352583587169647, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.19352583587169647, Class Loss=0.19352583587169647, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.19085881114006042, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.19085881114006042, Class Loss=0.19085881114006042, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.2151273787021637, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.2151273787021637, Class Loss=0.2151273787021637, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.19343067705631256, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.19343067705631256, Class Loss=0.19343067705631256, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.853829264640808, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.663112
Mean Acc: 0.119681
FreqW Acc: 0.477533
Mean IoU: 0.070684
Class IoU:
	class 0: 0.6757251
	class 1: 0.17729007
	class 2: 0.0
	class 3: 0.00015578838
	class 4: 0.18940946
	class 5: 0.0028412037
	class 6: 0.14884111
	class 7: 0.0018133618
	class 8: 0.0
	class 9: 0.0004264214
	class 10: 0.0002811332
	class 11: 0.0034638648
	class 12: 0.0
	class 13: 0.0046362337
	class 14: 0.0
	class 15: 6.897232e-06
	class 16: 0.0
	class 17: 0.0
	class 18: 0.13811421
Class Acc:
	class 0: 0.92783374
	class 1: 0.17741856
	class 2: 0.0
	class 3: 0.00015578838
	class 4: 0.19315813
	class 5: 0.0028412037
	class 6: 0.14910644
	class 7: 0.0018138114
	class 8: 0.0
	class 9: 0.0004265674
	class 10: 0.0002811332
	class 11: 0.0034638648
	class 12: 0.0
	class 13: 0.0046378546
	class 14: 0.0
	class 15: 6.8996856e-06
	class 16: 0.0
	class 17: 0.0
	class 18: 0.8127937

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.472698926925659, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=2.472698926925659, Class Loss=2.472698926925659, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.7753289937973022, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=1.7753289937973022, Class Loss=1.7753289937973022, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1561732292175293, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=1.1561732292175293, Class Loss=1.1561732292175293, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6887328028678894, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.6887328028678894, Class Loss=0.6887328028678894, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.43994492292404175, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.43994492292404175, Class Loss=0.43994492292404175, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3051503002643585, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.3051503002643585, Class Loss=0.3051503002643585, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.41866135597229, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=2.41866135597229, Class Loss=2.41866135597229, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.7705377340316772, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=1.7705377340316772, Class Loss=1.7705377340316772, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1618837118148804, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=1.1618837118148804, Class Loss=1.1618837118148804, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7208220362663269, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.7208220362663269, Class Loss=0.7208220362663269, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.42784789204597473, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.42784789204597473, Class Loss=0.42784789204597473, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3073181211948395, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.3073181211948395, Class Loss=0.3073181211948395, Reg Loss=0.0
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.427736520767212, Reg Loss=0.0
Clinet index 24, End of Epoch 1/6, Average Loss=2.427736520767212, Class Loss=2.427736520767212, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.7699192762374878, Reg Loss=0.0
Clinet index 24, End of Epoch 2/6, Average Loss=1.7699192762374878, Class Loss=1.7699192762374878, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1680091619491577, Reg Loss=0.0
Clinet index 24, End of Epoch 3/6, Average Loss=1.1680091619491577, Class Loss=1.1680091619491577, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7071937322616577, Reg Loss=0.0
Clinet index 24, End of Epoch 4/6, Average Loss=0.7071937322616577, Class Loss=0.7071937322616577, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4302827715873718, Reg Loss=0.0
Clinet index 24, End of Epoch 5/6, Average Loss=0.4302827715873718, Class Loss=0.4302827715873718, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.2932659387588501, Reg Loss=0.0
Clinet index 24, End of Epoch 6/6, Average Loss=0.2932659387588501, Class Loss=0.2932659387588501, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.5399961471557617, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=2.5399961471557617, Class Loss=2.5399961471557617, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.8118116855621338, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=1.8118116855621338, Class Loss=1.8118116855621338, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.196923851966858, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=1.196923851966858, Class Loss=1.196923851966858, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.70150226354599, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.70150226354599, Class Loss=0.70150226354599, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.40074285864830017, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.40074285864830017, Class Loss=0.40074285864830017, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.2824370861053467, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.2824370861053467, Class Loss=0.2824370861053467, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.7567218542099, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.669949
Mean Acc: 0.143028
FreqW Acc: 0.514630
Mean IoU: 0.092562
Class IoU:
	class 0: 0.72784513
	class 1: 0.29958206
	class 2: 0.008128232
	class 3: 0.00038173335
	class 4: 0.3269897
	class 5: 0.08297013
	class 6: 0.11970477
	class 7: 0.09478733
	class 8: 0.0
	class 9: 0.040236887
	class 10: 0.0
	class 11: 0.0053160614
	class 12: 4.7466834e-05
	class 13: 0.0032042172
	class 14: 0.020128153
	class 15: 0.00020386871
	class 16: 0.0
	class 17: 0.0
	class 18: 0.008920635
	class 19: 0.112785004
Class Acc:
	class 0: 0.93074024
	class 1: 0.30770564
	class 2: 0.008144148
	class 3: 0.00038175867
	class 4: 0.35093537
	class 5: 0.08328958
	class 6: 0.12080902
	class 7: 0.096003875
	class 8: 0.0
	class 9: 0.043587025
	class 10: 0.0
	class 11: 0.00531975
	class 12: 4.7485315e-05
	class 13: 0.0032058847
	class 14: 0.020135459
	class 15: 0.00020392911
	class 16: 0.0
	class 17: 0.0
	class 18: 0.009039085
	class 19: 0.8810122

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.30609652400016785, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.30609652400016785, Class Loss=0.30609652400016785, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.27007874846458435, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.27007874846458435, Class Loss=0.27007874846458435, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.24775288999080658, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.24775288999080658, Class Loss=0.24775288999080658, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.20807220041751862, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.20807220041751862, Class Loss=0.20807220041751862, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.1770353466272354, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.1770353466272354, Class Loss=0.1770353466272354, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.16378484666347504, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.16378484666347504, Class Loss=0.16378484666347504, Reg Loss=0.0
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.2632821798324585, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.2632821798324585, Class Loss=0.2632821798324585, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.2396249771118164, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.2396249771118164, Class Loss=0.2396249771118164, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.2012346088886261, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.2012346088886261, Class Loss=0.2012346088886261, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.18920503556728363, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.18920503556728363, Class Loss=0.18920503556728363, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.17013534903526306, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.17013534903526306, Class Loss=0.17013534903526306, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.16475923359394073, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.16475923359394073, Class Loss=0.16475923359394073, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.274749755859375, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.274749755859375, Class Loss=0.274749755859375, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.23881688714027405, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.23881688714027405, Class Loss=0.23881688714027405, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.20810191333293915, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.20810191333293915, Class Loss=0.20810191333293915, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.18146367371082306, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.18146367371082306, Class Loss=0.18146367371082306, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.18414688110351562, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.18414688110351562, Class Loss=0.18414688110351562, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.15523967146873474, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.15523967146873474, Class Loss=0.15523967146873474, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2980174124240875, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.2980174124240875, Class Loss=0.2980174124240875, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.27239441871643066, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.27239441871643066, Class Loss=0.27239441871643066, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.22583219408988953, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.22583219408988953, Class Loss=0.22583219408988953, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.19636721909046173, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.19636721909046173, Class Loss=0.19636721909046173, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.18350271880626678, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.18350271880626678, Class Loss=0.18350271880626678, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.16484913229942322, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.16484913229942322, Class Loss=0.16484913229942322, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=2.0457770824432373, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.658411
Mean Acc: 0.114530
FreqW Acc: 0.507547
Mean IoU: 0.062765
Class IoU:
	class 0: 0.72921455
	class 1: 0.07947265
	class 2: 0.0005719126
	class 3: 0.0
	class 4: 0.2796737
	class 5: 0.021184625
	class 6: 0.006167947
	class 7: 0.0121616805
	class 8: 0.0
	class 9: 0.018808922
	class 10: 0.0
	class 11: 0.0023290904
	class 12: 3.2673347e-07
	class 13: 0.00020171811
	class 14: 0.0004951228
	class 15: 3.0613865e-06
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.10502296
Class Acc:
	class 0: 0.92431414
	class 1: 0.079916745
	class 2: 0.0005719467
	class 3: 0.0
	class 4: 0.2938869
	class 5: 0.02118641
	class 6: 0.0061683524
	class 7: 0.012174232
	class 8: 0.0
	class 9: 0.019326685
	class 10: 0.0
	class 11: 0.0023293733
	class 12: 3.267338e-07
	class 13: 0.00020171811
	class 14: 0.00049512536
	class 15: 3.0614494e-06
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.9300211

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.15982428193092346, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.15982428193092346, Class Loss=0.15982428193092346, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000600
Epoch 2, Class Loss=0.14876174926757812, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.14876174926757812, Class Loss=0.14876174926757812, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.1423933207988739, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.1423933207988739, Class Loss=0.1423933207988739, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.14542004466056824, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.14542004466056824, Class Loss=0.14542004466056824, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.13894695043563843, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.13894695043563843, Class Loss=0.13894695043563843, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.1377692073583603, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.1377692073583603, Class Loss=0.1377692073583603, Reg Loss=0.0
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.17095723748207092, Reg Loss=0.0
Clinet index 25, End of Epoch 1/6, Average Loss=0.17095723748207092, Class Loss=0.17095723748207092, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.157850444316864, Reg Loss=0.0
Clinet index 25, End of Epoch 2/6, Average Loss=0.157850444316864, Class Loss=0.157850444316864, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.1445521116256714, Reg Loss=0.0
Clinet index 25, End of Epoch 3/6, Average Loss=0.1445521116256714, Class Loss=0.1445521116256714, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.13489946722984314, Reg Loss=0.0
Clinet index 25, End of Epoch 4/6, Average Loss=0.13489946722984314, Class Loss=0.13489946722984314, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.1314125955104828, Reg Loss=0.0
Clinet index 25, End of Epoch 5/6, Average Loss=0.1314125955104828, Class Loss=0.1314125955104828, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.12911230325698853, Reg Loss=0.0
Clinet index 25, End of Epoch 6/6, Average Loss=0.12911230325698853, Class Loss=0.12911230325698853, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1674027144908905, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.1674027144908905, Class Loss=0.1674027144908905, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.15190936625003815, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.15190936625003815, Class Loss=0.15190936625003815, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.1486148238182068, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.1486148238182068, Class Loss=0.1486148238182068, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.1332596391439438, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.1332596391439438, Class Loss=0.1332596391439438, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.1353411227464676, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.1353411227464676, Class Loss=0.1353411227464676, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.13244371116161346, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.13244371116161346, Class Loss=0.13244371116161346, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.182096466422081, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.182096466422081, Class Loss=0.182096466422081, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.1775633692741394, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.1775633692741394, Class Loss=0.1775633692741394, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.17358586192131042, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.17358586192131042, Class Loss=0.17358586192131042, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.16259269416332245, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.16259269416332245, Class Loss=0.16259269416332245, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.14481553435325623, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.14481553435325623, Class Loss=0.14481553435325623, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.14116014540195465, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.14116014540195465, Class Loss=0.14116014540195465, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=2.1311354637145996, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.662075
Mean Acc: 0.109968
FreqW Acc: 0.506094
Mean IoU: 0.058009
Class IoU:
	class 0: 0.728465
	class 1: 0.037120543
	class 2: 6.0921593e-05
	class 3: 0.0
	class 4: 0.25536507
	class 5: 0.008621329
	class 6: 0.0006013465
	class 7: 0.0027646115
	class 8: 0.0
	class 9: 0.013000288
	class 10: 0.0
	class 11: 0.001321246
	class 12: 0.0
	class 13: 2.659106e-05
	class 14: 5.1936227e-06
	class 15: 1.8277149e-07
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.11283507
Class Acc:
	class 0: 0.93101436
	class 1: 0.037240062
	class 2: 6.0921637e-05
	class 3: 0.0
	class 4: 0.2655168
	class 5: 0.0086214105
	class 6: 0.0006013476
	class 7: 0.002765537
	class 8: 0.0
	class 9: 0.013164121
	class 10: 0.0
	class 11: 0.0013213019
	class 12: 0.0
	class 13: 2.659106e-05
	class 14: 5.1936227e-06
	class 15: 1.827731e-07
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.939021

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14184656739234924, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.14184656739234924, Class Loss=0.14184656739234924, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.13973486423492432, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.13973486423492432, Class Loss=0.13973486423492432, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.13146057724952698, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.13146057724952698, Class Loss=0.13146057724952698, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.14806020259857178, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.14806020259857178, Class Loss=0.14806020259857178, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.12336315959692001, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.12336315959692001, Class Loss=0.12336315959692001, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1214606761932373, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.1214606761932373, Class Loss=0.1214606761932373, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.15642720460891724, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.15642720460891724, Class Loss=0.15642720460891724, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.13999666273593903, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.13999666273593903, Class Loss=0.13999666273593903, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.13392019271850586, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.13392019271850586, Class Loss=0.13392019271850586, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.134211465716362, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.134211465716362, Class Loss=0.134211465716362, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.12501488626003265, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.12501488626003265, Class Loss=0.12501488626003265, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1242242380976677, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.1242242380976677, Class Loss=0.1242242380976677, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14742062985897064, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.14742062985897064, Class Loss=0.14742062985897064, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.14314047992229462, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.14314047992229462, Class Loss=0.14314047992229462, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.13478781282901764, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.13478781282901764, Class Loss=0.13478781282901764, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.12629738450050354, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.12629738450050354, Class Loss=0.12629738450050354, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.12654010951519012, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.12654010951519012, Class Loss=0.12654010951519012, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.11933846771717072, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.11933846771717072, Class Loss=0.11933846771717072, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1431466042995453, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.1431466042995453, Class Loss=0.1431466042995453, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.14814206957817078, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.14814206957817078, Class Loss=0.14814206957817078, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.12906543910503387, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.12906543910503387, Class Loss=0.12906543910503387, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.12008053064346313, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.12008053064346313, Class Loss=0.12008053064346313, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.12396284192800522, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.12396284192800522, Class Loss=0.12396284192800522, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.12007810175418854, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.12007810175418854, Class Loss=0.12007810175418854, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=2.1889519691467285, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.662593
Mean Acc: 0.107332
FreqW Acc: 0.507985
Mean IoU: 0.055220
Class IoU:
	class 0: 0.73199105
	class 1: 0.018683527
	class 2: 3.4402805e-05
	class 3: 0.0
	class 4: 0.22600871
	class 5: 0.0050190855
	class 6: 6.842467e-06
	class 7: 0.00071552984
	class 8: 0.0
	class 9: 0.009213176
	class 10: 0.0
	class 11: 0.0007079705
	class 12: 0.0
	class 13: 1.6203927e-05
	class 14: 0.0
	class 15: 0.0
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.11201089
Class Acc:
	class 0: 0.9323276
	class 1: 0.018722339
	class 2: 3.4402805e-05
	class 3: 0.0
	class 4: 0.23294656
	class 5: 0.0050190855
	class 6: 6.842467e-06
	class 7: 0.00071567856
	class 8: 0.0
	class 9: 0.009264902
	class 10: 0.0
	class 11: 0.0007079998
	class 12: 0.0
	class 13: 1.6203927e-05
	class 14: 0.0
	class 15: 0.0
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.9468854

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.12878572940826416, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.12878572940826416, Class Loss=0.12878572940826416, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.12651175260543823, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.12651175260543823, Class Loss=0.12651175260543823, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.11853870749473572, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.11853870749473572, Class Loss=0.11853870749473572, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.12281468510627747, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.12281468510627747, Class Loss=0.12281468510627747, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.12487640976905823, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.12487640976905823, Class Loss=0.12487640976905823, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.11781938374042511, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.11781938374042511, Class Loss=0.11781938374042511, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.12638956308364868, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.12638956308364868, Class Loss=0.12638956308364868, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.11975254863500595, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.11975254863500595, Class Loss=0.11975254863500595, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.11468906700611115, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.11468906700611115, Class Loss=0.11468906700611115, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.10815504938364029, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.10815504938364029, Class Loss=0.10815504938364029, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.1116146594285965, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.1116146594285965, Class Loss=0.1116146594285965, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1110672578215599, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.1110672578215599, Class Loss=0.1110672578215599, Reg Loss=0.0
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.12310813367366791, Reg Loss=0.0
Clinet index 18, End of Epoch 1/6, Average Loss=0.12310813367366791, Class Loss=0.12310813367366791, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1235811859369278, Reg Loss=0.0
Clinet index 18, End of Epoch 2/6, Average Loss=0.1235811859369278, Class Loss=0.1235811859369278, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.12931901216506958, Reg Loss=0.0
Clinet index 18, End of Epoch 3/6, Average Loss=0.12931901216506958, Class Loss=0.12931901216506958, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.11982236057519913, Reg Loss=0.0
Clinet index 18, End of Epoch 4/6, Average Loss=0.11982236057519913, Class Loss=0.11982236057519913, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.11137813329696655, Reg Loss=0.0
Clinet index 18, End of Epoch 5/6, Average Loss=0.11137813329696655, Class Loss=0.11137813329696655, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.11184222996234894, Reg Loss=0.0
Clinet index 18, End of Epoch 6/6, Average Loss=0.11184222996234894, Class Loss=0.11184222996234894, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.12933449447155, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.12933449447155, Class Loss=0.12933449447155, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.13420240581035614, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.13420240581035614, Class Loss=0.13420240581035614, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.126128688454628, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.126128688454628, Class Loss=0.126128688454628, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.13060954213142395, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.13060954213142395, Class Loss=0.13060954213142395, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.11128373444080353, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.11128373444080353, Class Loss=0.11128373444080353, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.12022563815116882, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.12022563815116882, Class Loss=0.12022563815116882, Reg Loss=0.0
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=2.231396198272705, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.665793
Mean Acc: 0.106338
FreqW Acc: 0.508421
Mean IoU: 0.054189
Class IoU:
	class 0: 0.73278034
	class 1: 0.01449874
	class 2: 2.0068304e-05
	class 3: 0.0
	class 4: 0.20737357
	class 5: 0.0035621414
	class 6: 0.0
	class 7: 0.00036059806
	class 8: 0.0
	class 9: 0.0074093416
	class 10: 0.0
	class 11: 0.0007493238
	class 12: 0.0
	class 13: 2.3682662e-05
	class 14: 0.0
	class 15: 3.6554417e-07
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.11700023
Class Acc:
	class 0: 0.9372207
	class 1: 0.014527337
	class 2: 2.0068304e-05
	class 3: 0.0
	class 4: 0.21386626
	class 5: 0.0035621414
	class 6: 0.0
	class 7: 0.00036064553
	class 8: 0.0
	class 9: 0.007433588
	class 10: 0.0
	class 11: 0.0007493566
	class 12: 0.0
	class 13: 2.3682662e-05
	class 14: 0.0
	class 15: 3.6554624e-07
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.9490011

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.5550905466079712, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=1.5550905466079712, Class Loss=1.5550905466079712, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.0581053495407104, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=1.0581053495407104, Class Loss=1.0581053495407104, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7748527526855469, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.7748527526855469, Class Loss=0.7748527526855469, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5924321413040161, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.5924321413040161, Class Loss=0.5924321413040161, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.47145357728004456, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.47145357728004456, Class Loss=0.47145357728004456, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3725787103176117, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.3725787103176117, Class Loss=0.3725787103176117, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.5175153017044067, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=1.5175153017044067, Class Loss=1.5175153017044067, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.0631787776947021, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=1.0631787776947021, Class Loss=1.0631787776947021, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7823682427406311, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.7823682427406311, Class Loss=0.7823682427406311, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5669327974319458, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.5669327974319458, Class Loss=0.5669327974319458, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4642655551433563, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.4642655551433563, Class Loss=0.4642655551433563, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.35361751914024353, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.35361751914024353, Class Loss=0.35361751914024353, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.628546118736267, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=1.628546118736267, Class Loss=1.628546118736267, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.079503059387207, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=1.079503059387207, Class Loss=1.079503059387207, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7817961573600769, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.7817961573600769, Class Loss=0.7817961573600769, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.605751633644104, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.605751633644104, Class Loss=0.605751633644104, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4566996991634369, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.4566996991634369, Class Loss=0.4566996991634369, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3696412444114685, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3696412444114685, Class Loss=0.3696412444114685, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.6501076221466064, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=1.6501076221466064, Class Loss=1.6501076221466064, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.1511170864105225, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=1.1511170864105225, Class Loss=1.1511170864105225, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8327703475952148, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.8327703475952148, Class Loss=0.8327703475952148, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6214994192123413, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.6214994192123413, Class Loss=0.6214994192123413, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4788619577884674, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.4788619577884674, Class Loss=0.4788619577884674, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.36873960494995117, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.36873960494995117, Class Loss=0.36873960494995117, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.8434324264526367, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.701700
Mean Acc: 0.124230
FreqW Acc: 0.504395
Mean IoU: 0.093821
Class IoU:
	class 0: 0.7115767
	class 1: 0.32387918
	class 2: 0.0011624931
	class 3: 4.370301e-06
	class 4: 0.2702037
	class 5: 0.06213008
	class 6: 0.3157431
	class 7: 0.021982908
	class 8: 0.0
	class 9: 0.0071659638
	class 10: 0.0006019231
	class 11: 0.00071739906
	class 12: 0.0
	class 13: 0.005370616
	class 14: 0.0032230446
	class 15: 8.082202e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.00078120735
	class 19: 0.08096858
	class 20: 0.16465615
Class Acc:
	class 0: 0.99407834
	class 1: 0.32487714
	class 2: 0.0011625282
	class 3: 4.370301e-06
	class 4: 0.2765415
	class 5: 0.06240957
	class 6: 0.3176935
	class 7: 0.021998094
	class 8: 0.0
	class 9: 0.007173533
	class 10: 0.00060192344
	class 11: 0.00071739906
	class 12: 0.0
	class 13: 0.005383651
	class 14: 0.0032235084
	class 15: 8.08314e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0007828996
	class 19: 0.124535434
	class 20: 0.46757045

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.37615910172462463, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.37615910172462463, Class Loss=0.37615910172462463, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3189445734024048, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.3189445734024048, Class Loss=0.3189445734024048, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.26655998826026917, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.26655998826026917, Class Loss=0.26655998826026917, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.22924841940402985, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.22924841940402985, Class Loss=0.22924841940402985, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.22393155097961426, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.22393155097961426, Class Loss=0.22393155097961426, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.205746591091156, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.205746591091156, Class Loss=0.205746591091156, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.33210909366607666, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.33210909366607666, Class Loss=0.33210909366607666, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.27851417660713196, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.27851417660713196, Class Loss=0.27851417660713196, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.2492772787809372, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.2492772787809372, Class Loss=0.2492772787809372, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2265983670949936, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.2265983670949936, Class Loss=0.2265983670949936, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.1948108971118927, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.1948108971118927, Class Loss=0.1948108971118927, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.18443620204925537, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.18443620204925537, Class Loss=0.18443620204925537, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.33432886004447937, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.33432886004447937, Class Loss=0.33432886004447937, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.3017405867576599, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.3017405867576599, Class Loss=0.3017405867576599, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.26667141914367676, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.26667141914367676, Class Loss=0.26667141914367676, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.2213478535413742, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.2213478535413742, Class Loss=0.2213478535413742, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20747549831867218, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.20747549831867218, Class Loss=0.20747549831867218, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.19996364414691925, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.19996364414691925, Class Loss=0.19996364414691925, Reg Loss=0.0
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.34258371591567993, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.34258371591567993, Class Loss=0.34258371591567993, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3142502009868622, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.3142502009868622, Class Loss=0.3142502009868622, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.25665733218193054, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.25665733218193054, Class Loss=0.25665733218193054, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.22071309387683868, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.22071309387683868, Class Loss=0.22071309387683868, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.21239306032657623, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.21239306032657623, Class Loss=0.21239306032657623, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.18162770569324493, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.18162770569324493, Class Loss=0.18162770569324493, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.8818950653076172, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.684133
Mean Acc: 0.103858
FreqW Acc: 0.494645
Mean IoU: 0.059938
Class IoU:
	class 0: 0.71282005
	class 1: 0.17461202
	class 2: 0.0
	class 3: 5.141531e-07
	class 4: 0.1976324
	class 5: 0.0105135385
	class 6: 0.05433131
	class 7: 0.004288769
	class 8: 0.0
	class 9: 0.0028220662
	class 10: 0.00071579026
	class 11: 0.0016324177
	class 12: 0.0
	class 13: 0.002851044
	class 14: 0.0044063427
	class 15: 3.0248468e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.00044411345
	class 20: 0.09158917
Class Acc:
	class 0: 0.98120725
	class 1: 0.17487031
	class 2: 0.0
	class 3: 5.141531e-07
	class 4: 0.19952855
	class 5: 0.010515645
	class 6: 0.054363534
	class 7: 0.0042891
	class 8: 0.0
	class 9: 0.0028226739
	class 10: 0.00071579026
	class 11: 0.0016324177
	class 12: 0.0
	class 13: 0.0028545917
	class 14: 0.0044065723
	class 15: 3.0248952e-05
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0004456698
	class 20: 0.7433397

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.24145500361919403, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.24145500361919403, Class Loss=0.24145500361919403, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.21975626051425934, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.21975626051425934, Class Loss=0.21975626051425934, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.19373250007629395, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.19373250007629395, Class Loss=0.19373250007629395, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.16841544210910797, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.16841544210910797, Class Loss=0.16841544210910797, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.1671283096075058, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.1671283096075058, Class Loss=0.1671283096075058, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.169748917222023, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.169748917222023, Class Loss=0.169748917222023, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.21185407042503357, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.21185407042503357, Class Loss=0.21185407042503357, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.20509690046310425, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.20509690046310425, Class Loss=0.20509690046310425, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.17472803592681885, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.17472803592681885, Class Loss=0.17472803592681885, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.15729819238185883, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.15729819238185883, Class Loss=0.15729819238185883, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.165832057595253, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.165832057595253, Class Loss=0.165832057595253, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.15248459577560425, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.15248459577560425, Class Loss=0.15248459577560425, Reg Loss=0.0
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.1975795477628708, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.1975795477628708, Class Loss=0.1975795477628708, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.19711396098136902, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.19711396098136902, Class Loss=0.19711396098136902, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.1747433990240097, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.1747433990240097, Class Loss=0.1747433990240097, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.17181392014026642, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.17181392014026642, Class Loss=0.17181392014026642, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.1579379141330719, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.1579379141330719, Class Loss=0.1579379141330719, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.14654162526130676, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.14654162526130676, Class Loss=0.14654162526130676, Reg Loss=0.0
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20055963099002838, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.20055963099002838, Class Loss=0.20055963099002838, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.20971433818340302, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.20971433818340302, Class Loss=0.20971433818340302, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.17784053087234497, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.17784053087234497, Class Loss=0.17784053087234497, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.16861706972122192, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.16861706972122192, Class Loss=0.16861706972122192, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.1613376885652542, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.1613376885652542, Class Loss=0.1613376885652542, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.15723419189453125, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.15723419189453125, Class Loss=0.15723419189453125, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=2.0027518272399902, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.679840
Mean Acc: 0.097107
FreqW Acc: 0.490465
Mean IoU: 0.051263
Class IoU:
	class 0: 0.709708
	class 1: 0.103094876
	class 2: 0.0
	class 3: 0.0
	class 4: 0.1428402
	class 5: 0.0034312366
	class 6: 0.020696823
	class 7: 0.0015260306
	class 8: 0.0
	class 9: 0.00013822455
	class 10: 0.0003496496
	class 11: 0.00073925237
	class 12: 0.0
	class 13: 0.00078339136
	class 14: 0.0019077647
	class 15: 1.3707883e-06
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0
	class 20: 0.09130356
Class Acc:
	class 0: 0.977449
	class 1: 0.10320097
	class 2: 0.0
	class 3: 0.0
	class 4: 0.14358969
	class 5: 0.0034312499
	class 6: 0.02069991
	class 7: 0.0015261287
	class 8: 0.0
	class 9: 0.00013822455
	class 10: 0.0003496496
	class 11: 0.00073925237
	class 12: 0.0
	class 13: 0.000783813
	class 14: 0.0019077907
	class 15: 1.3707983e-06
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0
	class 20: 0.78542614

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.16669565439224243, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.16669565439224243, Class Loss=0.16669565439224243, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.16942733526229858, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.16942733526229858, Class Loss=0.16942733526229858, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.16787956655025482, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.16787956655025482, Class Loss=0.16787956655025482, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.14861245453357697, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.14861245453357697, Class Loss=0.14861245453357697, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.14700935781002045, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.14700935781002045, Class Loss=0.14700935781002045, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.14208073914051056, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.14208073914051056, Class Loss=0.14208073914051056, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.15289898216724396, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.15289898216724396, Class Loss=0.15289898216724396, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.14930260181427002, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.14930260181427002, Class Loss=0.14930260181427002, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.14566586911678314, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.14566586911678314, Class Loss=0.14566586911678314, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.1365109533071518, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.1365109533071518, Class Loss=0.1365109533071518, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.12920807301998138, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.12920807301998138, Class Loss=0.12920807301998138, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.12799157202243805, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.12799157202243805, Class Loss=0.12799157202243805, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.1740894466638565, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.1740894466638565, Class Loss=0.1740894466638565, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.1651194542646408, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.1651194542646408, Class Loss=0.1651194542646408, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.160063698887825, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.160063698887825, Class Loss=0.160063698887825, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.14137043058872223, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.14137043058872223, Class Loss=0.14137043058872223, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.15385684370994568, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.15385684370994568, Class Loss=0.15385684370994568, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.14792107045650482, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.14792107045650482, Class Loss=0.14792107045650482, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1721511334180832, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.1721511334180832, Class Loss=0.1721511334180832, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.16446644067764282, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.16446644067764282, Class Loss=0.16446644067764282, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.16718435287475586, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.16718435287475586, Class Loss=0.16718435287475586, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.14691443741321564, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.14691443741321564, Class Loss=0.14691443741321564, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.13530711829662323, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.13530711829662323, Class Loss=0.13530711829662323, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1419733166694641, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.1419733166694641, Class Loss=0.1419733166694641, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=2.087161064147949, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.679682
Mean Acc: 0.094527
FreqW Acc: 0.488762
Mean IoU: 0.048222
Class IoU:
	class 0: 0.7082276
	class 1: 0.073335096
	class 2: 0.0
	class 3: 0.0
	class 4: 0.1205063
	class 5: 0.0010273362
	class 6: 0.011182353
	class 7: 0.00064367533
	class 8: 0.0
	class 9: 1.4143908e-05
	class 10: 7.401342e-05
	class 11: 0.0005289437
	class 12: 0.0
	class 13: 0.00026210892
	class 14: 0.00063383835
	class 15: 9.1386234e-08
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0
	class 20: 0.09621686
Class Acc:
	class 0: 0.9781308
	class 1: 0.073398866
	class 2: 0.0
	class 3: 0.0
	class 4: 0.12080241
	class 5: 0.0010273362
	class 6: 0.011182697
	class 7: 0.0006436777
	class 8: 0.0
	class 9: 1.4143908e-05
	class 10: 7.401342e-05
	class 11: 0.0005289437
	class 12: 0.0
	class 13: 0.00026217123
	class 14: 0.00063383835
	class 15: 9.138655e-08
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0
	class 20: 0.7983717

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.14105793833732605, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.14105793833732605, Class Loss=0.14105793833732605, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.15013070404529572, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.15013070404529572, Class Loss=0.15013070404529572, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000372
Epoch 3, Class Loss=0.141456738114357, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.141456738114357, Class Loss=0.141456738114357, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.13389845192432404, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.13389845192432404, Class Loss=0.13389845192432404, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.1431874781847, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.1431874781847, Class Loss=0.1431874781847, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.1375657320022583, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.1375657320022583, Class Loss=0.1375657320022583, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.16394241154193878, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.16394241154193878, Class Loss=0.16394241154193878, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.13753224909305573, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.13753224909305573, Class Loss=0.13753224909305573, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.14037638902664185, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.14037638902664185, Class Loss=0.14037638902664185, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.138296440243721, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.138296440243721, Class Loss=0.138296440243721, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.13316355645656586, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.13316355645656586, Class Loss=0.13316355645656586, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.12477094680070877, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.12477094680070877, Class Loss=0.12477094680070877, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.15281866490840912, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.15281866490840912, Class Loss=0.15281866490840912, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.14918182790279388, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.14918182790279388, Class Loss=0.14918182790279388, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.14175347983837128, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.14175347983837128, Class Loss=0.14175347983837128, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.13194186985492706, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.13194186985492706, Class Loss=0.13194186985492706, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.1479082852602005, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.1479082852602005, Class Loss=0.1479082852602005, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.1493024080991745, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.1493024080991745, Class Loss=0.1493024080991745, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.15286393463611603, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.15286393463611603, Class Loss=0.15286393463611603, Reg Loss=0.0
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.13433244824409485, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.13433244824409485, Class Loss=0.13433244824409485, Reg Loss=0.0
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.13093413412570953, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.13093413412570953, Class Loss=0.13093413412570953, Reg Loss=0.0
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.1315741091966629, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.1315741091966629, Class Loss=0.1315741091966629, Reg Loss=0.0
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.14532190561294556, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.14532190561294556, Class Loss=0.14532190561294556, Reg Loss=0.0
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.12635555863380432, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.12635555863380432, Class Loss=0.12635555863380432, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=2.1369917392730713, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.678908
Mean Acc: 0.093685
FreqW Acc: 0.487737
Mean IoU: 0.047222
Class IoU:
	class 0: 0.7070332
	class 1: 0.06472937
	class 2: 0.0
	class 3: 0.0
	class 4: 0.11247818
	class 5: 0.0006175245
	class 6: 0.008652829
	class 7: 0.00050801196
	class 8: 0.0
	class 9: 4.1788817e-06
	class 10: 8.049205e-06
	class 11: 0.00039805897
	class 12: 0.0
	class 13: 0.00014041181
	class 14: 0.00048430532
	class 15: 0.0
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0
	class 20: 0.096606284
Class Acc:
	class 0: 0.97726625
	class 1: 0.064780205
	class 2: 0.0
	class 3: 0.0
	class 4: 0.11270127
	class 5: 0.0006175245
	class 6: 0.008652958
	class 7: 0.0005080147
	class 8: 0.0
	class 9: 4.1788817e-06
	class 10: 8.049205e-06
	class 11: 0.00039805897
	class 12: 0.0
	class 13: 0.00014043403
	class 14: 0.00048430532
	class 15: 0.0
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.0
	class 20: 0.80181766

voc_15-1_FT On GPUs 2
Run in 17932s
