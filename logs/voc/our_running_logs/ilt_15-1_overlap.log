nohup: ignoring input
30
kvoc_15-1_ILT On GPUs 2\Writing in results/seed_2023-ov/2023-03-08_voc_15-1_ILT.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: None
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch 1, Class Loss=1.9957629442214966, Reg Loss=11.507599830627441
Clinet index 3, End of Epoch 1/6, Average Loss=13.503362655639648, Class Loss=1.9957629442214966, Reg Loss=11.507599830627441
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.5844839811325073, Reg Loss=10.270212173461914
Clinet index 3, End of Epoch 2/6, Average Loss=11.854696273803711, Class Loss=1.5844839811325073, Reg Loss=10.270212173461914
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2692137956619263, Reg Loss=9.368843078613281
Clinet index 3, End of Epoch 3/6, Average Loss=10.638056755065918, Class Loss=1.2692137956619263, Reg Loss=9.368843078613281
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1848303079605103, Reg Loss=8.859397888183594
Clinet index 3, End of Epoch 4/6, Average Loss=10.044228553771973, Class Loss=1.1848303079605103, Reg Loss=8.859397888183594
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.065657615661621, Reg Loss=8.282916069030762
Clinet index 3, End of Epoch 5/6, Average Loss=9.348573684692383, Class Loss=1.065657615661621, Reg Loss=8.282916069030762
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8970091342926025, Reg Loss=7.723731994628906
Clinet index 3, End of Epoch 6/6, Average Loss=8.62074089050293, Class Loss=0.8970091342926025, Reg Loss=7.723731994628906
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.0334107875823975, Reg Loss=11.988706588745117
Clinet index 6, End of Epoch 1/6, Average Loss=14.022117614746094, Class Loss=2.0334107875823975, Reg Loss=11.988706588745117
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.5534862279891968, Reg Loss=10.15035629272461
Clinet index 6, End of Epoch 2/6, Average Loss=11.703842163085938, Class Loss=1.5534862279891968, Reg Loss=10.15035629272461
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.3755836486816406, Reg Loss=9.16466999053955
Clinet index 6, End of Epoch 3/6, Average Loss=10.540253639221191, Class Loss=1.3755836486816406, Reg Loss=9.16466999053955
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1763612031936646, Reg Loss=8.21335220336914
Clinet index 6, End of Epoch 4/6, Average Loss=9.389713287353516, Class Loss=1.1763612031936646, Reg Loss=8.21335220336914
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.0572280883789062, Reg Loss=8.586040496826172
Clinet index 6, End of Epoch 5/6, Average Loss=9.643268585205078, Class Loss=1.0572280883789062, Reg Loss=8.586040496826172
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9522774815559387, Reg Loss=8.454802513122559
Clinet index 6, End of Epoch 6/6, Average Loss=9.407079696655273, Class Loss=0.9522774815559387, Reg Loss=8.454802513122559
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.0019187927246094, Reg Loss=12.046977996826172
Clinet index 12, End of Epoch 1/6, Average Loss=14.048896789550781, Class Loss=2.0019187927246094, Reg Loss=12.046977996826172
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.5956393480300903, Reg Loss=10.44253921508789
Clinet index 12, End of Epoch 2/6, Average Loss=12.038178443908691, Class Loss=1.5956393480300903, Reg Loss=10.44253921508789
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.302941918373108, Reg Loss=9.404787063598633
Clinet index 12, End of Epoch 3/6, Average Loss=10.70772933959961, Class Loss=1.302941918373108, Reg Loss=9.404787063598633
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.207647442817688, Reg Loss=9.071864128112793
Clinet index 12, End of Epoch 4/6, Average Loss=10.279511451721191, Class Loss=1.207647442817688, Reg Loss=9.071864128112793
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.0396183729171753, Reg Loss=9.072900772094727
Clinet index 12, End of Epoch 5/6, Average Loss=10.112519264221191, Class Loss=1.0396183729171753, Reg Loss=9.072900772094727
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9237935543060303, Reg Loss=8.163378715515137
Clinet index 12, End of Epoch 6/6, Average Loss=9.087172508239746, Class Loss=0.9237935543060303, Reg Loss=8.163378715515137
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.1109066009521484, Reg Loss=11.558156967163086
Clinet index 0, End of Epoch 1/6, Average Loss=13.669063568115234, Class Loss=2.1109066009521484, Reg Loss=11.558156967163086
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.6575055122375488, Reg Loss=10.515438079833984
Clinet index 0, End of Epoch 2/6, Average Loss=12.172943115234375, Class Loss=1.6575055122375488, Reg Loss=10.515438079833984
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.4726524353027344, Reg Loss=9.317684173583984
Clinet index 0, End of Epoch 3/6, Average Loss=10.790336608886719, Class Loss=1.4726524353027344, Reg Loss=9.317684173583984
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.251298189163208, Reg Loss=8.818994522094727
Clinet index 0, End of Epoch 4/6, Average Loss=10.070292472839355, Class Loss=1.251298189163208, Reg Loss=8.818994522094727
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1334912776947021, Reg Loss=7.910713195800781
Clinet index 0, End of Epoch 5/6, Average Loss=9.044204711914062, Class Loss=1.1334912776947021, Reg Loss=7.910713195800781
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=1.027770757675171, Reg Loss=7.245738506317139
Clinet index 0, End of Epoch 6/6, Average Loss=8.27350902557373, Class Loss=1.027770757675171, Reg Loss=7.245738506317139
federated aggregation...
Validation, Class Loss=0.1932215541601181, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.935558
Mean Acc: 0.776904
FreqW Acc: 0.880817
Mean IoU: 0.712962
Class IoU:
	class 0: 0.9222044
	class 1: 0.90112853
	class 2: 0.42439222
	class 3: 0.8386408
	class 4: 0.6479049
	class 5: 0.7607183
	class 6: 0.93233573
	class 7: 0.89034003
	class 8: 0.90003556
	class 9: 0.38754213
	class 10: 0.7072592
	class 11: 0.511111
	class 12: 0.84853905
	class 13: 0.76302546
	class 14: 0.8165238
	class 15: 0.8295566
	class 16: 0.03908799
Class Acc:
	class 0: 0.9831425
	class 1: 0.96196604
	class 2: 0.8156619
	class 3: 0.8515974
	class 4: 0.7399862
	class 5: 0.8217759
	class 6: 0.9547958
	class 7: 0.90587795
	class 8: 0.91704315
	class 9: 0.45370987
	class 10: 0.72247344
	class 11: 0.52703804
	class 12: 0.8900664
	class 13: 0.91295606
	class 14: 0.8606177
	class 15: 0.8483444
	class 16: 0.040314976

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.974479615688324, Reg Loss=6.563420295715332
Clinet index 0, End of Epoch 1/6, Average Loss=7.537899971008301, Class Loss=0.974479615688324, Reg Loss=6.563420295715332
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.9491358995437622, Reg Loss=7.521600246429443
Clinet index 0, End of Epoch 2/6, Average Loss=8.470736503601074, Class Loss=0.9491358995437622, Reg Loss=7.521600246429443
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.9176746606826782, Reg Loss=7.1929931640625
Clinet index 0, End of Epoch 3/6, Average Loss=8.110668182373047, Class Loss=0.9176746606826782, Reg Loss=7.1929931640625
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.8536384105682373, Reg Loss=7.26341438293457
Clinet index 0, End of Epoch 4/6, Average Loss=8.117053031921387, Class Loss=0.8536384105682373, Reg Loss=7.26341438293457
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.7752057909965515, Reg Loss=6.907969951629639
Clinet index 0, End of Epoch 5/6, Average Loss=7.683175563812256, Class Loss=0.7752057909965515, Reg Loss=6.907969951629639
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.7834885120391846, Reg Loss=6.285111427307129
Clinet index 0, End of Epoch 6/6, Average Loss=7.068599700927734, Class Loss=0.7834885120391846, Reg Loss=6.285111427307129
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.9156472086906433, Reg Loss=7.657003879547119
Clinet index 2, End of Epoch 1/6, Average Loss=8.572650909423828, Class Loss=0.9156472086906433, Reg Loss=7.657003879547119
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.8769916296005249, Reg Loss=7.3873515129089355
Clinet index 2, End of Epoch 2/6, Average Loss=8.26434326171875, Class Loss=0.8769916296005249, Reg Loss=7.3873515129089355
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.8306818008422852, Reg Loss=7.4420976638793945
Clinet index 2, End of Epoch 3/6, Average Loss=8.27277946472168, Class Loss=0.8306818008422852, Reg Loss=7.4420976638793945
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.7405502200126648, Reg Loss=7.402674674987793
Clinet index 2, End of Epoch 4/6, Average Loss=8.143224716186523, Class Loss=0.7405502200126648, Reg Loss=7.402674674987793
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.713234007358551, Reg Loss=7.741092681884766
Clinet index 2, End of Epoch 5/6, Average Loss=8.454326629638672, Class Loss=0.713234007358551, Reg Loss=7.741092681884766
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.714043140411377, Reg Loss=7.196139335632324
Clinet index 2, End of Epoch 6/6, Average Loss=7.910182476043701, Class Loss=0.714043140411377, Reg Loss=7.196139335632324
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.9128437042236328, Reg Loss=7.189379692077637
Clinet index 8, End of Epoch 1/6, Average Loss=8.10222339630127, Class Loss=0.9128437042236328, Reg Loss=7.189379692077637
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.9125881791114807, Reg Loss=7.173830509185791
Clinet index 8, End of Epoch 2/6, Average Loss=8.086419105529785, Class Loss=0.9125881791114807, Reg Loss=7.173830509185791
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.8148837089538574, Reg Loss=7.358251571655273
Clinet index 8, End of Epoch 3/6, Average Loss=8.173135757446289, Class Loss=0.8148837089538574, Reg Loss=7.358251571655273
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.7508571743965149, Reg Loss=7.6479291915893555
Clinet index 8, End of Epoch 4/6, Average Loss=8.398786544799805, Class Loss=0.7508571743965149, Reg Loss=7.6479291915893555
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7073541283607483, Reg Loss=7.4592132568359375
Clinet index 8, End of Epoch 5/6, Average Loss=8.1665678024292, Class Loss=0.7073541283607483, Reg Loss=7.4592132568359375
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6719714403152466, Reg Loss=7.409710884094238
Clinet index 8, End of Epoch 6/6, Average Loss=8.081682205200195, Class Loss=0.6719714403152466, Reg Loss=7.409710884094238
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8568918108940125, Reg Loss=6.926437854766846
Clinet index 4, End of Epoch 1/6, Average Loss=7.783329486846924, Class Loss=0.8568918108940125, Reg Loss=6.926437854766846
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.8180719017982483, Reg Loss=7.077885627746582
Clinet index 4, End of Epoch 2/6, Average Loss=7.8959574699401855, Class Loss=0.8180719017982483, Reg Loss=7.077885627746582
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.7385104298591614, Reg Loss=7.053325176239014
Clinet index 4, End of Epoch 3/6, Average Loss=7.791835784912109, Class Loss=0.7385104298591614, Reg Loss=7.053325176239014
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.7188556790351868, Reg Loss=7.281236171722412
Clinet index 4, End of Epoch 4/6, Average Loss=8.000091552734375, Class Loss=0.7188556790351868, Reg Loss=7.281236171722412
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.661858856678009, Reg Loss=7.652708530426025
Clinet index 4, End of Epoch 5/6, Average Loss=8.314567565917969, Class Loss=0.661858856678009, Reg Loss=7.652708530426025
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6256926655769348, Reg Loss=7.55695104598999
Clinet index 4, End of Epoch 6/6, Average Loss=8.18264389038086, Class Loss=0.6256926655769348, Reg Loss=7.55695104598999
federated aggregation...
Validation, Class Loss=0.20208561420440674, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.930586
Mean Acc: 0.773689
FreqW Acc: 0.878808
Mean IoU: 0.703142
Class IoU:
	class 0: 0.92286056
	class 1: 0.9081635
	class 2: 0.4145333
	class 3: 0.68299896
	class 4: 0.6438833
	class 5: 0.68578696
	class 6: 0.9422948
	class 7: 0.8774961
	class 8: 0.8744234
	class 9: 0.37543568
	class 10: 0.7255611
	class 11: 0.5497535
	class 12: 0.84178406
	class 13: 0.7825445
	class 14: 0.7580699
	class 15: 0.8369212
	class 16: 0.13090362
Class Acc:
	class 0: 0.978519
	class 1: 0.9659111
	class 2: 0.7737908
	class 3: 0.6891006
	class 4: 0.7398753
	class 5: 0.7383309
	class 6: 0.96944904
	class 7: 0.89566857
	class 8: 0.8864496
	class 9: 0.43795323
	class 10: 0.7470514
	class 11: 0.5776188
	class 12: 0.88149613
	class 13: 0.9029634
	class 14: 0.78822833
	class 15: 0.8594789
	class 16: 0.3208286

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6475716829299927, Reg Loss=6.682855129241943
Clinet index 9, End of Epoch 1/6, Average Loss=7.3304266929626465, Class Loss=0.6475716829299927, Reg Loss=6.682855129241943
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.6390844583511353, Reg Loss=7.362175464630127
Clinet index 9, End of Epoch 2/6, Average Loss=8.001259803771973, Class Loss=0.6390844583511353, Reg Loss=7.362175464630127
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.6157444715499878, Reg Loss=7.286798000335693
Clinet index 9, End of Epoch 3/6, Average Loss=7.902542591094971, Class Loss=0.6157444715499878, Reg Loss=7.286798000335693
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.6103196740150452, Reg Loss=7.118587017059326
Clinet index 9, End of Epoch 4/6, Average Loss=7.728906631469727, Class Loss=0.6103196740150452, Reg Loss=7.118587017059326
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5970230102539062, Reg Loss=7.480904579162598
Clinet index 9, End of Epoch 5/6, Average Loss=8.077927589416504, Class Loss=0.5970230102539062, Reg Loss=7.480904579162598
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5714895129203796, Reg Loss=6.524667739868164
Clinet index 9, End of Epoch 6/6, Average Loss=7.096157073974609, Class Loss=0.5714895129203796, Reg Loss=6.524667739868164
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6708832383155823, Reg Loss=7.049600601196289
Clinet index 13, End of Epoch 1/6, Average Loss=7.720483779907227, Class Loss=0.6708832383155823, Reg Loss=7.049600601196289
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.6511657238006592, Reg Loss=7.0745744705200195
Clinet index 13, End of Epoch 2/6, Average Loss=7.725740432739258, Class Loss=0.6511657238006592, Reg Loss=7.0745744705200195
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5975601673126221, Reg Loss=7.359557628631592
Clinet index 13, End of Epoch 3/6, Average Loss=7.957118034362793, Class Loss=0.5975601673126221, Reg Loss=7.359557628631592
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.6176666021347046, Reg Loss=7.4773149490356445
Clinet index 13, End of Epoch 4/6, Average Loss=8.09498119354248, Class Loss=0.6176666021347046, Reg Loss=7.4773149490356445
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.6188520193099976, Reg Loss=8.313607215881348
Clinet index 13, End of Epoch 5/6, Average Loss=8.932458877563477, Class Loss=0.6188520193099976, Reg Loss=8.313607215881348
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.612478494644165, Reg Loss=7.179538249969482
Clinet index 13, End of Epoch 6/6, Average Loss=7.792016983032227, Class Loss=0.612478494644165, Reg Loss=7.179538249969482
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7057104110717773, Reg Loss=6.98306131362915
Clinet index 1, End of Epoch 1/6, Average Loss=7.688771724700928, Class Loss=0.7057104110717773, Reg Loss=6.98306131362915
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.6833067536354065, Reg Loss=6.73594856262207
Clinet index 1, End of Epoch 2/6, Average Loss=7.419255256652832, Class Loss=0.6833067536354065, Reg Loss=6.73594856262207
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.70116126537323, Reg Loss=7.049248695373535
Clinet index 1, End of Epoch 3/6, Average Loss=7.750410079956055, Class Loss=0.70116126537323, Reg Loss=7.049248695373535
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.6717837452888489, Reg Loss=7.062341213226318
Clinet index 1, End of Epoch 4/6, Average Loss=7.734125137329102, Class Loss=0.6717837452888489, Reg Loss=7.062341213226318
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.625173807144165, Reg Loss=6.831075668334961
Clinet index 1, End of Epoch 5/6, Average Loss=7.456249237060547, Class Loss=0.625173807144165, Reg Loss=6.831075668334961
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.6327511668205261, Reg Loss=6.579668045043945
Clinet index 1, End of Epoch 6/6, Average Loss=7.212419033050537, Class Loss=0.6327511668205261, Reg Loss=6.579668045043945
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6618985533714294, Reg Loss=6.710294246673584
Clinet index 11, End of Epoch 1/6, Average Loss=7.372192859649658, Class Loss=0.6618985533714294, Reg Loss=6.710294246673584
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.6257068514823914, Reg Loss=6.825251579284668
Clinet index 11, End of Epoch 2/6, Average Loss=7.450958251953125, Class Loss=0.6257068514823914, Reg Loss=6.825251579284668
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.6322988867759705, Reg Loss=7.3112077713012695
Clinet index 11, End of Epoch 3/6, Average Loss=7.943506717681885, Class Loss=0.6322988867759705, Reg Loss=7.3112077713012695
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.6345632672309875, Reg Loss=7.142634391784668
Clinet index 11, End of Epoch 4/6, Average Loss=7.77719783782959, Class Loss=0.6345632672309875, Reg Loss=7.142634391784668
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.6008275747299194, Reg Loss=7.048067569732666
Clinet index 11, End of Epoch 5/6, Average Loss=7.648895263671875, Class Loss=0.6008275747299194, Reg Loss=7.048067569732666
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.575768232345581, Reg Loss=6.90024995803833
Clinet index 11, End of Epoch 6/6, Average Loss=7.476017951965332, Class Loss=0.575768232345581, Reg Loss=6.90024995803833
federated aggregation...
Validation, Class Loss=0.22171473503112793, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.921098
Mean Acc: 0.749403
FreqW Acc: 0.871594
Mean IoU: 0.670952
Class IoU:
	class 0: 0.92220914
	class 1: 0.9104905
	class 2: 0.39130962
	class 3: 0.32893008
	class 4: 0.6288452
	class 5: 0.5826729
	class 6: 0.93788254
	class 7: 0.8767025
	class 8: 0.8619496
	class 9: 0.3783194
	class 10: 0.7091977
	class 11: 0.5450257
	class 12: 0.8471094
	class 13: 0.7807899
	class 14: 0.7546311
	class 15: 0.8336448
	class 16: 0.11647092
Class Acc:
	class 0: 0.97339207
	class 1: 0.96080446
	class 2: 0.7074471
	class 3: 0.3295981
	class 4: 0.7152264
	class 5: 0.61418957
	class 6: 0.9657657
	class 7: 0.8944019
	class 8: 0.8758776
	class 9: 0.44082734
	class 10: 0.7267254
	class 11: 0.5717865
	class 12: 0.8853158
	class 13: 0.9215923
	class 14: 0.7855724
	class 15: 0.853512
	class 16: 0.51781887

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.6137200593948364, Reg Loss=6.054937362670898
Clinet index 8, End of Epoch 1/6, Average Loss=6.668657302856445, Class Loss=0.6137200593948364, Reg Loss=6.054937362670898
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.6156295537948608, Reg Loss=5.896820545196533
Clinet index 8, End of Epoch 2/6, Average Loss=6.512450218200684, Class Loss=0.6156295537948608, Reg Loss=5.896820545196533
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5772900581359863, Reg Loss=6.035732269287109
Clinet index 8, End of Epoch 3/6, Average Loss=6.613022327423096, Class Loss=0.5772900581359863, Reg Loss=6.035732269287109
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5940211415290833, Reg Loss=6.3470563888549805
Clinet index 8, End of Epoch 4/6, Average Loss=6.941077709197998, Class Loss=0.5940211415290833, Reg Loss=6.3470563888549805
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.5825813412666321, Reg Loss=6.341036319732666
Clinet index 8, End of Epoch 5/6, Average Loss=6.923617839813232, Class Loss=0.5825813412666321, Reg Loss=6.341036319732666
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.5661466717720032, Reg Loss=6.334717750549316
Clinet index 8, End of Epoch 6/6, Average Loss=6.900864601135254, Class Loss=0.5661466717720032, Reg Loss=6.334717750549316
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6671885251998901, Reg Loss=6.068813800811768
Clinet index 5, End of Epoch 1/6, Average Loss=6.736002445220947, Class Loss=0.6671885251998901, Reg Loss=6.068813800811768
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.6575738787651062, Reg Loss=6.706184387207031
Clinet index 5, End of Epoch 2/6, Average Loss=7.363758087158203, Class Loss=0.6575738787651062, Reg Loss=6.706184387207031
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.6558542251586914, Reg Loss=6.400664329528809
Clinet index 5, End of Epoch 3/6, Average Loss=7.0565185546875, Class Loss=0.6558542251586914, Reg Loss=6.400664329528809
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.6504834890365601, Reg Loss=6.9956440925598145
Clinet index 5, End of Epoch 4/6, Average Loss=7.646127700805664, Class Loss=0.6504834890365601, Reg Loss=6.9956440925598145
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.6125805377960205, Reg Loss=6.9116435050964355
Clinet index 5, End of Epoch 5/6, Average Loss=7.524224281311035, Class Loss=0.6125805377960205, Reg Loss=6.9116435050964355
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5964450240135193, Reg Loss=6.700223445892334
Clinet index 5, End of Epoch 6/6, Average Loss=7.296668529510498, Class Loss=0.5964450240135193, Reg Loss=6.700223445892334
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.6119375824928284, Reg Loss=6.724276065826416
Clinet index 2, End of Epoch 1/6, Average Loss=7.3362135887146, Class Loss=0.6119375824928284, Reg Loss=6.724276065826416
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5943755507469177, Reg Loss=6.1303839683532715
Clinet index 2, End of Epoch 2/6, Average Loss=6.724759578704834, Class Loss=0.5943755507469177, Reg Loss=6.1303839683532715
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5996922850608826, Reg Loss=6.190344333648682
Clinet index 2, End of Epoch 3/6, Average Loss=6.790036678314209, Class Loss=0.5996922850608826, Reg Loss=6.190344333648682
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5871985554695129, Reg Loss=6.228756904602051
Clinet index 2, End of Epoch 4/6, Average Loss=6.815955638885498, Class Loss=0.5871985554695129, Reg Loss=6.228756904602051
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.5838561058044434, Reg Loss=6.31627082824707
Clinet index 2, End of Epoch 5/6, Average Loss=6.900126934051514, Class Loss=0.5838561058044434, Reg Loss=6.31627082824707
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.5790210366249084, Reg Loss=6.1322431564331055
Clinet index 2, End of Epoch 6/6, Average Loss=6.711264133453369, Class Loss=0.5790210366249084, Reg Loss=6.1322431564331055
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.5915960669517517, Reg Loss=5.985759735107422
Clinet index 9, End of Epoch 1/6, Average Loss=6.577355861663818, Class Loss=0.5915960669517517, Reg Loss=5.985759735107422
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.5799700021743774, Reg Loss=6.451923847198486
Clinet index 9, End of Epoch 2/6, Average Loss=7.031893730163574, Class Loss=0.5799700021743774, Reg Loss=6.451923847198486
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.5681270956993103, Reg Loss=6.648047924041748
Clinet index 9, End of Epoch 3/6, Average Loss=7.216175079345703, Class Loss=0.5681270956993103, Reg Loss=6.648047924041748
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.5691218376159668, Reg Loss=6.478161334991455
Clinet index 9, End of Epoch 4/6, Average Loss=7.047283172607422, Class Loss=0.5691218376159668, Reg Loss=6.478161334991455
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.5811510682106018, Reg Loss=6.552618026733398
Clinet index 9, End of Epoch 5/6, Average Loss=7.1337690353393555, Class Loss=0.5811510682106018, Reg Loss=6.552618026733398
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.5553780198097229, Reg Loss=5.705173015594482
Clinet index 9, End of Epoch 6/6, Average Loss=6.2605509757995605, Class Loss=0.5553780198097229, Reg Loss=5.705173015594482
federated aggregation...
Validation, Class Loss=0.2338675558567047, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.915890
Mean Acc: 0.737582
FreqW Acc: 0.867301
Mean IoU: 0.658530
Class IoU:
	class 0: 0.919842
	class 1: 0.9083597
	class 2: 0.38644332
	class 3: 0.16287448
	class 4: 0.6223231
	class 5: 0.5539382
	class 6: 0.9410707
	class 7: 0.8705252
	class 8: 0.842892
	class 9: 0.37598997
	class 10: 0.72961104
	class 11: 0.5453464
	class 12: 0.85552824
	class 13: 0.7931045
	class 14: 0.7448664
	class 15: 0.8324619
	class 16: 0.10982435
Class Acc:
	class 0: 0.9706133
	class 1: 0.9617729
	class 2: 0.6896494
	class 3: 0.162931
	class 4: 0.70671
	class 5: 0.5817595
	class 6: 0.9709311
	class 7: 0.88518465
	class 8: 0.85421854
	class 9: 0.43688795
	class 10: 0.7501482
	class 11: 0.5710673
	class 12: 0.88445985
	class 13: 0.88522094
	class 14: 0.7726626
	class 15: 0.8520107
	class 16: 0.6026633

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.5759097337722778, Reg Loss=5.534867286682129
Clinet index 8, End of Epoch 1/6, Average Loss=6.110776901245117, Class Loss=0.5759097337722778, Reg Loss=5.534867286682129
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.5869364738464355, Reg Loss=5.431375026702881
Clinet index 8, End of Epoch 2/6, Average Loss=6.018311500549316, Class Loss=0.5869364738464355, Reg Loss=5.431375026702881
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.5570970177650452, Reg Loss=5.655282497406006
Clinet index 8, End of Epoch 3/6, Average Loss=6.212379455566406, Class Loss=0.5570970177650452, Reg Loss=5.655282497406006
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.571910560131073, Reg Loss=5.804794788360596
Clinet index 8, End of Epoch 4/6, Average Loss=6.376705169677734, Class Loss=0.571910560131073, Reg Loss=5.804794788360596
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.5666953921318054, Reg Loss=5.751962184906006
Clinet index 8, End of Epoch 5/6, Average Loss=6.318657398223877, Class Loss=0.5666953921318054, Reg Loss=5.751962184906006
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.5642145276069641, Reg Loss=5.702433109283447
Clinet index 8, End of Epoch 6/6, Average Loss=6.266647815704346, Class Loss=0.5642145276069641, Reg Loss=5.702433109283447
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.568687379360199, Reg Loss=5.616546630859375
Clinet index 9, End of Epoch 1/6, Average Loss=6.185234069824219, Class Loss=0.568687379360199, Reg Loss=5.616546630859375
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.5467427372932434, Reg Loss=6.096865653991699
Clinet index 9, End of Epoch 2/6, Average Loss=6.643608570098877, Class Loss=0.5467427372932434, Reg Loss=6.096865653991699
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.5323184728622437, Reg Loss=6.098911762237549
Clinet index 9, End of Epoch 3/6, Average Loss=6.631230354309082, Class Loss=0.5323184728622437, Reg Loss=6.098911762237549
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.5745295286178589, Reg Loss=5.7153472900390625
Clinet index 9, End of Epoch 4/6, Average Loss=6.289876937866211, Class Loss=0.5745295286178589, Reg Loss=5.7153472900390625
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.5550011396408081, Reg Loss=5.933362007141113
Clinet index 9, End of Epoch 5/6, Average Loss=6.488363265991211, Class Loss=0.5550011396408081, Reg Loss=5.933362007141113
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.5455868244171143, Reg Loss=5.277738571166992
Clinet index 9, End of Epoch 6/6, Average Loss=5.823325157165527, Class Loss=0.5455868244171143, Reg Loss=5.277738571166992
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.5521836876869202, Reg Loss=5.734461307525635
Clinet index 12, End of Epoch 1/6, Average Loss=6.28664493560791, Class Loss=0.5521836876869202, Reg Loss=5.734461307525635
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.5457791686058044, Reg Loss=6.241564750671387
Clinet index 12, End of Epoch 2/6, Average Loss=6.787343978881836, Class Loss=0.5457791686058044, Reg Loss=6.241564750671387
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.5494403839111328, Reg Loss=6.041060447692871
Clinet index 12, End of Epoch 3/6, Average Loss=6.590500831604004, Class Loss=0.5494403839111328, Reg Loss=6.041060447692871
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.5394151210784912, Reg Loss=6.085607051849365
Clinet index 12, End of Epoch 4/6, Average Loss=6.625021934509277, Class Loss=0.5394151210784912, Reg Loss=6.085607051849365
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.5343872308731079, Reg Loss=6.252176284790039
Clinet index 12, End of Epoch 5/6, Average Loss=6.786563396453857, Class Loss=0.5343872308731079, Reg Loss=6.252176284790039
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.5411630868911743, Reg Loss=5.857842922210693
Clinet index 12, End of Epoch 6/6, Average Loss=6.399005889892578, Class Loss=0.5411630868911743, Reg Loss=5.857842922210693
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5332292318344116, Reg Loss=5.862786293029785
Clinet index 4, End of Epoch 1/6, Average Loss=6.396015644073486, Class Loss=0.5332292318344116, Reg Loss=5.862786293029785
Pseudo labeling is: None
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.5485603213310242, Reg Loss=5.8924241065979
Clinet index 4, End of Epoch 2/6, Average Loss=6.44098424911499, Class Loss=0.5485603213310242, Reg Loss=5.8924241065979
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.5262271165847778, Reg Loss=5.652446746826172
Clinet index 4, End of Epoch 3/6, Average Loss=6.17867374420166, Class Loss=0.5262271165847778, Reg Loss=5.652446746826172
Pseudo labeling is: None
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.53984135389328, Reg Loss=5.6227264404296875
Clinet index 4, End of Epoch 4/6, Average Loss=6.162567615509033, Class Loss=0.53984135389328, Reg Loss=5.6227264404296875
Pseudo labeling is: None
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.5371597409248352, Reg Loss=6.166795253753662
Clinet index 4, End of Epoch 5/6, Average Loss=6.703955173492432, Class Loss=0.5371597409248352, Reg Loss=6.166795253753662
Pseudo labeling is: None
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.5286909341812134, Reg Loss=5.931192398071289
Clinet index 4, End of Epoch 6/6, Average Loss=6.459883213043213, Class Loss=0.5286909341812134, Reg Loss=5.931192398071289
federated aggregation...
Validation, Class Loss=0.2334885150194168, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.916432
Mean Acc: 0.739983
FreqW Acc: 0.869017
Mean IoU: 0.660042
Class IoU:
	class 0: 0.9207055
	class 1: 0.90644825
	class 2: 0.38265553
	class 3: 0.15479846
	class 4: 0.6173477
	class 5: 0.5639665
	class 6: 0.93960714
	class 7: 0.8755693
	class 8: 0.8544014
	class 9: 0.37686372
	class 10: 0.7327392
	class 11: 0.53840125
	class 12: 0.8608389
	class 13: 0.7997115
	class 14: 0.74797595
	class 15: 0.8394822
	class 16: 0.10919908
Class Acc:
	class 0: 0.96906143
	class 1: 0.9610132
	class 2: 0.67840254
	class 3: 0.15484415
	class 4: 0.699104
	class 5: 0.5930513
	class 6: 0.9682473
	class 7: 0.88998884
	class 8: 0.86791855
	class 9: 0.4391545
	class 10: 0.7539982
	class 11: 0.56327105
	class 12: 0.89339733
	class 13: 0.89770126
	class 14: 0.77541286
	class 15: 0.8624237
	class 16: 0.6127152

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.9475715160369873, Reg Loss=32.17668151855469
Clinet index 14, End of Epoch 1/6, Average Loss=34.12425231933594, Class Loss=1.9475715160369873, Reg Loss=32.17668151855469
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.8491201400756836, Reg Loss=22.854007720947266
Clinet index 14, End of Epoch 2/6, Average Loss=24.703128814697266, Class Loss=1.8491201400756836, Reg Loss=22.854007720947266
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.7588471174240112, Reg Loss=20.83575439453125
Clinet index 14, End of Epoch 3/6, Average Loss=22.594600677490234, Class Loss=1.7588471174240112, Reg Loss=20.83575439453125
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.3222265243530273, Reg Loss=18.007478713989258
Clinet index 14, End of Epoch 4/6, Average Loss=19.32970428466797, Class Loss=1.3222265243530273, Reg Loss=18.007478713989258
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.2757563591003418, Reg Loss=16.701143264770508
Clinet index 14, End of Epoch 5/6, Average Loss=17.976900100708008, Class Loss=1.2757563591003418, Reg Loss=16.701143264770508
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9750463366508484, Reg Loss=15.359959602355957
Clinet index 14, End of Epoch 6/6, Average Loss=16.335006713867188, Class Loss=0.9750463366508484, Reg Loss=15.359959602355957
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.846667766571045, Reg Loss=31.631898880004883
Clinet index 6, End of Epoch 1/6, Average Loss=33.47856521606445, Class Loss=1.846667766571045, Reg Loss=31.631898880004883
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.7552729845046997, Reg Loss=23.598976135253906
Clinet index 6, End of Epoch 2/6, Average Loss=25.354249954223633, Class Loss=1.7552729845046997, Reg Loss=23.598976135253906
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5736212730407715, Reg Loss=20.65036964416504
Clinet index 6, End of Epoch 3/6, Average Loss=22.22399139404297, Class Loss=1.5736212730407715, Reg Loss=20.65036964416504
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.4291787147521973, Reg Loss=18.097440719604492
Clinet index 6, End of Epoch 4/6, Average Loss=19.52661895751953, Class Loss=1.4291787147521973, Reg Loss=18.097440719604492
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.175002098083496, Reg Loss=16.773494720458984
Clinet index 6, End of Epoch 5/6, Average Loss=17.948497772216797, Class Loss=1.175002098083496, Reg Loss=16.773494720458984
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9102638959884644, Reg Loss=15.684070587158203
Clinet index 6, End of Epoch 6/6, Average Loss=16.59433364868164, Class Loss=0.9102638959884644, Reg Loss=15.684070587158203
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=1.9568629264831543, Reg Loss=34.72381591796875
Clinet index 0, End of Epoch 1/6, Average Loss=36.68067932128906, Class Loss=1.9568629264831543, Reg Loss=34.72381591796875
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.768231987953186, Reg Loss=24.18509292602539
Clinet index 0, End of Epoch 2/6, Average Loss=25.953325271606445, Class Loss=1.768231987953186, Reg Loss=24.18509292602539
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6356571912765503, Reg Loss=20.530847549438477
Clinet index 0, End of Epoch 3/6, Average Loss=22.16650390625, Class Loss=1.6356571912765503, Reg Loss=20.530847549438477
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.397940993309021, Reg Loss=18.314611434936523
Clinet index 0, End of Epoch 4/6, Average Loss=19.712553024291992, Class Loss=1.397940993309021, Reg Loss=18.314611434936523
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1918351650238037, Reg Loss=17.118183135986328
Clinet index 0, End of Epoch 5/6, Average Loss=18.31001853942871, Class Loss=1.1918351650238037, Reg Loss=17.118183135986328
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=1.0385992527008057, Reg Loss=15.879612922668457
Clinet index 0, End of Epoch 6/6, Average Loss=16.918212890625, Class Loss=1.0385992527008057, Reg Loss=15.879612922668457
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.6994118690490723, Reg Loss=30.556419372558594
Clinet index 16, End of Epoch 1/6, Average Loss=32.25583267211914, Class Loss=1.6994118690490723, Reg Loss=30.556419372558594
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=1.5648303031921387, Reg Loss=21.338228225708008
Clinet index 16, End of Epoch 2/6, Average Loss=22.903059005737305, Class Loss=1.5648303031921387, Reg Loss=21.338228225708008
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5687534809112549, Reg Loss=19.711130142211914
Clinet index 16, End of Epoch 3/6, Average Loss=21.279884338378906, Class Loss=1.5687534809112549, Reg Loss=19.711130142211914
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.227410912513733, Reg Loss=17.592893600463867
Clinet index 16, End of Epoch 4/6, Average Loss=18.82030487060547, Class Loss=1.227410912513733, Reg Loss=17.592893600463867
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1835544109344482, Reg Loss=16.50335693359375
Clinet index 16, End of Epoch 5/6, Average Loss=17.68691062927246, Class Loss=1.1835544109344482, Reg Loss=16.50335693359375
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8913549184799194, Reg Loss=15.166092872619629
Clinet index 16, End of Epoch 6/6, Average Loss=16.05744743347168, Class Loss=0.8913549184799194, Reg Loss=15.166092872619629
federated aggregation...
Validation, Class Loss=0.31041452288627625, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.882684
Mean Acc: 0.640367
FreqW Acc: 0.791218
Mean IoU: 0.579353
Class IoU:
	class 0: 0.86614347
	class 1: 0.8539014
	class 2: 0.4029342
	class 3: 0.6868747
	class 4: 0.6004648
	class 5: 0.7380483
	class 6: 0.9254542
	class 7: 0.8137876
	class 8: 0.63599247
	class 9: 0.3613338
	class 10: 0.66813993
	class 11: 0.36420563
	class 12: 0.30581266
	class 13: 0.7565783
	class 14: 0.64122415
	class 15: 0.6829821
	class 16: 0.12197451
	class 17: 0.0025011678
Class Acc:
	class 0: 0.9827575
	class 1: 0.8930234
	class 2: 0.7492014
	class 3: 0.6911454
	class 4: 0.6814236
	class 5: 0.7844825
	class 6: 0.95972157
	class 7: 0.82499886
	class 8: 0.63870615
	class 9: 0.43024063
	class 10: 0.7397213
	class 11: 0.36632258
	class 12: 0.3078251
	class 13: 0.8433219
	class 14: 0.6617173
	class 15: 0.6957024
	class 16: 0.2737496
	class 17: 0.0025466739

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.8689897060394287, Reg Loss=14.657538414001465
Clinet index 0, End of Epoch 1/6, Average Loss=15.526528358459473, Class Loss=0.8689897060394287, Reg Loss=14.657538414001465
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.8460491299629211, Reg Loss=13.944978713989258
Clinet index 0, End of Epoch 2/6, Average Loss=14.791028022766113, Class Loss=0.8460491299629211, Reg Loss=13.944978713989258
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7832647562026978, Reg Loss=13.253597259521484
Clinet index 0, End of Epoch 3/6, Average Loss=14.03686237335205, Class Loss=0.7832647562026978, Reg Loss=13.253597259521484
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.642554521560669, Reg Loss=12.859945297241211
Clinet index 0, End of Epoch 4/6, Average Loss=13.5024995803833, Class Loss=0.642554521560669, Reg Loss=12.859945297241211
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5697547793388367, Reg Loss=12.979391098022461
Clinet index 0, End of Epoch 5/6, Average Loss=13.549145698547363, Class Loss=0.5697547793388367, Reg Loss=12.979391098022461
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5119616985321045, Reg Loss=12.755232810974121
Clinet index 0, End of Epoch 6/6, Average Loss=13.267194747924805, Class Loss=0.5119616985321045, Reg Loss=12.755232810974121
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8387883901596069, Reg Loss=15.549784660339355
Clinet index 12, End of Epoch 1/6, Average Loss=16.388572692871094, Class Loss=0.8387883901596069, Reg Loss=15.549784660339355
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.8781047463417053, Reg Loss=14.374860763549805
Clinet index 12, End of Epoch 2/6, Average Loss=15.252965927124023, Class Loss=0.8781047463417053, Reg Loss=14.374860763549805
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.7778177857398987, Reg Loss=13.72647476196289
Clinet index 12, End of Epoch 3/6, Average Loss=14.504292488098145, Class Loss=0.7778177857398987, Reg Loss=13.72647476196289
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5659205913543701, Reg Loss=13.08692455291748
Clinet index 12, End of Epoch 4/6, Average Loss=13.65284538269043, Class Loss=0.5659205913543701, Reg Loss=13.08692455291748
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4769483506679535, Reg Loss=12.692181587219238
Clinet index 12, End of Epoch 5/6, Average Loss=13.169130325317383, Class Loss=0.4769483506679535, Reg Loss=12.692181587219238
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4284801185131073, Reg Loss=12.840535163879395
Clinet index 12, End of Epoch 6/6, Average Loss=13.269015312194824, Class Loss=0.4284801185131073, Reg Loss=12.840535163879395
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8782600164413452, Reg Loss=15.445112228393555
Clinet index 10, End of Epoch 1/6, Average Loss=16.32337188720703, Class Loss=0.8782600164413452, Reg Loss=15.445112228393555
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.8413374423980713, Reg Loss=13.915406227111816
Clinet index 10, End of Epoch 2/6, Average Loss=14.756743431091309, Class Loss=0.8413374423980713, Reg Loss=13.915406227111816
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.7758921980857849, Reg Loss=14.720295906066895
Clinet index 10, End of Epoch 3/6, Average Loss=15.496188163757324, Class Loss=0.7758921980857849, Reg Loss=14.720295906066895
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5896590948104858, Reg Loss=12.987003326416016
Clinet index 10, End of Epoch 4/6, Average Loss=13.576662063598633, Class Loss=0.5896590948104858, Reg Loss=12.987003326416016
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5344073176383972, Reg Loss=12.72836685180664
Clinet index 10, End of Epoch 5/6, Average Loss=13.262774467468262, Class Loss=0.5344073176383972, Reg Loss=12.72836685180664
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4190957844257355, Reg Loss=12.065346717834473
Clinet index 10, End of Epoch 6/6, Average Loss=12.484442710876465, Class Loss=0.4190957844257355, Reg Loss=12.065346717834473
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8239339590072632, Reg Loss=14.275174140930176
Clinet index 17, End of Epoch 1/6, Average Loss=15.09910774230957, Class Loss=0.8239339590072632, Reg Loss=14.275174140930176
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7935007810592651, Reg Loss=13.952670097351074
Clinet index 17, End of Epoch 2/6, Average Loss=14.746170997619629, Class Loss=0.7935007810592651, Reg Loss=13.952670097351074
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.695838212966919, Reg Loss=13.356627464294434
Clinet index 17, End of Epoch 3/6, Average Loss=14.052465438842773, Class Loss=0.695838212966919, Reg Loss=13.356627464294434
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6093551516532898, Reg Loss=12.867900848388672
Clinet index 17, End of Epoch 4/6, Average Loss=13.477255821228027, Class Loss=0.6093551516532898, Reg Loss=12.867900848388672
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5179033875465393, Reg Loss=12.624917984008789
Clinet index 17, End of Epoch 5/6, Average Loss=13.142821311950684, Class Loss=0.5179033875465393, Reg Loss=12.624917984008789
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4497053921222687, Reg Loss=11.908809661865234
Clinet index 17, End of Epoch 6/6, Average Loss=12.358514785766602, Class Loss=0.4497053921222687, Reg Loss=11.908809661865234
federated aggregation...
Validation, Class Loss=0.3355092704296112, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.868687
Mean Acc: 0.621777
FreqW Acc: 0.779778
Mean IoU: 0.548844
Class IoU:
	class 0: 0.87422913
	class 1: 0.872954
	class 2: 0.4198949
	class 3: 0.5425309
	class 4: 0.6282317
	class 5: 0.72186935
	class 6: 0.9290749
	class 7: 0.7658104
	class 8: 0.47250855
	class 9: 0.3621426
	class 10: 0.4364713
	class 11: 0.4823445
	class 12: 0.20161065
	class 13: 0.7065357
	class 14: 0.5994083
	class 15: 0.60660243
	class 16: 0.09293843
	class 17: 0.16403668
Class Acc:
	class 0: 0.98517126
	class 1: 0.90121967
	class 2: 0.7433293
	class 3: 0.54447347
	class 4: 0.74473923
	class 5: 0.76371473
	class 6: 0.9575964
	class 7: 0.7740988
	class 8: 0.473258
	class 9: 0.44479343
	class 10: 0.43857446
	class 11: 0.4868475
	class 12: 0.20196714
	class 13: 0.75820684
	class 14: 0.6130896
	class 15: 0.61191034
	class 16: 0.15295987
	class 17: 0.5960349

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3993726372718811, Reg Loss=12.63878059387207
Clinet index 14, End of Epoch 1/6, Average Loss=13.038153648376465, Class Loss=0.3993726372718811, Reg Loss=12.63878059387207
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.3912314176559448, Reg Loss=11.871688842773438
Clinet index 14, End of Epoch 2/6, Average Loss=12.262920379638672, Class Loss=0.3912314176559448, Reg Loss=11.871688842773438
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.43050941824913025, Reg Loss=12.289430618286133
Clinet index 14, End of Epoch 3/6, Average Loss=12.719940185546875, Class Loss=0.43050941824913025, Reg Loss=12.289430618286133
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3617934584617615, Reg Loss=11.609943389892578
Clinet index 14, End of Epoch 4/6, Average Loss=11.971736907958984, Class Loss=0.3617934584617615, Reg Loss=11.609943389892578
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.3657503128051758, Reg Loss=11.570734977722168
Clinet index 14, End of Epoch 5/6, Average Loss=11.936485290527344, Class Loss=0.3657503128051758, Reg Loss=11.570734977722168
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.2737544775009155, Reg Loss=11.495881080627441
Clinet index 14, End of Epoch 6/6, Average Loss=11.769635200500488, Class Loss=0.2737544775009155, Reg Loss=11.495881080627441
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.34625720977783203, Reg Loss=12.263616561889648
Clinet index 8, End of Epoch 1/6, Average Loss=12.60987377166748, Class Loss=0.34625720977783203, Reg Loss=12.263616561889648
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.30607250332832336, Reg Loss=11.131315231323242
Clinet index 8, End of Epoch 2/6, Average Loss=11.437387466430664, Class Loss=0.30607250332832336, Reg Loss=11.131315231323242
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3123537302017212, Reg Loss=10.843914031982422
Clinet index 8, End of Epoch 3/6, Average Loss=11.156268119812012, Class Loss=0.3123537302017212, Reg Loss=10.843914031982422
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.2770543694496155, Reg Loss=11.197895050048828
Clinet index 8, End of Epoch 4/6, Average Loss=11.474949836730957, Class Loss=0.2770543694496155, Reg Loss=11.197895050048828
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.24679432809352875, Reg Loss=11.118182182312012
Clinet index 8, End of Epoch 5/6, Average Loss=11.36497688293457, Class Loss=0.24679432809352875, Reg Loss=11.118182182312012
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.2303134649991989, Reg Loss=10.202547073364258
Clinet index 8, End of Epoch 6/6, Average Loss=10.432860374450684, Class Loss=0.2303134649991989, Reg Loss=10.202547073364258
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.358345091342926, Reg Loss=11.659920692443848
Clinet index 16, End of Epoch 1/6, Average Loss=12.018265724182129, Class Loss=0.358345091342926, Reg Loss=11.659920692443848
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.32380470633506775, Reg Loss=11.198237419128418
Clinet index 16, End of Epoch 2/6, Average Loss=11.522042274475098, Class Loss=0.32380470633506775, Reg Loss=11.198237419128418
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.4053412079811096, Reg Loss=11.653871536254883
Clinet index 16, End of Epoch 3/6, Average Loss=12.059212684631348, Class Loss=0.4053412079811096, Reg Loss=11.653871536254883
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.282961905002594, Reg Loss=11.162444114685059
Clinet index 16, End of Epoch 4/6, Average Loss=11.445405960083008, Class Loss=0.282961905002594, Reg Loss=11.162444114685059
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.30753815174102783, Reg Loss=11.274813652038574
Clinet index 16, End of Epoch 5/6, Average Loss=11.582351684570312, Class Loss=0.30753815174102783, Reg Loss=11.274813652038574
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.2804795503616333, Reg Loss=10.926888465881348
Clinet index 16, End of Epoch 6/6, Average Loss=11.207367897033691, Class Loss=0.2804795503616333, Reg Loss=10.926888465881348
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.36230599880218506, Reg Loss=12.505224227905273
Clinet index 3, End of Epoch 1/6, Average Loss=12.86752986907959, Class Loss=0.36230599880218506, Reg Loss=12.505224227905273
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.44748997688293457, Reg Loss=12.668597221374512
Clinet index 3, End of Epoch 2/6, Average Loss=13.116086959838867, Class Loss=0.44748997688293457, Reg Loss=12.668597221374512
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.42344117164611816, Reg Loss=12.197660446166992
Clinet index 3, End of Epoch 3/6, Average Loss=12.621101379394531, Class Loss=0.42344117164611816, Reg Loss=12.197660446166992
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3352712094783783, Reg Loss=11.37995719909668
Clinet index 3, End of Epoch 4/6, Average Loss=11.715228080749512, Class Loss=0.3352712094783783, Reg Loss=11.37995719909668
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.2604368329048157, Reg Loss=10.921273231506348
Clinet index 3, End of Epoch 5/6, Average Loss=11.181710243225098, Class Loss=0.2604368329048157, Reg Loss=10.921273231506348
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.2762136459350586, Reg Loss=11.570405960083008
Clinet index 3, End of Epoch 6/6, Average Loss=11.846619606018066, Class Loss=0.2762136459350586, Reg Loss=11.570405960083008
federated aggregation...
Validation, Class Loss=0.390316903591156, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.847100
Mean Acc: 0.565505
FreqW Acc: 0.770039
Mean IoU: 0.480288
Class IoU:
	class 0: 0.8914486
	class 1: 0.8643864
	class 2: 0.41985846
	class 3: 0.11417992
	class 4: 0.6271601
	class 5: 0.681267
	class 6: 0.9309306
	class 7: 0.76717997
	class 8: 0.2241301
	class 9: 0.35301226
	class 10: 0.20262815
	class 11: 0.47377422
	class 12: 0.05327653
	class 13: 0.6261883
	class 14: 0.5854088
	class 15: 0.62277764
	class 16: 0.09829899
	class 17: 0.109283604
Class Acc:
	class 0: 0.9823193
	class 1: 0.8958716
	class 2: 0.74311066
	class 3: 0.11427027
	class 4: 0.7532628
	class 5: 0.7187362
	class 6: 0.9599237
	class 7: 0.77387154
	class 8: 0.22428645
	class 9: 0.43691656
	class 10: 0.20326185
	class 11: 0.4774494
	class 12: 0.053303137
	class 13: 0.6380456
	class 14: 0.5977797
	class 15: 0.6274769
	class 16: 0.12784767
	class 17: 0.8513528

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.2531941533088684, Reg Loss=10.551880836486816
Clinet index 17, End of Epoch 1/6, Average Loss=10.805074691772461, Class Loss=0.2531941533088684, Reg Loss=10.551880836486816
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.25173598527908325, Reg Loss=10.704146385192871
Clinet index 17, End of Epoch 2/6, Average Loss=10.95588207244873, Class Loss=0.25173598527908325, Reg Loss=10.704146385192871
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.23715068399906158, Reg Loss=10.391694068908691
Clinet index 17, End of Epoch 3/6, Average Loss=10.62884521484375, Class Loss=0.23715068399906158, Reg Loss=10.391694068908691
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.23929432034492493, Reg Loss=10.415778160095215
Clinet index 17, End of Epoch 4/6, Average Loss=10.655072212219238, Class Loss=0.23929432034492493, Reg Loss=10.415778160095215
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.2065449357032776, Reg Loss=10.491888999938965
Clinet index 17, End of Epoch 5/6, Average Loss=10.698433876037598, Class Loss=0.2065449357032776, Reg Loss=10.491888999938965
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.2369384467601776, Reg Loss=9.785996437072754
Clinet index 17, End of Epoch 6/6, Average Loss=10.022934913635254, Class Loss=0.2369384467601776, Reg Loss=9.785996437072754
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23627634346485138, Reg Loss=10.621731758117676
Clinet index 13, End of Epoch 1/6, Average Loss=10.85800838470459, Class Loss=0.23627634346485138, Reg Loss=10.621731758117676
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.24866606295108795, Reg Loss=10.900583267211914
Clinet index 13, End of Epoch 2/6, Average Loss=11.149249076843262, Class Loss=0.24866606295108795, Reg Loss=10.900583267211914
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.243251234292984, Reg Loss=11.092766761779785
Clinet index 13, End of Epoch 3/6, Average Loss=11.336017608642578, Class Loss=0.243251234292984, Reg Loss=11.092766761779785
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2487323135137558, Reg Loss=10.93490982055664
Clinet index 13, End of Epoch 4/6, Average Loss=11.183642387390137, Class Loss=0.2487323135137558, Reg Loss=10.93490982055664
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.21237802505493164, Reg Loss=10.325103759765625
Clinet index 13, End of Epoch 5/6, Average Loss=10.537481307983398, Class Loss=0.21237802505493164, Reg Loss=10.325103759765625
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.216093510389328, Reg Loss=10.20728874206543
Clinet index 13, End of Epoch 6/6, Average Loss=10.423381805419922, Class Loss=0.216093510389328, Reg Loss=10.20728874206543
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1879332959651947, Reg Loss=11.097014427185059
Clinet index 11, End of Epoch 1/6, Average Loss=11.284947395324707, Class Loss=0.1879332959651947, Reg Loss=11.097014427185059
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.23020368814468384, Reg Loss=11.317194938659668
Clinet index 11, End of Epoch 2/6, Average Loss=11.547398567199707, Class Loss=0.23020368814468384, Reg Loss=11.317194938659668
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2131059169769287, Reg Loss=10.992132186889648
Clinet index 11, End of Epoch 3/6, Average Loss=11.205238342285156, Class Loss=0.2131059169769287, Reg Loss=10.992132186889648
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2037222683429718, Reg Loss=11.654985427856445
Clinet index 11, End of Epoch 4/6, Average Loss=11.858707427978516, Class Loss=0.2037222683429718, Reg Loss=11.654985427856445
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.222674161195755, Reg Loss=10.753135681152344
Clinet index 11, End of Epoch 5/6, Average Loss=10.975810050964355, Class Loss=0.222674161195755, Reg Loss=10.753135681152344
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.19193701446056366, Reg Loss=11.340506553649902
Clinet index 11, End of Epoch 6/6, Average Loss=11.53244400024414, Class Loss=0.19193701446056366, Reg Loss=11.340506553649902
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.35864031314849854, Reg Loss=11.250853538513184
Clinet index 7, End of Epoch 1/6, Average Loss=11.60949420928955, Class Loss=0.35864031314849854, Reg Loss=11.250853538513184
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.3035707473754883, Reg Loss=11.124984741210938
Clinet index 7, End of Epoch 2/6, Average Loss=11.428555488586426, Class Loss=0.3035707473754883, Reg Loss=11.124984741210938
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2625080347061157, Reg Loss=10.552840232849121
Clinet index 7, End of Epoch 3/6, Average Loss=10.815348625183105, Class Loss=0.2625080347061157, Reg Loss=10.552840232849121
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.23950275778770447, Reg Loss=10.356478691101074
Clinet index 7, End of Epoch 4/6, Average Loss=10.59598159790039, Class Loss=0.23950275778770447, Reg Loss=10.356478691101074
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.2927747368812561, Reg Loss=10.28185749053955
Clinet index 7, End of Epoch 5/6, Average Loss=10.57463264465332, Class Loss=0.2927747368812561, Reg Loss=10.28185749053955
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.22636650502681732, Reg Loss=10.36343765258789
Clinet index 7, End of Epoch 6/6, Average Loss=10.589803695678711, Class Loss=0.22636650502681732, Reg Loss=10.36343765258789
federated aggregation...
Validation, Class Loss=0.43295541405677795, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.837114
Mean Acc: 0.530027
FreqW Acc: 0.764683
Mean IoU: 0.446410
Class IoU:
	class 0: 0.898189
	class 1: 0.8544913
	class 2: 0.40901506
	class 3: 0.009716982
	class 4: 0.63938415
	class 5: 0.6374253
	class 6: 0.9297288
	class 7: 0.78104496
	class 8: 0.116620935
	class 9: 0.33997962
	class 10: 0.07483914
	class 11: 0.46046615
	class 12: 0.010232397
	class 13: 0.49909547
	class 14: 0.5561367
	class 15: 0.6322405
	class 16: 0.091205075
	class 17: 0.09557336
Class Acc:
	class 0: 0.982493
	class 1: 0.88090277
	class 2: 0.6920676
	class 3: 0.009717236
	class 4: 0.7661634
	class 5: 0.66846204
	class 6: 0.9563314
	class 7: 0.78735286
	class 8: 0.11666111
	class 9: 0.4055698
	class 10: 0.07495792
	class 11: 0.46367288
	class 12: 0.010234065
	class 13: 0.5046364
	class 14: 0.5664554
	class 15: 0.6370152
	class 16: 0.106821515
	class 17: 0.91097116

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.20747211575508118, Reg Loss=9.79501724243164
Clinet index 17, End of Epoch 1/6, Average Loss=10.00248908996582, Class Loss=0.20747211575508118, Reg Loss=9.79501724243164
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.20963969826698303, Reg Loss=10.08380126953125
Clinet index 17, End of Epoch 2/6, Average Loss=10.293440818786621, Class Loss=0.20963969826698303, Reg Loss=10.08380126953125
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.20465895533561707, Reg Loss=9.950407028198242
Clinet index 17, End of Epoch 3/6, Average Loss=10.155065536499023, Class Loss=0.20465895533561707, Reg Loss=9.950407028198242
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.21465283632278442, Reg Loss=9.411569595336914
Clinet index 17, End of Epoch 4/6, Average Loss=9.626222610473633, Class Loss=0.21465283632278442, Reg Loss=9.411569595336914
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.19303235411643982, Reg Loss=9.953078269958496
Clinet index 17, End of Epoch 5/6, Average Loss=10.146110534667969, Class Loss=0.19303235411643982, Reg Loss=9.953078269958496
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.21404504776000977, Reg Loss=9.462119102478027
Clinet index 17, End of Epoch 6/6, Average Loss=9.676164627075195, Class Loss=0.21404504776000977, Reg Loss=9.462119102478027
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22306691110134125, Reg Loss=9.567445755004883
Clinet index 4, End of Epoch 1/6, Average Loss=9.790513038635254, Class Loss=0.22306691110134125, Reg Loss=9.567445755004883
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.2003817856311798, Reg Loss=9.830484390258789
Clinet index 4, End of Epoch 2/6, Average Loss=10.030866622924805, Class Loss=0.2003817856311798, Reg Loss=9.830484390258789
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.21146976947784424, Reg Loss=9.367289543151855
Clinet index 4, End of Epoch 3/6, Average Loss=9.57875919342041, Class Loss=0.21146976947784424, Reg Loss=9.367289543151855
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.21933138370513916, Reg Loss=9.815914154052734
Clinet index 4, End of Epoch 4/6, Average Loss=10.035245895385742, Class Loss=0.21933138370513916, Reg Loss=9.815914154052734
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.20394259691238403, Reg Loss=9.339117050170898
Clinet index 4, End of Epoch 5/6, Average Loss=9.543059349060059, Class Loss=0.20394259691238403, Reg Loss=9.339117050170898
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.22405043244361877, Reg Loss=9.42273998260498
Clinet index 4, End of Epoch 6/6, Average Loss=9.646790504455566, Class Loss=0.22405043244361877, Reg Loss=9.42273998260498
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22199806571006775, Reg Loss=10.5885648727417
Clinet index 5, End of Epoch 1/6, Average Loss=10.810563087463379, Class Loss=0.22199806571006775, Reg Loss=10.5885648727417
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.23214000463485718, Reg Loss=10.838174819946289
Clinet index 5, End of Epoch 2/6, Average Loss=11.070314407348633, Class Loss=0.23214000463485718, Reg Loss=10.838174819946289
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.27818647027015686, Reg Loss=10.85224437713623
Clinet index 5, End of Epoch 3/6, Average Loss=11.130431175231934, Class Loss=0.27818647027015686, Reg Loss=10.85224437713623
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18972259759902954, Reg Loss=10.443136215209961
Clinet index 5, End of Epoch 4/6, Average Loss=10.632859230041504, Class Loss=0.18972259759902954, Reg Loss=10.443136215209961
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.21077996492385864, Reg Loss=9.7792329788208
Clinet index 5, End of Epoch 5/6, Average Loss=9.990013122558594, Class Loss=0.21077996492385864, Reg Loss=9.7792329788208
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.18497349321842194, Reg Loss=10.09353256225586
Clinet index 5, End of Epoch 6/6, Average Loss=10.2785062789917, Class Loss=0.18497349321842194, Reg Loss=10.09353256225586
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.30751392245292664, Reg Loss=10.407062530517578
Clinet index 2, End of Epoch 1/6, Average Loss=10.714576721191406, Class Loss=0.30751392245292664, Reg Loss=10.407062530517578
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.24306738376617432, Reg Loss=10.558371543884277
Clinet index 2, End of Epoch 2/6, Average Loss=10.80143928527832, Class Loss=0.24306738376617432, Reg Loss=10.558371543884277
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2993297576904297, Reg Loss=10.048101425170898
Clinet index 2, End of Epoch 3/6, Average Loss=10.347431182861328, Class Loss=0.2993297576904297, Reg Loss=10.048101425170898
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2565377652645111, Reg Loss=10.600993156433105
Clinet index 2, End of Epoch 4/6, Average Loss=10.85753059387207, Class Loss=0.2565377652645111, Reg Loss=10.600993156433105
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.2390339970588684, Reg Loss=9.988548278808594
Clinet index 2, End of Epoch 5/6, Average Loss=10.227581977844238, Class Loss=0.2390339970588684, Reg Loss=9.988548278808594
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.23737917840480804, Reg Loss=9.530600547790527
Clinet index 2, End of Epoch 6/6, Average Loss=9.767979621887207, Class Loss=0.23737917840480804, Reg Loss=9.530600547790527
federated aggregation...
Validation, Class Loss=0.4458509683609009, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.833304
Mean Acc: 0.513826
FreqW Acc: 0.759980
Mean IoU: 0.432052
Class IoU:
	class 0: 0.8972627
	class 1: 0.83259904
	class 2: 0.40367433
	class 3: 0.0019833185
	class 4: 0.636078
	class 5: 0.6067104
	class 6: 0.92952424
	class 7: 0.7652939
	class 8: 0.10568858
	class 9: 0.3320003
	class 10: 0.057255704
	class 11: 0.44948184
	class 12: 0.0057169497
	class 13: 0.43801275
	class 14: 0.51939386
	class 15: 0.62366414
	class 16: 0.07930567
	class 17: 0.09329281
Class Acc:
	class 0: 0.9833038
	class 1: 0.8543521
	class 2: 0.67725724
	class 3: 0.0019833455
	class 4: 0.75135094
	class 5: 0.633511
	class 6: 0.9553442
	class 7: 0.77078
	class 8: 0.10572088
	class 9: 0.39474586
	class 10: 0.05732624
	class 11: 0.4525519
	class 12: 0.005717406
	class 13: 0.4416727
	class 14: 0.52751017
	class 15: 0.62769693
	class 16: 0.089868724
	class 17: 0.9181669

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.360136032104492, Reg Loss=24.9503173828125
Clinet index 17, End of Epoch 1/6, Average Loss=27.310453414916992, Class Loss=2.360136032104492, Reg Loss=24.9503173828125
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.0426712036132812, Reg Loss=17.254337310791016
Clinet index 17, End of Epoch 2/6, Average Loss=19.297008514404297, Class Loss=2.0426712036132812, Reg Loss=17.254337310791016
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6562244892120361, Reg Loss=14.364951133728027
Clinet index 17, End of Epoch 3/6, Average Loss=16.021175384521484, Class Loss=1.6562244892120361, Reg Loss=14.364951133728027
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.376692533493042, Reg Loss=12.702458381652832
Clinet index 17, End of Epoch 4/6, Average Loss=14.079151153564453, Class Loss=1.376692533493042, Reg Loss=12.702458381652832
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1085548400878906, Reg Loss=11.767973899841309
Clinet index 17, End of Epoch 5/6, Average Loss=12.8765287399292, Class Loss=1.1085548400878906, Reg Loss=11.767973899841309
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9071161150932312, Reg Loss=11.374359130859375
Clinet index 17, End of Epoch 6/6, Average Loss=12.281475067138672, Class Loss=0.9071161150932312, Reg Loss=11.374359130859375
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.469965934753418, Reg Loss=26.14670753479004
Clinet index 21, End of Epoch 1/6, Average Loss=28.61667251586914, Class Loss=2.469965934753418, Reg Loss=26.14670753479004
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.050031900405884, Reg Loss=17.950468063354492
Clinet index 21, End of Epoch 2/6, Average Loss=20.000499725341797, Class Loss=2.050031900405884, Reg Loss=17.950468063354492
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.7236647605895996, Reg Loss=15.119189262390137
Clinet index 21, End of Epoch 3/6, Average Loss=16.842853546142578, Class Loss=1.7236647605895996, Reg Loss=15.119189262390137
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.3730870485305786, Reg Loss=13.830242156982422
Clinet index 21, End of Epoch 4/6, Average Loss=15.203329086303711, Class Loss=1.3730870485305786, Reg Loss=13.830242156982422
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1238068342208862, Reg Loss=12.351211547851562
Clinet index 21, End of Epoch 5/6, Average Loss=13.475018501281738, Class Loss=1.1238068342208862, Reg Loss=12.351211547851562
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.881563127040863, Reg Loss=11.549508094787598
Clinet index 21, End of Epoch 6/6, Average Loss=12.431071281433105, Class Loss=0.881563127040863, Reg Loss=11.549508094787598
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.4837284088134766, Reg Loss=24.880203247070312
Clinet index 10, End of Epoch 1/6, Average Loss=27.36393165588379, Class Loss=2.4837284088134766, Reg Loss=24.880203247070312
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.085905075073242, Reg Loss=16.938335418701172
Clinet index 10, End of Epoch 2/6, Average Loss=19.024240493774414, Class Loss=2.085905075073242, Reg Loss=16.938335418701172
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.7220759391784668, Reg Loss=14.58679485321045
Clinet index 10, End of Epoch 3/6, Average Loss=16.308870315551758, Class Loss=1.7220759391784668, Reg Loss=14.58679485321045
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.3673374652862549, Reg Loss=12.984698295593262
Clinet index 10, End of Epoch 4/6, Average Loss=14.352035522460938, Class Loss=1.3673374652862549, Reg Loss=12.984698295593262
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1029736995697021, Reg Loss=12.264671325683594
Clinet index 10, End of Epoch 5/6, Average Loss=13.367645263671875, Class Loss=1.1029736995697021, Reg Loss=12.264671325683594
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8502340316772461, Reg Loss=12.154221534729004
Clinet index 10, End of Epoch 6/6, Average Loss=13.00445556640625, Class Loss=0.8502340316772461, Reg Loss=12.154221534729004
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.360851764678955, Reg Loss=25.04806900024414
Clinet index 5, End of Epoch 1/6, Average Loss=27.408920288085938, Class Loss=2.360851764678955, Reg Loss=25.04806900024414
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.0196022987365723, Reg Loss=17.372949600219727
Clinet index 5, End of Epoch 2/6, Average Loss=19.39255142211914, Class Loss=2.0196022987365723, Reg Loss=17.372949600219727
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6775083541870117, Reg Loss=15.031584739685059
Clinet index 5, End of Epoch 3/6, Average Loss=16.70909309387207, Class Loss=1.6775083541870117, Reg Loss=15.031584739685059
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.391729474067688, Reg Loss=13.554180145263672
Clinet index 5, End of Epoch 4/6, Average Loss=14.94590950012207, Class Loss=1.391729474067688, Reg Loss=13.554180145263672
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.097435474395752, Reg Loss=12.086285591125488
Clinet index 5, End of Epoch 5/6, Average Loss=13.183721542358398, Class Loss=1.097435474395752, Reg Loss=12.086285591125488
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8924288749694824, Reg Loss=11.967533111572266
Clinet index 5, End of Epoch 6/6, Average Loss=12.859962463378906, Class Loss=0.8924288749694824, Reg Loss=11.967533111572266
federated aggregation...
Validation, Class Loss=0.431964248418808, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.830655
Mean Acc: 0.541346
FreqW Acc: 0.724564
Mean IoU: 0.481540
Class IoU:
	class 0: 0.84830105
	class 1: 0.8773529
	class 2: 0.429448
	class 3: 0.42712912
	class 4: 0.6286134
	class 5: 0.6480899
	class 6: 0.9299914
	class 7: 0.65363944
	class 8: 0.14641109
	class 9: 0.27162609
	class 10: 0.6767865
	class 11: 0.46391734
	class 12: 0.011972036
	class 13: 0.728467
	class 14: 0.7554246
	class 15: 0.42998722
	class 16: 0.03449024
	class 17: 0.086552106
	class 18: 0.10106185
Class Acc:
	class 0: 0.98833996
	class 1: 0.90039194
	class 2: 0.71336013
	class 3: 0.42842296
	class 4: 0.72856915
	class 5: 0.6821982
	class 6: 0.95068425
	class 7: 0.6568789
	class 8: 0.14652924
	class 9: 0.30935973
	class 10: 0.7076205
	class 11: 0.47724637
	class 12: 0.011974904
	class 13: 0.75965214
	class 14: 0.78457916
	class 15: 0.43101367
	class 16: 0.0345391
	class 17: 0.44410682
	class 18: 0.13009979

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7881795763969421, Reg Loss=10.907003402709961
Clinet index 19, End of Epoch 1/6, Average Loss=11.695182800292969, Class Loss=0.7881795763969421, Reg Loss=10.907003402709961
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7071532011032104, Reg Loss=10.087191581726074
Clinet index 19, End of Epoch 2/6, Average Loss=10.794344902038574, Class Loss=0.7071532011032104, Reg Loss=10.087191581726074
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6216822862625122, Reg Loss=10.154244422912598
Clinet index 19, End of Epoch 3/6, Average Loss=10.77592658996582, Class Loss=0.6216822862625122, Reg Loss=10.154244422912598
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5568643808364868, Reg Loss=9.419770240783691
Clinet index 19, End of Epoch 4/6, Average Loss=9.976634979248047, Class Loss=0.5568643808364868, Reg Loss=9.419770240783691
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5052041411399841, Reg Loss=9.499704360961914
Clinet index 19, End of Epoch 5/6, Average Loss=10.004908561706543, Class Loss=0.5052041411399841, Reg Loss=9.499704360961914
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5043956637382507, Reg Loss=9.509586334228516
Clinet index 19, End of Epoch 6/6, Average Loss=10.013981819152832, Class Loss=0.5043956637382507, Reg Loss=9.509586334228516
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8119168877601624, Reg Loss=12.028796195983887
Clinet index 11, End of Epoch 1/6, Average Loss=12.840713500976562, Class Loss=0.8119168877601624, Reg Loss=12.028796195983887
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7369208335876465, Reg Loss=11.26251220703125
Clinet index 11, End of Epoch 2/6, Average Loss=11.999433517456055, Class Loss=0.7369208335876465, Reg Loss=11.26251220703125
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6114111542701721, Reg Loss=10.42123794555664
Clinet index 11, End of Epoch 3/6, Average Loss=11.032649040222168, Class Loss=0.6114111542701721, Reg Loss=10.42123794555664
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5848628282546997, Reg Loss=10.30431842803955
Clinet index 11, End of Epoch 4/6, Average Loss=10.889181137084961, Class Loss=0.5848628282546997, Reg Loss=10.30431842803955
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.528212308883667, Reg Loss=10.397180557250977
Clinet index 11, End of Epoch 5/6, Average Loss=10.925393104553223, Class Loss=0.528212308883667, Reg Loss=10.397180557250977
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5005271434783936, Reg Loss=9.338046073913574
Clinet index 11, End of Epoch 6/6, Average Loss=9.838573455810547, Class Loss=0.5005271434783936, Reg Loss=9.338046073913574
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7979418635368347, Reg Loss=11.905566215515137
Clinet index 9, End of Epoch 1/6, Average Loss=12.703508377075195, Class Loss=0.7979418635368347, Reg Loss=11.905566215515137
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.770521879196167, Reg Loss=11.258735656738281
Clinet index 9, End of Epoch 2/6, Average Loss=12.029257774353027, Class Loss=0.770521879196167, Reg Loss=11.258735656738281
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.650891125202179, Reg Loss=10.759389877319336
Clinet index 9, End of Epoch 3/6, Average Loss=11.41028118133545, Class Loss=0.650891125202179, Reg Loss=10.759389877319336
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5847288966178894, Reg Loss=10.184598922729492
Clinet index 9, End of Epoch 4/6, Average Loss=10.769328117370605, Class Loss=0.5847288966178894, Reg Loss=10.184598922729492
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5635344982147217, Reg Loss=10.604141235351562
Clinet index 9, End of Epoch 5/6, Average Loss=11.167675971984863, Class Loss=0.5635344982147217, Reg Loss=10.604141235351562
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5491965413093567, Reg Loss=10.30102825164795
Clinet index 9, End of Epoch 6/6, Average Loss=10.850224494934082, Class Loss=0.5491965413093567, Reg Loss=10.30102825164795
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7922450304031372, Reg Loss=11.465508460998535
Clinet index 1, End of Epoch 1/6, Average Loss=12.257753372192383, Class Loss=0.7922450304031372, Reg Loss=11.465508460998535
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7038434743881226, Reg Loss=10.592124938964844
Clinet index 1, End of Epoch 2/6, Average Loss=11.295968055725098, Class Loss=0.7038434743881226, Reg Loss=10.592124938964844
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6238011717796326, Reg Loss=10.371642112731934
Clinet index 1, End of Epoch 3/6, Average Loss=10.995443344116211, Class Loss=0.6238011717796326, Reg Loss=10.371642112731934
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5395103693008423, Reg Loss=9.737608909606934
Clinet index 1, End of Epoch 4/6, Average Loss=10.277119636535645, Class Loss=0.5395103693008423, Reg Loss=9.737608909606934
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5247240662574768, Reg Loss=9.545182228088379
Clinet index 1, End of Epoch 5/6, Average Loss=10.069906234741211, Class Loss=0.5247240662574768, Reg Loss=9.545182228088379
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5119484663009644, Reg Loss=9.510401725769043
Clinet index 1, End of Epoch 6/6, Average Loss=10.022350311279297, Class Loss=0.5119484663009644, Reg Loss=9.510401725769043
federated aggregation...
Validation, Class Loss=0.5989585518836975, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.771219
Mean Acc: 0.431801
FreqW Acc: 0.692588
Mean IoU: 0.368695
Class IoU:
	class 0: 0.8472508
	class 1: 0.7824953
	class 2: 0.32997805
	class 3: 0.14757995
	class 4: 0.54171884
	class 5: 0.55088234
	class 6: 0.92385846
	class 7: 0.20827588
	class 8: 0.021157688
	class 9: 0.15658481
	class 10: 0.38585904
	class 11: 0.40185675
	class 12: 0.0027980395
	class 13: 0.47905317
	class 14: 0.65633893
	class 15: 0.42280743
	class 16: 0.0
	class 17: 0.057332404
	class 18: 0.089369476
Class Acc:
	class 0: 0.9393336
	class 1: 0.79903
	class 2: 0.43556032
	class 3: 0.1477077
	class 4: 0.6074187
	class 5: 0.5763507
	class 6: 0.94631463
	class 7: 0.20843741
	class 8: 0.021157688
	class 9: 0.16073652
	class 10: 0.38847622
	class 11: 0.40638906
	class 12: 0.0027980395
	class 13: 0.48483416
	class 14: 0.6726583
	class 15: 0.42360902
	class 16: 0.0
	class 17: 0.21401665
	class 18: 0.7693975

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5185023546218872, Reg Loss=9.367498397827148
Clinet index 8, End of Epoch 1/6, Average Loss=9.886000633239746, Class Loss=0.5185023546218872, Reg Loss=9.367498397827148
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5031546354293823, Reg Loss=9.088760375976562
Clinet index 8, End of Epoch 2/6, Average Loss=9.591915130615234, Class Loss=0.5031546354293823, Reg Loss=9.088760375976562
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5014877319335938, Reg Loss=8.780144691467285
Clinet index 8, End of Epoch 3/6, Average Loss=9.281632423400879, Class Loss=0.5014877319335938, Reg Loss=8.780144691467285
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.47397303581237793, Reg Loss=9.068509101867676
Clinet index 8, End of Epoch 4/6, Average Loss=9.542482376098633, Class Loss=0.47397303581237793, Reg Loss=9.068509101867676
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.48311513662338257, Reg Loss=9.137761116027832
Clinet index 8, End of Epoch 5/6, Average Loss=9.62087631225586, Class Loss=0.48311513662338257, Reg Loss=9.137761116027832
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.47500503063201904, Reg Loss=8.906978607177734
Clinet index 8, End of Epoch 6/6, Average Loss=9.381983757019043, Class Loss=0.47500503063201904, Reg Loss=8.906978607177734
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.5082994103431702, Reg Loss=9.262604713439941
Clinet index 5, End of Epoch 1/6, Average Loss=9.770904541015625, Class Loss=0.5082994103431702, Reg Loss=9.262604713439941
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.5079972743988037, Reg Loss=9.035158157348633
Clinet index 5, End of Epoch 2/6, Average Loss=9.543155670166016, Class Loss=0.5079972743988037, Reg Loss=9.035158157348633
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.4971974194049835, Reg Loss=9.456400871276855
Clinet index 5, End of Epoch 3/6, Average Loss=9.953598022460938, Class Loss=0.4971974194049835, Reg Loss=9.456400871276855
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.49510714411735535, Reg Loss=9.233222007751465
Clinet index 5, End of Epoch 4/6, Average Loss=9.728328704833984, Class Loss=0.49510714411735535, Reg Loss=9.233222007751465
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.4955299496650696, Reg Loss=8.849342346191406
Clinet index 5, End of Epoch 5/6, Average Loss=9.34487247467041, Class Loss=0.4955299496650696, Reg Loss=8.849342346191406
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.4757218658924103, Reg Loss=9.144721984863281
Clinet index 5, End of Epoch 6/6, Average Loss=9.620444297790527, Class Loss=0.4757218658924103, Reg Loss=9.144721984863281
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.513238251209259, Reg Loss=9.65755844116211
Clinet index 21, End of Epoch 1/6, Average Loss=10.170796394348145, Class Loss=0.513238251209259, Reg Loss=9.65755844116211
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.5070751905441284, Reg Loss=9.662920951843262
Clinet index 21, End of Epoch 2/6, Average Loss=10.16999626159668, Class Loss=0.5070751905441284, Reg Loss=9.662920951843262
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.48464980721473694, Reg Loss=9.044638633728027
Clinet index 21, End of Epoch 3/6, Average Loss=9.529288291931152, Class Loss=0.48464980721473694, Reg Loss=9.044638633728027
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.49243050813674927, Reg Loss=9.741673469543457
Clinet index 21, End of Epoch 4/6, Average Loss=10.23410415649414, Class Loss=0.49243050813674927, Reg Loss=9.741673469543457
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.46777933835983276, Reg Loss=8.700004577636719
Clinet index 21, End of Epoch 5/6, Average Loss=9.167783737182617, Class Loss=0.46777933835983276, Reg Loss=8.700004577636719
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.45952939987182617, Reg Loss=8.691847801208496
Clinet index 21, End of Epoch 6/6, Average Loss=9.151376724243164, Class Loss=0.45952939987182617, Reg Loss=8.691847801208496
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.49508383870124817, Reg Loss=9.211451530456543
Clinet index 7, End of Epoch 1/6, Average Loss=9.706535339355469, Class Loss=0.49508383870124817, Reg Loss=9.211451530456543
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.47752538323402405, Reg Loss=9.004182815551758
Clinet index 7, End of Epoch 2/6, Average Loss=9.481708526611328, Class Loss=0.47752538323402405, Reg Loss=9.004182815551758
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.4665490388870239, Reg Loss=9.176228523254395
Clinet index 7, End of Epoch 3/6, Average Loss=9.642777442932129, Class Loss=0.4665490388870239, Reg Loss=9.176228523254395
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.45403262972831726, Reg Loss=8.880617141723633
Clinet index 7, End of Epoch 4/6, Average Loss=9.334650039672852, Class Loss=0.45403262972831726, Reg Loss=8.880617141723633
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.46845367550849915, Reg Loss=8.580412864685059
Clinet index 7, End of Epoch 5/6, Average Loss=9.048866271972656, Class Loss=0.46845367550849915, Reg Loss=8.580412864685059
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.4537205696105957, Reg Loss=8.20192813873291
Clinet index 7, End of Epoch 6/6, Average Loss=8.655649185180664, Class Loss=0.4537205696105957, Reg Loss=8.20192813873291
federated aggregation...
Validation, Class Loss=0.6216022968292236, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.762139
Mean Acc: 0.409117
FreqW Acc: 0.680445
Mean IoU: 0.346886
Class IoU:
	class 0: 0.8365448
	class 1: 0.7622696
	class 2: 0.26294842
	class 3: 0.13672161
	class 4: 0.50934094
	class 5: 0.5365848
	class 6: 0.9081266
	class 7: 0.08385566
	class 8: 0.030931085
	class 9: 0.1720027
	class 10: 0.36732322
	class 11: 0.38493857
	class 12: 0.002297479
	class 13: 0.43591613
	class 14: 0.574012
	class 15: 0.43404475
	class 16: 0.0
	class 17: 0.059713833
	class 18: 0.09326214
Class Acc:
	class 0: 0.93266404
	class 1: 0.7748779
	class 2: 0.31135616
	class 3: 0.13681176
	class 4: 0.56130004
	class 5: 0.55836535
	class 6: 0.92760146
	class 7: 0.08387502
	class 8: 0.030931283
	class 9: 0.17691329
	class 10: 0.36927807
	class 11: 0.38793382
	class 12: 0.0022974834
	class 13: 0.43944156
	class 14: 0.5837173
	class 15: 0.4349474
	class 16: 0.0
	class 17: 0.25682905
	class 18: 0.804074

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.45401233434677124, Reg Loss=8.3792085647583
Clinet index 14, End of Epoch 1/6, Average Loss=8.833220481872559, Class Loss=0.45401233434677124, Reg Loss=8.3792085647583
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.4474102258682251, Reg Loss=8.770196914672852
Clinet index 14, End of Epoch 2/6, Average Loss=9.217607498168945, Class Loss=0.4474102258682251, Reg Loss=8.770196914672852
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.44483503699302673, Reg Loss=8.623589515686035
Clinet index 14, End of Epoch 3/6, Average Loss=9.068424224853516, Class Loss=0.44483503699302673, Reg Loss=8.623589515686035
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4444480240345001, Reg Loss=8.695474624633789
Clinet index 14, End of Epoch 4/6, Average Loss=9.139923095703125, Class Loss=0.4444480240345001, Reg Loss=8.695474624633789
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.45017948746681213, Reg Loss=8.78528118133545
Clinet index 14, End of Epoch 5/6, Average Loss=9.23546028137207, Class Loss=0.45017948746681213, Reg Loss=8.78528118133545
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.4314282238483429, Reg Loss=8.24000358581543
Clinet index 14, End of Epoch 6/6, Average Loss=8.671431541442871, Class Loss=0.4314282238483429, Reg Loss=8.24000358581543
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4912721514701843, Reg Loss=8.764049530029297
Clinet index 4, End of Epoch 1/6, Average Loss=9.255321502685547, Class Loss=0.4912721514701843, Reg Loss=8.764049530029297
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.4948772192001343, Reg Loss=9.327831268310547
Clinet index 4, End of Epoch 2/6, Average Loss=9.822708129882812, Class Loss=0.4948772192001343, Reg Loss=9.327831268310547
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.47365304827690125, Reg Loss=8.541122436523438
Clinet index 4, End of Epoch 3/6, Average Loss=9.014775276184082, Class Loss=0.47365304827690125, Reg Loss=8.541122436523438
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4651244282722473, Reg Loss=8.600330352783203
Clinet index 4, End of Epoch 4/6, Average Loss=9.065454483032227, Class Loss=0.4651244282722473, Reg Loss=8.600330352783203
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.47317516803741455, Reg Loss=8.895841598510742
Clinet index 4, End of Epoch 5/6, Average Loss=9.369016647338867, Class Loss=0.47317516803741455, Reg Loss=8.895841598510742
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.4588221609592438, Reg Loss=8.688861846923828
Clinet index 4, End of Epoch 6/6, Average Loss=9.147684097290039, Class Loss=0.4588221609592438, Reg Loss=8.688861846923828
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.47323131561279297, Reg Loss=9.172192573547363
Clinet index 11, End of Epoch 1/6, Average Loss=9.645423889160156, Class Loss=0.47323131561279297, Reg Loss=9.172192573547363
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.4711261987686157, Reg Loss=8.82304859161377
Clinet index 11, End of Epoch 2/6, Average Loss=9.294175148010254, Class Loss=0.4711261987686157, Reg Loss=8.82304859161377
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.4625391960144043, Reg Loss=8.44214916229248
Clinet index 11, End of Epoch 3/6, Average Loss=8.904687881469727, Class Loss=0.4625391960144043, Reg Loss=8.44214916229248
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.4559837281703949, Reg Loss=8.154961585998535
Clinet index 11, End of Epoch 4/6, Average Loss=8.610945701599121, Class Loss=0.4559837281703949, Reg Loss=8.154961585998535
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.4481104016304016, Reg Loss=8.714078903198242
Clinet index 11, End of Epoch 5/6, Average Loss=9.162189483642578, Class Loss=0.4481104016304016, Reg Loss=8.714078903198242
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.43717360496520996, Reg Loss=7.894428730010986
Clinet index 11, End of Epoch 6/6, Average Loss=8.331602096557617, Class Loss=0.43717360496520996, Reg Loss=7.894428730010986
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.4736728370189667, Reg Loss=8.881582260131836
Clinet index 21, End of Epoch 1/6, Average Loss=9.355255126953125, Class Loss=0.4736728370189667, Reg Loss=8.881582260131836
Pseudo labeling is: None
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.47139063477516174, Reg Loss=8.84248161315918
Clinet index 21, End of Epoch 2/6, Average Loss=9.313872337341309, Class Loss=0.47139063477516174, Reg Loss=8.84248161315918
Pseudo labeling is: None
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.466511070728302, Reg Loss=8.423556327819824
Clinet index 21, End of Epoch 3/6, Average Loss=8.890067100524902, Class Loss=0.466511070728302, Reg Loss=8.423556327819824
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.4738583564758301, Reg Loss=9.013659477233887
Clinet index 21, End of Epoch 4/6, Average Loss=9.487518310546875, Class Loss=0.4738583564758301, Reg Loss=9.013659477233887
Pseudo labeling is: None
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.4614294469356537, Reg Loss=8.137825965881348
Clinet index 21, End of Epoch 5/6, Average Loss=8.599255561828613, Class Loss=0.4614294469356537, Reg Loss=8.137825965881348
Pseudo labeling is: None
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.44473856687545776, Reg Loss=8.142023086547852
Clinet index 21, End of Epoch 6/6, Average Loss=8.586761474609375, Class Loss=0.44473856687545776, Reg Loss=8.142023086547852
federated aggregation...
Validation, Class Loss=0.6444178223609924, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.751972
Mean Acc: 0.398695
FreqW Acc: 0.671153
Mean IoU: 0.334690
Class IoU:
	class 0: 0.8267468
	class 1: 0.7406508
	class 2: 0.25365797
	class 3: 0.12552571
	class 4: 0.48302537
	class 5: 0.5413866
	class 6: 0.907289
	class 7: 0.039098404
	class 8: 0.031529482
	class 9: 0.1798895
	class 10: 0.33372003
	class 11: 0.39017034
	class 12: 0.002257619
	class 13: 0.4044369
	class 14: 0.5018846
	class 15: 0.44516265
	class 16: 0.0
	class 17: 0.06075505
	class 18: 0.09192193
Class Acc:
	class 0: 0.92077136
	class 1: 0.7513833
	class 2: 0.29399204
	class 3: 0.12559758
	class 4: 0.52663267
	class 5: 0.5623001
	class 6: 0.92508894
	class 7: 0.039104626
	class 8: 0.031529713
	class 9: 0.18531445
	class 10: 0.33529767
	class 11: 0.39409482
	class 12: 0.0022576218
	class 13: 0.4072159
	class 14: 0.5083321
	class 15: 0.44612104
	class 16: 0.0
	class 17: 0.28653604
	class 18: 0.83364284

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4333324134349823, Reg Loss=7.908505916595459
Clinet index 15, End of Epoch 1/6, Average Loss=8.341837882995605, Class Loss=0.4333324134349823, Reg Loss=7.908505916595459
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.4411790370941162, Reg Loss=7.768195629119873
Clinet index 15, End of Epoch 2/6, Average Loss=8.20937442779541, Class Loss=0.4411790370941162, Reg Loss=7.768195629119873
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.42411258816719055, Reg Loss=8.079900741577148
Clinet index 15, End of Epoch 3/6, Average Loss=8.504013061523438, Class Loss=0.42411258816719055, Reg Loss=8.079900741577148
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.42637625336647034, Reg Loss=7.686480522155762
Clinet index 15, End of Epoch 4/6, Average Loss=8.1128568649292, Class Loss=0.42637625336647034, Reg Loss=7.686480522155762
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4322611689567566, Reg Loss=8.331473350524902
Clinet index 15, End of Epoch 5/6, Average Loss=8.763734817504883, Class Loss=0.4322611689567566, Reg Loss=8.331473350524902
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.4287169575691223, Reg Loss=7.7447638511657715
Clinet index 15, End of Epoch 6/6, Average Loss=8.173480987548828, Class Loss=0.4287169575691223, Reg Loss=7.7447638511657715
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.42384928464889526, Reg Loss=8.079092979431152
Clinet index 12, End of Epoch 1/6, Average Loss=8.502942085266113, Class Loss=0.42384928464889526, Reg Loss=8.079092979431152
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.41654786467552185, Reg Loss=7.2538838386535645
Clinet index 12, End of Epoch 2/6, Average Loss=7.670431613922119, Class Loss=0.41654786467552185, Reg Loss=7.2538838386535645
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.4070572257041931, Reg Loss=7.3095011711120605
Clinet index 12, End of Epoch 3/6, Average Loss=7.716558456420898, Class Loss=0.4070572257041931, Reg Loss=7.3095011711120605
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.4196069836616516, Reg Loss=7.524654865264893
Clinet index 12, End of Epoch 4/6, Average Loss=7.9442620277404785, Class Loss=0.4196069836616516, Reg Loss=7.524654865264893
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.416268527507782, Reg Loss=7.210797309875488
Clinet index 12, End of Epoch 5/6, Average Loss=7.627065658569336, Class Loss=0.416268527507782, Reg Loss=7.210797309875488
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.41211938858032227, Reg Loss=7.398348331451416
Clinet index 12, End of Epoch 6/6, Average Loss=7.810467720031738, Class Loss=0.41211938858032227, Reg Loss=7.398348331451416
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.44607800245285034, Reg Loss=8.176824569702148
Clinet index 21, End of Epoch 1/6, Average Loss=8.622902870178223, Class Loss=0.44607800245285034, Reg Loss=8.176824569702148
Pseudo labeling is: None
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.44584912061691284, Reg Loss=8.158195495605469
Clinet index 21, End of Epoch 2/6, Average Loss=8.604044914245605, Class Loss=0.44584912061691284, Reg Loss=8.158195495605469
Pseudo labeling is: None
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.4545525908470154, Reg Loss=7.80935525894165
Clinet index 21, End of Epoch 3/6, Average Loss=8.263907432556152, Class Loss=0.4545525908470154, Reg Loss=7.80935525894165
Pseudo labeling is: None
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.4534216523170471, Reg Loss=8.442008972167969
Clinet index 21, End of Epoch 4/6, Average Loss=8.895430564880371, Class Loss=0.4534216523170471, Reg Loss=8.442008972167969
Pseudo labeling is: None
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.4404808282852173, Reg Loss=7.715928554534912
Clinet index 21, End of Epoch 5/6, Average Loss=8.15640926361084, Class Loss=0.4404808282852173, Reg Loss=7.715928554534912
Pseudo labeling is: None
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.4303375780582428, Reg Loss=7.727334022521973
Clinet index 21, End of Epoch 6/6, Average Loss=8.157671928405762, Class Loss=0.4303375780582428, Reg Loss=7.727334022521973
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4589090049266815, Reg Loss=8.280138969421387
Clinet index 16, End of Epoch 1/6, Average Loss=8.73904800415039, Class Loss=0.4589090049266815, Reg Loss=8.280138969421387
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.45295441150665283, Reg Loss=8.07071590423584
Clinet index 16, End of Epoch 2/6, Average Loss=8.523670196533203, Class Loss=0.45295441150665283, Reg Loss=8.07071590423584
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.4470594525337219, Reg Loss=7.619925498962402
Clinet index 16, End of Epoch 3/6, Average Loss=8.066985130310059, Class Loss=0.4470594525337219, Reg Loss=7.619925498962402
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.43176543712615967, Reg Loss=7.725011348724365
Clinet index 16, End of Epoch 4/6, Average Loss=8.156776428222656, Class Loss=0.43176543712615967, Reg Loss=7.725011348724365
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.46998563408851624, Reg Loss=8.203404426574707
Clinet index 16, End of Epoch 5/6, Average Loss=8.67339038848877, Class Loss=0.46998563408851624, Reg Loss=8.203404426574707
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.43569862842559814, Reg Loss=7.644075870513916
Clinet index 16, End of Epoch 6/6, Average Loss=8.079774856567383, Class Loss=0.43569862842559814, Reg Loss=7.644075870513916
federated aggregation...
Validation, Class Loss=0.6413482427597046, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.753093
Mean Acc: 0.399320
FreqW Acc: 0.669801
Mean IoU: 0.332844
Class IoU:
	class 0: 0.8247148
	class 1: 0.7401691
	class 2: 0.23409049
	class 3: 0.12727474
	class 4: 0.48663694
	class 5: 0.543506
	class 6: 0.90251833
	class 7: 0.034692127
	class 8: 0.033637412
	class 9: 0.18000853
	class 10: 0.35830352
	class 11: 0.3618183
	class 12: 0.0020435
	class 13: 0.40819323
	class 14: 0.4691823
	class 15: 0.45165017
	class 16: 0.0
	class 17: 0.06688794
	class 18: 0.09871213
Class Acc:
	class 0: 0.92159134
	class 1: 0.75018597
	class 2: 0.26634222
	class 3: 0.12735084
	class 4: 0.5272868
	class 5: 0.56474036
	class 6: 0.91973907
	class 7: 0.0346975
	class 8: 0.033638
	class 9: 0.18546906
	class 10: 0.36015558
	class 11: 0.36409235
	class 12: 0.0020435022
	class 13: 0.4109218
	class 14: 0.47449455
	class 15: 0.45268163
	class 16: 0.0
	class 17: 0.34904936
	class 18: 0.8426007

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.607952117919922, Reg Loss=26.28583526611328
Clinet index 9, End of Epoch 1/6, Average Loss=28.893787384033203, Class Loss=2.607952117919922, Reg Loss=26.28583526611328
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.197539806365967, Reg Loss=17.557483673095703
Clinet index 9, End of Epoch 2/6, Average Loss=19.755023956298828, Class Loss=2.197539806365967, Reg Loss=17.557483673095703
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6273025274276733, Reg Loss=14.729414939880371
Clinet index 9, End of Epoch 3/6, Average Loss=16.356718063354492, Class Loss=1.6273025274276733, Reg Loss=14.729414939880371
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0858361721038818, Reg Loss=13.211488723754883
Clinet index 9, End of Epoch 4/6, Average Loss=14.297325134277344, Class Loss=1.0858361721038818, Reg Loss=13.211488723754883
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8149288296699524, Reg Loss=11.699090003967285
Clinet index 9, End of Epoch 5/6, Average Loss=12.514019012451172, Class Loss=0.8149288296699524, Reg Loss=11.699090003967285
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5621063709259033, Reg Loss=11.05070686340332
Clinet index 9, End of Epoch 6/6, Average Loss=11.612812995910645, Class Loss=0.5621063709259033, Reg Loss=11.05070686340332
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.5115246772766113, Reg Loss=26.687009811401367
Clinet index 12, End of Epoch 1/6, Average Loss=29.19853401184082, Class Loss=2.5115246772766113, Reg Loss=26.687009811401367
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.2138612270355225, Reg Loss=17.826887130737305
Clinet index 12, End of Epoch 2/6, Average Loss=20.040748596191406, Class Loss=2.2138612270355225, Reg Loss=17.826887130737305
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6466169357299805, Reg Loss=14.966029167175293
Clinet index 12, End of Epoch 3/6, Average Loss=16.612646102905273, Class Loss=1.6466169357299805, Reg Loss=14.966029167175293
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1167954206466675, Reg Loss=13.230976104736328
Clinet index 12, End of Epoch 4/6, Average Loss=14.347771644592285, Class Loss=1.1167954206466675, Reg Loss=13.230976104736328
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.747546374797821, Reg Loss=11.83962631225586
Clinet index 12, End of Epoch 5/6, Average Loss=12.587172508239746, Class Loss=0.747546374797821, Reg Loss=11.83962631225586
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5336877703666687, Reg Loss=11.068470001220703
Clinet index 12, End of Epoch 6/6, Average Loss=11.602157592773438, Class Loss=0.5336877703666687, Reg Loss=11.068470001220703
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.535252094268799, Reg Loss=26.406784057617188
Clinet index 24, End of Epoch 1/6, Average Loss=28.942035675048828, Class Loss=2.535252094268799, Reg Loss=26.406784057617188
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.216430902481079, Reg Loss=18.01198959350586
Clinet index 24, End of Epoch 2/6, Average Loss=20.22842025756836, Class Loss=2.216430902481079, Reg Loss=18.01198959350586
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6539223194122314, Reg Loss=14.817525863647461
Clinet index 24, End of Epoch 3/6, Average Loss=16.47144889831543, Class Loss=1.6539223194122314, Reg Loss=14.817525863647461
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1074693202972412, Reg Loss=12.7945556640625
Clinet index 24, End of Epoch 4/6, Average Loss=13.90202522277832, Class Loss=1.1074693202972412, Reg Loss=12.7945556640625
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7716178894042969, Reg Loss=11.939569473266602
Clinet index 24, End of Epoch 5/6, Average Loss=12.711187362670898, Class Loss=0.7716178894042969, Reg Loss=11.939569473266602
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5173829793930054, Reg Loss=11.136295318603516
Clinet index 24, End of Epoch 6/6, Average Loss=11.653677940368652, Class Loss=0.5173829793930054, Reg Loss=11.136295318603516
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.6759138107299805, Reg Loss=27.93347930908203
Clinet index 8, End of Epoch 1/6, Average Loss=30.609394073486328, Class Loss=2.6759138107299805, Reg Loss=27.93347930908203
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.2699737548828125, Reg Loss=18.349319458007812
Clinet index 8, End of Epoch 2/6, Average Loss=20.619293212890625, Class Loss=2.2699737548828125, Reg Loss=18.349319458007812
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.7254363298416138, Reg Loss=15.18883228302002
Clinet index 8, End of Epoch 3/6, Average Loss=16.914268493652344, Class Loss=1.7254363298416138, Reg Loss=15.18883228302002
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1624436378479004, Reg Loss=13.620858192443848
Clinet index 8, End of Epoch 4/6, Average Loss=14.783302307128906, Class Loss=1.1624436378479004, Reg Loss=13.620858192443848
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7150448560714722, Reg Loss=12.171067237854004
Clinet index 8, End of Epoch 5/6, Average Loss=12.886112213134766, Class Loss=0.7150448560714722, Reg Loss=12.171067237854004
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5042684674263, Reg Loss=10.963973045349121
Clinet index 8, End of Epoch 6/6, Average Loss=11.468241691589355, Class Loss=0.5042684674263, Reg Loss=10.963973045349121
federated aggregation...
Validation, Class Loss=0.6809675693511963, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.743663
Mean Acc: 0.248743
FreqW Acc: 0.602021
Mean IoU: 0.212691
Class IoU:
	class 0: 0.7999761
	class 1: 0.34909052
	class 2: 0.12143426
	class 3: 0.07495225
	class 4: 0.43907166
	class 5: 0.4619686
	class 6: 0.49966055
	class 7: 0.11520913
	class 8: 0.04161192
	class 9: 0.21991175
	class 10: 0.21409678
	class 11: 0.27997005
	class 12: 0.00664857
	class 13: 0.2566939
	class 14: 0.041044913
	class 15: 0.1393692
	class 16: 0.0
	class 17: 4.5153793e-06
	class 18: 0.08864348
	class 19: 0.10446101
Class Acc:
	class 0: 0.9914107
	class 1: 0.34947237
	class 2: 0.12634216
	class 3: 0.07499308
	class 4: 0.4496486
	class 5: 0.47173053
	class 6: 0.50271237
	class 7: 0.11548579
	class 8: 0.041612037
	class 9: 0.24540065
	class 10: 0.2142822
	class 11: 0.283543
	class 12: 0.006648598
	class 13: 0.25726518
	class 14: 0.041087396
	class 15: 0.13942437
	class 16: 0.0
	class 17: 4.5153793e-06
	class 18: 0.10319885
	class 19: 0.5606032

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5188778638839722, Reg Loss=10.320331573486328
Clinet index 5, End of Epoch 1/6, Average Loss=10.83920955657959, Class Loss=0.5188778638839722, Reg Loss=10.320331573486328
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.42603325843811035, Reg Loss=10.03525447845459
Clinet index 5, End of Epoch 2/6, Average Loss=10.461287498474121, Class Loss=0.42603325843811035, Reg Loss=10.03525447845459
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.38234880566596985, Reg Loss=9.454880714416504
Clinet index 5, End of Epoch 3/6, Average Loss=9.83722972869873, Class Loss=0.38234880566596985, Reg Loss=9.454880714416504
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.30540093779563904, Reg Loss=9.167781829833984
Clinet index 5, End of Epoch 4/6, Average Loss=9.473182678222656, Class Loss=0.30540093779563904, Reg Loss=9.167781829833984
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 5, Class Loss=0.27076658606529236, Reg Loss=8.815831184387207
Clinet index 5, End of Epoch 5/6, Average Loss=9.086597442626953, Class Loss=0.27076658606529236, Reg Loss=8.815831184387207
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.25342148542404175, Reg Loss=8.38726806640625
Clinet index 5, End of Epoch 6/6, Average Loss=8.640689849853516, Class Loss=0.25342148542404175, Reg Loss=8.38726806640625
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.44568145275115967, Reg Loss=10.927563667297363
Clinet index 8, End of Epoch 1/6, Average Loss=11.373245239257812, Class Loss=0.44568145275115967, Reg Loss=10.927563667297363
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.3950960338115692, Reg Loss=10.35454273223877
Clinet index 8, End of Epoch 2/6, Average Loss=10.749638557434082, Class Loss=0.3950960338115692, Reg Loss=10.35454273223877
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.32300880551338196, Reg Loss=9.996333122253418
Clinet index 8, End of Epoch 3/6, Average Loss=10.319341659545898, Class Loss=0.32300880551338196, Reg Loss=9.996333122253418
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 4, Class Loss=0.3026071786880493, Reg Loss=9.655799865722656
Clinet index 8, End of Epoch 4/6, Average Loss=9.958407402038574, Class Loss=0.3026071786880493, Reg Loss=9.655799865722656
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.25360867381095886, Reg Loss=9.589005470275879
Clinet index 8, End of Epoch 5/6, Average Loss=9.84261417388916, Class Loss=0.25360867381095886, Reg Loss=9.589005470275879
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.2576459050178528, Reg Loss=9.148613929748535
Clinet index 8, End of Epoch 6/6, Average Loss=9.406259536743164, Class Loss=0.2576459050178528, Reg Loss=9.148613929748535
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4147353172302246, Reg Loss=10.261314392089844
Clinet index 0, End of Epoch 1/6, Average Loss=10.676050186157227, Class Loss=0.4147353172302246, Reg Loss=10.261314392089844
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3806808590888977, Reg Loss=9.645503997802734
Clinet index 0, End of Epoch 2/6, Average Loss=10.026185035705566, Class Loss=0.3806808590888977, Reg Loss=9.645503997802734
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.31407809257507324, Reg Loss=9.180780410766602
Clinet index 0, End of Epoch 3/6, Average Loss=9.494858741760254, Class Loss=0.31407809257507324, Reg Loss=9.180780410766602
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.27194470167160034, Reg Loss=8.478643417358398
Clinet index 0, End of Epoch 4/6, Average Loss=8.750588417053223, Class Loss=0.27194470167160034, Reg Loss=8.478643417358398
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 5, Class Loss=0.26420271396636963, Reg Loss=8.348245620727539
Clinet index 0, End of Epoch 5/6, Average Loss=8.612448692321777, Class Loss=0.26420271396636963, Reg Loss=8.348245620727539
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.2450745552778244, Reg Loss=8.123135566711426
Clinet index 0, End of Epoch 6/6, Average Loss=8.368209838867188, Class Loss=0.2450745552778244, Reg Loss=8.123135566711426
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5084481239318848, Reg Loss=10.29805850982666
Clinet index 6, End of Epoch 1/6, Average Loss=10.806507110595703, Class Loss=0.5084481239318848, Reg Loss=10.29805850982666
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.40331947803497314, Reg Loss=9.77062702178955
Clinet index 6, End of Epoch 2/6, Average Loss=10.173946380615234, Class Loss=0.40331947803497314, Reg Loss=9.77062702178955
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.34650081396102905, Reg Loss=9.331929206848145
Clinet index 6, End of Epoch 3/6, Average Loss=9.67842960357666, Class Loss=0.34650081396102905, Reg Loss=9.331929206848145
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.2954527735710144, Reg Loss=9.140713691711426
Clinet index 6, End of Epoch 4/6, Average Loss=9.436166763305664, Class Loss=0.2954527735710144, Reg Loss=9.140713691711426
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 5, Class Loss=0.27466943860054016, Reg Loss=8.957357406616211
Clinet index 6, End of Epoch 5/6, Average Loss=9.232027053833008, Class Loss=0.27466943860054016, Reg Loss=8.957357406616211
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.24052931368350983, Reg Loss=8.635416030883789
Clinet index 6, End of Epoch 6/6, Average Loss=8.875945091247559, Class Loss=0.24052931368350983, Reg Loss=8.635416030883789
federated aggregation...
Validation, Class Loss=1.0154292583465576, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.691746
Mean Acc: 0.126930
FreqW Acc: 0.609321
Mean IoU: 0.082312
Class IoU:
	class 0: 0.868194
	class 1: 0.00014915803
	class 2: 0.0062104906
	class 3: 0.0
	class 4: 0.056894794
	class 5: 0.03788034
	class 6: 0.0072531067
	class 7: 0.0021730042
	class 8: 0.0019722416
	class 9: 0.17079905
	class 10: 2.2184393e-05
	class 11: 0.25646818
	class 12: 0.0
	class 13: 0.0015996124
	class 14: 0.0
	class 15: 0.04445487
	class 16: 0.0
	class 17: 0.0
	class 18: 0.12520391
	class 19: 0.06696509
Class Acc:
	class 0: 0.96517825
	class 1: 0.00014915803
	class 2: 0.006214007
	class 3: 0.0
	class 4: 0.057130046
	class 5: 0.037882913
	class 6: 0.0072532785
	class 7: 0.0021730138
	class 8: 0.0019722416
	class 9: 0.18168493
	class 10: 2.2184393e-05
	class 11: 0.25781602
	class 12: 0.0
	class 13: 0.0015996185
	class 14: 0.0
	class 15: 0.04446098
	class 16: 0.0
	class 17: 0.0
	class 18: 0.13990352
	class 19: 0.83515054

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.22884014248847961, Reg Loss=8.271378517150879
Clinet index 8, End of Epoch 1/6, Average Loss=8.500218391418457, Class Loss=0.22884014248847961, Reg Loss=8.271378517150879
Pseudo labeling is: None
Epoch 2, lr = 0.000600
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.2222471386194229, Reg Loss=8.344205856323242
Clinet index 8, End of Epoch 2/6, Average Loss=8.566452980041504, Class Loss=0.2222471386194229, Reg Loss=8.344205856323242
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 3, Class Loss=0.21134543418884277, Reg Loss=8.17637825012207
Clinet index 8, End of Epoch 3/6, Average Loss=8.387723922729492, Class Loss=0.21134543418884277, Reg Loss=8.17637825012207
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.22533264756202698, Reg Loss=7.987660884857178
Clinet index 8, End of Epoch 4/6, Average Loss=8.212993621826172, Class Loss=0.22533264756202698, Reg Loss=7.987660884857178
Pseudo labeling is: None
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.21991464495658875, Reg Loss=8.435224533081055
Clinet index 8, End of Epoch 5/6, Average Loss=8.655138969421387, Class Loss=0.21991464495658875, Reg Loss=8.435224533081055
Pseudo labeling is: None
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.20415857434272766, Reg Loss=8.082712173461914
Clinet index 8, End of Epoch 6/6, Average Loss=8.286870956420898, Class Loss=0.20415857434272766, Reg Loss=8.082712173461914
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22139973938465118, Reg Loss=8.061790466308594
Clinet index 25, End of Epoch 1/6, Average Loss=8.28318977355957, Class Loss=0.22139973938465118, Reg Loss=8.061790466308594
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2435569167137146, Reg Loss=8.494332313537598
Clinet index 25, End of Epoch 2/6, Average Loss=8.737889289855957, Class Loss=0.2435569167137146, Reg Loss=8.494332313537598
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.21292626857757568, Reg Loss=7.815531253814697
Clinet index 25, End of Epoch 3/6, Average Loss=8.028457641601562, Class Loss=0.21292626857757568, Reg Loss=7.815531253814697
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.21466849744319916, Reg Loss=7.647877216339111
Clinet index 25, End of Epoch 4/6, Average Loss=7.862545490264893, Class Loss=0.21466849744319916, Reg Loss=7.647877216339111
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 5, Class Loss=0.2101951688528061, Reg Loss=7.860477924346924
Clinet index 25, End of Epoch 5/6, Average Loss=8.070672988891602, Class Loss=0.2101951688528061, Reg Loss=7.860477924346924
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Epoch 6, Class Loss=0.21892565488815308, Reg Loss=7.653110027313232
Clinet index 25, End of Epoch 6/6, Average Loss=7.872035503387451, Class Loss=0.21892565488815308, Reg Loss=7.653110027313232
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.2371339499950409, Reg Loss=8.759079933166504
Clinet index 22, End of Epoch 1/6, Average Loss=8.996213912963867, Class Loss=0.2371339499950409, Reg Loss=8.759079933166504
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 2, Class Loss=0.23523014783859253, Reg Loss=8.44868278503418
Clinet index 22, End of Epoch 2/6, Average Loss=8.683913230895996, Class Loss=0.23523014783859253, Reg Loss=8.44868278503418
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.22082439064979553, Reg Loss=8.115911483764648
Clinet index 22, End of Epoch 3/6, Average Loss=8.336735725402832, Class Loss=0.22082439064979553, Reg Loss=8.115911483764648
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.21574965119361877, Reg Loss=8.287025451660156
Clinet index 22, End of Epoch 4/6, Average Loss=8.502775192260742, Class Loss=0.21574965119361877, Reg Loss=8.287025451660156
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.20673681795597076, Reg Loss=7.856266975402832
Clinet index 22, End of Epoch 5/6, Average Loss=8.063003540039062, Class Loss=0.20673681795597076, Reg Loss=7.856266975402832
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.20431257784366608, Reg Loss=7.589334011077881
Clinet index 22, End of Epoch 6/6, Average Loss=7.793646812438965, Class Loss=0.20431257784366608, Reg Loss=7.589334011077881
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.2598038613796234, Reg Loss=8.133805274963379
Clinet index 5, End of Epoch 1/6, Average Loss=8.393609046936035, Class Loss=0.2598038613796234, Reg Loss=8.133805274963379
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.25812608003616333, Reg Loss=8.004353523254395
Clinet index 5, End of Epoch 2/6, Average Loss=8.262479782104492, Class Loss=0.25812608003616333, Reg Loss=8.004353523254395
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.26919519901275635, Reg Loss=7.990725517272949
Clinet index 5, End of Epoch 3/6, Average Loss=8.259921073913574, Class Loss=0.26919519901275635, Reg Loss=7.990725517272949
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.24707649648189545, Reg Loss=7.891915798187256
Clinet index 5, End of Epoch 4/6, Average Loss=8.138992309570312, Class Loss=0.24707649648189545, Reg Loss=7.891915798187256
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 5, Class Loss=0.22267737984657288, Reg Loss=7.739047050476074
Clinet index 5, End of Epoch 5/6, Average Loss=7.961724281311035, Class Loss=0.22267737984657288, Reg Loss=7.739047050476074
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.22740009427070618, Reg Loss=7.402776718139648
Clinet index 5, End of Epoch 6/6, Average Loss=7.630177021026611, Class Loss=0.22740009427070618, Reg Loss=7.402776718139648
federated aggregation...
Validation, Class Loss=1.098528265953064, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.686120
Mean Acc: 0.119239
FreqW Acc: 0.605059
Mean IoU: 0.073368
Class IoU:
	class 0: 0.8637844
	class 1: 0.0
	class 2: 0.001492916
	class 3: 0.0
	class 4: 0.005343834
	class 5: 0.007721072
	class 6: 0.001289936
	class 7: 0.00020926743
	class 8: 0.00016637162
	class 9: 0.110120766
	class 10: 0.0
	class 11: 0.22150773
	class 12: 0.0
	class 13: 0.00023059435
	class 14: 0.0
	class 15: 0.051776487
	class 16: 0.0
	class 17: 0.0
	class 18: 0.13606016
	class 19: 0.0676634
Class Acc:
	class 0: 0.95785457
	class 1: 0.0
	class 2: 0.0014929385
	class 3: 0.0
	class 4: 0.0053536417
	class 5: 0.0077211247
	class 6: 0.0012899366
	class 7: 0.00020926743
	class 8: 0.00016637162
	class 9: 0.113446675
	class 10: 0.0
	class 11: 0.22217189
	class 12: 0.0
	class 13: 0.00023059435
	class 14: 0.0
	class 15: 0.051780175
	class 16: 0.0
	class 17: 0.0
	class 18: 0.1526214
	class 19: 0.87044036

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20529906451702118, Reg Loss=7.371190071105957
Clinet index 3, End of Epoch 1/6, Average Loss=7.576488971710205, Class Loss=0.20529906451702118, Reg Loss=7.371190071105957
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.21449504792690277, Reg Loss=7.727603435516357
Clinet index 3, End of Epoch 2/6, Average Loss=7.942098617553711, Class Loss=0.21449504792690277, Reg Loss=7.727603435516357
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.20056483149528503, Reg Loss=7.1814351081848145
Clinet index 3, End of Epoch 3/6, Average Loss=7.381999969482422, Class Loss=0.20056483149528503, Reg Loss=7.1814351081848145
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.22976642847061157, Reg Loss=7.483887672424316
Clinet index 3, End of Epoch 4/6, Average Loss=7.713654041290283, Class Loss=0.22976642847061157, Reg Loss=7.483887672424316
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20449674129486084, Reg Loss=7.010395526885986
Clinet index 3, End of Epoch 5/6, Average Loss=7.214892387390137, Class Loss=0.20449674129486084, Reg Loss=7.010395526885986
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1929311752319336, Reg Loss=6.846260070800781
Clinet index 3, End of Epoch 6/6, Average Loss=7.039191246032715, Class Loss=0.1929311752319336, Reg Loss=6.846260070800781
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2186732292175293, Reg Loss=7.06123685836792
Clinet index 19, End of Epoch 1/6, Average Loss=7.279910087585449, Class Loss=0.2186732292175293, Reg Loss=7.06123685836792
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.20473000407218933, Reg Loss=7.265660762786865
Clinet index 19, End of Epoch 2/6, Average Loss=7.470390796661377, Class Loss=0.20473000407218933, Reg Loss=7.265660762786865
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 3, Class Loss=0.20258298516273499, Reg Loss=7.076322078704834
Clinet index 19, End of Epoch 3/6, Average Loss=7.278904914855957, Class Loss=0.20258298516273499, Reg Loss=7.076322078704834
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Epoch 4, Class Loss=0.20307743549346924, Reg Loss=7.7927680015563965
Clinet index 19, End of Epoch 4/6, Average Loss=7.995845317840576, Class Loss=0.20307743549346924, Reg Loss=7.7927680015563965
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20626011490821838, Reg Loss=7.014657497406006
Clinet index 19, End of Epoch 5/6, Average Loss=7.220917701721191, Class Loss=0.20626011490821838, Reg Loss=7.014657497406006
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0
Epoch 6, Class Loss=0.19283431768417358, Reg Loss=6.970511436462402
Clinet index 19, End of Epoch 6/6, Average Loss=7.163345813751221, Class Loss=0.19283431768417358, Reg Loss=6.970511436462402
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2203998863697052, Reg Loss=7.480871200561523
Clinet index 1, End of Epoch 1/6, Average Loss=7.701271057128906, Class Loss=0.2203998863697052, Reg Loss=7.480871200561523
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.21844223141670227, Reg Loss=7.532313823699951
Clinet index 1, End of Epoch 2/6, Average Loss=7.75075626373291, Class Loss=0.21844223141670227, Reg Loss=7.532313823699951
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2176976203918457, Reg Loss=7.116764545440674
Clinet index 1, End of Epoch 3/6, Average Loss=7.3344621658325195, Class Loss=0.2176976203918457, Reg Loss=7.116764545440674
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.20524922013282776, Reg Loss=7.113833427429199
Clinet index 1, End of Epoch 4/6, Average Loss=7.319082736968994, Class Loss=0.20524922013282776, Reg Loss=7.113833427429199
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20267747342586517, Reg Loss=7.108943462371826
Clinet index 1, End of Epoch 5/6, Average Loss=7.311620712280273, Class Loss=0.20267747342586517, Reg Loss=7.108943462371826
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 6, Class Loss=0.1966470181941986, Reg Loss=7.209901809692383
Clinet index 1, End of Epoch 6/6, Average Loss=7.406548976898193, Class Loss=0.1966470181941986, Reg Loss=7.209901809692383
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22345608472824097, Reg Loss=7.163209915161133
Clinet index 11, End of Epoch 1/6, Average Loss=7.3866658210754395, Class Loss=0.22345608472824097, Reg Loss=7.163209915161133
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.2173212468624115, Reg Loss=7.33129358291626
Clinet index 11, End of Epoch 2/6, Average Loss=7.548614978790283, Class Loss=0.2173212468624115, Reg Loss=7.33129358291626
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 3, Class Loss=0.2136463224887848, Reg Loss=7.40306282043457
Clinet index 11, End of Epoch 3/6, Average Loss=7.616709232330322, Class Loss=0.2136463224887848, Reg Loss=7.40306282043457
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2066907286643982, Reg Loss=6.999772071838379
Clinet index 11, End of Epoch 4/6, Average Loss=7.206462860107422, Class Loss=0.2066907286643982, Reg Loss=6.999772071838379
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20722033083438873, Reg Loss=6.6050519943237305
Clinet index 11, End of Epoch 5/6, Average Loss=6.812272548675537, Class Loss=0.20722033083438873, Reg Loss=6.6050519943237305
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.21276050806045532, Reg Loss=6.658755302429199
Clinet index 11, End of Epoch 6/6, Average Loss=6.87151575088501, Class Loss=0.21276050806045532, Reg Loss=6.658755302429199
federated aggregation...
Validation, Class Loss=1.1494605541229248, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.680986
Mean Acc: 0.117972
FreqW Acc: 0.603213
Mean IoU: 0.070943
Class IoU:
	class 0: 0.8611101
	class 1: 0.0
	class 2: 0.00041355012
	class 3: 0.0
	class 4: 0.00034782055
	class 5: 0.0008016
	class 6: 0.0001663246
	class 7: 6.638828e-05
	class 8: 4.426401e-05
	class 9: 0.07411121
	class 10: 0.0
	class 11: 0.21007118
	class 12: 0.0
	class 13: 8.143512e-05
	class 14: 0.0
	class 15: 0.059121247
	class 16: 0.0
	class 17: 0.0
	class 18: 0.14522022
	class 19: 0.06730063
Class Acc:
	class 0: 0.9495652
	class 1: 0.0
	class 2: 0.0004135504
	class 3: 0.0
	class 4: 0.0003479867
	class 5: 0.0008016
	class 6: 0.0001663246
	class 7: 6.638828e-05
	class 8: 4.426401e-05
	class 9: 0.07546739
	class 10: 0.0
	class 11: 0.21054664
	class 12: 0.0
	class 13: 8.143512e-05
	class 14: 0.0
	class 15: 0.059128065
	class 16: 0.0
	class 17: 0.0
	class 18: 0.16607423
	class 19: 0.89673173

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2093231976032257, Reg Loss=6.559141635894775
Clinet index 4, End of Epoch 1/6, Average Loss=6.768465042114258, Class Loss=0.2093231976032257, Reg Loss=6.559141635894775
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.20467935502529144, Reg Loss=6.451107978820801
Clinet index 4, End of Epoch 2/6, Average Loss=6.655787467956543, Class Loss=0.20467935502529144, Reg Loss=6.451107978820801
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19278477132320404, Reg Loss=6.101803779602051
Clinet index 4, End of Epoch 3/6, Average Loss=6.294588565826416, Class Loss=0.19278477132320404, Reg Loss=6.101803779602051
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 4, Class Loss=0.19468514621257782, Reg Loss=6.117397785186768
Clinet index 4, End of Epoch 4/6, Average Loss=6.312082767486572, Class Loss=0.19468514621257782, Reg Loss=6.117397785186768
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.20524078607559204, Reg Loss=6.042906284332275
Clinet index 4, End of Epoch 5/6, Average Loss=6.248147010803223, Class Loss=0.20524078607559204, Reg Loss=6.042906284332275
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.21010605990886688, Reg Loss=6.1323676109313965
Clinet index 4, End of Epoch 6/6, Average Loss=6.34247350692749, Class Loss=0.21010605990886688, Reg Loss=6.1323676109313965
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19836628437042236, Reg Loss=6.733786106109619
Clinet index 13, End of Epoch 1/6, Average Loss=6.932152271270752, Class Loss=0.19836628437042236, Reg Loss=6.733786106109619
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.18984711170196533, Reg Loss=6.690813064575195
Clinet index 13, End of Epoch 2/6, Average Loss=6.880660057067871, Class Loss=0.18984711170196533, Reg Loss=6.690813064575195
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 3, Class Loss=0.18315333127975464, Reg Loss=6.665241718292236
Clinet index 13, End of Epoch 3/6, Average Loss=6.848394870758057, Class Loss=0.18315333127975464, Reg Loss=6.665241718292236
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0
Epoch 4, Class Loss=0.18106144666671753, Reg Loss=6.848338603973389
Clinet index 13, End of Epoch 4/6, Average Loss=7.029399871826172, Class Loss=0.18106144666671753, Reg Loss=6.848338603973389
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.18128253519535065, Reg Loss=6.189194202423096
Clinet index 13, End of Epoch 5/6, Average Loss=6.370476722717285, Class Loss=0.18128253519535065, Reg Loss=6.189194202423096
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.17634934186935425, Reg Loss=6.305675983428955
Clinet index 13, End of Epoch 6/6, Average Loss=6.482025146484375, Class Loss=0.17634934186935425, Reg Loss=6.305675983428955
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.18843582272529602, Reg Loss=6.47422456741333
Clinet index 18, End of Epoch 1/6, Average Loss=6.662660598754883, Class Loss=0.18843582272529602, Reg Loss=6.47422456741333
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19201122224330902, Reg Loss=6.390010833740234
Clinet index 18, End of Epoch 2/6, Average Loss=6.582022190093994, Class Loss=0.19201122224330902, Reg Loss=6.390010833740234
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.1929306983947754, Reg Loss=6.488495826721191
Clinet index 18, End of Epoch 3/6, Average Loss=6.681426525115967, Class Loss=0.1929306983947754, Reg Loss=6.488495826721191
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18319346010684967, Reg Loss=6.286526679992676
Clinet index 18, End of Epoch 4/6, Average Loss=6.469720363616943, Class Loss=0.18319346010684967, Reg Loss=6.286526679992676
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 5, Class Loss=0.1868191659450531, Reg Loss=6.63787841796875
Clinet index 18, End of Epoch 5/6, Average Loss=6.824697494506836, Class Loss=0.1868191659450531, Reg Loss=6.63787841796875
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.18528760969638824, Reg Loss=5.8446173667907715
Clinet index 18, End of Epoch 6/6, Average Loss=6.029904842376709, Class Loss=0.18528760969638824, Reg Loss=5.8446173667907715
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.20591184496879578, Reg Loss=6.742385387420654
Clinet index 9, End of Epoch 1/6, Average Loss=6.948297023773193, Class Loss=0.20591184496879578, Reg Loss=6.742385387420654
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.21190285682678223, Reg Loss=6.754945755004883
Clinet index 9, End of Epoch 2/6, Average Loss=6.966848373413086, Class Loss=0.21190285682678223, Reg Loss=6.754945755004883
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 3, Class Loss=0.2039988934993744, Reg Loss=6.7963643074035645
Clinet index 9, End of Epoch 3/6, Average Loss=7.000363349914551, Class Loss=0.2039988934993744, Reg Loss=6.7963643074035645
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.20587140321731567, Reg Loss=6.811934471130371
Clinet index 9, End of Epoch 4/6, Average Loss=7.017806053161621, Class Loss=0.20587140321731567, Reg Loss=6.811934471130371
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.18875589966773987, Reg Loss=6.465427875518799
Clinet index 9, End of Epoch 5/6, Average Loss=6.654183864593506, Class Loss=0.18875589966773987, Reg Loss=6.465427875518799
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.20615017414093018, Reg Loss=6.620234489440918
Clinet index 9, End of Epoch 6/6, Average Loss=6.826384544372559, Class Loss=0.20615017414093018, Reg Loss=6.620234489440918
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=1.165688157081604, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.682799
Mean Acc: 0.117025
FreqW Acc: 0.600383
Mean IoU: 0.069172
Class IoU:
	class 0: 0.85683745
	class 1: 0.0
	class 2: 0.00021501754
	class 3: 0.0
	class 4: 8.321576e-05
	class 5: 0.00021244025
	class 6: 0.00013645459
	class 7: 3.511844e-05
	class 8: 1.4652914e-05
	class 9: 0.05542619
	class 10: 0.0
	class 11: 0.17861432
	class 12: 0.0
	class 13: 6.356925e-05
	class 14: 0.0
	class 15: 0.06654884
	class 16: 0.0
	class 17: 0.0
	class 18: 0.15533032
	class 19: 0.06992084
Class Acc:
	class 0: 0.9517764
	class 1: 0.0
	class 2: 0.00021501754
	class 3: 0.0
	class 4: 8.323239e-05
	class 5: 0.00021244025
	class 6: 0.00013645459
	class 7: 3.511844e-05
	class 8: 1.4652914e-05
	class 9: 0.056292433
	class 10: 0.0
	class 11: 0.17890635
	class 12: 0.0
	class 13: 6.356925e-05
	class 14: 0.0
	class 15: 0.06655793
	class 16: 0.0
	class 17: 0.0
	class 18: 0.18168181
	class 19: 0.9045279

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=1.7079635858535767, Reg Loss=14.074987411499023
Clinet index 29, End of Epoch 1/6, Average Loss=15.782951354980469, Class Loss=1.7079635858535767, Reg Loss=14.074987411499023
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.3859111070632935, Reg Loss=11.024426460266113
Clinet index 29, End of Epoch 2/6, Average Loss=12.410337448120117, Class Loss=1.3859111070632935, Reg Loss=11.024426460266113
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2557358741760254, Reg Loss=9.227182388305664
Clinet index 29, End of Epoch 3/6, Average Loss=10.482917785644531, Class Loss=1.2557358741760254, Reg Loss=9.227182388305664
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.109872817993164, Reg Loss=8.408649444580078
Clinet index 29, End of Epoch 4/6, Average Loss=9.518522262573242, Class Loss=1.109872817993164, Reg Loss=8.408649444580078
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9765909910202026, Reg Loss=7.638803958892822
Clinet index 29, End of Epoch 5/6, Average Loss=8.615394592285156, Class Loss=0.9765909910202026, Reg Loss=7.638803958892822
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 6, Class Loss=0.8676663637161255, Reg Loss=7.357715129852295
Clinet index 29, End of Epoch 6/6, Average Loss=8.225381851196289, Class Loss=0.8676663637161255, Reg Loss=7.357715129852295
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.7021574974060059, Reg Loss=14.390053749084473
Clinet index 3, End of Epoch 1/6, Average Loss=16.09221076965332, Class Loss=1.7021574974060059, Reg Loss=14.390053749084473
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4132740497589111, Reg Loss=10.3563871383667
Clinet index 3, End of Epoch 2/6, Average Loss=11.769660949707031, Class Loss=1.4132740497589111, Reg Loss=10.3563871383667
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2725498676300049, Reg Loss=8.72253131866455
Clinet index 3, End of Epoch 3/6, Average Loss=9.995080947875977, Class Loss=1.2725498676300049, Reg Loss=8.72253131866455
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=1.0819164514541626, Reg Loss=7.90371561050415
Clinet index 3, End of Epoch 4/6, Average Loss=8.985631942749023, Class Loss=1.0819164514541626, Reg Loss=7.90371561050415
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9688215255737305, Reg Loss=7.439848899841309
Clinet index 3, End of Epoch 5/6, Average Loss=8.408670425415039, Class Loss=0.9688215255737305, Reg Loss=7.439848899841309
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8348762392997742, Reg Loss=7.249403953552246
Clinet index 3, End of Epoch 6/6, Average Loss=8.084280014038086, Class Loss=0.8348762392997742, Reg Loss=7.249403953552246
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=1.8149477243423462, Reg Loss=14.619086265563965
Clinet index 8, End of Epoch 1/6, Average Loss=16.43403434753418, Class Loss=1.8149477243423462, Reg Loss=14.619086265563965
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4194484949111938, Reg Loss=10.795570373535156
Clinet index 8, End of Epoch 2/6, Average Loss=12.215019226074219, Class Loss=1.4194484949111938, Reg Loss=10.795570373535156
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2862558364868164, Reg Loss=8.979263305664062
Clinet index 8, End of Epoch 3/6, Average Loss=10.265519142150879, Class Loss=1.2862558364868164, Reg Loss=8.979263305664062
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.131518840789795, Reg Loss=8.088438034057617
Clinet index 8, End of Epoch 4/6, Average Loss=9.21995735168457, Class Loss=1.131518840789795, Reg Loss=8.088438034057617
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9640690684318542, Reg Loss=7.504347801208496
Clinet index 8, End of Epoch 5/6, Average Loss=8.468417167663574, Class Loss=0.9640690684318542, Reg Loss=7.504347801208496
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.837142288684845, Reg Loss=7.13870906829834
Clinet index 8, End of Epoch 6/6, Average Loss=7.975851535797119, Class Loss=0.837142288684845, Reg Loss=7.13870906829834
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.8649773597717285, Reg Loss=14.209081649780273
Clinet index 19, End of Epoch 1/6, Average Loss=16.074058532714844, Class Loss=1.8649773597717285, Reg Loss=14.209081649780273
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=1.5145494937896729, Reg Loss=10.341769218444824
Clinet index 19, End of Epoch 2/6, Average Loss=11.856318473815918, Class Loss=1.5145494937896729, Reg Loss=10.341769218444824
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.3289350271224976, Reg Loss=9.061686515808105
Clinet index 19, End of Epoch 3/6, Average Loss=10.390621185302734, Class Loss=1.3289350271224976, Reg Loss=9.061686515808105
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1625415086746216, Reg Loss=8.26375675201416
Clinet index 19, End of Epoch 4/6, Average Loss=9.426298141479492, Class Loss=1.1625415086746216, Reg Loss=8.26375675201416
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.016012191772461, Reg Loss=7.987207889556885
Clinet index 19, End of Epoch 5/6, Average Loss=9.003219604492188, Class Loss=1.016012191772461, Reg Loss=7.987207889556885
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8584169149398804, Reg Loss=7.260039329528809
Clinet index 19, End of Epoch 6/6, Average Loss=8.11845588684082, Class Loss=0.8584169149398804, Reg Loss=7.260039329528809
federated aggregation...
Validation, Class Loss=0.9253007173538208, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.697405
Mean Acc: 0.138607
FreqW Acc: 0.582290
Mean IoU: 0.099627
Class IoU:
	class 0: 0.8234767
	class 1: 0.26871592
	class 2: 0.009010472
	class 3: 1.0025985e-05
	class 4: 0.1667737
	class 5: 0.12656689
	class 6: 0.15712544
	class 7: 0.002535419
	class 8: 0.0023504698
	class 9: 0.04158815
	class 10: 0.0048626456
	class 11: 0.13971394
	class 12: 0.0
	class 13: 0.15216334
	class 14: 0.00023068306
	class 15: 0.02254027
	class 16: 0.0
	class 17: 0.0
	class 18: 0.10228197
	class 19: 0.072228074
	class 20: 0.0
Class Acc:
	class 0: 0.9722947
	class 1: 0.26919064
	class 2: 0.009026436
	class 3: 1.0025985e-05
	class 4: 0.17398791
	class 5: 0.12671928
	class 6: 0.1572649
	class 7: 0.002535423
	class 8: 0.0023504698
	class 9: 0.04199905
	class 10: 0.004862701
	class 11: 0.1399055
	class 12: 0.0
	class 13: 0.15236261
	class 14: 0.0002306834
	class 15: 0.022541545
	class 16: 0.0
	class 17: 0.0
	class 18: 0.10973536
	class 19: 0.7257344
	class 20: 0.0

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.8172643780708313, Reg Loss=7.062294006347656
Clinet index 4, End of Epoch 1/6, Average Loss=7.879558563232422, Class Loss=0.8172643780708313, Reg Loss=7.062294006347656
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7536889314651489, Reg Loss=6.711380958557129
Clinet index 4, End of Epoch 2/6, Average Loss=7.465069770812988, Class Loss=0.7536889314651489, Reg Loss=6.711380958557129
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6364386677742004, Reg Loss=6.891664981842041
Clinet index 4, End of Epoch 3/6, Average Loss=7.528103828430176, Class Loss=0.6364386677742004, Reg Loss=6.891664981842041
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5585135221481323, Reg Loss=6.576030254364014
Clinet index 4, End of Epoch 4/6, Average Loss=7.1345438957214355, Class Loss=0.5585135221481323, Reg Loss=6.576030254364014
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5339206457138062, Reg Loss=6.41308069229126
Clinet index 4, End of Epoch 5/6, Average Loss=6.9470014572143555, Class Loss=0.5339206457138062, Reg Loss=6.41308069229126
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5036013126373291, Reg Loss=6.206972122192383
Clinet index 4, End of Epoch 6/6, Average Loss=6.710573196411133, Class Loss=0.5036013126373291, Reg Loss=6.206972122192383
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7475599050521851, Reg Loss=7.160227298736572
Clinet index 0, End of Epoch 1/6, Average Loss=7.907787322998047, Class Loss=0.7475599050521851, Reg Loss=7.160227298736572
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.6761953830718994, Reg Loss=7.062512397766113
Clinet index 0, End of Epoch 2/6, Average Loss=7.738707542419434, Class Loss=0.6761953830718994, Reg Loss=7.062512397766113
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6152238249778748, Reg Loss=6.969271183013916
Clinet index 0, End of Epoch 3/6, Average Loss=7.5844950675964355, Class Loss=0.6152238249778748, Reg Loss=6.969271183013916
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5543806552886963, Reg Loss=6.887775897979736
Clinet index 0, End of Epoch 4/6, Average Loss=7.442156791687012, Class Loss=0.5543806552886963, Reg Loss=6.887775897979736
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5037314891815186, Reg Loss=6.54599142074585
Clinet index 0, End of Epoch 5/6, Average Loss=7.049722671508789, Class Loss=0.5037314891815186, Reg Loss=6.54599142074585
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4832521677017212, Reg Loss=6.29882287979126
Clinet index 0, End of Epoch 6/6, Average Loss=6.782074928283691, Class Loss=0.4832521677017212, Reg Loss=6.29882287979126
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.7687739729881287, Reg Loss=6.788137912750244
Clinet index 29, End of Epoch 1/6, Average Loss=7.556911945343018, Class Loss=0.7687739729881287, Reg Loss=6.788137912750244
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7216706871986389, Reg Loss=7.112946510314941
Clinet index 29, End of Epoch 2/6, Average Loss=7.8346171379089355, Class Loss=0.7216706871986389, Reg Loss=7.112946510314941
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.6657785773277283, Reg Loss=6.884265899658203
Clinet index 29, End of Epoch 3/6, Average Loss=7.550044536590576, Class Loss=0.6657785773277283, Reg Loss=6.884265899658203
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.594137966632843, Reg Loss=6.770016670227051
Clinet index 29, End of Epoch 4/6, Average Loss=7.364154815673828, Class Loss=0.594137966632843, Reg Loss=6.770016670227051
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5467575192451477, Reg Loss=6.351367473602295
Clinet index 29, End of Epoch 5/6, Average Loss=6.898125171661377, Class Loss=0.5467575192451477, Reg Loss=6.351367473602295
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 6, Class Loss=0.5161893963813782, Reg Loss=6.616284370422363
Clinet index 29, End of Epoch 6/6, Average Loss=7.132473945617676, Class Loss=0.5161893963813782, Reg Loss=6.616284370422363
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.7841060757637024, Reg Loss=7.294310092926025
Clinet index 20, End of Epoch 1/6, Average Loss=8.078415870666504, Class Loss=0.7841060757637024, Reg Loss=7.294310092926025
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7303756475448608, Reg Loss=6.804638862609863
Clinet index 20, End of Epoch 2/6, Average Loss=7.535014629364014, Class Loss=0.7303756475448608, Reg Loss=6.804638862609863
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6369931697845459, Reg Loss=6.773952960968018
Clinet index 20, End of Epoch 3/6, Average Loss=7.410945892333984, Class Loss=0.6369931697845459, Reg Loss=6.773952960968018
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5619964003562927, Reg Loss=6.5812883377075195
Clinet index 20, End of Epoch 4/6, Average Loss=7.143284797668457, Class Loss=0.5619964003562927, Reg Loss=6.5812883377075195
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5076845288276672, Reg Loss=6.315770149230957
Clinet index 20, End of Epoch 5/6, Average Loss=6.823454856872559, Class Loss=0.5076845288276672, Reg Loss=6.315770149230957
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.48432832956314087, Reg Loss=6.38053035736084
Clinet index 20, End of Epoch 6/6, Average Loss=6.864858627319336, Class Loss=0.48432832956314087, Reg Loss=6.38053035736084
federated aggregation...
Validation, Class Loss=0.9400587677955627, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.700948
Mean Acc: 0.173864
FreqW Acc: 0.590987
Mean IoU: 0.122388
Class IoU:
	class 0: 0.8292591
	class 1: 0.36979598
	class 2: 0.0037083216
	class 3: 0.0014491405
	class 4: 0.21165083
	class 5: 0.10788457
	class 6: 0.17721334
	class 7: 0.004159842
	class 8: 0.0017447143
	class 9: 0.038194787
	class 10: 0.015007141
	class 11: 0.156944
	class 12: 0.0
	class 13: 0.28170666
	class 14: 0.0062279105
	class 15: 0.019398361
	class 16: 0.0
	class 17: 0.0
	class 18: 0.072365865
	class 19: 0.07305085
	class 20: 0.20038827
Class Acc:
	class 0: 0.9675982
	class 1: 0.37120926
	class 2: 0.0037090527
	class 3: 0.0014491405
	class 4: 0.22237228
	class 5: 0.10791374
	class 6: 0.17741689
	class 7: 0.0041598515
	class 8: 0.0017447143
	class 9: 0.038524467
	class 10: 0.015009018
	class 11: 0.15715551
	class 12: 0.0
	class 13: 0.2829596
	class 14: 0.0062293173
	class 15: 0.019399675
	class 16: 0.0
	class 17: 0.0
	class 18: 0.075179055
	class 19: 0.7154641
	class 20: 0.48365447

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5476069450378418, Reg Loss=6.27208948135376
Clinet index 13, End of Epoch 1/6, Average Loss=6.819696426391602, Class Loss=0.5476069450378418, Reg Loss=6.27208948135376
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5445762276649475, Reg Loss=6.606071472167969
Clinet index 13, End of Epoch 2/6, Average Loss=7.1506476402282715, Class Loss=0.5445762276649475, Reg Loss=6.606071472167969
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.512416422367096, Reg Loss=6.433688640594482
Clinet index 13, End of Epoch 3/6, Average Loss=6.946105003356934, Class Loss=0.512416422367096, Reg Loss=6.433688640594482
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4970325827598572, Reg Loss=6.358211517333984
Clinet index 13, End of Epoch 4/6, Average Loss=6.855244159698486, Class Loss=0.4970325827598572, Reg Loss=6.358211517333984
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.4937419295310974, Reg Loss=6.3706955909729
Clinet index 13, End of Epoch 5/6, Average Loss=6.864437580108643, Class Loss=0.4937419295310974, Reg Loss=6.3706955909729
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.4908756613731384, Reg Loss=5.987688064575195
Clinet index 13, End of Epoch 6/6, Average Loss=6.4785637855529785, Class Loss=0.4908756613731384, Reg Loss=5.987688064575195
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.5066980123519897, Reg Loss=6.599332332611084
Clinet index 12, End of Epoch 1/6, Average Loss=7.106030464172363, Class Loss=0.5066980123519897, Reg Loss=6.599332332611084
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5007867813110352, Reg Loss=6.5612969398498535
Clinet index 12, End of Epoch 2/6, Average Loss=7.062083721160889, Class Loss=0.5007867813110352, Reg Loss=6.5612969398498535
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.4902764856815338, Reg Loss=6.584354877471924
Clinet index 12, End of Epoch 3/6, Average Loss=7.074631214141846, Class Loss=0.4902764856815338, Reg Loss=6.584354877471924
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.47675642371177673, Reg Loss=6.200417518615723
Clinet index 12, End of Epoch 4/6, Average Loss=6.677174091339111, Class Loss=0.47675642371177673, Reg Loss=6.200417518615723
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.47041332721710205, Reg Loss=6.279930591583252
Clinet index 12, End of Epoch 5/6, Average Loss=6.7503437995910645, Class Loss=0.47041332721710205, Reg Loss=6.279930591583252
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.45420515537261963, Reg Loss=6.2943243980407715
Clinet index 12, End of Epoch 6/6, Average Loss=6.748529434204102, Class Loss=0.45420515537261963, Reg Loss=6.2943243980407715
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.4911341071128845, Reg Loss=6.3734636306762695
Clinet index 20, End of Epoch 1/6, Average Loss=6.864597797393799, Class Loss=0.4911341071128845, Reg Loss=6.3734636306762695
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.4852977991104126, Reg Loss=6.052985191345215
Clinet index 20, End of Epoch 2/6, Average Loss=6.538282871246338, Class Loss=0.4852977991104126, Reg Loss=6.052985191345215
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.46732383966445923, Reg Loss=6.031173229217529
Clinet index 20, End of Epoch 3/6, Average Loss=6.498497009277344, Class Loss=0.46732383966445923, Reg Loss=6.031173229217529
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.46312013268470764, Reg Loss=5.933758735656738
Clinet index 20, End of Epoch 4/6, Average Loss=6.396878719329834, Class Loss=0.46312013268470764, Reg Loss=5.933758735656738
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.4369795620441437, Reg Loss=5.890562534332275
Clinet index 20, End of Epoch 5/6, Average Loss=6.327542304992676, Class Loss=0.4369795620441437, Reg Loss=5.890562534332275
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.4398418962955475, Reg Loss=5.901494026184082
Clinet index 20, End of Epoch 6/6, Average Loss=6.341335773468018, Class Loss=0.4398418962955475, Reg Loss=5.901494026184082
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5074928402900696, Reg Loss=6.423633098602295
Clinet index 15, End of Epoch 1/6, Average Loss=6.931126117706299, Class Loss=0.5074928402900696, Reg Loss=6.423633098602295
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.4945012629032135, Reg Loss=6.313955783843994
Clinet index 15, End of Epoch 2/6, Average Loss=6.808456897735596, Class Loss=0.4945012629032135, Reg Loss=6.313955783843994
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.47784149646759033, Reg Loss=6.08344030380249
Clinet index 15, End of Epoch 3/6, Average Loss=6.561281681060791, Class Loss=0.47784149646759033, Reg Loss=6.08344030380249
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4632321000099182, Reg Loss=6.3942389488220215
Clinet index 15, End of Epoch 4/6, Average Loss=6.857470989227295, Class Loss=0.4632321000099182, Reg Loss=6.3942389488220215
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.46919965744018555, Reg Loss=5.92897367477417
Clinet index 15, End of Epoch 5/6, Average Loss=6.3981733322143555, Class Loss=0.46919965744018555, Reg Loss=5.92897367477417
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.467470645904541, Reg Loss=6.085351943969727
Clinet index 15, End of Epoch 6/6, Average Loss=6.552822589874268, Class Loss=0.467470645904541, Reg Loss=6.085351943969727
federated aggregation...
Validation, Class Loss=1.0127263069152832, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.692747
Mean Acc: 0.159357
FreqW Acc: 0.581498
Mean IoU: 0.097006
Class IoU:
	class 0: 0.8241875
	class 1: 0.2510292
	class 2: 0.00054184266
	class 3: 1.2853828e-05
	class 4: 0.15582815
	class 5: 0.0030610198
	class 6: 0.11231836
	class 7: 0.0007243379
	class 8: 1.5568721e-05
	class 9: 0.03314843
	class 10: 0.00512106
	class 11: 0.12959798
	class 12: 0.0
	class 13: 0.2274138
	class 14: 0.003043955
	class 15: 0.020544775
	class 16: 0.0
	class 17: 0.0
	class 18: 0.05288135
	class 19: 0.0770397
	class 20: 0.14061682
Class Acc:
	class 0: 0.96182555
	class 1: 0.2515818
	class 2: 0.00054184423
	class 3: 1.2853828e-05
	class 4: 0.16236006
	class 5: 0.0030610305
	class 6: 0.11237739
	class 7: 0.0007243379
	class 8: 1.5568721e-05
	class 9: 0.03335519
	class 10: 0.005121061
	class 11: 0.12969156
	class 12: 0.0
	class 13: 0.22811349
	class 14: 0.0030443284
	class 15: 0.020545892
	class 16: 0.0
	class 17: 0.0
	class 18: 0.05429339
	class 19: 0.7141287
	class 20: 0.66569746

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.4577702581882477, Reg Loss=5.9394755363464355
Clinet index 6, End of Epoch 1/6, Average Loss=6.39724588394165, Class Loss=0.4577702581882477, Reg Loss=5.9394755363464355
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.4657951593399048, Reg Loss=5.949697017669678
Clinet index 6, End of Epoch 2/6, Average Loss=6.415492057800293, Class Loss=0.4657951593399048, Reg Loss=5.949697017669678
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.46133723855018616, Reg Loss=5.740859031677246
Clinet index 6, End of Epoch 3/6, Average Loss=6.20219612121582, Class Loss=0.46133723855018616, Reg Loss=5.740859031677246
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4467877745628357, Reg Loss=5.891628265380859
Clinet index 6, End of Epoch 4/6, Average Loss=6.33841609954834, Class Loss=0.4467877745628357, Reg Loss=5.891628265380859
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4318593740463257, Reg Loss=5.565981388092041
Clinet index 6, End of Epoch 5/6, Average Loss=5.997840881347656, Class Loss=0.4318593740463257, Reg Loss=5.565981388092041
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.4370673596858978, Reg Loss=5.8830742835998535
Clinet index 6, End of Epoch 6/6, Average Loss=6.320141792297363, Class Loss=0.4370673596858978, Reg Loss=5.8830742835998535
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.4575343132019043, Reg Loss=5.746976375579834
Clinet index 29, End of Epoch 1/6, Average Loss=6.204510688781738, Class Loss=0.4575343132019043, Reg Loss=5.746976375579834
Pseudo labeling is: None
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.4498406946659088, Reg Loss=5.896749973297119
Clinet index 29, End of Epoch 2/6, Average Loss=6.346590518951416, Class Loss=0.4498406946659088, Reg Loss=5.896749973297119
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.442341685295105, Reg Loss=5.80567741394043
Clinet index 29, End of Epoch 3/6, Average Loss=6.248019218444824, Class Loss=0.442341685295105, Reg Loss=5.80567741394043
Pseudo labeling is: None
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.43065395951271057, Reg Loss=5.853919506072998
Clinet index 29, End of Epoch 4/6, Average Loss=6.284573554992676, Class Loss=0.43065395951271057, Reg Loss=5.853919506072998
Pseudo labeling is: None
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.43024250864982605, Reg Loss=5.497246742248535
Clinet index 29, End of Epoch 5/6, Average Loss=5.927489280700684, Class Loss=0.43024250864982605, Reg Loss=5.497246742248535
Pseudo labeling is: None
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.43375664949417114, Reg Loss=5.444111347198486
Clinet index 29, End of Epoch 6/6, Average Loss=5.877868175506592, Class Loss=0.43375664949417114, Reg Loss=5.444111347198486
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.4963427782058716, Reg Loss=5.768272876739502
Clinet index 13, End of Epoch 1/6, Average Loss=6.264615535736084, Class Loss=0.4963427782058716, Reg Loss=5.768272876739502
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.491595596075058, Reg Loss=6.135566711425781
Clinet index 13, End of Epoch 2/6, Average Loss=6.627162456512451, Class Loss=0.491595596075058, Reg Loss=6.135566711425781
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.4815309941768646, Reg Loss=5.8918633460998535
Clinet index 13, End of Epoch 3/6, Average Loss=6.37339448928833, Class Loss=0.4815309941768646, Reg Loss=5.8918633460998535
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.4716351330280304, Reg Loss=5.98621940612793
Clinet index 13, End of Epoch 4/6, Average Loss=6.457854747772217, Class Loss=0.4716351330280304, Reg Loss=5.98621940612793
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.47451746463775635, Reg Loss=6.04557991027832
Clinet index 13, End of Epoch 5/6, Average Loss=6.520097255706787, Class Loss=0.47451746463775635, Reg Loss=6.04557991027832
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.4776303470134735, Reg Loss=5.739990234375
Clinet index 13, End of Epoch 6/6, Average Loss=6.217620372772217, Class Loss=0.4776303470134735, Reg Loss=5.739990234375
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.456468790769577, Reg Loss=5.966227054595947
Clinet index 2, End of Epoch 1/6, Average Loss=6.422695636749268, Class Loss=0.456468790769577, Reg Loss=5.966227054595947
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.4455185532569885, Reg Loss=6.285175800323486
Clinet index 2, End of Epoch 2/6, Average Loss=6.73069429397583, Class Loss=0.4455185532569885, Reg Loss=6.285175800323486
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.4509747326374054, Reg Loss=5.8543572425842285
Clinet index 2, End of Epoch 3/6, Average Loss=6.305332183837891, Class Loss=0.4509747326374054, Reg Loss=5.8543572425842285
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4337289333343506, Reg Loss=5.679869174957275
Clinet index 2, End of Epoch 4/6, Average Loss=6.113597869873047, Class Loss=0.4337289333343506, Reg Loss=5.679869174957275
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 5, Class Loss=0.4295400381088257, Reg Loss=5.737705707550049
Clinet index 2, End of Epoch 5/6, Average Loss=6.167245864868164, Class Loss=0.4295400381088257, Reg Loss=5.737705707550049
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.4362306594848633, Reg Loss=5.5557684898376465
Clinet index 2, End of Epoch 6/6, Average Loss=5.99199914932251, Class Loss=0.4362306594848633, Reg Loss=5.5557684898376465
federated aggregation...
Validation, Class Loss=1.057270884513855, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.688315
Mean Acc: 0.151119
FreqW Acc: 0.577367
Mean IoU: 0.085864
Class IoU:
	class 0: 0.8221002
	class 1: 0.15579586
	class 2: 0.000103925144
	class 3: 0.0
	class 4: 0.10743004
	class 5: 0.00064382085
	class 6: 0.07458789
	class 7: 9.685634e-05
	class 8: 0.0
	class 9: 0.032263394
	class 10: 0.004117659
	class 11: 0.1134108
	class 12: 0.0
	class 13: 0.2102552
	class 14: 0.0019905707
	class 15: 0.01902505
	class 16: 0.0
	class 17: 0.0
	class 18: 0.058381047
	class 19: 0.079799116
	class 20: 0.12313384
Class Acc:
	class 0: 0.958339
	class 1: 0.15604143
	class 2: 0.000103925144
	class 3: 0.0
	class 4: 0.11064095
	class 5: 0.000643821
	class 6: 0.074605525
	class 7: 9.685634e-05
	class 8: 0.0
	class 9: 0.032461233
	class 10: 0.004117659
	class 11: 0.11348651
	class 12: 0.0
	class 13: 0.21082285
	class 14: 0.0019906722
	class 15: 0.019026043
	class 16: 0.0
	class 17: 0.0
	class 18: 0.060213108
	class 19: 0.7300757
	class 20: 0.7008431

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.43345460295677185, Reg Loss=5.6864824295043945
Clinet index 6, End of Epoch 1/6, Average Loss=6.119936943054199, Class Loss=0.43345460295677185, Reg Loss=5.6864824295043945
Pseudo labeling is: None
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.45219817757606506, Reg Loss=5.696149826049805
Clinet index 6, End of Epoch 2/6, Average Loss=6.148347854614258, Class Loss=0.45219817757606506, Reg Loss=5.696149826049805
Pseudo labeling is: None
Epoch 3, lr = 0.000372
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.45080360770225525, Reg Loss=5.574034214019775
Clinet index 6, End of Epoch 3/6, Average Loss=6.024837970733643, Class Loss=0.45080360770225525, Reg Loss=5.574034214019775
Pseudo labeling is: None
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.45316681265830994, Reg Loss=5.486029624938965
Clinet index 6, End of Epoch 4/6, Average Loss=5.939196586608887, Class Loss=0.45316681265830994, Reg Loss=5.486029624938965
Pseudo labeling is: None
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.44051018357276917, Reg Loss=5.34416389465332
Clinet index 6, End of Epoch 5/6, Average Loss=5.784674167633057, Class Loss=0.44051018357276917, Reg Loss=5.34416389465332
Pseudo labeling is: None
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.43833959102630615, Reg Loss=5.568673133850098
Clinet index 6, End of Epoch 6/6, Average Loss=6.007012844085693, Class Loss=0.43833959102630615, Reg Loss=5.568673133850098
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4697602689266205, Reg Loss=5.807215690612793
Clinet index 16, End of Epoch 1/6, Average Loss=6.276976108551025, Class Loss=0.4697602689266205, Reg Loss=5.807215690612793
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.45241424441337585, Reg Loss=6.082210063934326
Clinet index 16, End of Epoch 2/6, Average Loss=6.534624099731445, Class Loss=0.45241424441337585, Reg Loss=6.082210063934326
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.44588127732276917, Reg Loss=5.864502906799316
Clinet index 16, End of Epoch 3/6, Average Loss=6.310384273529053, Class Loss=0.44588127732276917, Reg Loss=5.864502906799316
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.44578737020492554, Reg Loss=5.892829418182373
Clinet index 16, End of Epoch 4/6, Average Loss=6.338616847991943, Class Loss=0.44578737020492554, Reg Loss=5.892829418182373
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4487110674381256, Reg Loss=5.725003719329834
Clinet index 16, End of Epoch 5/6, Average Loss=6.173714637756348, Class Loss=0.4487110674381256, Reg Loss=5.725003719329834
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.4344431161880493, Reg Loss=5.747488021850586
Clinet index 16, End of Epoch 6/6, Average Loss=6.181931018829346, Class Loss=0.4344431161880493, Reg Loss=5.747488021850586
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.4869745075702667, Reg Loss=5.5608320236206055
Clinet index 13, End of Epoch 1/6, Average Loss=6.047806739807129, Class Loss=0.4869745075702667, Reg Loss=5.5608320236206055
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.4802406132221222, Reg Loss=5.88549280166626
Clinet index 13, End of Epoch 2/6, Average Loss=6.365733623504639, Class Loss=0.4802406132221222, Reg Loss=5.88549280166626
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.4814816117286682, Reg Loss=5.613030910491943
Clinet index 13, End of Epoch 3/6, Average Loss=6.094512462615967, Class Loss=0.4814816117286682, Reg Loss=5.613030910491943
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.4712747633457184, Reg Loss=5.751704692840576
Clinet index 13, End of Epoch 4/6, Average Loss=6.222979545593262, Class Loss=0.4712747633457184, Reg Loss=5.751704692840576
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.48252779245376587, Reg Loss=5.92678689956665
Clinet index 13, End of Epoch 5/6, Average Loss=6.4093146324157715, Class Loss=0.48252779245376587, Reg Loss=5.92678689956665
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.4751296639442444, Reg Loss=5.578819751739502
Clinet index 13, End of Epoch 6/6, Average Loss=6.053949356079102, Class Loss=0.4751296639442444, Reg Loss=5.578819751739502
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4298737943172455, Reg Loss=5.97572660446167
Clinet index 22, End of Epoch 1/6, Average Loss=6.405600547790527, Class Loss=0.4298737943172455, Reg Loss=5.97572660446167
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.4167948365211487, Reg Loss=5.662603855133057
Clinet index 22, End of Epoch 2/6, Average Loss=6.0793986320495605, Class Loss=0.4167948365211487, Reg Loss=5.662603855133057
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.4360564351081848, Reg Loss=5.4698381423950195
Clinet index 22, End of Epoch 3/6, Average Loss=5.905894756317139, Class Loss=0.4360564351081848, Reg Loss=5.4698381423950195
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.4245241582393646, Reg Loss=5.6747283935546875
Clinet index 22, End of Epoch 4/6, Average Loss=6.099252700805664, Class Loss=0.4245241582393646, Reg Loss=5.6747283935546875
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.42661064863204956, Reg Loss=5.572514533996582
Clinet index 22, End of Epoch 5/6, Average Loss=5.999125003814697, Class Loss=0.42661064863204956, Reg Loss=5.572514533996582
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.42233791947364807, Reg Loss=5.787306308746338
Clinet index 22, End of Epoch 6/6, Average Loss=6.209644317626953, Class Loss=0.42233791947364807, Reg Loss=5.787306308746338
federated aggregation...
Validation, Class Loss=1.072387933731079, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.687726
Mean Acc: 0.146183
FreqW Acc: 0.576788
Mean IoU: 0.080981
Class IoU:
	class 0: 0.82332116
	class 1: 0.13138053
	class 2: 6.235509e-05
	class 3: 0.0
	class 4: 0.081760235
	class 5: 0.0004426085
	class 6: 0.054926984
	class 7: 4.8107453e-05
	class 8: 0.0
	class 9: 0.032452278
	class 10: 0.0026603602
	class 11: 0.11304677
	class 12: 0.0
	class 13: 0.17576827
	class 14: 0.0012081631
	class 15: 0.017590433
	class 16: 0.0
	class 17: 0.0
	class 18: 0.05701546
	class 19: 0.078448415
	class 20: 0.13046564
Class Acc:
	class 0: 0.9595422
	class 1: 0.13153963
	class 2: 6.235509e-05
	class 3: 0.0
	class 4: 0.083636425
	class 5: 0.0004426085
	class 6: 0.054935407
	class 7: 4.8107453e-05
	class 8: 0.0
	class 9: 0.032652818
	class 10: 0.0026603602
	class 11: 0.113120645
	class 12: 0.0
	class 13: 0.17613357
	class 14: 0.0012081665
	class 15: 0.01759109
	class 16: 0.0
	class 17: 0.0
	class 18: 0.05872556
	class 19: 0.729747
	class 20: 0.707787

voc_15-1_ILT On GPUs 2
Run in 20197s
