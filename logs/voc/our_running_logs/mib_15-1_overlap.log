nohup: ignoring input
30
kvoc_15-1_MiB On GPUs 2\Writing in results/seed_2023-ov/2023-03-08_voc_15-1_MiB.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: None
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch 1, Class Loss=0.5739260315895081, Reg Loss=0.12982596457004547
Clinet index 3, End of Epoch 1/6, Average Loss=0.7037519812583923, Class Loss=0.5739260315895081, Reg Loss=0.12982596457004547
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4222579002380371, Reg Loss=0.10881832987070084
Clinet index 3, End of Epoch 2/6, Average Loss=0.5310762524604797, Class Loss=0.4222579002380371, Reg Loss=0.10881832987070084
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.3869301974773407, Reg Loss=0.10865813493728638
Clinet index 3, End of Epoch 3/6, Average Loss=0.4955883324146271, Class Loss=0.3869301974773407, Reg Loss=0.10865813493728638
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.36883604526519775, Reg Loss=0.1003330796957016
Clinet index 3, End of Epoch 4/6, Average Loss=0.46916913986206055, Class Loss=0.36883604526519775, Reg Loss=0.1003330796957016
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.3577386438846588, Reg Loss=0.09742555022239685
Clinet index 3, End of Epoch 5/6, Average Loss=0.45516419410705566, Class Loss=0.3577386438846588, Reg Loss=0.09742555022239685
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.327837198972702, Reg Loss=0.09036216139793396
Clinet index 3, End of Epoch 6/6, Average Loss=0.418199360370636, Class Loss=0.327837198972702, Reg Loss=0.09036216139793396
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5612890124320984, Reg Loss=0.12218507379293442
Clinet index 6, End of Epoch 1/6, Average Loss=0.683474063873291, Class Loss=0.5612890124320984, Reg Loss=0.12218507379293442
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4235818088054657, Reg Loss=0.11119893193244934
Clinet index 6, End of Epoch 2/6, Average Loss=0.534780740737915, Class Loss=0.4235818088054657, Reg Loss=0.11119893193244934
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.3934568762779236, Reg Loss=0.10044166445732117
Clinet index 6, End of Epoch 3/6, Average Loss=0.49389854073524475, Class Loss=0.3934568762779236, Reg Loss=0.10044166445732117
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.3680945038795471, Reg Loss=0.09906373172998428
Clinet index 6, End of Epoch 4/6, Average Loss=0.4671582281589508, Class Loss=0.3680945038795471, Reg Loss=0.09906373172998428
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.3443775475025177, Reg Loss=0.09715442359447479
Clinet index 6, End of Epoch 5/6, Average Loss=0.4415319561958313, Class Loss=0.3443775475025177, Reg Loss=0.09715442359447479
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3208088278770447, Reg Loss=0.0990695059299469
Clinet index 6, End of Epoch 6/6, Average Loss=0.4198783338069916, Class Loss=0.3208088278770447, Reg Loss=0.0990695059299469
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5774669051170349, Reg Loss=0.125056654214859
Clinet index 12, End of Epoch 1/6, Average Loss=0.7025235891342163, Class Loss=0.5774669051170349, Reg Loss=0.125056654214859
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.434687077999115, Reg Loss=0.11064418405294418
Clinet index 12, End of Epoch 2/6, Average Loss=0.5453312397003174, Class Loss=0.434687077999115, Reg Loss=0.11064418405294418
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.3970370292663574, Reg Loss=0.10688839107751846
Clinet index 12, End of Epoch 3/6, Average Loss=0.5039254426956177, Class Loss=0.3970370292663574, Reg Loss=0.10688839107751846
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.387919545173645, Reg Loss=0.10469304770231247
Clinet index 12, End of Epoch 4/6, Average Loss=0.4926126003265381, Class Loss=0.387919545173645, Reg Loss=0.10469304770231247
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.3697749078273773, Reg Loss=0.09731730073690414
Clinet index 12, End of Epoch 5/6, Average Loss=0.46709221601486206, Class Loss=0.3697749078273773, Reg Loss=0.09731730073690414
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3412867784500122, Reg Loss=0.09330716729164124
Clinet index 12, End of Epoch 6/6, Average Loss=0.43459394574165344, Class Loss=0.3412867784500122, Reg Loss=0.09330716729164124
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5359253883361816, Reg Loss=0.12482395023107529
Clinet index 0, End of Epoch 1/6, Average Loss=0.6607493162155151, Class Loss=0.5359253883361816, Reg Loss=0.12482395023107529
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.41671043634414673, Reg Loss=0.11659714579582214
Clinet index 0, End of Epoch 2/6, Average Loss=0.5333075523376465, Class Loss=0.41671043634414673, Reg Loss=0.11659714579582214
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.3815143406391144, Reg Loss=0.10793847590684891
Clinet index 0, End of Epoch 3/6, Average Loss=0.4894528090953827, Class Loss=0.3815143406391144, Reg Loss=0.10793847590684891
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.35290175676345825, Reg Loss=0.10489098727703094
Clinet index 0, End of Epoch 4/6, Average Loss=0.4577927589416504, Class Loss=0.35290175676345825, Reg Loss=0.10489098727703094
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.33817949891090393, Reg Loss=0.10562075674533844
Clinet index 0, End of Epoch 5/6, Average Loss=0.44380027055740356, Class Loss=0.33817949891090393, Reg Loss=0.10562075674533844
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.32158154249191284, Reg Loss=0.09478611499071121
Clinet index 0, End of Epoch 6/6, Average Loss=0.41636765003204346, Class Loss=0.32158154249191284, Reg Loss=0.09478611499071121
federated aggregation...
Validation, Class Loss=0.2844869792461395, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.939370
Mean Acc: 0.805446
FreqW Acc: 0.889578
Mean IoU: 0.716897
Class IoU:
	class 0: 0.93308663
	class 1: 0.88891697
	class 2: 0.41400704
	class 3: 0.86010635
	class 4: 0.6385517
	class 5: 0.7983041
	class 6: 0.93058264
	class 7: 0.88730407
	class 8: 0.87271047
	class 9: 0.4179797
	class 10: 0.6988002
	class 11: 0.56356305
	class 12: 0.8027826
	class 13: 0.76901114
	class 14: 0.85750693
	class 15: 0.8539379
	class 16: 9.4532275e-05
Class Acc:
	class 0: 0.97177947
	class 1: 0.96532565
	class 2: 0.86137533
	class 3: 0.890227
	class 4: 0.7247827
	class 5: 0.8986001
	class 6: 0.9608635
	class 7: 0.9372825
	class 8: 0.90854853
	class 9: 0.5252411
	class 10: 0.71652216
	class 11: 0.6085852
	class 12: 0.9620626
	class 13: 0.91835445
	class 14: 0.9175655
	class 15: 0.9253657
	class 16: 9.453232e-05

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.31191736459732056, Reg Loss=0.09819315373897552
Clinet index 0, End of Epoch 1/6, Average Loss=0.4101105332374573, Class Loss=0.31191736459732056, Reg Loss=0.09819315373897552
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.3110092282295227, Reg Loss=0.11459171772003174
Clinet index 0, End of Epoch 2/6, Average Loss=0.42560094594955444, Class Loss=0.3110092282295227, Reg Loss=0.11459171772003174
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.298311322927475, Reg Loss=0.09813092648983002
Clinet index 0, End of Epoch 3/6, Average Loss=0.3964422345161438, Class Loss=0.298311322927475, Reg Loss=0.09813092648983002
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.2950579524040222, Reg Loss=0.09994934499263763
Clinet index 0, End of Epoch 4/6, Average Loss=0.39500731229782104, Class Loss=0.2950579524040222, Reg Loss=0.09994934499263763
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.2795441746711731, Reg Loss=0.09996401518583298
Clinet index 0, End of Epoch 5/6, Average Loss=0.37950819730758667, Class Loss=0.2795441746711731, Reg Loss=0.09996401518583298
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.2686566710472107, Reg Loss=0.09120777249336243
Clinet index 0, End of Epoch 6/6, Average Loss=0.3598644435405731, Class Loss=0.2686566710472107, Reg Loss=0.09120777249336243
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3344847857952118, Reg Loss=0.10300391912460327
Clinet index 2, End of Epoch 1/6, Average Loss=0.43748870491981506, Class Loss=0.3344847857952118, Reg Loss=0.10300391912460327
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3288610577583313, Reg Loss=0.10308155417442322
Clinet index 2, End of Epoch 2/6, Average Loss=0.4319426119327545, Class Loss=0.3288610577583313, Reg Loss=0.10308155417442322
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3009524345397949, Reg Loss=0.0938229039311409
Clinet index 2, End of Epoch 3/6, Average Loss=0.3947753310203552, Class Loss=0.3009524345397949, Reg Loss=0.0938229039311409
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2977849543094635, Reg Loss=0.0957496389746666
Clinet index 2, End of Epoch 4/6, Average Loss=0.3935346007347107, Class Loss=0.2977849543094635, Reg Loss=0.0957496389746666
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.28966841101646423, Reg Loss=0.10475070774555206
Clinet index 2, End of Epoch 5/6, Average Loss=0.3944191336631775, Class Loss=0.28966841101646423, Reg Loss=0.10475070774555206
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.2754853367805481, Reg Loss=0.09876871854066849
Clinet index 2, End of Epoch 6/6, Average Loss=0.374254047870636, Class Loss=0.2754853367805481, Reg Loss=0.09876871854066849
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3417012393474579, Reg Loss=0.09575733542442322
Clinet index 8, End of Epoch 1/6, Average Loss=0.4374585747718811, Class Loss=0.3417012393474579, Reg Loss=0.09575733542442322
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3239559829235077, Reg Loss=0.0962657630443573
Clinet index 8, End of Epoch 2/6, Average Loss=0.420221745967865, Class Loss=0.3239559829235077, Reg Loss=0.0962657630443573
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.30946409702301025, Reg Loss=0.09692351520061493
Clinet index 8, End of Epoch 3/6, Average Loss=0.4063876271247864, Class Loss=0.30946409702301025, Reg Loss=0.09692351520061493
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2979492247104645, Reg Loss=0.0989522710442543
Clinet index 8, End of Epoch 4/6, Average Loss=0.3969014883041382, Class Loss=0.2979492247104645, Reg Loss=0.0989522710442543
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.28006720542907715, Reg Loss=0.0906427651643753
Clinet index 8, End of Epoch 5/6, Average Loss=0.37070995569229126, Class Loss=0.28006720542907715, Reg Loss=0.0906427651643753
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.2664172053337097, Reg Loss=0.08958541601896286
Clinet index 8, End of Epoch 6/6, Average Loss=0.3560026288032532, Class Loss=0.2664172053337097, Reg Loss=0.08958541601896286
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.33130213618278503, Reg Loss=0.09148961305618286
Clinet index 4, End of Epoch 1/6, Average Loss=0.4227917492389679, Class Loss=0.33130213618278503, Reg Loss=0.09148961305618286
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3110325336456299, Reg Loss=0.08816342055797577
Clinet index 4, End of Epoch 2/6, Average Loss=0.39919596910476685, Class Loss=0.3110325336456299, Reg Loss=0.08816342055797577
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.30333396792411804, Reg Loss=0.09246782213449478
Clinet index 4, End of Epoch 3/6, Average Loss=0.3958017826080322, Class Loss=0.30333396792411804, Reg Loss=0.09246782213449478
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2943902015686035, Reg Loss=0.0919635221362114
Clinet index 4, End of Epoch 4/6, Average Loss=0.3863537311553955, Class Loss=0.2943902015686035, Reg Loss=0.0919635221362114
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2848719656467438, Reg Loss=0.0974205732345581
Clinet index 4, End of Epoch 5/6, Average Loss=0.3822925388813019, Class Loss=0.2848719656467438, Reg Loss=0.0974205732345581
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.26654380559921265, Reg Loss=0.09032340347766876
Clinet index 4, End of Epoch 6/6, Average Loss=0.3568671941757202, Class Loss=0.26654380559921265, Reg Loss=0.09032340347766876
federated aggregation...
Validation, Class Loss=0.2731825113296509, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.934987
Mean Acc: 0.824164
FreqW Acc: 0.887593
Mean IoU: 0.727816
Class IoU:
	class 0: 0.9271354
	class 1: 0.89293826
	class 2: 0.41468593
	class 3: 0.8627019
	class 4: 0.64321476
	class 5: 0.79707295
	class 6: 0.9284557
	class 7: 0.8814505
	class 8: 0.8829456
	class 9: 0.42461988
	class 10: 0.71087486
	class 11: 0.57419366
	class 12: 0.8202758
	class 13: 0.77401084
	class 14: 0.8509538
	class 15: 0.85605836
	class 16: 0.13127477
Class Acc:
	class 0: 0.96217024
	class 1: 0.9581374
	class 2: 0.87164813
	class 3: 0.8897849
	class 4: 0.72811824
	class 5: 0.8952111
	class 6: 0.9568338
	class 7: 0.93590385
	class 8: 0.9184081
	class 9: 0.532675
	class 10: 0.7295161
	class 11: 0.62789875
	class 12: 0.960051
	class 13: 0.9179788
	class 14: 0.91393477
	class 15: 0.9231255
	class 16: 0.28939447

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.27097198367118835, Reg Loss=0.0830543115735054
Clinet index 9, End of Epoch 1/6, Average Loss=0.35402628779411316, Class Loss=0.27097198367118835, Reg Loss=0.0830543115735054
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2597956955432892, Reg Loss=0.08146205544471741
Clinet index 9, End of Epoch 2/6, Average Loss=0.3412577509880066, Class Loss=0.2597956955432892, Reg Loss=0.08146205544471741
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.25441381335258484, Reg Loss=0.08469346910715103
Clinet index 9, End of Epoch 3/6, Average Loss=0.3391072750091553, Class Loss=0.25441381335258484, Reg Loss=0.08469346910715103
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.24315477907657623, Reg Loss=0.0829298123717308
Clinet index 9, End of Epoch 4/6, Average Loss=0.32608458399772644, Class Loss=0.24315477907657623, Reg Loss=0.0829298123717308
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.23843693733215332, Reg Loss=0.08146130293607712
Clinet index 9, End of Epoch 5/6, Average Loss=0.31989824771881104, Class Loss=0.23843693733215332, Reg Loss=0.08146130293607712
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.22670066356658936, Reg Loss=0.08134559541940689
Clinet index 9, End of Epoch 6/6, Average Loss=0.30804625153541565, Class Loss=0.22670066356658936, Reg Loss=0.08134559541940689
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.277337908744812, Reg Loss=0.09277499467134476
Clinet index 13, End of Epoch 1/6, Average Loss=0.37011289596557617, Class Loss=0.277337908744812, Reg Loss=0.09277499467134476
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.27186912298202515, Reg Loss=0.08951529115438461
Clinet index 13, End of Epoch 2/6, Average Loss=0.36138442158699036, Class Loss=0.27186912298202515, Reg Loss=0.08951529115438461
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2685757577419281, Reg Loss=0.08983857929706573
Clinet index 13, End of Epoch 3/6, Average Loss=0.35841435194015503, Class Loss=0.2685757577419281, Reg Loss=0.08983857929706573
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.25430750846862793, Reg Loss=0.09523268043994904
Clinet index 13, End of Epoch 4/6, Average Loss=0.34954017400741577, Class Loss=0.25430750846862793, Reg Loss=0.09523268043994904
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.26447054743766785, Reg Loss=0.09510233998298645
Clinet index 13, End of Epoch 5/6, Average Loss=0.3595728874206543, Class Loss=0.26447054743766785, Reg Loss=0.09510233998298645
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.24306955933570862, Reg Loss=0.09436871111392975
Clinet index 13, End of Epoch 6/6, Average Loss=0.33743828535079956, Class Loss=0.24306955933570862, Reg Loss=0.09436871111392975
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.26137542724609375, Reg Loss=0.0927852913737297
Clinet index 1, End of Epoch 1/6, Average Loss=0.35416072607040405, Class Loss=0.26137542724609375, Reg Loss=0.0927852913737297
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2467924803495407, Reg Loss=0.09756621718406677
Clinet index 1, End of Epoch 2/6, Average Loss=0.3443586826324463, Class Loss=0.2467924803495407, Reg Loss=0.09756621718406677
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.24145735800266266, Reg Loss=0.0959114134311676
Clinet index 1, End of Epoch 3/6, Average Loss=0.33736878633499146, Class Loss=0.24145735800266266, Reg Loss=0.0959114134311676
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.2369372546672821, Reg Loss=0.09911011904478073
Clinet index 1, End of Epoch 4/6, Average Loss=0.33604738116264343, Class Loss=0.2369372546672821, Reg Loss=0.09911011904478073
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.22039416432380676, Reg Loss=0.09466029703617096
Clinet index 1, End of Epoch 5/6, Average Loss=0.3150544762611389, Class Loss=0.22039416432380676, Reg Loss=0.09466029703617096
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.221501886844635, Reg Loss=0.09244630485773087
Clinet index 1, End of Epoch 6/6, Average Loss=0.3139481842517853, Class Loss=0.221501886844635, Reg Loss=0.09244630485773087
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.25742781162261963, Reg Loss=0.09834711253643036
Clinet index 11, End of Epoch 1/6, Average Loss=0.3557749390602112, Class Loss=0.25742781162261963, Reg Loss=0.09834711253643036
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.24603544175624847, Reg Loss=0.09854499250650406
Clinet index 11, End of Epoch 2/6, Average Loss=0.34458044171333313, Class Loss=0.24603544175624847, Reg Loss=0.09854499250650406
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.24452686309814453, Reg Loss=0.0921577513217926
Clinet index 11, End of Epoch 3/6, Average Loss=0.33668461441993713, Class Loss=0.24452686309814453, Reg Loss=0.0921577513217926
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.2361697554588318, Reg Loss=0.09400911629199982
Clinet index 11, End of Epoch 4/6, Average Loss=0.3301788568496704, Class Loss=0.2361697554588318, Reg Loss=0.09400911629199982
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.22808301448822021, Reg Loss=0.09424329549074173
Clinet index 11, End of Epoch 5/6, Average Loss=0.32232630252838135, Class Loss=0.22808301448822021, Reg Loss=0.09424329549074173
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.2179824411869049, Reg Loss=0.09281851351261139
Clinet index 11, End of Epoch 6/6, Average Loss=0.3108009696006775, Class Loss=0.2179824411869049, Reg Loss=0.09281851351261139
federated aggregation...
Validation, Class Loss=0.25723835825920105, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.927769
Mean Acc: 0.831459
FreqW Acc: 0.880819
Mean IoU: 0.725821
Class IoU:
	class 0: 0.9177064
	class 1: 0.89471084
	class 2: 0.41319695
	class 3: 0.85339206
	class 4: 0.6436471
	class 5: 0.79320407
	class 6: 0.923177
	class 7: 0.8870807
	class 8: 0.8926181
	class 9: 0.4277681
	class 10: 0.6853791
	class 11: 0.5696472
	class 12: 0.8344973
	class 13: 0.7546076
	class 14: 0.8527909
	class 15: 0.855136
	class 16: 0.140401
Class Acc:
	class 0: 0.951397
	class 1: 0.95032084
	class 2: 0.8652987
	class 3: 0.87474126
	class 4: 0.72599685
	class 5: 0.88373905
	class 6: 0.94759
	class 7: 0.93111026
	class 8: 0.9314424
	class 9: 0.53699756
	class 10: 0.7006858
	class 11: 0.6195179
	class 12: 0.95667225
	class 13: 0.9197233
	class 14: 0.9247966
	class 15: 0.91967744
	class 16: 0.4950883

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.23502062261104584, Reg Loss=0.08875030279159546
Clinet index 8, End of Epoch 1/6, Average Loss=0.3237709403038025, Class Loss=0.23502062261104584, Reg Loss=0.08875030279159546
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.22751884162425995, Reg Loss=0.0868598148226738
Clinet index 8, End of Epoch 2/6, Average Loss=0.31437864899635315, Class Loss=0.22751884162425995, Reg Loss=0.0868598148226738
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.21899718046188354, Reg Loss=0.09029628336429596
Clinet index 8, End of Epoch 3/6, Average Loss=0.3092934489250183, Class Loss=0.21899718046188354, Reg Loss=0.09029628336429596
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.22344568371772766, Reg Loss=0.09615571051836014
Clinet index 8, End of Epoch 4/6, Average Loss=0.3196013867855072, Class Loss=0.22344568371772766, Reg Loss=0.09615571051836014
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.21789950132369995, Reg Loss=0.09227044135332108
Clinet index 8, End of Epoch 5/6, Average Loss=0.31016993522644043, Class Loss=0.21789950132369995, Reg Loss=0.09227044135332108
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.20989544689655304, Reg Loss=0.08790920674800873
Clinet index 8, End of Epoch 6/6, Average Loss=0.29780465364456177, Class Loss=0.20989544689655304, Reg Loss=0.08790920674800873
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23160706460475922, Reg Loss=0.0945281982421875
Clinet index 5, End of Epoch 1/6, Average Loss=0.3261352777481079, Class Loss=0.23160706460475922, Reg Loss=0.0945281982421875
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2302004098892212, Reg Loss=0.09795208275318146
Clinet index 5, End of Epoch 2/6, Average Loss=0.32815247774124146, Class Loss=0.2302004098892212, Reg Loss=0.09795208275318146
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.218769833445549, Reg Loss=0.09416867792606354
Clinet index 5, End of Epoch 3/6, Average Loss=0.31293851137161255, Class Loss=0.218769833445549, Reg Loss=0.09416867792606354
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2236633449792862, Reg Loss=0.09850195050239563
Clinet index 5, End of Epoch 4/6, Average Loss=0.322165310382843, Class Loss=0.2236633449792862, Reg Loss=0.09850195050239563
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20986072719097137, Reg Loss=0.0950600728392601
Clinet index 5, End of Epoch 5/6, Average Loss=0.3049207925796509, Class Loss=0.20986072719097137, Reg Loss=0.0950600728392601
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.20434322953224182, Reg Loss=0.09806303679943085
Clinet index 5, End of Epoch 6/6, Average Loss=0.3024062514305115, Class Loss=0.20434322953224182, Reg Loss=0.09806303679943085
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.23217473924160004, Reg Loss=0.1051836609840393
Clinet index 2, End of Epoch 1/6, Average Loss=0.33735841512680054, Class Loss=0.23217473924160004, Reg Loss=0.1051836609840393
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.23345617949962616, Reg Loss=0.09786853939294815
Clinet index 2, End of Epoch 2/6, Average Loss=0.3313247263431549, Class Loss=0.23345617949962616, Reg Loss=0.09786853939294815
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.22029481828212738, Reg Loss=0.09748097509145737
Clinet index 2, End of Epoch 3/6, Average Loss=0.31777578592300415, Class Loss=0.22029481828212738, Reg Loss=0.09748097509145737
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.22501246631145477, Reg Loss=0.09401752799749374
Clinet index 2, End of Epoch 4/6, Average Loss=0.3190299868583679, Class Loss=0.22501246631145477, Reg Loss=0.09401752799749374
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.22069045901298523, Reg Loss=0.09315133094787598
Clinet index 2, End of Epoch 5/6, Average Loss=0.3138417899608612, Class Loss=0.22069045901298523, Reg Loss=0.09315133094787598
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.21593478322029114, Reg Loss=0.09027335792779922
Clinet index 2, End of Epoch 6/6, Average Loss=0.30620813369750977, Class Loss=0.21593478322029114, Reg Loss=0.09027335792779922
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.23617029190063477, Reg Loss=0.07472777366638184
Clinet index 9, End of Epoch 1/6, Average Loss=0.3108980655670166, Class Loss=0.23617029190063477, Reg Loss=0.07472777366638184
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.2241840958595276, Reg Loss=0.07785088568925858
Clinet index 9, End of Epoch 2/6, Average Loss=0.30203497409820557, Class Loss=0.2241840958595276, Reg Loss=0.07785088568925858
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.22511577606201172, Reg Loss=0.08064388483762741
Clinet index 9, End of Epoch 3/6, Average Loss=0.3057596683502197, Class Loss=0.22511577606201172, Reg Loss=0.08064388483762741
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.22107990086078644, Reg Loss=0.08160518854856491
Clinet index 9, End of Epoch 4/6, Average Loss=0.30268508195877075, Class Loss=0.22107990086078644, Reg Loss=0.08160518854856491
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.2172306478023529, Reg Loss=0.07804162800312042
Clinet index 9, End of Epoch 5/6, Average Loss=0.2952722907066345, Class Loss=0.2172306478023529, Reg Loss=0.07804162800312042
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.20576560497283936, Reg Loss=0.07499939203262329
Clinet index 9, End of Epoch 6/6, Average Loss=0.28076499700546265, Class Loss=0.20576560497283936, Reg Loss=0.07499939203262329
federated aggregation...
Validation, Class Loss=0.24835394322872162, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.925588
Mean Acc: 0.834166
FreqW Acc: 0.879003
Mean IoU: 0.726131
Class IoU:
	class 0: 0.91474026
	class 1: 0.8946474
	class 2: 0.41329882
	class 3: 0.8351637
	class 4: 0.64814043
	class 5: 0.7886022
	class 6: 0.92329353
	class 7: 0.8778909
	class 8: 0.8974282
	class 9: 0.43261778
	class 10: 0.6991622
	class 11: 0.57194525
	class 12: 0.8401525
	class 13: 0.7613943
	class 14: 0.8451736
	class 15: 0.85580534
	class 16: 0.14477344
Class Acc:
	class 0: 0.9481647
	class 1: 0.943898
	class 2: 0.8601175
	class 3: 0.85180795
	class 4: 0.7274097
	class 5: 0.87174106
	class 6: 0.94696563
	class 7: 0.9304812
	class 8: 0.9345629
	class 9: 0.54848593
	class 10: 0.71574605
	class 11: 0.6209854
	class 12: 0.95541936
	class 13: 0.9140473
	class 14: 0.913917
	class 15: 0.91755784
	class 16: 0.57950896

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.21052590012550354, Reg Loss=0.0869186595082283
Clinet index 8, End of Epoch 1/6, Average Loss=0.29744455218315125, Class Loss=0.21052590012550354, Reg Loss=0.0869186595082283
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.21379153430461884, Reg Loss=0.08975658565759659
Clinet index 8, End of Epoch 2/6, Average Loss=0.303548127412796, Class Loss=0.21379153430461884, Reg Loss=0.08975658565759659
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.2093983143568039, Reg Loss=0.09497476369142532
Clinet index 8, End of Epoch 3/6, Average Loss=0.3043730854988098, Class Loss=0.2093983143568039, Reg Loss=0.09497476369142532
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.20443624258041382, Reg Loss=0.09351545572280884
Clinet index 8, End of Epoch 4/6, Average Loss=0.29795169830322266, Class Loss=0.20443624258041382, Reg Loss=0.09351545572280884
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.20173047482967377, Reg Loss=0.08655054122209549
Clinet index 8, End of Epoch 5/6, Average Loss=0.28828102350234985, Class Loss=0.20173047482967377, Reg Loss=0.08655054122209549
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.20483018457889557, Reg Loss=0.08866112679243088
Clinet index 8, End of Epoch 6/6, Average Loss=0.29349130392074585, Class Loss=0.20483018457889557, Reg Loss=0.08866112679243088
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.21147069334983826, Reg Loss=0.07672392576932907
Clinet index 9, End of Epoch 1/6, Average Loss=0.2881946265697479, Class Loss=0.21147069334983826, Reg Loss=0.07672392576932907
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.21254132688045502, Reg Loss=0.08159007877111435
Clinet index 9, End of Epoch 2/6, Average Loss=0.29413139820098877, Class Loss=0.21254132688045502, Reg Loss=0.08159007877111435
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.21013061702251434, Reg Loss=0.08225324749946594
Clinet index 9, End of Epoch 3/6, Average Loss=0.2923838496208191, Class Loss=0.21013061702251434, Reg Loss=0.08225324749946594
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.21334822475910187, Reg Loss=0.07897714525461197
Clinet index 9, End of Epoch 4/6, Average Loss=0.29232537746429443, Class Loss=0.21334822475910187, Reg Loss=0.07897714525461197
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.20045284926891327, Reg Loss=0.07846130430698395
Clinet index 9, End of Epoch 5/6, Average Loss=0.2789141535758972, Class Loss=0.20045284926891327, Reg Loss=0.07846130430698395
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.2015826553106308, Reg Loss=0.07666128128767014
Clinet index 9, End of Epoch 6/6, Average Loss=0.27824392914772034, Class Loss=0.2015826553106308, Reg Loss=0.07666128128767014
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.22103866934776306, Reg Loss=0.08842520415782928
Clinet index 12, End of Epoch 1/6, Average Loss=0.30946385860443115, Class Loss=0.22103866934776306, Reg Loss=0.08842520415782928
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.21798992156982422, Reg Loss=0.09270450472831726
Clinet index 12, End of Epoch 2/6, Average Loss=0.3106944262981415, Class Loss=0.21798992156982422, Reg Loss=0.09270450472831726
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.21311071515083313, Reg Loss=0.08715758472681046
Clinet index 12, End of Epoch 3/6, Average Loss=0.300268292427063, Class Loss=0.21311071515083313, Reg Loss=0.08715758472681046
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.20879454910755157, Reg Loss=0.08613165467977524
Clinet index 12, End of Epoch 4/6, Average Loss=0.2949261963367462, Class Loss=0.20879454910755157, Reg Loss=0.08613165467977524
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.2062838226556778, Reg Loss=0.08867904543876648
Clinet index 12, End of Epoch 5/6, Average Loss=0.29496288299560547, Class Loss=0.2062838226556778, Reg Loss=0.08867904543876648
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.20730896294116974, Reg Loss=0.09282021969556808
Clinet index 12, End of Epoch 6/6, Average Loss=0.3001291751861572, Class Loss=0.20730896294116974, Reg Loss=0.09282021969556808
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.20655140280723572, Reg Loss=0.09190302342176437
Clinet index 4, End of Epoch 1/6, Average Loss=0.2984544336795807, Class Loss=0.20655140280723572, Reg Loss=0.09190302342176437
Pseudo labeling is: None
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.2010658234357834, Reg Loss=0.09212367236614227
Clinet index 4, End of Epoch 2/6, Average Loss=0.29318949580192566, Class Loss=0.2010658234357834, Reg Loss=0.09212367236614227
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.19970332086086273, Reg Loss=0.09184745699167252
Clinet index 4, End of Epoch 3/6, Average Loss=0.29155078530311584, Class Loss=0.19970332086086273, Reg Loss=0.09184745699167252
Pseudo labeling is: None
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.20401647686958313, Reg Loss=0.09092235565185547
Clinet index 4, End of Epoch 4/6, Average Loss=0.2949388325214386, Class Loss=0.20401647686958313, Reg Loss=0.09092235565185547
Pseudo labeling is: None
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.2105245590209961, Reg Loss=0.09294430911540985
Clinet index 4, End of Epoch 5/6, Average Loss=0.30346888303756714, Class Loss=0.2105245590209961, Reg Loss=0.09294430911540985
Pseudo labeling is: None
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.1992253214120865, Reg Loss=0.09825479984283447
Clinet index 4, End of Epoch 6/6, Average Loss=0.29748010635375977, Class Loss=0.1992253214120865, Reg Loss=0.09825479984283447
federated aggregation...
Validation, Class Loss=0.2408788800239563, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.927522
Mean Acc: 0.836516
FreqW Acc: 0.881063
Mean IoU: 0.727661
Class IoU:
	class 0: 0.91710514
	class 1: 0.8936847
	class 2: 0.41392195
	class 3: 0.831612
	class 4: 0.6465764
	class 5: 0.7851147
	class 6: 0.92373705
	class 7: 0.8783069
	class 8: 0.90195954
	class 9: 0.436856
	class 10: 0.7018494
	class 11: 0.5733424
	class 12: 0.84694636
	class 13: 0.7606369
	class 14: 0.8469336
	class 15: 0.8549845
	class 16: 0.15667422
Class Acc:
	class 0: 0.9498814
	class 1: 0.94297385
	class 2: 0.8650034
	class 3: 0.84872484
	class 4: 0.7262959
	class 5: 0.8706487
	class 6: 0.948177
	class 7: 0.9306735
	class 8: 0.9423352
	class 9: 0.56068057
	class 10: 0.71962345
	class 11: 0.6300733
	class 12: 0.95586467
	class 13: 0.9179462
	class 14: 0.909906
	class 15: 0.91987437
	class 16: 0.58209753

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.0484236478805542, Reg Loss=0.42322495579719543
Clinet index 14, End of Epoch 1/6, Average Loss=1.4716485738754272, Class Loss=1.0484236478805542, Reg Loss=0.42322495579719543
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.8503376245498657, Reg Loss=0.37427470088005066
Clinet index 14, End of Epoch 2/6, Average Loss=1.2246123552322388, Class Loss=0.8503376245498657, Reg Loss=0.37427470088005066
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7294012308120728, Reg Loss=0.39006420969963074
Clinet index 14, End of Epoch 3/6, Average Loss=1.1194654703140259, Class Loss=0.7294012308120728, Reg Loss=0.39006420969963074
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6020951271057129, Reg Loss=0.3298153281211853
Clinet index 14, End of Epoch 4/6, Average Loss=0.9319104552268982, Class Loss=0.6020951271057129, Reg Loss=0.3298153281211853
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5708643198013306, Reg Loss=0.3780492842197418
Clinet index 14, End of Epoch 5/6, Average Loss=0.94891357421875, Class Loss=0.5708643198013306, Reg Loss=0.3780492842197418
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.508952796459198, Reg Loss=0.3236720561981201
Clinet index 14, End of Epoch 6/6, Average Loss=0.8326248526573181, Class Loss=0.508952796459198, Reg Loss=0.3236720561981201
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.0755715370178223, Reg Loss=0.41844457387924194
Clinet index 6, End of Epoch 1/6, Average Loss=1.494016170501709, Class Loss=1.0755715370178223, Reg Loss=0.41844457387924194
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.871013343334198, Reg Loss=0.3968713581562042
Clinet index 6, End of Epoch 2/6, Average Loss=1.2678847312927246, Class Loss=0.871013343334198, Reg Loss=0.3968713581562042
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.692177414894104, Reg Loss=0.3966659903526306
Clinet index 6, End of Epoch 3/6, Average Loss=1.0888433456420898, Class Loss=0.692177414894104, Reg Loss=0.3966659903526306
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6051710844039917, Reg Loss=0.3779778778553009
Clinet index 6, End of Epoch 4/6, Average Loss=0.9831489324569702, Class Loss=0.6051710844039917, Reg Loss=0.3779778778553009
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5442245006561279, Reg Loss=0.36528563499450684
Clinet index 6, End of Epoch 5/6, Average Loss=0.9095101356506348, Class Loss=0.5442245006561279, Reg Loss=0.36528563499450684
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4905441999435425, Reg Loss=0.3028857707977295
Clinet index 6, End of Epoch 6/6, Average Loss=0.793429970741272, Class Loss=0.4905441999435425, Reg Loss=0.3028857707977295
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.0872722864151, Reg Loss=0.4253201186656952
Clinet index 0, End of Epoch 1/6, Average Loss=1.5125924348831177, Class Loss=1.0872722864151, Reg Loss=0.4253201186656952
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.8598483800888062, Reg Loss=0.3865678310394287
Clinet index 0, End of Epoch 2/6, Average Loss=1.2464162111282349, Class Loss=0.8598483800888062, Reg Loss=0.3865678310394287
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.722841739654541, Reg Loss=0.3764920234680176
Clinet index 0, End of Epoch 3/6, Average Loss=1.0993337631225586, Class Loss=0.722841739654541, Reg Loss=0.3764920234680176
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5937104225158691, Reg Loss=0.3970123529434204
Clinet index 0, End of Epoch 4/6, Average Loss=0.9907227754592896, Class Loss=0.5937104225158691, Reg Loss=0.3970123529434204
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5371528267860413, Reg Loss=0.34825587272644043
Clinet index 0, End of Epoch 5/6, Average Loss=0.8854086995124817, Class Loss=0.5371528267860413, Reg Loss=0.34825587272644043
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5149922370910645, Reg Loss=0.3447520434856415
Clinet index 0, End of Epoch 6/6, Average Loss=0.8597443103790283, Class Loss=0.5149922370910645, Reg Loss=0.3447520434856415
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.0463104248046875, Reg Loss=0.40811237692832947
Clinet index 16, End of Epoch 1/6, Average Loss=1.4544228315353394, Class Loss=1.0463104248046875, Reg Loss=0.40811237692832947
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.8331246376037598, Reg Loss=0.3381727933883667
Clinet index 16, End of Epoch 2/6, Average Loss=1.1712974309921265, Class Loss=0.8331246376037598, Reg Loss=0.3381727933883667
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.6833025813102722, Reg Loss=0.33850061893463135
Clinet index 16, End of Epoch 3/6, Average Loss=1.0218031406402588, Class Loss=0.6833025813102722, Reg Loss=0.33850061893463135
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5774250030517578, Reg Loss=0.3302854299545288
Clinet index 16, End of Epoch 4/6, Average Loss=0.9077104330062866, Class Loss=0.5774250030517578, Reg Loss=0.3302854299545288
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5389260053634644, Reg Loss=0.32952404022216797
Clinet index 16, End of Epoch 5/6, Average Loss=0.8684500455856323, Class Loss=0.5389260053634644, Reg Loss=0.32952404022216797
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4765608012676239, Reg Loss=0.3020666837692261
Clinet index 16, End of Epoch 6/6, Average Loss=0.7786275148391724, Class Loss=0.4765608012676239, Reg Loss=0.3020666837692261
federated aggregation...
Validation, Class Loss=0.6178907752037048, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.873448
Mean Acc: 0.602582
FreqW Acc: 0.789542
Mean IoU: 0.531006
Class IoU:
	class 0: 0.86969626
	class 1: 0.6438503
	class 2: 0.3759167
	class 3: 0.39467266
	class 4: 0.57587373
	class 5: 0.647821
	class 6: 0.7519306
	class 7: 0.7970925
	class 8: 0.67370474
	class 9: 0.2639323
	class 10: 0.25375277
	class 11: 0.50585043
	class 12: 0.57140994
	class 13: 0.44729134
	class 14: 0.72243255
	class 15: 0.7669433
	class 16: 0.060287423
	class 17: 0.2356541
Class Acc:
	class 0: 0.96874994
	class 1: 0.64843017
	class 2: 0.6772501
	class 3: 0.3964745
	class 4: 0.6371582
	class 5: 0.69269115
	class 6: 0.7597335
	class 7: 0.8664925
	class 8: 0.67766696
	class 9: 0.31931254
	class 10: 0.25583297
	class 11: 0.54933923
	class 12: 0.6149682
	class 13: 0.5387238
	class 14: 0.77102184
	class 15: 0.8080712
	class 16: 0.22107346
	class 17: 0.44349092

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.5030239820480347, Reg Loss=0.3454042375087738
Clinet index 0, End of Epoch 1/6, Average Loss=0.8484282493591309, Class Loss=0.5030239820480347, Reg Loss=0.3454042375087738
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.49012765288352966, Reg Loss=0.3107472360134125
Clinet index 0, End of Epoch 2/6, Average Loss=0.8008748888969421, Class Loss=0.49012765288352966, Reg Loss=0.3107472360134125
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.4758676290512085, Reg Loss=0.2975575923919678
Clinet index 0, End of Epoch 3/6, Average Loss=0.7734252214431763, Class Loss=0.4758676290512085, Reg Loss=0.2975575923919678
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.44308483600616455, Reg Loss=0.31756529211997986
Clinet index 0, End of Epoch 4/6, Average Loss=0.7606501579284668, Class Loss=0.44308483600616455, Reg Loss=0.31756529211997986
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4264678955078125, Reg Loss=0.29130348563194275
Clinet index 0, End of Epoch 5/6, Average Loss=0.7177714109420776, Class Loss=0.4264678955078125, Reg Loss=0.29130348563194275
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.4171109199523926, Reg Loss=0.30252018570899963
Clinet index 0, End of Epoch 6/6, Average Loss=0.7196310758590698, Class Loss=0.4171109199523926, Reg Loss=0.30252018570899963
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4971557855606079, Reg Loss=0.3615037798881531
Clinet index 12, End of Epoch 1/6, Average Loss=0.858659565448761, Class Loss=0.4971557855606079, Reg Loss=0.3615037798881531
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.486025869846344, Reg Loss=0.34154683351516724
Clinet index 12, End of Epoch 2/6, Average Loss=0.8275727033615112, Class Loss=0.486025869846344, Reg Loss=0.34154683351516724
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4828852713108063, Reg Loss=0.313955694437027
Clinet index 12, End of Epoch 3/6, Average Loss=0.7968409657478333, Class Loss=0.4828852713108063, Reg Loss=0.313955694437027
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.43826356530189514, Reg Loss=0.2812209725379944
Clinet index 12, End of Epoch 4/6, Average Loss=0.7194845676422119, Class Loss=0.43826356530189514, Reg Loss=0.2812209725379944
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3974234163761139, Reg Loss=0.2916303277015686
Clinet index 12, End of Epoch 5/6, Average Loss=0.6890537738800049, Class Loss=0.3974234163761139, Reg Loss=0.2916303277015686
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.38552504777908325, Reg Loss=0.31842246651649475
Clinet index 12, End of Epoch 6/6, Average Loss=0.7039475440979004, Class Loss=0.38552504777908325, Reg Loss=0.31842246651649475
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5021705031394958, Reg Loss=0.33391430974006653
Clinet index 10, End of Epoch 1/6, Average Loss=0.8360848426818848, Class Loss=0.5021705031394958, Reg Loss=0.33391430974006653
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.47880980372428894, Reg Loss=0.30531853437423706
Clinet index 10, End of Epoch 2/6, Average Loss=0.7841283082962036, Class Loss=0.47880980372428894, Reg Loss=0.30531853437423706
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.48414042592048645, Reg Loss=0.3286192715167999
Clinet index 10, End of Epoch 3/6, Average Loss=0.8127596974372864, Class Loss=0.48414042592048645, Reg Loss=0.3286192715167999
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4323398470878601, Reg Loss=0.27853381633758545
Clinet index 10, End of Epoch 4/6, Average Loss=0.7108736634254456, Class Loss=0.4323398470878601, Reg Loss=0.27853381633758545
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.41502946615219116, Reg Loss=0.27685755491256714
Clinet index 10, End of Epoch 5/6, Average Loss=0.6918870210647583, Class Loss=0.41502946615219116, Reg Loss=0.27685755491256714
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.3759828209877014, Reg Loss=0.28650403022766113
Clinet index 10, End of Epoch 6/6, Average Loss=0.6624868512153625, Class Loss=0.3759828209877014, Reg Loss=0.28650403022766113
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4734157919883728, Reg Loss=0.3026226758956909
Clinet index 17, End of Epoch 1/6, Average Loss=0.7760384678840637, Class Loss=0.4734157919883728, Reg Loss=0.3026226758956909
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4692368507385254, Reg Loss=0.32252389192581177
Clinet index 17, End of Epoch 2/6, Average Loss=0.7917607426643372, Class Loss=0.4692368507385254, Reg Loss=0.32252389192581177
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4480469524860382, Reg Loss=0.2797209620475769
Clinet index 17, End of Epoch 3/6, Average Loss=0.7277679443359375, Class Loss=0.4480469524860382, Reg Loss=0.2797209620475769
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4332071542739868, Reg Loss=0.27934229373931885
Clinet index 17, End of Epoch 4/6, Average Loss=0.7125494480133057, Class Loss=0.4332071542739868, Reg Loss=0.27934229373931885
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4004595875740051, Reg Loss=0.30714738368988037
Clinet index 17, End of Epoch 5/6, Average Loss=0.7076069712638855, Class Loss=0.4004595875740051, Reg Loss=0.30714738368988037
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.3717072308063507, Reg Loss=0.281270831823349
Clinet index 17, End of Epoch 6/6, Average Loss=0.6529780626296997, Class Loss=0.3717072308063507, Reg Loss=0.281270831823349
federated aggregation...
Validation, Class Loss=0.5304122567176819, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.883150
Mean Acc: 0.635952
FreqW Acc: 0.813443
Mean IoU: 0.543802
Class IoU:
	class 0: 0.89620304
	class 1: 0.6201857
	class 2: 0.3802538
	class 3: 0.49747288
	class 4: 0.55960184
	class 5: 0.6776082
	class 6: 0.7414475
	class 7: 0.7996891
	class 8: 0.712161
	class 9: 0.26405704
	class 10: 0.2270096
	class 11: 0.47132707
	class 12: 0.6094149
	class 13: 0.5074535
	class 14: 0.75251275
	class 15: 0.7932472
	class 16: 0.055958074
	class 17: 0.22283152
Class Acc:
	class 0: 0.96723294
	class 1: 0.62441844
	class 2: 0.6961293
	class 3: 0.50092727
	class 4: 0.6222596
	class 5: 0.72746336
	class 6: 0.7514986
	class 7: 0.86433107
	class 8: 0.7221705
	class 9: 0.32711002
	class 10: 0.22825974
	class 11: 0.5208517
	class 12: 0.67932874
	class 13: 0.58983934
	class 14: 0.8052543
	class 15: 0.84783983
	class 16: 0.15389626
	class 17: 0.8183336

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3722790777683258, Reg Loss=0.28999102115631104
Clinet index 14, End of Epoch 1/6, Average Loss=0.6622700691223145, Class Loss=0.3722790777683258, Reg Loss=0.28999102115631104
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.3797129690647125, Reg Loss=0.3008720874786377
Clinet index 14, End of Epoch 2/6, Average Loss=0.6805850267410278, Class Loss=0.3797129690647125, Reg Loss=0.3008720874786377
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.3859318792819977, Reg Loss=0.2974078357219696
Clinet index 14, End of Epoch 3/6, Average Loss=0.6833397150039673, Class Loss=0.3859318792819977, Reg Loss=0.2974078357219696
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3645339012145996, Reg Loss=0.2711526155471802
Clinet index 14, End of Epoch 4/6, Average Loss=0.6356865167617798, Class Loss=0.3645339012145996, Reg Loss=0.2711526155471802
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.34646105766296387, Reg Loss=0.31059300899505615
Clinet index 14, End of Epoch 5/6, Average Loss=0.65705406665802, Class Loss=0.34646105766296387, Reg Loss=0.31059300899505615
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.3270680606365204, Reg Loss=0.27774837613105774
Clinet index 14, End of Epoch 6/6, Average Loss=0.6048164367675781, Class Loss=0.3270680606365204, Reg Loss=0.27774837613105774
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.35322046279907227, Reg Loss=0.2723545432090759
Clinet index 8, End of Epoch 1/6, Average Loss=0.6255750060081482, Class Loss=0.35322046279907227, Reg Loss=0.2723545432090759
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3414495587348938, Reg Loss=0.24333898723125458
Clinet index 8, End of Epoch 2/6, Average Loss=0.5847885608673096, Class Loss=0.3414495587348938, Reg Loss=0.24333898723125458
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3344504237174988, Reg Loss=0.2561158835887909
Clinet index 8, End of Epoch 3/6, Average Loss=0.5905662775039673, Class Loss=0.3344504237174988, Reg Loss=0.2561158835887909
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.32548993825912476, Reg Loss=0.25502529740333557
Clinet index 8, End of Epoch 4/6, Average Loss=0.5805152654647827, Class Loss=0.32548993825912476, Reg Loss=0.25502529740333557
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.2962449789047241, Reg Loss=0.2464350461959839
Clinet index 8, End of Epoch 5/6, Average Loss=0.542680025100708, Class Loss=0.2962449789047241, Reg Loss=0.2464350461959839
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.2985679507255554, Reg Loss=0.24233047664165497
Clinet index 8, End of Epoch 6/6, Average Loss=0.5408984422683716, Class Loss=0.2985679507255554, Reg Loss=0.24233047664165497
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.35686418414115906, Reg Loss=0.26069313287734985
Clinet index 16, End of Epoch 1/6, Average Loss=0.6175572872161865, Class Loss=0.35686418414115906, Reg Loss=0.26069313287734985
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.3363357186317444, Reg Loss=0.24396130442619324
Clinet index 16, End of Epoch 2/6, Average Loss=0.5802969932556152, Class Loss=0.3363357186317444, Reg Loss=0.24396130442619324
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.3584253489971161, Reg Loss=0.28867265582084656
Clinet index 16, End of Epoch 3/6, Average Loss=0.6470980048179626, Class Loss=0.3584253489971161, Reg Loss=0.28867265582084656
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3271734416484833, Reg Loss=0.2587282955646515
Clinet index 16, End of Epoch 4/6, Average Loss=0.5859017372131348, Class Loss=0.3271734416484833, Reg Loss=0.2587282955646515
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.32592830061912537, Reg Loss=0.2619093060493469
Clinet index 16, End of Epoch 5/6, Average Loss=0.5878375768661499, Class Loss=0.32592830061912537, Reg Loss=0.2619093060493469
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.3086104989051819, Reg Loss=0.2589663863182068
Clinet index 16, End of Epoch 6/6, Average Loss=0.5675768852233887, Class Loss=0.3086104989051819, Reg Loss=0.2589663863182068
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3708782494068146, Reg Loss=0.25745970010757446
Clinet index 3, End of Epoch 1/6, Average Loss=0.6283379793167114, Class Loss=0.3708782494068146, Reg Loss=0.25745970010757446
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3697999119758606, Reg Loss=0.25132185220718384
Clinet index 3, End of Epoch 2/6, Average Loss=0.6211217641830444, Class Loss=0.3697999119758606, Reg Loss=0.25132185220718384
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3509294092655182, Reg Loss=0.262563556432724
Clinet index 3, End of Epoch 3/6, Average Loss=0.6134929656982422, Class Loss=0.3509294092655182, Reg Loss=0.262563556432724
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3336315453052521, Reg Loss=0.2582818865776062
Clinet index 3, End of Epoch 4/6, Average Loss=0.5919134616851807, Class Loss=0.3336315453052521, Reg Loss=0.2582818865776062
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3125, Reg Loss=0.2288554310798645
Clinet index 3, End of Epoch 5/6, Average Loss=0.5413554310798645, Class Loss=0.3125, Reg Loss=0.2288554310798645
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.30479782819747925, Reg Loss=0.27102622389793396
Clinet index 3, End of Epoch 6/6, Average Loss=0.5758240222930908, Class Loss=0.30479782819747925, Reg Loss=0.27102622389793396
federated aggregation...
Validation, Class Loss=0.4750717878341675, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.885508
Mean Acc: 0.628529
FreqW Acc: 0.816183
Mean IoU: 0.539375
Class IoU:
	class 0: 0.9007067
	class 1: 0.59303194
	class 2: 0.37973824
	class 3: 0.51376176
	class 4: 0.53206056
	class 5: 0.6617583
	class 6: 0.73818606
	class 7: 0.7948223
	class 8: 0.6957881
	class 9: 0.26903734
	class 10: 0.23841947
	class 11: 0.44353673
	class 12: 0.6105022
	class 13: 0.5262293
	class 14: 0.74474514
	class 15: 0.8049084
	class 16: 0.044047143
	class 17: 0.21747035
Class Acc:
	class 0: 0.97196794
	class 1: 0.5962713
	class 2: 0.68301255
	class 3: 0.5173966
	class 4: 0.5812419
	class 5: 0.7035599
	class 6: 0.7466345
	class 7: 0.84972966
	class 8: 0.70499235
	class 9: 0.32342553
	class 10: 0.2402558
	class 11: 0.47976163
	class 12: 0.6656006
	class 13: 0.6221959
	class 14: 0.7953308
	class 15: 0.86086416
	class 16: 0.09170387
	class 17: 0.87958324

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.2930688261985779, Reg Loss=0.2598549723625183
Clinet index 17, End of Epoch 1/6, Average Loss=0.5529237985610962, Class Loss=0.2930688261985779, Reg Loss=0.2598549723625183
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.30753812193870544, Reg Loss=0.2690671682357788
Clinet index 17, End of Epoch 2/6, Average Loss=0.5766053199768066, Class Loss=0.30753812193870544, Reg Loss=0.2690671682357788
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.2876034379005432, Reg Loss=0.2678344249725342
Clinet index 17, End of Epoch 3/6, Average Loss=0.5554378628730774, Class Loss=0.2876034379005432, Reg Loss=0.2678344249725342
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.27926087379455566, Reg Loss=0.2546197175979614
Clinet index 17, End of Epoch 4/6, Average Loss=0.5338805913925171, Class Loss=0.27926087379455566, Reg Loss=0.2546197175979614
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.2673287093639374, Reg Loss=0.2795809805393219
Clinet index 17, End of Epoch 5/6, Average Loss=0.5469096899032593, Class Loss=0.2673287093639374, Reg Loss=0.2795809805393219
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.2620364725589752, Reg Loss=0.2719252407550812
Clinet index 17, End of Epoch 6/6, Average Loss=0.5339617133140564, Class Loss=0.2620364725589752, Reg Loss=0.2719252407550812
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.28950366377830505, Reg Loss=0.23874500393867493
Clinet index 13, End of Epoch 1/6, Average Loss=0.52824866771698, Class Loss=0.28950366377830505, Reg Loss=0.23874500393867493
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2769486606121063, Reg Loss=0.23023481667041779
Clinet index 13, End of Epoch 2/6, Average Loss=0.5071834921836853, Class Loss=0.2769486606121063, Reg Loss=0.23023481667041779
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.28857874870300293, Reg Loss=0.22906507551670074
Clinet index 13, End of Epoch 3/6, Average Loss=0.5176438093185425, Class Loss=0.28857874870300293, Reg Loss=0.22906507551670074
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2666613459587097, Reg Loss=0.24035188555717468
Clinet index 13, End of Epoch 4/6, Average Loss=0.507013201713562, Class Loss=0.2666613459587097, Reg Loss=0.24035188555717468
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.25370198488235474, Reg Loss=0.22319886088371277
Clinet index 13, End of Epoch 5/6, Average Loss=0.4769008457660675, Class Loss=0.25370198488235474, Reg Loss=0.22319886088371277
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2525881230831146, Reg Loss=0.25078463554382324
Clinet index 13, End of Epoch 6/6, Average Loss=0.5033727884292603, Class Loss=0.2525881230831146, Reg Loss=0.25078463554382324
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2907300591468811, Reg Loss=0.22855569422245026
Clinet index 11, End of Epoch 1/6, Average Loss=0.5192857384681702, Class Loss=0.2907300591468811, Reg Loss=0.22855569422245026
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2959710359573364, Reg Loss=0.24709926545619965
Clinet index 11, End of Epoch 2/6, Average Loss=0.5430703163146973, Class Loss=0.2959710359573364, Reg Loss=0.24709926545619965
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2635519504547119, Reg Loss=0.25594791769981384
Clinet index 11, End of Epoch 3/6, Average Loss=0.5194998979568481, Class Loss=0.2635519504547119, Reg Loss=0.25594791769981384
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2668420076370239, Reg Loss=0.26042306423187256
Clinet index 11, End of Epoch 4/6, Average Loss=0.5272650718688965, Class Loss=0.2668420076370239, Reg Loss=0.26042306423187256
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.26285988092422485, Reg Loss=0.2865080237388611
Clinet index 11, End of Epoch 5/6, Average Loss=0.5493679046630859, Class Loss=0.26285988092422485, Reg Loss=0.2865080237388611
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.26470473408699036, Reg Loss=0.26654109358787537
Clinet index 11, End of Epoch 6/6, Average Loss=0.5312458276748657, Class Loss=0.26470473408699036, Reg Loss=0.26654109358787537
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.32467085123062134, Reg Loss=0.3007332980632782
Clinet index 7, End of Epoch 1/6, Average Loss=0.6254041194915771, Class Loss=0.32467085123062134, Reg Loss=0.3007332980632782
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2991911470890045, Reg Loss=0.28378090262413025
Clinet index 7, End of Epoch 2/6, Average Loss=0.5829720497131348, Class Loss=0.2991911470890045, Reg Loss=0.28378090262413025
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2932532727718353, Reg Loss=0.2587451934814453
Clinet index 7, End of Epoch 3/6, Average Loss=0.551998496055603, Class Loss=0.2932532727718353, Reg Loss=0.2587451934814453
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.286299467086792, Reg Loss=0.2702176868915558
Clinet index 7, End of Epoch 4/6, Average Loss=0.5565171241760254, Class Loss=0.286299467086792, Reg Loss=0.2702176868915558
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.2864093780517578, Reg Loss=0.2538619637489319
Clinet index 7, End of Epoch 5/6, Average Loss=0.5402713418006897, Class Loss=0.2864093780517578, Reg Loss=0.2538619637489319
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2686556279659271, Reg Loss=0.26759350299835205
Clinet index 7, End of Epoch 6/6, Average Loss=0.5362491607666016, Class Loss=0.2686556279659271, Reg Loss=0.26759350299835205
federated aggregation...
Validation, Class Loss=0.44394996762275696, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.886512
Mean Acc: 0.625203
FreqW Acc: 0.817505
Mean IoU: 0.537844
Class IoU:
	class 0: 0.90312576
	class 1: 0.59688044
	class 2: 0.3845237
	class 3: 0.52080774
	class 4: 0.5253037
	class 5: 0.6573174
	class 6: 0.7112094
	class 7: 0.8007131
	class 8: 0.68614596
	class 9: 0.26898676
	class 10: 0.22109447
	class 11: 0.4474228
	class 12: 0.61983806
	class 13: 0.5230398
	class 14: 0.7525743
	class 15: 0.8100029
	class 16: 0.038605858
	class 17: 0.21359779
Class Acc:
	class 0: 0.9746419
	class 1: 0.59999615
	class 2: 0.6858006
	class 3: 0.5245981
	class 4: 0.57313746
	class 5: 0.6977767
	class 6: 0.7181977
	class 7: 0.8438474
	class 8: 0.69379544
	class 9: 0.31419212
	class 10: 0.22245646
	class 11: 0.48513472
	class 12: 0.6727522
	class 13: 0.60439193
	class 14: 0.7987491
	class 15: 0.866489
	class 16: 0.07015756
	class 17: 0.9075449

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.2525026798248291, Reg Loss=0.24835315346717834
Clinet index 17, End of Epoch 1/6, Average Loss=0.5008558034896851, Class Loss=0.2525026798248291, Reg Loss=0.24835315346717834
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.26073476672172546, Reg Loss=0.2800779342651367
Clinet index 17, End of Epoch 2/6, Average Loss=0.5408127307891846, Class Loss=0.26073476672172546, Reg Loss=0.2800779342651367
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.25725117325782776, Reg Loss=0.26293250918388367
Clinet index 17, End of Epoch 3/6, Average Loss=0.5201836824417114, Class Loss=0.25725117325782776, Reg Loss=0.26293250918388367
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.24237141013145447, Reg Loss=0.267486035823822
Clinet index 17, End of Epoch 4/6, Average Loss=0.5098574161529541, Class Loss=0.24237141013145447, Reg Loss=0.267486035823822
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.26010411977767944, Reg Loss=0.29787564277648926
Clinet index 17, End of Epoch 5/6, Average Loss=0.5579797625541687, Class Loss=0.26010411977767944, Reg Loss=0.29787564277648926
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.24183622002601624, Reg Loss=0.27642324566841125
Clinet index 17, End of Epoch 6/6, Average Loss=0.5182594656944275, Class Loss=0.24183622002601624, Reg Loss=0.27642324566841125
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23737479746341705, Reg Loss=0.22807951271533966
Clinet index 4, End of Epoch 1/6, Average Loss=0.4654543101787567, Class Loss=0.23737479746341705, Reg Loss=0.22807951271533966
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.23609665036201477, Reg Loss=0.2254680097103119
Clinet index 4, End of Epoch 2/6, Average Loss=0.46156466007232666, Class Loss=0.23609665036201477, Reg Loss=0.2254680097103119
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2375001162290573, Reg Loss=0.24958796799182892
Clinet index 4, End of Epoch 3/6, Average Loss=0.48708808422088623, Class Loss=0.2375001162290573, Reg Loss=0.24958796799182892
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.23194263875484467, Reg Loss=0.2393590807914734
Clinet index 4, End of Epoch 4/6, Average Loss=0.47130173444747925, Class Loss=0.23194263875484467, Reg Loss=0.2393590807914734
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.23615938425064087, Reg Loss=0.23502035439014435
Clinet index 4, End of Epoch 5/6, Average Loss=0.471179723739624, Class Loss=0.23615938425064087, Reg Loss=0.23502035439014435
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2336544692516327, Reg Loss=0.23123076558113098
Clinet index 4, End of Epoch 6/6, Average Loss=0.46488523483276367, Class Loss=0.2336544692516327, Reg Loss=0.23123076558113098
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2517875134944916, Reg Loss=0.2546932101249695
Clinet index 5, End of Epoch 1/6, Average Loss=0.5064806938171387, Class Loss=0.2517875134944916, Reg Loss=0.2546932101249695
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.2516336441040039, Reg Loss=0.25669384002685547
Clinet index 5, End of Epoch 2/6, Average Loss=0.5083274841308594, Class Loss=0.2516336441040039, Reg Loss=0.25669384002685547
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2704783082008362, Reg Loss=0.24929159879684448
Clinet index 5, End of Epoch 3/6, Average Loss=0.5197699069976807, Class Loss=0.2704783082008362, Reg Loss=0.24929159879684448
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.22804874181747437, Reg Loss=0.248776376247406
Clinet index 5, End of Epoch 4/6, Average Loss=0.47682511806488037, Class Loss=0.22804874181747437, Reg Loss=0.248776376247406
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.23522508144378662, Reg Loss=0.26979660987854004
Clinet index 5, End of Epoch 5/6, Average Loss=0.5050216913223267, Class Loss=0.23522508144378662, Reg Loss=0.26979660987854004
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2302044928073883, Reg Loss=0.2458457201719284
Clinet index 5, End of Epoch 6/6, Average Loss=0.4760501980781555, Class Loss=0.2302044928073883, Reg Loss=0.2458457201719284
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2665436267852783, Reg Loss=0.27243614196777344
Clinet index 2, End of Epoch 1/6, Average Loss=0.5389797687530518, Class Loss=0.2665436267852783, Reg Loss=0.27243614196777344
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.25374293327331543, Reg Loss=0.2233567237854004
Clinet index 2, End of Epoch 2/6, Average Loss=0.4770996570587158, Class Loss=0.25374293327331543, Reg Loss=0.2233567237854004
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2594444155693054, Reg Loss=0.26411426067352295
Clinet index 2, End of Epoch 3/6, Average Loss=0.5235586762428284, Class Loss=0.2594444155693054, Reg Loss=0.26411426067352295
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2556936740875244, Reg Loss=0.23936519026756287
Clinet index 2, End of Epoch 4/6, Average Loss=0.4950588643550873, Class Loss=0.2556936740875244, Reg Loss=0.23936519026756287
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.24276483058929443, Reg Loss=0.24184295535087585
Clinet index 2, End of Epoch 5/6, Average Loss=0.4846077859401703, Class Loss=0.24276483058929443, Reg Loss=0.24184295535087585
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.24853205680847168, Reg Loss=0.25158971548080444
Clinet index 2, End of Epoch 6/6, Average Loss=0.5001217722892761, Class Loss=0.24853205680847168, Reg Loss=0.25158971548080444
federated aggregation...
Validation, Class Loss=0.4406919479370117, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.884490
Mean Acc: 0.610665
FreqW Acc: 0.814224
Mean IoU: 0.526986
Class IoU:
	class 0: 0.90252525
	class 1: 0.58078146
	class 2: 0.3833916
	class 3: 0.49039713
	class 4: 0.530199
	class 5: 0.63956785
	class 6: 0.7120922
	class 7: 0.79411054
	class 8: 0.6804498
	class 9: 0.2511707
	class 10: 0.20015688
	class 11: 0.42794952
	class 12: 0.5957622
	class 13: 0.5054833
	class 14: 0.7410924
	class 15: 0.8110369
	class 16: 0.033039473
	class 17: 0.20653668
Class Acc:
	class 0: 0.9774962
	class 1: 0.5832486
	class 2: 0.6726279
	class 3: 0.4933754
	class 4: 0.57608527
	class 5: 0.6747835
	class 6: 0.71954566
	class 7: 0.83378106
	class 8: 0.6880653
	class 9: 0.29064253
	class 10: 0.20107757
	class 11: 0.4568897
	class 12: 0.63985634
	class 13: 0.57414234
	class 14: 0.78330195
	class 15: 0.86259353
	class 16: 0.058053188
	class 17: 0.9064037

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6402978897094727, Reg Loss=0.3150137960910797
Clinet index 17, End of Epoch 1/6, Average Loss=0.95531165599823, Class Loss=0.6402978897094727, Reg Loss=0.3150137960910797
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5697205066680908, Reg Loss=0.2964656352996826
Clinet index 17, End of Epoch 2/6, Average Loss=0.8661861419677734, Class Loss=0.5697205066680908, Reg Loss=0.2964656352996826
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5194568634033203, Reg Loss=0.2869004011154175
Clinet index 17, End of Epoch 3/6, Average Loss=0.8063572645187378, Class Loss=0.5194568634033203, Reg Loss=0.2869004011154175
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4970267415046692, Reg Loss=0.27210938930511475
Clinet index 17, End of Epoch 4/6, Average Loss=0.7691361308097839, Class Loss=0.4970267415046692, Reg Loss=0.27210938930511475
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4778909385204315, Reg Loss=0.26677045226097107
Clinet index 17, End of Epoch 5/6, Average Loss=0.7446613907814026, Class Loss=0.4778909385204315, Reg Loss=0.26677045226097107
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4609794318675995, Reg Loss=0.2563062012195587
Clinet index 17, End of Epoch 6/6, Average Loss=0.7172856330871582, Class Loss=0.4609794318675995, Reg Loss=0.2563062012195587
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6262483596801758, Reg Loss=0.330145001411438
Clinet index 21, End of Epoch 1/6, Average Loss=0.9563933610916138, Class Loss=0.6262483596801758, Reg Loss=0.330145001411438
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5675422549247742, Reg Loss=0.2983437478542328
Clinet index 21, End of Epoch 2/6, Average Loss=0.8658859729766846, Class Loss=0.5675422549247742, Reg Loss=0.2983437478542328
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5294032096862793, Reg Loss=0.2814372777938843
Clinet index 21, End of Epoch 3/6, Average Loss=0.8108404874801636, Class Loss=0.5294032096862793, Reg Loss=0.2814372777938843
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4950958490371704, Reg Loss=0.29293203353881836
Clinet index 21, End of Epoch 4/6, Average Loss=0.7880278825759888, Class Loss=0.4950958490371704, Reg Loss=0.29293203353881836
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.472261905670166, Reg Loss=0.2786007523536682
Clinet index 21, End of Epoch 5/6, Average Loss=0.7508626580238342, Class Loss=0.472261905670166, Reg Loss=0.2786007523536682
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.45772266387939453, Reg Loss=0.27455317974090576
Clinet index 21, End of Epoch 6/6, Average Loss=0.7322758436203003, Class Loss=0.45772266387939453, Reg Loss=0.27455317974090576
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6251109838485718, Reg Loss=0.30861204862594604
Clinet index 10, End of Epoch 1/6, Average Loss=0.9337230324745178, Class Loss=0.6251109838485718, Reg Loss=0.30861204862594604
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5650909543037415, Reg Loss=0.28913211822509766
Clinet index 10, End of Epoch 2/6, Average Loss=0.8542230725288391, Class Loss=0.5650909543037415, Reg Loss=0.28913211822509766
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5163957476615906, Reg Loss=0.2823806703090668
Clinet index 10, End of Epoch 3/6, Average Loss=0.798776388168335, Class Loss=0.5163957476615906, Reg Loss=0.2823806703090668
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4847719669342041, Reg Loss=0.2772260308265686
Clinet index 10, End of Epoch 4/6, Average Loss=0.7619979977607727, Class Loss=0.4847719669342041, Reg Loss=0.2772260308265686
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.46228745579719543, Reg Loss=0.27840566635131836
Clinet index 10, End of Epoch 5/6, Average Loss=0.7406930923461914, Class Loss=0.46228745579719543, Reg Loss=0.27840566635131836
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4398624002933502, Reg Loss=0.2739855945110321
Clinet index 10, End of Epoch 6/6, Average Loss=0.7138479948043823, Class Loss=0.4398624002933502, Reg Loss=0.2739855945110321
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6154050230979919, Reg Loss=0.3286048471927643
Clinet index 5, End of Epoch 1/6, Average Loss=0.9440099000930786, Class Loss=0.6154050230979919, Reg Loss=0.3286048471927643
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5662254095077515, Reg Loss=0.30854201316833496
Clinet index 5, End of Epoch 2/6, Average Loss=0.8747674226760864, Class Loss=0.5662254095077515, Reg Loss=0.30854201316833496
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5086213946342468, Reg Loss=0.29272666573524475
Clinet index 5, End of Epoch 3/6, Average Loss=0.801348090171814, Class Loss=0.5086213946342468, Reg Loss=0.29272666573524475
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4892345666885376, Reg Loss=0.28313490748405457
Clinet index 5, End of Epoch 4/6, Average Loss=0.7723695039749146, Class Loss=0.4892345666885376, Reg Loss=0.28313490748405457
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.45789584517478943, Reg Loss=0.2735337018966675
Clinet index 5, End of Epoch 5/6, Average Loss=0.7314295768737793, Class Loss=0.45789584517478943, Reg Loss=0.2735337018966675
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.43850281834602356, Reg Loss=0.27444154024124146
Clinet index 5, End of Epoch 6/6, Average Loss=0.7129443883895874, Class Loss=0.43850281834602356, Reg Loss=0.27444154024124146
federated aggregation...
Validation, Class Loss=0.6493627429008484, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.857306
Mean Acc: 0.672364
FreqW Acc: 0.801862
Mean IoU: 0.569633
Class IoU:
	class 0: 0.87351173
	class 1: 0.72437865
	class 2: 0.4256637
	class 3: 0.59499055
	class 4: 0.5898678
	class 5: 0.6608762
	class 6: 0.8373908
	class 7: 0.8271398
	class 8: 0.7149701
	class 9: 0.29355457
	class 10: 0.44272202
	class 11: 0.5159914
	class 12: 0.64664006
	class 13: 0.5535049
	class 14: 0.7849521
	class 15: 0.8369678
	class 16: 0.17992793
	class 17: 0.20253916
	class 18: 0.11743008
Class Acc:
	class 0: 0.9219373
	class 1: 0.73319614
	class 2: 0.84035236
	class 3: 0.60097116
	class 4: 0.6253083
	class 5: 0.69661313
	class 6: 0.84559566
	class 7: 0.8393338
	class 8: 0.7221109
	class 9: 0.33843318
	class 10: 0.45877403
	class 11: 0.55475295
	class 12: 0.66067517
	class 13: 0.57142544
	class 14: 0.86334693
	class 15: 0.87410307
	class 16: 0.26939875
	class 17: 0.8320619
	class 18: 0.52653176

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.44404056668281555, Reg Loss=0.27460774779319763
Clinet index 19, End of Epoch 1/6, Average Loss=0.7186483144760132, Class Loss=0.44404056668281555, Reg Loss=0.27460774779319763
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4270783066749573, Reg Loss=0.26677531003952026
Clinet index 19, End of Epoch 2/6, Average Loss=0.6938536167144775, Class Loss=0.4270783066749573, Reg Loss=0.26677531003952026
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.407457172870636, Reg Loss=0.2680465877056122
Clinet index 19, End of Epoch 3/6, Average Loss=0.6755037307739258, Class Loss=0.407457172870636, Reg Loss=0.2680465877056122
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.38963261246681213, Reg Loss=0.2681712508201599
Clinet index 19, End of Epoch 4/6, Average Loss=0.6578038930892944, Class Loss=0.38963261246681213, Reg Loss=0.2681712508201599
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.36546817421913147, Reg Loss=0.26055794954299927
Clinet index 19, End of Epoch 5/6, Average Loss=0.6260261535644531, Class Loss=0.36546817421913147, Reg Loss=0.26055794954299927
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.34999001026153564, Reg Loss=0.26499688625335693
Clinet index 19, End of Epoch 6/6, Average Loss=0.6149868965148926, Class Loss=0.34999001026153564, Reg Loss=0.26499688625335693
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.44344210624694824, Reg Loss=0.26962757110595703
Clinet index 11, End of Epoch 1/6, Average Loss=0.7130696773529053, Class Loss=0.44344210624694824, Reg Loss=0.26962757110595703
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.42979004979133606, Reg Loss=0.2745169997215271
Clinet index 11, End of Epoch 2/6, Average Loss=0.7043070793151855, Class Loss=0.42979004979133606, Reg Loss=0.2745169997215271
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4191400110721588, Reg Loss=0.26210978627204895
Clinet index 11, End of Epoch 3/6, Average Loss=0.6812497973442078, Class Loss=0.4191400110721588, Reg Loss=0.26210978627204895
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3939950466156006, Reg Loss=0.2663617730140686
Clinet index 11, End of Epoch 4/6, Average Loss=0.6603568196296692, Class Loss=0.3939950466156006, Reg Loss=0.2663617730140686
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3759109377861023, Reg Loss=0.2688080668449402
Clinet index 11, End of Epoch 5/6, Average Loss=0.6447190046310425, Class Loss=0.3759109377861023, Reg Loss=0.2688080668449402
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.35097551345825195, Reg Loss=0.2592715322971344
Clinet index 11, End of Epoch 6/6, Average Loss=0.610247015953064, Class Loss=0.35097551345825195, Reg Loss=0.2592715322971344
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4308233857154846, Reg Loss=0.27254968881607056
Clinet index 9, End of Epoch 1/6, Average Loss=0.7033730745315552, Class Loss=0.4308233857154846, Reg Loss=0.27254968881607056
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4223327934741974, Reg Loss=0.26660192012786865
Clinet index 9, End of Epoch 2/6, Average Loss=0.6889346837997437, Class Loss=0.4223327934741974, Reg Loss=0.26660192012786865
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3966667950153351, Reg Loss=0.2694259285926819
Clinet index 9, End of Epoch 3/6, Average Loss=0.6660927534103394, Class Loss=0.3966667950153351, Reg Loss=0.2694259285926819
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3784606456756592, Reg Loss=0.26471036672592163
Clinet index 9, End of Epoch 4/6, Average Loss=0.6431710124015808, Class Loss=0.3784606456756592, Reg Loss=0.26471036672592163
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.37163522839546204, Reg Loss=0.26634481549263
Clinet index 9, End of Epoch 5/6, Average Loss=0.637980043888092, Class Loss=0.37163522839546204, Reg Loss=0.26634481549263
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.34398752450942993, Reg Loss=0.2642306685447693
Clinet index 9, End of Epoch 6/6, Average Loss=0.6082181930541992, Class Loss=0.34398752450942993, Reg Loss=0.2642306685447693
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4458056688308716, Reg Loss=0.2869350016117096
Clinet index 1, End of Epoch 1/6, Average Loss=0.7327406406402588, Class Loss=0.4458056688308716, Reg Loss=0.2869350016117096
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.427662193775177, Reg Loss=0.28421393036842346
Clinet index 1, End of Epoch 2/6, Average Loss=0.7118761539459229, Class Loss=0.427662193775177, Reg Loss=0.28421393036842346
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4134303629398346, Reg Loss=0.2772553563117981
Clinet index 1, End of Epoch 3/6, Average Loss=0.6906857490539551, Class Loss=0.4134303629398346, Reg Loss=0.2772553563117981
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.39542609453201294, Reg Loss=0.2725333273410797
Clinet index 1, End of Epoch 4/6, Average Loss=0.667959451675415, Class Loss=0.39542609453201294, Reg Loss=0.2725333273410797
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.372961163520813, Reg Loss=0.2738962471485138
Clinet index 1, End of Epoch 5/6, Average Loss=0.6468573808670044, Class Loss=0.372961163520813, Reg Loss=0.2738962471485138
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.3625762164592743, Reg Loss=0.2778836488723755
Clinet index 1, End of Epoch 6/6, Average Loss=0.6404598951339722, Class Loss=0.3625762164592743, Reg Loss=0.2778836488723755
federated aggregation...
Validation, Class Loss=0.5910549759864807, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.834376
Mean Acc: 0.674166
FreqW Acc: 0.782668
Mean IoU: 0.565042
Class IoU:
	class 0: 0.8456321
	class 1: 0.7023891
	class 2: 0.42662886
	class 3: 0.62860423
	class 4: 0.5772815
	class 5: 0.64875335
	class 6: 0.81907266
	class 7: 0.81936026
	class 8: 0.72926056
	class 9: 0.2792496
	class 10: 0.4818219
	class 11: 0.5084056
	class 12: 0.65325266
	class 13: 0.5736606
	class 14: 0.78110105
	class 15: 0.83711886
	class 16: 0.092377305
	class 17: 0.21812728
	class 18: 0.11370312
Class Acc:
	class 0: 0.88444644
	class 1: 0.7093757
	class 2: 0.8391425
	class 3: 0.63631946
	class 4: 0.606417
	class 5: 0.6818591
	class 6: 0.8263094
	class 7: 0.8306151
	class 8: 0.7368534
	class 9: 0.32274276
	class 10: 0.50429994
	class 11: 0.54979414
	class 12: 0.6674086
	class 13: 0.58968437
	class 14: 0.85546625
	class 15: 0.87269914
	class 16: 0.10933909
	class 17: 0.8291401
	class 18: 0.75723773

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.35248133540153503, Reg Loss=0.2720051109790802
Clinet index 8, End of Epoch 1/6, Average Loss=0.6244864463806152, Class Loss=0.35248133540153503, Reg Loss=0.2720051109790802
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.334440678358078, Reg Loss=0.26165705919265747
Clinet index 8, End of Epoch 2/6, Average Loss=0.5960977077484131, Class Loss=0.334440678358078, Reg Loss=0.26165705919265747
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3354487717151642, Reg Loss=0.2745154798030853
Clinet index 8, End of Epoch 3/6, Average Loss=0.6099642515182495, Class Loss=0.3354487717151642, Reg Loss=0.2745154798030853
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3066767454147339, Reg Loss=0.26713430881500244
Clinet index 8, End of Epoch 4/6, Average Loss=0.5738110542297363, Class Loss=0.3066767454147339, Reg Loss=0.26713430881500244
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3039429783821106, Reg Loss=0.277601420879364
Clinet index 8, End of Epoch 5/6, Average Loss=0.5815443992614746, Class Loss=0.3039429783821106, Reg Loss=0.277601420879364
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.29909271001815796, Reg Loss=0.26611411571502686
Clinet index 8, End of Epoch 6/6, Average Loss=0.5652068257331848, Class Loss=0.29909271001815796, Reg Loss=0.26611411571502686
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.34279513359069824, Reg Loss=0.269108384847641
Clinet index 5, End of Epoch 1/6, Average Loss=0.6119035482406616, Class Loss=0.34279513359069824, Reg Loss=0.269108384847641
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.33422189950942993, Reg Loss=0.2672478258609772
Clinet index 5, End of Epoch 2/6, Average Loss=0.6014697551727295, Class Loss=0.33422189950942993, Reg Loss=0.2672478258609772
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.33288607001304626, Reg Loss=0.26655885577201843
Clinet index 5, End of Epoch 3/6, Average Loss=0.5994449257850647, Class Loss=0.33288607001304626, Reg Loss=0.26655885577201843
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3196801245212555, Reg Loss=0.2655941843986511
Clinet index 5, End of Epoch 4/6, Average Loss=0.585274338722229, Class Loss=0.3196801245212555, Reg Loss=0.2655941843986511
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.29800233244895935, Reg Loss=0.26301679015159607
Clinet index 5, End of Epoch 5/6, Average Loss=0.5610191226005554, Class Loss=0.29800233244895935, Reg Loss=0.26301679015159607
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.2936243712902069, Reg Loss=0.2693065106868744
Clinet index 5, End of Epoch 6/6, Average Loss=0.5629308819770813, Class Loss=0.2936243712902069, Reg Loss=0.2693065106868744
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3606969118118286, Reg Loss=0.2756118178367615
Clinet index 21, End of Epoch 1/6, Average Loss=0.6363087296485901, Class Loss=0.3606969118118286, Reg Loss=0.2756118178367615
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.3415178954601288, Reg Loss=0.2695259749889374
Clinet index 21, End of Epoch 2/6, Average Loss=0.6110438704490662, Class Loss=0.3415178954601288, Reg Loss=0.2695259749889374
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.33384883403778076, Reg Loss=0.25890445709228516
Clinet index 21, End of Epoch 3/6, Average Loss=0.5927532911300659, Class Loss=0.33384883403778076, Reg Loss=0.25890445709228516
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3258920907974243, Reg Loss=0.27246254682540894
Clinet index 21, End of Epoch 4/6, Average Loss=0.5983546376228333, Class Loss=0.3258920907974243, Reg Loss=0.27246254682540894
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.3112333416938782, Reg Loss=0.2646295428276062
Clinet index 21, End of Epoch 5/6, Average Loss=0.5758628845214844, Class Loss=0.3112333416938782, Reg Loss=0.2646295428276062
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.301590234041214, Reg Loss=0.2628776729106903
Clinet index 21, End of Epoch 6/6, Average Loss=0.5644679069519043, Class Loss=0.301590234041214, Reg Loss=0.2628776729106903
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3516530394554138, Reg Loss=0.26613175868988037
Clinet index 7, End of Epoch 1/6, Average Loss=0.6177847981452942, Class Loss=0.3516530394554138, Reg Loss=0.26613175868988037
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3347461223602295, Reg Loss=0.2711644172668457
Clinet index 7, End of Epoch 2/6, Average Loss=0.6059105396270752, Class Loss=0.3347461223602295, Reg Loss=0.2711644172668457
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3227792978286743, Reg Loss=0.267819881439209
Clinet index 7, End of Epoch 3/6, Average Loss=0.5905991792678833, Class Loss=0.3227792978286743, Reg Loss=0.267819881439209
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.31117698550224304, Reg Loss=0.2674714922904968
Clinet index 7, End of Epoch 4/6, Average Loss=0.5786484479904175, Class Loss=0.31117698550224304, Reg Loss=0.2674714922904968
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3053703010082245, Reg Loss=0.26645296812057495
Clinet index 7, End of Epoch 5/6, Average Loss=0.571823239326477, Class Loss=0.3053703010082245, Reg Loss=0.26645296812057495
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.2902885377407074, Reg Loss=0.2665201425552368
Clinet index 7, End of Epoch 6/6, Average Loss=0.5568087100982666, Class Loss=0.2902885377407074, Reg Loss=0.2665201425552368
federated aggregation...
Validation, Class Loss=0.5565388798713684, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.840277
Mean Acc: 0.675943
FreqW Acc: 0.787668
Mean IoU: 0.565143
Class IoU:
	class 0: 0.85272574
	class 1: 0.69757265
	class 2: 0.42343196
	class 3: 0.6644868
	class 4: 0.559275
	class 5: 0.64363515
	class 6: 0.7972174
	class 7: 0.8175966
	class 8: 0.7112124
	class 9: 0.2587251
	class 10: 0.49951437
	class 11: 0.5049894
	class 12: 0.650081
	class 13: 0.61007696
	class 14: 0.7909884
	class 15: 0.84122735
	class 16: 0.06741366
	class 17: 0.21788128
	class 18: 0.12966551
Class Acc:
	class 0: 0.89154613
	class 1: 0.7046523
	class 2: 0.82723486
	class 3: 0.6739742
	class 4: 0.5828451
	class 5: 0.67751956
	class 6: 0.8036508
	class 7: 0.8283361
	class 8: 0.71793884
	class 9: 0.29221764
	class 10: 0.52523434
	class 11: 0.54471946
	class 12: 0.67012733
	class 13: 0.6270733
	class 14: 0.8652136
	class 15: 0.878883
	class 16: 0.07418953
	class 17: 0.8404006
	class 18: 0.81715965

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3035227656364441, Reg Loss=0.25292879343032837
Clinet index 14, End of Epoch 1/6, Average Loss=0.5564515590667725, Class Loss=0.3035227656364441, Reg Loss=0.25292879343032837
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2891812026500702, Reg Loss=0.25499263405799866
Clinet index 14, End of Epoch 2/6, Average Loss=0.5441738367080688, Class Loss=0.2891812026500702, Reg Loss=0.25499263405799866
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2859538793563843, Reg Loss=0.2535723149776459
Clinet index 14, End of Epoch 3/6, Average Loss=0.5395262241363525, Class Loss=0.2859538793563843, Reg Loss=0.2535723149776459
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2742598354816437, Reg Loss=0.25568750500679016
Clinet index 14, End of Epoch 4/6, Average Loss=0.5299473404884338, Class Loss=0.2742598354816437, Reg Loss=0.25568750500679016
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.2685620188713074, Reg Loss=0.25181078910827637
Clinet index 14, End of Epoch 5/6, Average Loss=0.5203728079795837, Class Loss=0.2685620188713074, Reg Loss=0.25181078910827637
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.26340538263320923, Reg Loss=0.2553618550300598
Clinet index 14, End of Epoch 6/6, Average Loss=0.518767237663269, Class Loss=0.26340538263320923, Reg Loss=0.2553618550300598
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3002525568008423, Reg Loss=0.27344468235969543
Clinet index 4, End of Epoch 1/6, Average Loss=0.5736972093582153, Class Loss=0.3002525568008423, Reg Loss=0.27344468235969543
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2980082929134369, Reg Loss=0.2697479724884033
Clinet index 4, End of Epoch 2/6, Average Loss=0.5677562952041626, Class Loss=0.2980082929134369, Reg Loss=0.2697479724884033
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.27664756774902344, Reg Loss=0.27472132444381714
Clinet index 4, End of Epoch 3/6, Average Loss=0.5513688921928406, Class Loss=0.27664756774902344, Reg Loss=0.27472132444381714
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2844478189945221, Reg Loss=0.26872551441192627
Clinet index 4, End of Epoch 4/6, Average Loss=0.553173303604126, Class Loss=0.2844478189945221, Reg Loss=0.26872551441192627
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.2722640931606293, Reg Loss=0.2763497233390808
Clinet index 4, End of Epoch 5/6, Average Loss=0.5486137866973877, Class Loss=0.2722640931606293, Reg Loss=0.2763497233390808
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2606848478317261, Reg Loss=0.2657408118247986
Clinet index 4, End of Epoch 6/6, Average Loss=0.5264256596565247, Class Loss=0.2606848478317261, Reg Loss=0.2657408118247986
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.2984985113143921, Reg Loss=0.26154065132141113
Clinet index 11, End of Epoch 1/6, Average Loss=0.5600391626358032, Class Loss=0.2984985113143921, Reg Loss=0.26154065132141113
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3019903302192688, Reg Loss=0.26124149560928345
Clinet index 11, End of Epoch 2/6, Average Loss=0.5632318258285522, Class Loss=0.3019903302192688, Reg Loss=0.26124149560928345
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.28917577862739563, Reg Loss=0.2569388449192047
Clinet index 11, End of Epoch 3/6, Average Loss=0.5461146235466003, Class Loss=0.28917577862739563, Reg Loss=0.2569388449192047
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.27558284997940063, Reg Loss=0.25728222727775574
Clinet index 11, End of Epoch 4/6, Average Loss=0.532865047454834, Class Loss=0.27558284997940063, Reg Loss=0.25728222727775574
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.27646324038505554, Reg Loss=0.26444917917251587
Clinet index 11, End of Epoch 5/6, Average Loss=0.540912389755249, Class Loss=0.27646324038505554, Reg Loss=0.26444917917251587
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.2605407238006592, Reg Loss=0.2584978938102722
Clinet index 11, End of Epoch 6/6, Average Loss=0.5190386176109314, Class Loss=0.2605407238006592, Reg Loss=0.2584978938102722
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.304648220539093, Reg Loss=0.26658084988594055
Clinet index 21, End of Epoch 1/6, Average Loss=0.571229100227356, Class Loss=0.304648220539093, Reg Loss=0.26658084988594055
Pseudo labeling is: None
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.29439619183540344, Reg Loss=0.26354336738586426
Clinet index 21, End of Epoch 2/6, Average Loss=0.5579395294189453, Class Loss=0.29439619183540344, Reg Loss=0.26354336738586426
Pseudo labeling is: None
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.2863965928554535, Reg Loss=0.2632264792919159
Clinet index 21, End of Epoch 3/6, Average Loss=0.5496230721473694, Class Loss=0.2863965928554535, Reg Loss=0.2632264792919159
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.29031866788864136, Reg Loss=0.26358819007873535
Clinet index 21, End of Epoch 4/6, Average Loss=0.5539068579673767, Class Loss=0.29031866788864136, Reg Loss=0.26358819007873535
Pseudo labeling is: None
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.2759225368499756, Reg Loss=0.26770153641700745
Clinet index 21, End of Epoch 5/6, Average Loss=0.5436240434646606, Class Loss=0.2759225368499756, Reg Loss=0.26770153641700745
Pseudo labeling is: None
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.27493640780448914, Reg Loss=0.2622678279876709
Clinet index 21, End of Epoch 6/6, Average Loss=0.5372042655944824, Class Loss=0.27493640780448914, Reg Loss=0.2622678279876709
federated aggregation...
Validation, Class Loss=0.537814736366272, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.844319
Mean Acc: 0.672696
FreqW Acc: 0.790447
Mean IoU: 0.561356
Class IoU:
	class 0: 0.85830015
	class 1: 0.6822244
	class 2: 0.42135507
	class 3: 0.6647987
	class 4: 0.5485625
	class 5: 0.6381287
	class 6: 0.7913277
	class 7: 0.8170952
	class 8: 0.698715
	class 9: 0.2505247
	class 10: 0.49851397
	class 11: 0.50426316
	class 12: 0.6371676
	class 13: 0.62238044
	class 14: 0.78876656
	class 15: 0.841837
	class 16: 0.048766095
	class 17: 0.21172011
	class 18: 0.14131492
Class Acc:
	class 0: 0.89881355
	class 1: 0.6898149
	class 2: 0.82160425
	class 3: 0.6740776
	class 4: 0.5723323
	class 5: 0.67102873
	class 6: 0.7976961
	class 7: 0.82864845
	class 8: 0.7048186
	class 9: 0.27910945
	class 10: 0.5236526
	class 11: 0.5512108
	class 12: 0.6552481
	class 13: 0.6399571
	class 14: 0.8577923
	class 15: 0.8790789
	class 16: 0.051885072
	class 17: 0.8504229
	class 18: 0.8340362

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2592600882053375, Reg Loss=0.25102680921554565
Clinet index 15, End of Epoch 1/6, Average Loss=0.5102869272232056, Class Loss=0.2592600882053375, Reg Loss=0.25102680921554565
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.24968045949935913, Reg Loss=0.25558483600616455
Clinet index 15, End of Epoch 2/6, Average Loss=0.5052652955055237, Class Loss=0.24968045949935913, Reg Loss=0.25558483600616455
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.24623045325279236, Reg Loss=0.25067102909088135
Clinet index 15, End of Epoch 3/6, Average Loss=0.4969014823436737, Class Loss=0.24623045325279236, Reg Loss=0.25067102909088135
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.23920583724975586, Reg Loss=0.25427699089050293
Clinet index 15, End of Epoch 4/6, Average Loss=0.4934828281402588, Class Loss=0.23920583724975586, Reg Loss=0.25427699089050293
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.24493946135044098, Reg Loss=0.2547970116138458
Clinet index 15, End of Epoch 5/6, Average Loss=0.499736487865448, Class Loss=0.24493946135044098, Reg Loss=0.2547970116138458
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2381243109703064, Reg Loss=0.24987320601940155
Clinet index 15, End of Epoch 6/6, Average Loss=0.48799753189086914, Class Loss=0.2381243109703064, Reg Loss=0.24987320601940155
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.26209983229637146, Reg Loss=0.27809545397758484
Clinet index 12, End of Epoch 1/6, Average Loss=0.5401952862739563, Class Loss=0.26209983229637146, Reg Loss=0.27809545397758484
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.2576000690460205, Reg Loss=0.26239845156669617
Clinet index 12, End of Epoch 2/6, Average Loss=0.5199985504150391, Class Loss=0.2576000690460205, Reg Loss=0.26239845156669617
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2565382421016693, Reg Loss=0.260580450296402
Clinet index 12, End of Epoch 3/6, Average Loss=0.5171186923980713, Class Loss=0.2565382421016693, Reg Loss=0.260580450296402
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2472657412290573, Reg Loss=0.2610248327255249
Clinet index 12, End of Epoch 4/6, Average Loss=0.5082905888557434, Class Loss=0.2472657412290573, Reg Loss=0.2610248327255249
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.24185669422149658, Reg Loss=0.2599348723888397
Clinet index 12, End of Epoch 5/6, Average Loss=0.5017915964126587, Class Loss=0.24185669422149658, Reg Loss=0.2599348723888397
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.24253329634666443, Reg Loss=0.2621556520462036
Clinet index 12, End of Epoch 6/6, Average Loss=0.5046889781951904, Class Loss=0.24253329634666443, Reg Loss=0.2621556520462036
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.26554590463638306, Reg Loss=0.2693636417388916
Clinet index 21, End of Epoch 1/6, Average Loss=0.5349095463752747, Class Loss=0.26554590463638306, Reg Loss=0.2693636417388916
Pseudo labeling is: None
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.25837060809135437, Reg Loss=0.2639215588569641
Clinet index 21, End of Epoch 2/6, Average Loss=0.5222921371459961, Class Loss=0.25837060809135437, Reg Loss=0.2639215588569641
Pseudo labeling is: None
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.26239410042762756, Reg Loss=0.26672983169555664
Clinet index 21, End of Epoch 3/6, Average Loss=0.5291239023208618, Class Loss=0.26239410042762756, Reg Loss=0.26672983169555664
Pseudo labeling is: None
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.2705966830253601, Reg Loss=0.2701074182987213
Clinet index 21, End of Epoch 4/6, Average Loss=0.5407041311264038, Class Loss=0.2705966830253601, Reg Loss=0.2701074182987213
Pseudo labeling is: None
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.2571544349193573, Reg Loss=0.2624722421169281
Clinet index 21, End of Epoch 5/6, Average Loss=0.5196266770362854, Class Loss=0.2571544349193573, Reg Loss=0.2624722421169281
Pseudo labeling is: None
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.2582910656929016, Reg Loss=0.26270124316215515
Clinet index 21, End of Epoch 6/6, Average Loss=0.5209922790527344, Class Loss=0.2582910656929016, Reg Loss=0.26270124316215515
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.27338096499443054, Reg Loss=0.2661963105201721
Clinet index 16, End of Epoch 1/6, Average Loss=0.5395772457122803, Class Loss=0.27338096499443054, Reg Loss=0.2661963105201721
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.26346513628959656, Reg Loss=0.26255002617836
Clinet index 16, End of Epoch 2/6, Average Loss=0.5260151624679565, Class Loss=0.26346513628959656, Reg Loss=0.26255002617836
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2580673098564148, Reg Loss=0.25861814618110657
Clinet index 16, End of Epoch 3/6, Average Loss=0.5166854858398438, Class Loss=0.2580673098564148, Reg Loss=0.25861814618110657
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.24431370198726654, Reg Loss=0.2659000754356384
Clinet index 16, End of Epoch 4/6, Average Loss=0.5102137923240662, Class Loss=0.24431370198726654, Reg Loss=0.2659000754356384
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.2554326057434082, Reg Loss=0.2655029892921448
Clinet index 16, End of Epoch 5/6, Average Loss=0.520935595035553, Class Loss=0.2554326057434082, Reg Loss=0.2655029892921448
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2523374855518341, Reg Loss=0.26590442657470703
Clinet index 16, End of Epoch 6/6, Average Loss=0.5182418823242188, Class Loss=0.2523374855518341, Reg Loss=0.26590442657470703
federated aggregation...
Validation, Class Loss=0.524874210357666, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.848863
Mean Acc: 0.672806
FreqW Acc: 0.793682
Mean IoU: 0.561921
Class IoU:
	class 0: 0.8622487
	class 1: 0.677928
	class 2: 0.42122826
	class 3: 0.68213636
	class 4: 0.53331953
	class 5: 0.6346562
	class 6: 0.78258646
	class 7: 0.8161711
	class 8: 0.7138109
	class 9: 0.23887677
	class 10: 0.5137235
	class 11: 0.4980693
	class 12: 0.62809986
	class 13: 0.6350398
	class 14: 0.78963614
	class 15: 0.84413093
	class 16: 0.04211561
	class 17: 0.21072711
	class 18: 0.15199593
Class Acc:
	class 0: 0.9044357
	class 1: 0.68609226
	class 2: 0.81483406
	class 3: 0.6936576
	class 4: 0.55427
	class 5: 0.66617125
	class 6: 0.7884049
	class 7: 0.8279746
	class 8: 0.7208444
	class 9: 0.2635923
	class 10: 0.54185265
	class 11: 0.5413543
	class 12: 0.6468745
	class 13: 0.6550903
	class 14: 0.85490316
	class 15: 0.88527936
	class 16: 0.044667695
	class 17: 0.8563905
	class 18: 0.83662117

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.9085044860839844, Reg Loss=0.4692418575286865
Clinet index 9, End of Epoch 1/6, Average Loss=1.377746343612671, Class Loss=0.9085044860839844, Reg Loss=0.4692418575286865
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6596625447273254, Reg Loss=0.3890193998813629
Clinet index 9, End of Epoch 2/6, Average Loss=1.0486819744110107, Class Loss=0.6596625447273254, Reg Loss=0.3890193998813629
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5479474663734436, Reg Loss=0.3584354817867279
Clinet index 9, End of Epoch 3/6, Average Loss=0.9063829183578491, Class Loss=0.5479474663734436, Reg Loss=0.3584354817867279
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5027034282684326, Reg Loss=0.34314221143722534
Clinet index 9, End of Epoch 4/6, Average Loss=0.845845639705658, Class Loss=0.5027034282684326, Reg Loss=0.34314221143722534
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4773549735546112, Reg Loss=0.3355830907821655
Clinet index 9, End of Epoch 5/6, Average Loss=0.8129380941390991, Class Loss=0.4773549735546112, Reg Loss=0.3355830907821655
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.44514426589012146, Reg Loss=0.34323447942733765
Clinet index 9, End of Epoch 6/6, Average Loss=0.7883787155151367, Class Loss=0.44514426589012146, Reg Loss=0.34323447942733765
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.86152184009552, Reg Loss=0.4623093008995056
Clinet index 12, End of Epoch 1/6, Average Loss=1.3238310813903809, Class Loss=0.86152184009552, Reg Loss=0.4623093008995056
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6565306782722473, Reg Loss=0.37437576055526733
Clinet index 12, End of Epoch 2/6, Average Loss=1.0309064388275146, Class Loss=0.6565306782722473, Reg Loss=0.37437576055526733
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5423506498336792, Reg Loss=0.3461672365665436
Clinet index 12, End of Epoch 3/6, Average Loss=0.8885178565979004, Class Loss=0.5423506498336792, Reg Loss=0.3461672365665436
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5005728006362915, Reg Loss=0.3408687114715576
Clinet index 12, End of Epoch 4/6, Average Loss=0.8414415121078491, Class Loss=0.5005728006362915, Reg Loss=0.3408687114715576
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4694225490093231, Reg Loss=0.32810747623443604
Clinet index 12, End of Epoch 5/6, Average Loss=0.7975300550460815, Class Loss=0.4694225490093231, Reg Loss=0.32810747623443604
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4362044334411621, Reg Loss=0.3264220952987671
Clinet index 12, End of Epoch 6/6, Average Loss=0.7626265287399292, Class Loss=0.4362044334411621, Reg Loss=0.3264220952987671
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.855550229549408, Reg Loss=0.4605250358581543
Clinet index 24, End of Epoch 1/6, Average Loss=1.316075325012207, Class Loss=0.855550229549408, Reg Loss=0.4605250358581543
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6563658118247986, Reg Loss=0.37283089756965637
Clinet index 24, End of Epoch 2/6, Average Loss=1.0291967391967773, Class Loss=0.6563658118247986, Reg Loss=0.37283089756965637
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5533043146133423, Reg Loss=0.3392142653465271
Clinet index 24, End of Epoch 3/6, Average Loss=0.8925185799598694, Class Loss=0.5533043146133423, Reg Loss=0.3392142653465271
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5164164304733276, Reg Loss=0.32907983660697937
Clinet index 24, End of Epoch 4/6, Average Loss=0.8454962968826294, Class Loss=0.5164164304733276, Reg Loss=0.32907983660697937
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.48395004868507385, Reg Loss=0.31935936212539673
Clinet index 24, End of Epoch 5/6, Average Loss=0.803309440612793, Class Loss=0.48395004868507385, Reg Loss=0.31935936212539673
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4441879391670227, Reg Loss=0.3137684166431427
Clinet index 24, End of Epoch 6/6, Average Loss=0.7579563856124878, Class Loss=0.4441879391670227, Reg Loss=0.3137684166431427
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.9398971199989319, Reg Loss=0.47324439883232117
Clinet index 8, End of Epoch 1/6, Average Loss=1.4131414890289307, Class Loss=0.9398971199989319, Reg Loss=0.47324439883232117
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6702408790588379, Reg Loss=0.3843494653701782
Clinet index 8, End of Epoch 2/6, Average Loss=1.0545903444290161, Class Loss=0.6702408790588379, Reg Loss=0.3843494653701782
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5591362118721008, Reg Loss=0.35524487495422363
Clinet index 8, End of Epoch 3/6, Average Loss=0.9143810868263245, Class Loss=0.5591362118721008, Reg Loss=0.35524487495422363
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5189779996871948, Reg Loss=0.34360870718955994
Clinet index 8, End of Epoch 4/6, Average Loss=0.8625867366790771, Class Loss=0.5189779996871948, Reg Loss=0.34360870718955994
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4796423316001892, Reg Loss=0.33313778042793274
Clinet index 8, End of Epoch 5/6, Average Loss=0.8127801418304443, Class Loss=0.4796423316001892, Reg Loss=0.33313778042793274
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4496484398841858, Reg Loss=0.33279603719711304
Clinet index 8, End of Epoch 6/6, Average Loss=0.7824444770812988, Class Loss=0.4496484398841858, Reg Loss=0.33279603719711304
federated aggregation...
Validation, Class Loss=0.8804716467857361, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.783968
Mean Acc: 0.511254
FreqW Acc: 0.719528
Mean IoU: 0.419118
Class IoU:
	class 0: 0.82301015
	class 1: 0.35909915
	class 2: 0.36896482
	class 3: 0.54388595
	class 4: 0.26007882
	class 5: 0.4615596
	class 6: 0.4654686
	class 7: 0.65973943
	class 8: 0.63421255
	class 9: 0.15355316
	class 10: 0.49498564
	class 11: 0.38066688
	class 12: 0.5781616
	class 13: 0.482844
	class 14: 0.53774214
	class 15: 0.7588142
	class 16: 0.0019797226
	class 17: 0.15719332
	class 18: 0.08322038
	class 19: 0.17717332
Class Acc:
	class 0: 0.87557286
	class 1: 0.3597047
	class 2: 0.57770056
	class 3: 0.5470095
	class 4: 0.26357943
	class 5: 0.47185728
	class 6: 0.46786514
	class 7: 0.67052394
	class 8: 0.63720095
	class 9: 0.21459779
	class 10: 0.5443271
	class 11: 0.4293423
	class 12: 0.6387359
	class 13: 0.4908483
	class 14: 0.5497625
	class 15: 0.79300344
	class 16: 0.0020552548
	class 17: 0.4048137
	class 18: 0.44830427
	class 19: 0.83828586

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4441072940826416, Reg Loss=0.31835487484931946
Clinet index 5, End of Epoch 1/6, Average Loss=0.7624621391296387, Class Loss=0.4441072940826416, Reg Loss=0.31835487484931946
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4170634150505066, Reg Loss=0.31041938066482544
Clinet index 5, End of Epoch 2/6, Average Loss=0.727482795715332, Class Loss=0.4170634150505066, Reg Loss=0.31041938066482544
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3953093886375427, Reg Loss=0.30279892683029175
Clinet index 5, End of Epoch 3/6, Average Loss=0.6981083154678345, Class Loss=0.3953093886375427, Reg Loss=0.30279892683029175
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.359444260597229, Reg Loss=0.3030254542827606
Clinet index 5, End of Epoch 4/6, Average Loss=0.662469744682312, Class Loss=0.359444260597229, Reg Loss=0.3030254542827606
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.32674282789230347, Reg Loss=0.30700501799583435
Clinet index 5, End of Epoch 5/6, Average Loss=0.6337478160858154, Class Loss=0.32674282789230347, Reg Loss=0.30700501799583435
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.30755358934402466, Reg Loss=0.29751110076904297
Clinet index 5, End of Epoch 6/6, Average Loss=0.6050646901130676, Class Loss=0.30755358934402466, Reg Loss=0.29751110076904297
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.4323841333389282, Reg Loss=0.3332778513431549
Clinet index 8, End of Epoch 1/6, Average Loss=0.7656619548797607, Class Loss=0.4323841333389282, Reg Loss=0.3332778513431549
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.41392165422439575, Reg Loss=0.3226128816604614
Clinet index 8, End of Epoch 2/6, Average Loss=0.7365345358848572, Class Loss=0.41392165422439575, Reg Loss=0.3226128816604614
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.3781229257583618, Reg Loss=0.3173936903476715
Clinet index 8, End of Epoch 3/6, Average Loss=0.6955165863037109, Class Loss=0.3781229257583618, Reg Loss=0.3173936903476715
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.35958975553512573, Reg Loss=0.3246481120586395
Clinet index 8, End of Epoch 4/6, Average Loss=0.6842378377914429, Class Loss=0.35958975553512573, Reg Loss=0.3246481120586395
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3333091139793396, Reg Loss=0.3098732829093933
Clinet index 8, End of Epoch 5/6, Average Loss=0.6431823968887329, Class Loss=0.3333091139793396, Reg Loss=0.3098732829093933
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.31626537442207336, Reg Loss=0.3169083893299103
Clinet index 8, End of Epoch 6/6, Average Loss=0.6331737637519836, Class Loss=0.31626537442207336, Reg Loss=0.3169083893299103
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.42447298765182495, Reg Loss=0.32062187790870667
Clinet index 0, End of Epoch 1/6, Average Loss=0.745094895362854, Class Loss=0.42447298765182495, Reg Loss=0.32062187790870667
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4052087068557739, Reg Loss=0.3295135796070099
Clinet index 0, End of Epoch 2/6, Average Loss=0.7347222566604614, Class Loss=0.4052087068557739, Reg Loss=0.3295135796070099
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.37147629261016846, Reg Loss=0.3179064989089966
Clinet index 0, End of Epoch 3/6, Average Loss=0.689382791519165, Class Loss=0.37147629261016846, Reg Loss=0.3179064989089966
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3395511507987976, Reg Loss=0.3114722669124603
Clinet index 0, End of Epoch 4/6, Average Loss=0.6510233879089355, Class Loss=0.3395511507987976, Reg Loss=0.3114722669124603
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3202489912509918, Reg Loss=0.31984812021255493
Clinet index 0, End of Epoch 5/6, Average Loss=0.6400971412658691, Class Loss=0.3202489912509918, Reg Loss=0.31984812021255493
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.29582107067108154, Reg Loss=0.31315097212791443
Clinet index 0, End of Epoch 6/6, Average Loss=0.6089720726013184, Class Loss=0.29582107067108154, Reg Loss=0.31315097212791443
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4446505010128021, Reg Loss=0.32634514570236206
Clinet index 6, End of Epoch 1/6, Average Loss=0.7709956169128418, Class Loss=0.4446505010128021, Reg Loss=0.32634514570236206
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.41411805152893066, Reg Loss=0.32269492745399475
Clinet index 6, End of Epoch 2/6, Average Loss=0.736812949180603, Class Loss=0.41411805152893066, Reg Loss=0.32269492745399475
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3823346793651581, Reg Loss=0.3145572543144226
Clinet index 6, End of Epoch 3/6, Average Loss=0.6968919038772583, Class Loss=0.3823346793651581, Reg Loss=0.3145572543144226
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3521360456943512, Reg Loss=0.31542137265205383
Clinet index 6, End of Epoch 4/6, Average Loss=0.667557418346405, Class Loss=0.3521360456943512, Reg Loss=0.31542137265205383
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.32971975207328796, Reg Loss=0.31920763850212097
Clinet index 6, End of Epoch 5/6, Average Loss=0.6489273905754089, Class Loss=0.32971975207328796, Reg Loss=0.31920763850212097
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.30241063237190247, Reg Loss=0.3151911199092865
Clinet index 6, End of Epoch 6/6, Average Loss=0.617601752281189, Class Loss=0.30241063237190247, Reg Loss=0.3151911199092865
federated aggregation...
Validation, Class Loss=0.7497514486312866, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.808314
Mean Acc: 0.475752
FreqW Acc: 0.736093
Mean IoU: 0.400806
Class IoU:
	class 0: 0.8546081
	class 1: 0.25215048
	class 2: 0.36681032
	class 3: 0.50727963
	class 4: 0.26577613
	class 5: 0.45476356
	class 6: 0.4076346
	class 7: 0.6371846
	class 8: 0.64509153
	class 9: 0.13833691
	class 10: 0.46158695
	class 11: 0.33351874
	class 12: 0.57411325
	class 13: 0.47267613
	class 14: 0.5229812
	class 15: 0.7549673
	class 16: 0.00036735146
	class 17: 0.088056974
	class 18: 0.101246275
	class 19: 0.1769635
Class Acc:
	class 0: 0.92517906
	class 1: 0.25222543
	class 2: 0.5512046
	class 3: 0.5092134
	class 4: 0.26774147
	class 5: 0.46336323
	class 6: 0.4094047
	class 7: 0.6505811
	class 8: 0.6480537
	class 9: 0.18090026
	class 10: 0.49880058
	class 11: 0.36307043
	class 12: 0.61272097
	class 13: 0.4835254
	class 14: 0.5364949
	class 15: 0.77442336
	class 16: 0.00036872306
	class 17: 0.15996966
	class 18: 0.31874302
	class 19: 0.909052

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.29146477580070496, Reg Loss=0.3186020255088806
Clinet index 8, End of Epoch 1/6, Average Loss=0.6100667715072632, Class Loss=0.29146477580070496, Reg Loss=0.3186020255088806
Pseudo labeling is: None
Epoch 2, lr = 0.000600
Epoch 2, Class Loss=0.28221380710601807, Reg Loss=0.3209611177444458
Clinet index 8, End of Epoch 2/6, Average Loss=0.6031749248504639, Class Loss=0.28221380710601807, Reg Loss=0.3209611177444458
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.2679530382156372, Reg Loss=0.31108975410461426
Clinet index 8, End of Epoch 3/6, Average Loss=0.5790427923202515, Class Loss=0.2679530382156372, Reg Loss=0.31108975410461426
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2662600874900818, Reg Loss=0.3147158622741699
Clinet index 8, End of Epoch 4/6, Average Loss=0.5809759497642517, Class Loss=0.2662600874900818, Reg Loss=0.3147158622741699
Pseudo labeling is: None
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.25994640588760376, Reg Loss=0.31348344683647156
Clinet index 8, End of Epoch 5/6, Average Loss=0.5734298229217529, Class Loss=0.25994640588760376, Reg Loss=0.31348344683647156
Pseudo labeling is: None
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.251395046710968, Reg Loss=0.3147367835044861
Clinet index 8, End of Epoch 6/6, Average Loss=0.5661318302154541, Class Loss=0.251395046710968, Reg Loss=0.3147367835044861
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.28909170627593994, Reg Loss=0.30653145909309387
Clinet index 25, End of Epoch 1/6, Average Loss=0.5956231355667114, Class Loss=0.28909170627593994, Reg Loss=0.30653145909309387
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2783181369304657, Reg Loss=0.30399319529533386
Clinet index 25, End of Epoch 2/6, Average Loss=0.5823113322257996, Class Loss=0.2783181369304657, Reg Loss=0.30399319529533386
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2570911645889282, Reg Loss=0.2935952842235565
Clinet index 25, End of Epoch 3/6, Average Loss=0.5506864786148071, Class Loss=0.2570911645889282, Reg Loss=0.2935952842235565
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.24078209698200226, Reg Loss=0.3003583550453186
Clinet index 25, End of Epoch 4/6, Average Loss=0.5411404371261597, Class Loss=0.24078209698200226, Reg Loss=0.3003583550453186
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.22845032811164856, Reg Loss=0.29421865940093994
Clinet index 25, End of Epoch 5/6, Average Loss=0.5226689577102661, Class Loss=0.22845032811164856, Reg Loss=0.29421865940093994
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.21884874999523163, Reg Loss=0.30748897790908813
Clinet index 25, End of Epoch 6/6, Average Loss=0.526337742805481, Class Loss=0.21884874999523163, Reg Loss=0.30748897790908813
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2993561029434204, Reg Loss=0.30969011783599854
Clinet index 22, End of Epoch 1/6, Average Loss=0.609046220779419, Class Loss=0.2993561029434204, Reg Loss=0.30969011783599854
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.2767038643360138, Reg Loss=0.31766629219055176
Clinet index 22, End of Epoch 2/6, Average Loss=0.5943701267242432, Class Loss=0.2767038643360138, Reg Loss=0.31766629219055176
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.26142945885658264, Reg Loss=0.31351935863494873
Clinet index 22, End of Epoch 3/6, Average Loss=0.574948787689209, Class Loss=0.26142945885658264, Reg Loss=0.31351935863494873
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.243296816945076, Reg Loss=0.31131792068481445
Clinet index 22, End of Epoch 4/6, Average Loss=0.5546147227287292, Class Loss=0.243296816945076, Reg Loss=0.31131792068481445
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.2384989708662033, Reg Loss=0.3057976961135864
Clinet index 22, End of Epoch 5/6, Average Loss=0.5442966818809509, Class Loss=0.2384989708662033, Reg Loss=0.3057976961135864
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.2250375896692276, Reg Loss=0.311832994222641
Clinet index 22, End of Epoch 6/6, Average Loss=0.5368705987930298, Class Loss=0.2250375896692276, Reg Loss=0.311832994222641
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.3019903004169464, Reg Loss=0.30504468083381653
Clinet index 5, End of Epoch 1/6, Average Loss=0.6070349812507629, Class Loss=0.3019903004169464, Reg Loss=0.30504468083381653
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.29313188791275024, Reg Loss=0.301990270614624
Clinet index 5, End of Epoch 2/6, Average Loss=0.5951221585273743, Class Loss=0.29313188791275024, Reg Loss=0.301990270614624
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2862793803215027, Reg Loss=0.3028561770915985
Clinet index 5, End of Epoch 3/6, Average Loss=0.5891355276107788, Class Loss=0.2862793803215027, Reg Loss=0.3028561770915985
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.2691866159439087, Reg Loss=0.3061685264110565
Clinet index 5, End of Epoch 4/6, Average Loss=0.5753551721572876, Class Loss=0.2691866159439087, Reg Loss=0.3061685264110565
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.2535102963447571, Reg Loss=0.3030157685279846
Clinet index 5, End of Epoch 5/6, Average Loss=0.5565260648727417, Class Loss=0.2535102963447571, Reg Loss=0.3030157685279846
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.24490006268024445, Reg Loss=0.2961364686489105
Clinet index 5, End of Epoch 6/6, Average Loss=0.5410365462303162, Class Loss=0.24490006268024445, Reg Loss=0.2961364686489105
federated aggregation...
Validation, Class Loss=0.7223895192146301, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.810766
Mean Acc: 0.444202
FreqW Acc: 0.731761
Mean IoU: 0.376016
Class IoU:
	class 0: 0.85933155
	class 1: 0.17806281
	class 2: 0.35758364
	class 3: 0.44191015
	class 4: 0.24860223
	class 5: 0.43138897
	class 6: 0.3218319
	class 7: 0.6278263
	class 8: 0.6138487
	class 9: 0.119813845
	class 10: 0.4387407
	class 11: 0.30163556
	class 12: 0.544575
	class 13: 0.43763244
	class 14: 0.4942099
	class 15: 0.7516688
	class 16: 0.00015119507
	class 17: 0.06847968
	class 18: 0.0964444
	class 19: 0.18658082
Class Acc:
	class 0: 0.9425978
	class 1: 0.17808513
	class 2: 0.51264554
	class 3: 0.44335574
	class 4: 0.2499841
	class 5: 0.43817857
	class 6: 0.3228585
	class 7: 0.63721514
	class 8: 0.61628467
	class 9: 0.14769068
	class 10: 0.46841952
	class 11: 0.32377937
	class 12: 0.5702688
	class 13: 0.44761062
	class 14: 0.50683695
	class 15: 0.76838
	class 16: 0.00015143983
	class 17: 0.12015394
	class 18: 0.27040735
	class 19: 0.91913694

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23321309685707092, Reg Loss=0.3100898265838623
Clinet index 3, End of Epoch 1/6, Average Loss=0.5433028936386108, Class Loss=0.23321309685707092, Reg Loss=0.3100898265838623
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.23311777412891388, Reg Loss=0.31418806314468384
Clinet index 3, End of Epoch 2/6, Average Loss=0.5473058223724365, Class Loss=0.23311777412891388, Reg Loss=0.31418806314468384
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.214729443192482, Reg Loss=0.31005239486694336
Clinet index 3, End of Epoch 3/6, Average Loss=0.5247818231582642, Class Loss=0.214729443192482, Reg Loss=0.31005239486694336
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.22922161221504211, Reg Loss=0.3142958879470825
Clinet index 3, End of Epoch 4/6, Average Loss=0.5435174703598022, Class Loss=0.22922161221504211, Reg Loss=0.3142958879470825
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20534883439540863, Reg Loss=0.31765216588974
Clinet index 3, End of Epoch 5/6, Average Loss=0.5230010151863098, Class Loss=0.20534883439540863, Reg Loss=0.31765216588974
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2009117305278778, Reg Loss=0.3151622712612152
Clinet index 3, End of Epoch 6/6, Average Loss=0.516074001789093, Class Loss=0.2009117305278778, Reg Loss=0.3151622712612152
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.24606910347938538, Reg Loss=0.3083505928516388
Clinet index 19, End of Epoch 1/6, Average Loss=0.5544196963310242, Class Loss=0.24606910347938538, Reg Loss=0.3083505928516388
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.22463169693946838, Reg Loss=0.3064424991607666
Clinet index 19, End of Epoch 2/6, Average Loss=0.5310741662979126, Class Loss=0.22463169693946838, Reg Loss=0.3064424991607666
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.21561524271965027, Reg Loss=0.3081818222999573
Clinet index 19, End of Epoch 3/6, Average Loss=0.5237970352172852, Class Loss=0.21561524271965027, Reg Loss=0.3081818222999573
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.21276110410690308, Reg Loss=0.3049685060977936
Clinet index 19, End of Epoch 4/6, Average Loss=0.517729640007019, Class Loss=0.21276110410690308, Reg Loss=0.3049685060977936
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.2041000872850418, Reg Loss=0.3065374493598938
Clinet index 19, End of Epoch 5/6, Average Loss=0.5106375217437744, Class Loss=0.2041000872850418, Reg Loss=0.3065374493598938
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.19956296682357788, Reg Loss=0.3035431206226349
Clinet index 19, End of Epoch 6/6, Average Loss=0.5031061172485352, Class Loss=0.19956296682357788, Reg Loss=0.3035431206226349
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23616448044776917, Reg Loss=0.31195273995399475
Clinet index 1, End of Epoch 1/6, Average Loss=0.5481172204017639, Class Loss=0.23616448044776917, Reg Loss=0.31195273995399475
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.23114505410194397, Reg Loss=0.309947669506073
Clinet index 1, End of Epoch 2/6, Average Loss=0.5410927534103394, Class Loss=0.23114505410194397, Reg Loss=0.309947669506073
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.22476013004779816, Reg Loss=0.3077404797077179
Clinet index 1, End of Epoch 3/6, Average Loss=0.5325006246566772, Class Loss=0.22476013004779816, Reg Loss=0.3077404797077179
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.20769727230072021, Reg Loss=0.31484168767929077
Clinet index 1, End of Epoch 4/6, Average Loss=0.522538959980011, Class Loss=0.20769727230072021, Reg Loss=0.31484168767929077
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20545360445976257, Reg Loss=0.30790823698043823
Clinet index 1, End of Epoch 5/6, Average Loss=0.5133618116378784, Class Loss=0.20545360445976257, Reg Loss=0.30790823698043823
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1995820254087448, Reg Loss=0.3199896812438965
Clinet index 1, End of Epoch 6/6, Average Loss=0.5195717215538025, Class Loss=0.1995820254087448, Reg Loss=0.3199896812438965
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23082312941551208, Reg Loss=0.31698036193847656
Clinet index 11, End of Epoch 1/6, Average Loss=0.547803521156311, Class Loss=0.23082312941551208, Reg Loss=0.31698036193847656
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.23212072253227234, Reg Loss=0.31540343165397644
Clinet index 11, End of Epoch 2/6, Average Loss=0.5475241541862488, Class Loss=0.23212072253227234, Reg Loss=0.31540343165397644
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2149994671344757, Reg Loss=0.31466981768608093
Clinet index 11, End of Epoch 3/6, Average Loss=0.5296692848205566, Class Loss=0.2149994671344757, Reg Loss=0.31466981768608093
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2079460769891739, Reg Loss=0.3107015788555145
Clinet index 11, End of Epoch 4/6, Average Loss=0.5186476707458496, Class Loss=0.2079460769891739, Reg Loss=0.3107015788555145
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20266294479370117, Reg Loss=0.309542715549469
Clinet index 11, End of Epoch 5/6, Average Loss=0.5122056603431702, Class Loss=0.20266294479370117, Reg Loss=0.309542715549469
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.19866205751895905, Reg Loss=0.30700820684432983
Clinet index 11, End of Epoch 6/6, Average Loss=0.5056702494621277, Class Loss=0.19866205751895905, Reg Loss=0.30700820684432983
federated aggregation...
Validation, Class Loss=0.709338903427124, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.807869
Mean Acc: 0.437324
FreqW Acc: 0.730813
Mean IoU: 0.368818
Class IoU:
	class 0: 0.8615471
	class 1: 0.15114366
	class 2: 0.35508928
	class 3: 0.44789296
	class 4: 0.25559545
	class 5: 0.4136803
	class 6: 0.2281807
	class 7: 0.6089184
	class 8: 0.6060976
	class 9: 0.114643104
	class 10: 0.43910554
	class 11: 0.30147898
	class 12: 0.54348487
	class 13: 0.4522975
	class 14: 0.48247394
	class 15: 0.7603746
	class 16: 0.0
	class 17: 0.08019071
	class 18: 0.094338134
	class 19: 0.17982309
Class Acc:
	class 0: 0.94142336
	class 1: 0.15116075
	class 2: 0.5007415
	class 3: 0.4492184
	class 4: 0.2569447
	class 5: 0.41989598
	class 6: 0.22847642
	class 7: 0.6147082
	class 8: 0.60813165
	class 9: 0.13472779
	class 10: 0.4671289
	class 11: 0.32267544
	class 12: 0.5694432
	class 13: 0.46294785
	class 14: 0.49486914
	class 15: 0.7780226
	class 16: 0.0
	class 17: 0.14017212
	class 18: 0.27385685
	class 19: 0.9319302

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20179732143878937, Reg Loss=0.3015257716178894
Clinet index 4, End of Epoch 1/6, Average Loss=0.5033230781555176, Class Loss=0.20179732143878937, Reg Loss=0.3015257716178894
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1897447258234024, Reg Loss=0.2955854535102844
Clinet index 4, End of Epoch 2/6, Average Loss=0.48533016443252563, Class Loss=0.1897447258234024, Reg Loss=0.2955854535102844
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.18017087876796722, Reg Loss=0.29874375462532043
Clinet index 4, End of Epoch 3/6, Average Loss=0.47891461849212646, Class Loss=0.18017087876796722, Reg Loss=0.29874375462532043
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.1846104860305786, Reg Loss=0.2918485403060913
Clinet index 4, End of Epoch 4/6, Average Loss=0.4764590263366699, Class Loss=0.1846104860305786, Reg Loss=0.2918485403060913
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.19199612736701965, Reg Loss=0.3012672960758209
Clinet index 4, End of Epoch 5/6, Average Loss=0.4932634234428406, Class Loss=0.19199612736701965, Reg Loss=0.3012672960758209
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1839853823184967, Reg Loss=0.2917007803916931
Clinet index 4, End of Epoch 6/6, Average Loss=0.4756861627101898, Class Loss=0.1839853823184967, Reg Loss=0.2917007803916931
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20124095678329468, Reg Loss=0.3081127107143402
Clinet index 13, End of Epoch 1/6, Average Loss=0.5093536376953125, Class Loss=0.20124095678329468, Reg Loss=0.3081127107143402
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19169726967811584, Reg Loss=0.30086106061935425
Clinet index 13, End of Epoch 2/6, Average Loss=0.4925583302974701, Class Loss=0.19169726967811584, Reg Loss=0.30086106061935425
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19041982293128967, Reg Loss=0.29968395829200745
Clinet index 13, End of Epoch 3/6, Average Loss=0.4901037812232971, Class Loss=0.19041982293128967, Reg Loss=0.29968395829200745
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18600575625896454, Reg Loss=0.3036620616912842
Clinet index 13, End of Epoch 4/6, Average Loss=0.4896678328514099, Class Loss=0.18600575625896454, Reg Loss=0.3036620616912842
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.18347328901290894, Reg Loss=0.30214157700538635
Clinet index 13, End of Epoch 5/6, Average Loss=0.4856148660182953, Class Loss=0.18347328901290894, Reg Loss=0.30214157700538635
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.18124376237392426, Reg Loss=0.3058386445045471
Clinet index 13, End of Epoch 6/6, Average Loss=0.48708242177963257, Class Loss=0.18124376237392426, Reg Loss=0.3058386445045471
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.198288232088089, Reg Loss=0.30486631393432617
Clinet index 18, End of Epoch 1/6, Average Loss=0.5031545162200928, Class Loss=0.198288232088089, Reg Loss=0.30486631393432617
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19539940357208252, Reg Loss=0.2971550226211548
Clinet index 18, End of Epoch 2/6, Average Loss=0.4925544261932373, Class Loss=0.19539940357208252, Reg Loss=0.2971550226211548
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19926922023296356, Reg Loss=0.29993951320648193
Clinet index 18, End of Epoch 3/6, Average Loss=0.4992087483406067, Class Loss=0.19926922023296356, Reg Loss=0.29993951320648193
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.19581808149814606, Reg Loss=0.2939969301223755
Clinet index 18, End of Epoch 4/6, Average Loss=0.48981499671936035, Class Loss=0.19581808149814606, Reg Loss=0.2939969301223755
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.18240122497081757, Reg Loss=0.3047788143157959
Clinet index 18, End of Epoch 5/6, Average Loss=0.48718005418777466, Class Loss=0.18240122497081757, Reg Loss=0.3047788143157959
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1829352080821991, Reg Loss=0.29608333110809326
Clinet index 18, End of Epoch 6/6, Average Loss=0.47901853919029236, Class Loss=0.1829352080821991, Reg Loss=0.29608333110809326
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.2036430537700653, Reg Loss=0.3295878469944
Clinet index 9, End of Epoch 1/6, Average Loss=0.5332309007644653, Class Loss=0.2036430537700653, Reg Loss=0.3295878469944
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.20324020087718964, Reg Loss=0.3284311294555664
Clinet index 9, End of Epoch 2/6, Average Loss=0.5316713452339172, Class Loss=0.20324020087718964, Reg Loss=0.3284311294555664
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.1945286989212036, Reg Loss=0.3262971341609955
Clinet index 9, End of Epoch 3/6, Average Loss=0.5208258628845215, Class Loss=0.1945286989212036, Reg Loss=0.3262971341609955
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.19202673435211182, Reg Loss=0.3202761709690094
Clinet index 9, End of Epoch 4/6, Average Loss=0.5123028755187988, Class Loss=0.19202673435211182, Reg Loss=0.3202761709690094
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.18324947357177734, Reg Loss=0.3152989149093628
Clinet index 9, End of Epoch 5/6, Average Loss=0.49854838848114014, Class Loss=0.18324947357177734, Reg Loss=0.3152989149093628
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.1942611038684845, Reg Loss=0.3272847831249237
Clinet index 9, End of Epoch 6/6, Average Loss=0.5215458869934082, Class Loss=0.1942611038684845, Reg Loss=0.3272847831249237
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=0.7017725706100464, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.810308
Mean Acc: 0.436194
FreqW Acc: 0.730331
Mean IoU: 0.368227
Class IoU:
	class 0: 0.8614265
	class 1: 0.15098637
	class 2: 0.34832245
	class 3: 0.43162242
	class 4: 0.2648207
	class 5: 0.41223556
	class 6: 0.22652332
	class 7: 0.613965
	class 8: 0.59492606
	class 9: 0.103634536
	class 10: 0.46571195
	class 11: 0.29580644
	class 12: 0.5277944
	class 13: 0.4519481
	class 14: 0.47881585
	class 15: 0.7593793
	class 16: 0.0
	class 17: 0.095424876
	class 18: 0.08534827
	class 19: 0.1958387
Class Acc:
	class 0: 0.9460761
	class 1: 0.15101103
	class 2: 0.48609158
	class 3: 0.43284133
	class 4: 0.26642773
	class 5: 0.41809896
	class 6: 0.22684766
	class 7: 0.6197978
	class 8: 0.597102
	class 9: 0.119649105
	class 10: 0.4966795
	class 11: 0.316627
	class 12: 0.54972506
	class 13: 0.46272308
	class 14: 0.49101654
	class 15: 0.77703965
	class 16: 0.0
	class 17: 0.17793304
	class 18: 0.2553372
	class 19: 0.93284786

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6117818355560303, Reg Loss=0.42398911714553833
Clinet index 29, End of Epoch 1/6, Average Loss=1.0357708930969238, Class Loss=0.6117818355560303, Reg Loss=0.42398911714553833
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.497710645198822, Reg Loss=0.3922843337059021
Clinet index 29, End of Epoch 2/6, Average Loss=0.8899949789047241, Class Loss=0.497710645198822, Reg Loss=0.3922843337059021
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.43934959173202515, Reg Loss=0.3828686773777008
Clinet index 29, End of Epoch 3/6, Average Loss=0.8222182989120483, Class Loss=0.43934959173202515, Reg Loss=0.3828686773777008
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4212956428527832, Reg Loss=0.37873169779777527
Clinet index 29, End of Epoch 4/6, Average Loss=0.8000273704528809, Class Loss=0.4212956428527832, Reg Loss=0.37873169779777527
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.41215071082115173, Reg Loss=0.3779747486114502
Clinet index 29, End of Epoch 5/6, Average Loss=0.7901254892349243, Class Loss=0.41215071082115173, Reg Loss=0.3779747486114502
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.40485233068466187, Reg Loss=0.37022125720977783
Clinet index 29, End of Epoch 6/6, Average Loss=0.7750735878944397, Class Loss=0.40485233068466187, Reg Loss=0.37022125720977783
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6161481738090515, Reg Loss=0.429216206073761
Clinet index 3, End of Epoch 1/6, Average Loss=1.0453643798828125, Class Loss=0.6161481738090515, Reg Loss=0.429216206073761
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.515247642993927, Reg Loss=0.40198424458503723
Clinet index 3, End of Epoch 2/6, Average Loss=0.9172319173812866, Class Loss=0.515247642993927, Reg Loss=0.40198424458503723
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.45120659470558167, Reg Loss=0.38939422369003296
Clinet index 3, End of Epoch 3/6, Average Loss=0.840600848197937, Class Loss=0.45120659470558167, Reg Loss=0.38939422369003296
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.41872119903564453, Reg Loss=0.3807843327522278
Clinet index 3, End of Epoch 4/6, Average Loss=0.7995055317878723, Class Loss=0.41872119903564453, Reg Loss=0.3807843327522278
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4180988669395447, Reg Loss=0.38051217794418335
Clinet index 3, End of Epoch 5/6, Average Loss=0.798611044883728, Class Loss=0.4180988669395447, Reg Loss=0.38051217794418335
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4056685268878937, Reg Loss=0.37656012177467346
Clinet index 3, End of Epoch 6/6, Average Loss=0.7822286486625671, Class Loss=0.4056685268878937, Reg Loss=0.37656012177467346
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6642768979072571, Reg Loss=0.4165249466896057
Clinet index 8, End of Epoch 1/6, Average Loss=1.0808018445968628, Class Loss=0.6642768979072571, Reg Loss=0.4165249466896057
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5215166807174683, Reg Loss=0.3942517042160034
Clinet index 8, End of Epoch 2/6, Average Loss=0.9157683849334717, Class Loss=0.5215166807174683, Reg Loss=0.3942517042160034
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.46285173296928406, Reg Loss=0.3876611888408661
Clinet index 8, End of Epoch 3/6, Average Loss=0.8505129218101501, Class Loss=0.46285173296928406, Reg Loss=0.3876611888408661
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.44002771377563477, Reg Loss=0.38986119627952576
Clinet index 8, End of Epoch 4/6, Average Loss=0.8298889398574829, Class Loss=0.44002771377563477, Reg Loss=0.38986119627952576
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4235306680202484, Reg Loss=0.3813159763813019
Clinet index 8, End of Epoch 5/6, Average Loss=0.8048466444015503, Class Loss=0.4235306680202484, Reg Loss=0.3813159763813019
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4149758815765381, Reg Loss=0.38369321823120117
Clinet index 8, End of Epoch 6/6, Average Loss=0.7986690998077393, Class Loss=0.4149758815765381, Reg Loss=0.38369321823120117
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6528046131134033, Reg Loss=0.4252663254737854
Clinet index 19, End of Epoch 1/6, Average Loss=1.078070878982544, Class Loss=0.6528046131134033, Reg Loss=0.4252663254737854
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5386651158332825, Reg Loss=0.39468640089035034
Clinet index 19, End of Epoch 2/6, Average Loss=0.9333515167236328, Class Loss=0.5386651158332825, Reg Loss=0.39468640089035034
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.46924182772636414, Reg Loss=0.3872108459472656
Clinet index 19, End of Epoch 3/6, Average Loss=0.8564527034759521, Class Loss=0.46924182772636414, Reg Loss=0.3872108459472656
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.446584552526474, Reg Loss=0.379194974899292
Clinet index 19, End of Epoch 4/6, Average Loss=0.8257795572280884, Class Loss=0.446584552526474, Reg Loss=0.379194974899292
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.43612217903137207, Reg Loss=0.3814554810523987
Clinet index 19, End of Epoch 5/6, Average Loss=0.8175776600837708, Class Loss=0.43612217903137207, Reg Loss=0.3814554810523987
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4189041256904602, Reg Loss=0.37141045928001404
Clinet index 19, End of Epoch 6/6, Average Loss=0.7903145551681519, Class Loss=0.4189041256904602, Reg Loss=0.37141045928001404
federated aggregation...
Validation, Class Loss=0.8729354739189148, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.799622
Mean Acc: 0.344595
FreqW Acc: 0.694695
Mean IoU: 0.297548
Class IoU:
	class 0: 0.8388156
	class 1: 0.10258625
	class 2: 0.31977022
	class 3: 0.2516542
	class 4: 0.1506393
	class 5: 0.39738026
	class 6: 0.078342065
	class 7: 0.39844427
	class 8: 0.58120877
	class 9: 0.11939227
	class 10: 0.35235712
	class 11: 0.2377335
	class 12: 0.48052505
	class 13: 0.41676876
	class 14: 0.42937332
	class 15: 0.76525396
	class 16: 0.0
	class 17: 0.08168205
	class 18: 0.09678893
	class 19: 0.1497956
	class 20: 0.0
Class Acc:
	class 0: 0.97067535
	class 1: 0.102609254
	class 2: 0.4051991
	class 3: 0.2527898
	class 4: 0.1508171
	class 5: 0.40616095
	class 6: 0.078360856
	class 7: 0.40014192
	class 8: 0.5837785
	class 9: 0.13302892
	class 10: 0.3638325
	class 11: 0.24580352
	class 12: 0.50398517
	class 13: 0.4263012
	class 14: 0.44663402
	class 15: 0.78074336
	class 16: 0.0
	class 17: 0.17529817
	class 18: 0.16076247
	class 19: 0.6495634
	class 20: 0.0

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.41836032271385193, Reg Loss=0.3760380148887634
Clinet index 4, End of Epoch 1/6, Average Loss=0.794398307800293, Class Loss=0.41836032271385193, Reg Loss=0.3760380148887634
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4118245244026184, Reg Loss=0.3743850588798523
Clinet index 4, End of Epoch 2/6, Average Loss=0.7862095832824707, Class Loss=0.4118245244026184, Reg Loss=0.3743850588798523
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3979170620441437, Reg Loss=0.3687557578086853
Clinet index 4, End of Epoch 3/6, Average Loss=0.7666728496551514, Class Loss=0.3979170620441437, Reg Loss=0.3687557578086853
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3851105272769928, Reg Loss=0.3609054386615753
Clinet index 4, End of Epoch 4/6, Average Loss=0.7460159659385681, Class Loss=0.3851105272769928, Reg Loss=0.3609054386615753
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.37811875343322754, Reg Loss=0.3622571527957916
Clinet index 4, End of Epoch 5/6, Average Loss=0.7403758764266968, Class Loss=0.37811875343322754, Reg Loss=0.3622571527957916
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.37739846110343933, Reg Loss=0.36355867981910706
Clinet index 4, End of Epoch 6/6, Average Loss=0.7409571409225464, Class Loss=0.37739846110343933, Reg Loss=0.36355867981910706
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.38877204060554504, Reg Loss=0.3729906976222992
Clinet index 0, End of Epoch 1/6, Average Loss=0.7617627382278442, Class Loss=0.38877204060554504, Reg Loss=0.3729906976222992
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.37913763523101807, Reg Loss=0.3693457245826721
Clinet index 0, End of Epoch 2/6, Average Loss=0.7484833598136902, Class Loss=0.37913763523101807, Reg Loss=0.3693457245826721
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3712853193283081, Reg Loss=0.3699309527873993
Clinet index 0, End of Epoch 3/6, Average Loss=0.7412163019180298, Class Loss=0.3712853193283081, Reg Loss=0.3699309527873993
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.36035269498825073, Reg Loss=0.3673690855503082
Clinet index 0, End of Epoch 4/6, Average Loss=0.7277218103408813, Class Loss=0.36035269498825073, Reg Loss=0.3673690855503082
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.34527161717414856, Reg Loss=0.362332284450531
Clinet index 0, End of Epoch 5/6, Average Loss=0.707603931427002, Class Loss=0.34527161717414856, Reg Loss=0.362332284450531
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.3478168845176697, Reg Loss=0.3621145486831665
Clinet index 0, End of Epoch 6/6, Average Loss=0.7099314332008362, Class Loss=0.3478168845176697, Reg Loss=0.3621145486831665
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.40285825729370117, Reg Loss=0.36937347054481506
Clinet index 29, End of Epoch 1/6, Average Loss=0.7722316980361938, Class Loss=0.40285825729370117, Reg Loss=0.36937347054481506
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.39250460267066956, Reg Loss=0.372963011264801
Clinet index 29, End of Epoch 2/6, Average Loss=0.765467643737793, Class Loss=0.39250460267066956, Reg Loss=0.372963011264801
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.39257216453552246, Reg Loss=0.3627949059009552
Clinet index 29, End of Epoch 3/6, Average Loss=0.7553670406341553, Class Loss=0.39257216453552246, Reg Loss=0.3627949059009552
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.37720370292663574, Reg Loss=0.3647877871990204
Clinet index 29, End of Epoch 4/6, Average Loss=0.7419915199279785, Class Loss=0.37720370292663574, Reg Loss=0.3647877871990204
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3714110851287842, Reg Loss=0.35963907837867737
Clinet index 29, End of Epoch 5/6, Average Loss=0.7310501337051392, Class Loss=0.3714110851287842, Reg Loss=0.35963907837867737
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.36646634340286255, Reg Loss=0.3564552366733551
Clinet index 29, End of Epoch 6/6, Average Loss=0.72292160987854, Class Loss=0.36646634340286255, Reg Loss=0.3564552366733551
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.41049519181251526, Reg Loss=0.37163659930229187
Clinet index 20, End of Epoch 1/6, Average Loss=0.7821317911148071, Class Loss=0.41049519181251526, Reg Loss=0.37163659930229187
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.39617207646369934, Reg Loss=0.3663558065891266
Clinet index 20, End of Epoch 2/6, Average Loss=0.7625278830528259, Class Loss=0.39617207646369934, Reg Loss=0.3663558065891266
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3984676003456116, Reg Loss=0.36225607991218567
Clinet index 20, End of Epoch 3/6, Average Loss=0.7607237100601196, Class Loss=0.3984676003456116, Reg Loss=0.36225607991218567
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.37605684995651245, Reg Loss=0.3554219603538513
Clinet index 20, End of Epoch 4/6, Average Loss=0.7314788103103638, Class Loss=0.37605684995651245, Reg Loss=0.3554219603538513
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3814903497695923, Reg Loss=0.3614421784877777
Clinet index 20, End of Epoch 5/6, Average Loss=0.7429325580596924, Class Loss=0.3814903497695923, Reg Loss=0.3614421784877777
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.36515310406684875, Reg Loss=0.35903385281562805
Clinet index 20, End of Epoch 6/6, Average Loss=0.7241869568824768, Class Loss=0.36515310406684875, Reg Loss=0.35903385281562805
federated aggregation...
Validation, Class Loss=0.833167552947998, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.803985
Mean Acc: 0.371741
FreqW Acc: 0.707379
Mean IoU: 0.320726
Class IoU:
	class 0: 0.8471649
	class 1: 0.1274732
	class 2: 0.3222186
	class 3: 0.3487044
	class 4: 0.16537012
	class 5: 0.41232893
	class 6: 0.07486592
	class 7: 0.40681806
	class 8: 0.6421515
	class 9: 0.1079672
	class 10: 0.37310416
	class 11: 0.2653491
	class 12: 0.52899414
	class 13: 0.4456565
	class 14: 0.47649196
	class 15: 0.7684476
	class 16: 0.0
	class 17: 0.07351878
	class 18: 0.084575795
	class 19: 0.1509005
	class 20: 0.11313569
Class Acc:
	class 0: 0.9648116
	class 1: 0.12750472
	class 2: 0.41803926
	class 3: 0.35071412
	class 4: 0.16565882
	class 5: 0.42140582
	class 6: 0.07489396
	class 7: 0.4085657
	class 8: 0.64567095
	class 9: 0.12082305
	class 10: 0.387003
	class 11: 0.27367917
	class 12: 0.55235606
	class 13: 0.45644757
	class 14: 0.49732268
	class 15: 0.7844423
	class 16: 0.0
	class 17: 0.13532442
	class 18: 0.13160613
	class 19: 0.7169169
	class 20: 0.17336704

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.395529568195343, Reg Loss=0.3699552118778229
Clinet index 13, End of Epoch 1/6, Average Loss=0.7654848098754883, Class Loss=0.395529568195343, Reg Loss=0.3699552118778229
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3840080499649048, Reg Loss=0.36764827370643616
Clinet index 13, End of Epoch 2/6, Average Loss=0.7516562938690186, Class Loss=0.3840080499649048, Reg Loss=0.36764827370643616
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3689350187778473, Reg Loss=0.36836758255958557
Clinet index 13, End of Epoch 3/6, Average Loss=0.7373026013374329, Class Loss=0.3689350187778473, Reg Loss=0.36836758255958557
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3544970452785492, Reg Loss=0.36458316445350647
Clinet index 13, End of Epoch 4/6, Average Loss=0.7190802097320557, Class Loss=0.3544970452785492, Reg Loss=0.36458316445350647
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3601128160953522, Reg Loss=0.3661050796508789
Clinet index 13, End of Epoch 5/6, Average Loss=0.7262178659439087, Class Loss=0.3601128160953522, Reg Loss=0.3661050796508789
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3525628447532654, Reg Loss=0.3662363588809967
Clinet index 13, End of Epoch 6/6, Average Loss=0.7187992334365845, Class Loss=0.3525628447532654, Reg Loss=0.3662363588809967
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.37185004353523254, Reg Loss=0.3666057288646698
Clinet index 12, End of Epoch 1/6, Average Loss=0.7384557723999023, Class Loss=0.37185004353523254, Reg Loss=0.3666057288646698
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.36840319633483887, Reg Loss=0.36703822016716003
Clinet index 12, End of Epoch 2/6, Average Loss=0.7354414463043213, Class Loss=0.36840319633483887, Reg Loss=0.36703822016716003
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.34591659903526306, Reg Loss=0.36829203367233276
Clinet index 12, End of Epoch 3/6, Average Loss=0.7142086029052734, Class Loss=0.34591659903526306, Reg Loss=0.36829203367233276
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3395160436630249, Reg Loss=0.36691057682037354
Clinet index 12, End of Epoch 4/6, Average Loss=0.7064266204833984, Class Loss=0.3395160436630249, Reg Loss=0.36691057682037354
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.33336469531059265, Reg Loss=0.37145552039146423
Clinet index 12, End of Epoch 5/6, Average Loss=0.7048202157020569, Class Loss=0.33336469531059265, Reg Loss=0.37145552039146423
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.32336369156837463, Reg Loss=0.37101122736930847
Clinet index 12, End of Epoch 6/6, Average Loss=0.6943749189376831, Class Loss=0.32336369156837463, Reg Loss=0.37101122736930847
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.365143746137619, Reg Loss=0.36235302686691284
Clinet index 20, End of Epoch 1/6, Average Loss=0.7274967432022095, Class Loss=0.365143746137619, Reg Loss=0.36235302686691284
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.36197540163993835, Reg Loss=0.3581460416316986
Clinet index 20, End of Epoch 2/6, Average Loss=0.720121443271637, Class Loss=0.36197540163993835, Reg Loss=0.3581460416316986
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.35803651809692383, Reg Loss=0.3603993058204651
Clinet index 20, End of Epoch 3/6, Average Loss=0.7184358239173889, Class Loss=0.35803651809692383, Reg Loss=0.3603993058204651
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.3439296782016754, Reg Loss=0.3577735424041748
Clinet index 20, End of Epoch 4/6, Average Loss=0.7017031908035278, Class Loss=0.3439296782016754, Reg Loss=0.3577735424041748
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.3397385776042938, Reg Loss=0.35356268286705017
Clinet index 20, End of Epoch 5/6, Average Loss=0.693301260471344, Class Loss=0.3397385776042938, Reg Loss=0.35356268286705017
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.328927218914032, Reg Loss=0.36004361510276794
Clinet index 20, End of Epoch 6/6, Average Loss=0.6889708042144775, Class Loss=0.328927218914032, Reg Loss=0.36004361510276794
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3446316421031952, Reg Loss=0.36357608437538147
Clinet index 15, End of Epoch 1/6, Average Loss=0.7082077264785767, Class Loss=0.3446316421031952, Reg Loss=0.36357608437538147
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3459095060825348, Reg Loss=0.3556984066963196
Clinet index 15, End of Epoch 2/6, Average Loss=0.7016079425811768, Class Loss=0.3459095060825348, Reg Loss=0.3556984066963196
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.33600690960884094, Reg Loss=0.35824745893478394
Clinet index 15, End of Epoch 3/6, Average Loss=0.6942543983459473, Class Loss=0.33600690960884094, Reg Loss=0.35824745893478394
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3339340388774872, Reg Loss=0.36218592524528503
Clinet index 15, End of Epoch 4/6, Average Loss=0.6961199641227722, Class Loss=0.3339340388774872, Reg Loss=0.36218592524528503
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3257782757282257, Reg Loss=0.3688211441040039
Clinet index 15, End of Epoch 5/6, Average Loss=0.6945993900299072, Class Loss=0.3257782757282257, Reg Loss=0.3688211441040039
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.31183061003685, Reg Loss=0.3657582700252533
Clinet index 15, End of Epoch 6/6, Average Loss=0.6775888800621033, Class Loss=0.31183061003685, Reg Loss=0.3657582700252533
federated aggregation...
Validation, Class Loss=0.8227137327194214, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.800866
Mean Acc: 0.384377
FreqW Acc: 0.710060
Mean IoU: 0.323701
Class IoU:
	class 0: 0.84941053
	class 1: 0.1367891
	class 2: 0.3153785
	class 3: 0.34730268
	class 4: 0.17215921
	class 5: 0.40407708
	class 6: 0.076156415
	class 7: 0.41666344
	class 8: 0.63699836
	class 9: 0.10387671
	class 10: 0.39456213
	class 11: 0.27081335
	class 12: 0.534829
	class 13: 0.45194712
	class 14: 0.48151875
	class 15: 0.7740228
	class 16: 0.0
	class 17: 0.066158615
	class 18: 0.081209935
	class 19: 0.15471788
	class 20: 0.1291208
Class Acc:
	class 0: 0.9553623
	class 1: 0.13682464
	class 2: 0.40986717
	class 3: 0.3483089
	class 4: 0.17249432
	class 5: 0.41207117
	class 6: 0.07619811
	class 7: 0.41851816
	class 8: 0.64036286
	class 9: 0.11579778
	class 10: 0.41046074
	class 11: 0.27860063
	class 12: 0.5644602
	class 13: 0.46211272
	class 14: 0.50190717
	class 15: 0.79120016
	class 16: 0.0
	class 17: 0.11124811
	class 18: 0.12734139
	class 19: 0.7512364
	class 20: 0.38755226

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3371981084346771, Reg Loss=0.3730325698852539
Clinet index 6, End of Epoch 1/6, Average Loss=0.7102307081222534, Class Loss=0.3371981084346771, Reg Loss=0.3730325698852539
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.33814823627471924, Reg Loss=0.37711861729621887
Clinet index 6, End of Epoch 2/6, Average Loss=0.7152668237686157, Class Loss=0.33814823627471924, Reg Loss=0.37711861729621887
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.32913005352020264, Reg Loss=0.3667447566986084
Clinet index 6, End of Epoch 3/6, Average Loss=0.695874810218811, Class Loss=0.32913005352020264, Reg Loss=0.3667447566986084
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.318499892950058, Reg Loss=0.3725537955760956
Clinet index 6, End of Epoch 4/6, Average Loss=0.6910536885261536, Class Loss=0.318499892950058, Reg Loss=0.3725537955760956
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.31653547286987305, Reg Loss=0.36780205368995667
Clinet index 6, End of Epoch 5/6, Average Loss=0.6843374967575073, Class Loss=0.31653547286987305, Reg Loss=0.36780205368995667
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.31362080574035645, Reg Loss=0.36941447854042053
Clinet index 6, End of Epoch 6/6, Average Loss=0.6830352544784546, Class Loss=0.31362080574035645, Reg Loss=0.36941447854042053
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.32222574949264526, Reg Loss=0.35583481192588806
Clinet index 29, End of Epoch 1/6, Average Loss=0.6780605316162109, Class Loss=0.32222574949264526, Reg Loss=0.35583481192588806
Pseudo labeling is: None
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.3249777853488922, Reg Loss=0.3591819405555725
Clinet index 29, End of Epoch 2/6, Average Loss=0.6841597557067871, Class Loss=0.3249777853488922, Reg Loss=0.3591819405555725
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.31963905692100525, Reg Loss=0.35620275139808655
Clinet index 29, End of Epoch 3/6, Average Loss=0.6758418083190918, Class Loss=0.31963905692100525, Reg Loss=0.35620275139808655
Pseudo labeling is: None
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.3050630986690521, Reg Loss=0.35266244411468506
Clinet index 29, End of Epoch 4/6, Average Loss=0.6577255725860596, Class Loss=0.3050630986690521, Reg Loss=0.35266244411468506
Pseudo labeling is: None
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.30058228969573975, Reg Loss=0.3534919321537018
Clinet index 29, End of Epoch 5/6, Average Loss=0.6540741920471191, Class Loss=0.30058228969573975, Reg Loss=0.3534919321537018
Pseudo labeling is: None
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.3007729649543762, Reg Loss=0.35789209604263306
Clinet index 29, End of Epoch 6/6, Average Loss=0.6586650609970093, Class Loss=0.3007729649543762, Reg Loss=0.35789209604263306
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.35292717814445496, Reg Loss=0.36159443855285645
Clinet index 13, End of Epoch 1/6, Average Loss=0.7145216464996338, Class Loss=0.35292717814445496, Reg Loss=0.36159443855285645
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.3500065803527832, Reg Loss=0.3668961226940155
Clinet index 13, End of Epoch 2/6, Average Loss=0.7169027328491211, Class Loss=0.3500065803527832, Reg Loss=0.3668961226940155
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.33994707465171814, Reg Loss=0.36480966210365295
Clinet index 13, End of Epoch 3/6, Average Loss=0.7047567367553711, Class Loss=0.33994707465171814, Reg Loss=0.36480966210365295
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.32612791657447815, Reg Loss=0.3637794554233551
Clinet index 13, End of Epoch 4/6, Average Loss=0.6899073719978333, Class Loss=0.32612791657447815, Reg Loss=0.3637794554233551
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.33212190866470337, Reg Loss=0.36330634355545044
Clinet index 13, End of Epoch 5/6, Average Loss=0.6954282522201538, Class Loss=0.33212190866470337, Reg Loss=0.36330634355545044
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.3290138840675354, Reg Loss=0.36659541726112366
Clinet index 13, End of Epoch 6/6, Average Loss=0.6956093311309814, Class Loss=0.3290138840675354, Reg Loss=0.36659541726112366
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.34092211723327637, Reg Loss=0.35656872391700745
Clinet index 2, End of Epoch 1/6, Average Loss=0.6974908113479614, Class Loss=0.34092211723327637, Reg Loss=0.35656872391700745
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.3355540633201599, Reg Loss=0.35794925689697266
Clinet index 2, End of Epoch 2/6, Average Loss=0.6935033202171326, Class Loss=0.3355540633201599, Reg Loss=0.35794925689697266
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3258427083492279, Reg Loss=0.3579123318195343
Clinet index 2, End of Epoch 3/6, Average Loss=0.6837550401687622, Class Loss=0.3258427083492279, Reg Loss=0.3579123318195343
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.3137708008289337, Reg Loss=0.3575400114059448
Clinet index 2, End of Epoch 4/6, Average Loss=0.6713107824325562, Class Loss=0.3137708008289337, Reg Loss=0.3575400114059448
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3110125958919525, Reg Loss=0.35677194595336914
Clinet index 2, End of Epoch 5/6, Average Loss=0.667784571647644, Class Loss=0.3110125958919525, Reg Loss=0.35677194595336914
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3040178716182709, Reg Loss=0.3556223213672638
Clinet index 2, End of Epoch 6/6, Average Loss=0.6596401929855347, Class Loss=0.3040178716182709, Reg Loss=0.3556223213672638
federated aggregation...
Validation, Class Loss=0.8033299446105957, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.800202
Mean Acc: 0.392605
FreqW Acc: 0.710961
Mean IoU: 0.328264
Class IoU:
	class 0: 0.8485711
	class 1: 0.15137483
	class 2: 0.31464702
	class 3: 0.35168603
	class 4: 0.18059354
	class 5: 0.3841278
	class 6: 0.08674885
	class 7: 0.44920126
	class 8: 0.6321362
	class 9: 0.103410244
	class 10: 0.40887856
	class 11: 0.25352022
	class 12: 0.5407626
	class 13: 0.48465508
	class 14: 0.50061697
	class 15: 0.77230746
	class 16: 0.0
	class 17: 0.06258001
	class 18: 0.08249961
	class 19: 0.15715034
	class 20: 0.12808478
Class Acc:
	class 0: 0.95124525
	class 1: 0.15141316
	class 2: 0.41410157
	class 3: 0.35278922
	class 4: 0.18091251
	class 5: 0.39079934
	class 6: 0.08680564
	class 7: 0.4513786
	class 8: 0.635225
	class 9: 0.11643329
	class 10: 0.42715204
	class 11: 0.2605211
	class 12: 0.57442814
	class 13: 0.49621263
	class 14: 0.52210057
	class 15: 0.7893387
	class 16: 0.0
	class 17: 0.09772515
	class 18: 0.1329069
	class 19: 0.75008404
	class 20: 0.46313655

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.3117884397506714, Reg Loss=0.3735775351524353
Clinet index 6, End of Epoch 1/6, Average Loss=0.6853659749031067, Class Loss=0.3117884397506714, Reg Loss=0.3735775351524353
Pseudo labeling is: None
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.31424230337142944, Reg Loss=0.37542441487312317
Clinet index 6, End of Epoch 2/6, Average Loss=0.689666748046875, Class Loss=0.31424230337142944, Reg Loss=0.37542441487312317
Pseudo labeling is: None
Epoch 3, lr = 0.000372
Epoch 3, Class Loss=0.30256614089012146, Reg Loss=0.3757752776145935
Clinet index 6, End of Epoch 3/6, Average Loss=0.6783413887023926, Class Loss=0.30256614089012146, Reg Loss=0.3757752776145935
Pseudo labeling is: None
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.2992919683456421, Reg Loss=0.3730168342590332
Clinet index 6, End of Epoch 4/6, Average Loss=0.6723088026046753, Class Loss=0.2992919683456421, Reg Loss=0.3730168342590332
Pseudo labeling is: None
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.3055782914161682, Reg Loss=0.36915722489356995
Clinet index 6, End of Epoch 5/6, Average Loss=0.6747355461120605, Class Loss=0.3055782914161682, Reg Loss=0.36915722489356995
Pseudo labeling is: None
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.2999503016471863, Reg Loss=0.37029027938842773
Clinet index 6, End of Epoch 6/6, Average Loss=0.670240581035614, Class Loss=0.2999503016471863, Reg Loss=0.37029027938842773
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.311631441116333, Reg Loss=0.36642947793006897
Clinet index 16, End of Epoch 1/6, Average Loss=0.6780608892440796, Class Loss=0.311631441116333, Reg Loss=0.36642947793006897
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.2950732707977295, Reg Loss=0.374508261680603
Clinet index 16, End of Epoch 2/6, Average Loss=0.6695815324783325, Class Loss=0.2950732707977295, Reg Loss=0.374508261680603
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.28919169306755066, Reg Loss=0.3666902482509613
Clinet index 16, End of Epoch 3/6, Average Loss=0.655881941318512, Class Loss=0.28919169306755066, Reg Loss=0.3666902482509613
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2860509753227234, Reg Loss=0.3646198809146881
Clinet index 16, End of Epoch 4/6, Average Loss=0.6506708860397339, Class Loss=0.2860509753227234, Reg Loss=0.3646198809146881
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.2932650148868561, Reg Loss=0.3673800528049469
Clinet index 16, End of Epoch 5/6, Average Loss=0.660645067691803, Class Loss=0.2932650148868561, Reg Loss=0.3673800528049469
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.27559539675712585, Reg Loss=0.3705008029937744
Clinet index 16, End of Epoch 6/6, Average Loss=0.6460962295532227, Class Loss=0.27559539675712585, Reg Loss=0.3705008029937744
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.33342576026916504, Reg Loss=0.36584168672561646
Clinet index 13, End of Epoch 1/6, Average Loss=0.6992674469947815, Class Loss=0.33342576026916504, Reg Loss=0.36584168672561646
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.31876930594444275, Reg Loss=0.3650878965854645
Clinet index 13, End of Epoch 2/6, Average Loss=0.6838572025299072, Class Loss=0.31876930594444275, Reg Loss=0.3650878965854645
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.3120495676994324, Reg Loss=0.3647870421409607
Clinet index 13, End of Epoch 3/6, Average Loss=0.6768366098403931, Class Loss=0.3120495676994324, Reg Loss=0.3647870421409607
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.3067183494567871, Reg Loss=0.36578676104545593
Clinet index 13, End of Epoch 4/6, Average Loss=0.6725051403045654, Class Loss=0.3067183494567871, Reg Loss=0.36578676104545593
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.31801313161849976, Reg Loss=0.36301660537719727
Clinet index 13, End of Epoch 5/6, Average Loss=0.681029736995697, Class Loss=0.31801313161849976, Reg Loss=0.36301660537719727
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.31643253564834595, Reg Loss=0.36954328417778015
Clinet index 13, End of Epoch 6/6, Average Loss=0.6859757900238037, Class Loss=0.31643253564834595, Reg Loss=0.36954328417778015
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.31857579946517944, Reg Loss=0.3580615222454071
Clinet index 22, End of Epoch 1/6, Average Loss=0.6766372919082642, Class Loss=0.31857579946517944, Reg Loss=0.3580615222454071
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.30894190073013306, Reg Loss=0.3629149794578552
Clinet index 22, End of Epoch 2/6, Average Loss=0.6718568801879883, Class Loss=0.30894190073013306, Reg Loss=0.3629149794578552
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2953367829322815, Reg Loss=0.3585192561149597
Clinet index 22, End of Epoch 3/6, Average Loss=0.6538560390472412, Class Loss=0.2953367829322815, Reg Loss=0.3585192561149597
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.29313865303993225, Reg Loss=0.3622990846633911
Clinet index 22, End of Epoch 4/6, Average Loss=0.655437707901001, Class Loss=0.29313865303993225, Reg Loss=0.3622990846633911
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.28810814023017883, Reg Loss=0.3613419532775879
Clinet index 22, End of Epoch 5/6, Average Loss=0.6494500637054443, Class Loss=0.28810814023017883, Reg Loss=0.3613419532775879
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.28749555349349976, Reg Loss=0.3708849847316742
Clinet index 22, End of Epoch 6/6, Average Loss=0.6583805084228516, Class Loss=0.28749555349349976, Reg Loss=0.3708849847316742
federated aggregation...
Validation, Class Loss=0.7915903925895691, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.801008
Mean Acc: 0.397222
FreqW Acc: 0.712382
Mean IoU: 0.331476
Class IoU:
	class 0: 0.8488428
	class 1: 0.15905471
	class 2: 0.31727177
	class 3: 0.35761833
	class 4: 0.17887053
	class 5: 0.37756103
	class 6: 0.09122999
	class 7: 0.47170153
	class 8: 0.6291329
	class 9: 0.106078036
	class 10: 0.42155328
	class 11: 0.25459597
	class 12: 0.5474331
	class 13: 0.48326826
	class 14: 0.50763255
	class 15: 0.7768029
	class 16: 0.0
	class 17: 0.061762422
	class 18: 0.081344984
	class 19: 0.15764973
	class 20: 0.13158725
Class Acc:
	class 0: 0.95031005
	class 1: 0.15909807
	class 2: 0.4206854
	class 3: 0.3586696
	class 4: 0.17917801
	class 5: 0.38383788
	class 6: 0.091289304
	class 7: 0.4742253
	class 8: 0.6321672
	class 9: 0.119676426
	class 10: 0.4409099
	class 11: 0.2615069
	class 12: 0.5854081
	class 13: 0.49443978
	class 14: 0.5289713
	class 15: 0.7946767
	class 16: 0.0
	class 17: 0.094328985
	class 18: 0.13453194
	class 19: 0.7367546
	class 20: 0.5010011

voc_15-1_MiB On GPUs 2
Run in 20325s
