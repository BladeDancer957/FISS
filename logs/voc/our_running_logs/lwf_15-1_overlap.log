nohup: ignoring input
30
kvoc_15-1_LWF On GPUs 2\Writing in results/seed_2023-ov/2023-03-08_voc_15-1_LWF.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: None
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch 1, Class Loss=1.9348117113113403, Reg Loss=1.2257094383239746
Clinet index 3, End of Epoch 1/6, Average Loss=3.1605210304260254, Class Loss=1.9348117113113403, Reg Loss=1.2257094383239746
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4640988111495972, Reg Loss=1.178227424621582
Clinet index 3, End of Epoch 2/6, Average Loss=2.6423263549804688, Class Loss=1.4640988111495972, Reg Loss=1.178227424621582
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.152145504951477, Reg Loss=1.2067270278930664
Clinet index 3, End of Epoch 3/6, Average Loss=2.358872413635254, Class Loss=1.152145504951477, Reg Loss=1.2067270278930664
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0168975591659546, Reg Loss=1.1389966011047363
Clinet index 3, End of Epoch 4/6, Average Loss=2.1558942794799805, Class Loss=1.0168975591659546, Reg Loss=1.1389966011047363
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8857409358024597, Reg Loss=1.1394387483596802
Clinet index 3, End of Epoch 5/6, Average Loss=2.025179624557495, Class Loss=0.8857409358024597, Reg Loss=1.1394387483596802
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7531095743179321, Reg Loss=1.0245946645736694
Clinet index 3, End of Epoch 6/6, Average Loss=1.7777042388916016, Class Loss=0.7531095743179321, Reg Loss=1.0245946645736694
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.9705772399902344, Reg Loss=1.1382187604904175
Clinet index 6, End of Epoch 1/6, Average Loss=3.1087961196899414, Class Loss=1.9705772399902344, Reg Loss=1.1382187604904175
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4657312631607056, Reg Loss=1.2202951908111572
Clinet index 6, End of Epoch 2/6, Average Loss=2.6860265731811523, Class Loss=1.4657312631607056, Reg Loss=1.2202951908111572
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2182643413543701, Reg Loss=1.1323180198669434
Clinet index 6, End of Epoch 3/6, Average Loss=2.3505823612213135, Class Loss=1.2182643413543701, Reg Loss=1.1323180198669434
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0411994457244873, Reg Loss=1.0367649793624878
Clinet index 6, End of Epoch 4/6, Average Loss=2.0779643058776855, Class Loss=1.0411994457244873, Reg Loss=1.0367649793624878
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8971463441848755, Reg Loss=1.0449944734573364
Clinet index 6, End of Epoch 5/6, Average Loss=1.942140817642212, Class Loss=0.8971463441848755, Reg Loss=1.0449944734573364
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7590704560279846, Reg Loss=1.1403602361679077
Clinet index 6, End of Epoch 6/6, Average Loss=1.899430751800537, Class Loss=0.7590704560279846, Reg Loss=1.1403602361679077
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.9308017492294312, Reg Loss=1.2041457891464233
Clinet index 12, End of Epoch 1/6, Average Loss=3.1349475383758545, Class Loss=1.9308017492294312, Reg Loss=1.2041457891464233
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.49320387840271, Reg Loss=1.179517149925232
Clinet index 12, End of Epoch 2/6, Average Loss=2.6727209091186523, Class Loss=1.49320387840271, Reg Loss=1.179517149925232
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.1875486373901367, Reg Loss=1.2225533723831177
Clinet index 12, End of Epoch 3/6, Average Loss=2.410101890563965, Class Loss=1.1875486373901367, Reg Loss=1.2225533723831177
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0688362121582031, Reg Loss=1.135755181312561
Clinet index 12, End of Epoch 4/6, Average Loss=2.2045912742614746, Class Loss=1.0688362121582031, Reg Loss=1.135755181312561
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8356397747993469, Reg Loss=1.1449567079544067
Clinet index 12, End of Epoch 5/6, Average Loss=1.9805965423583984, Class Loss=0.8356397747993469, Reg Loss=1.1449567079544067
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7382087707519531, Reg Loss=1.01975679397583
Clinet index 12, End of Epoch 6/6, Average Loss=1.7579655647277832, Class Loss=0.7382087707519531, Reg Loss=1.01975679397583
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.028904438018799, Reg Loss=1.2031956911087036
Clinet index 0, End of Epoch 1/6, Average Loss=3.232100009918213, Class Loss=2.028904438018799, Reg Loss=1.2031956911087036
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4910480976104736, Reg Loss=1.3069539070129395
Clinet index 0, End of Epoch 2/6, Average Loss=2.798002004623413, Class Loss=1.4910480976104736, Reg Loss=1.3069539070129395
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.354846477508545, Reg Loss=1.1549286842346191
Clinet index 0, End of Epoch 3/6, Average Loss=2.509775161743164, Class Loss=1.354846477508545, Reg Loss=1.1549286842346191
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0473463535308838, Reg Loss=1.2559692859649658
Clinet index 0, End of Epoch 4/6, Average Loss=2.3033156394958496, Class Loss=1.0473463535308838, Reg Loss=1.2559692859649658
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9462637305259705, Reg Loss=1.2558749914169312
Clinet index 0, End of Epoch 5/6, Average Loss=2.202138662338257, Class Loss=0.9462637305259705, Reg Loss=1.2558749914169312
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8717812895774841, Reg Loss=1.0750666856765747
Clinet index 0, End of Epoch 6/6, Average Loss=1.946847915649414, Class Loss=0.8717812895774841, Reg Loss=1.0750666856765747
federated aggregation...
Validation, Class Loss=0.20884142816066742, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.928572
Mean Acc: 0.747385
FreqW Acc: 0.868302
Mean IoU: 0.689067
Class IoU:
	class 0: 0.91396797
	class 1: 0.9083433
	class 2: 0.42499566
	class 3: 0.7646951
	class 4: 0.6299838
	class 5: 0.6860122
	class 6: 0.8935877
	class 7: 0.8637185
	class 8: 0.88030285
	class 9: 0.37395057
	class 10: 0.6645498
	class 11: 0.4707369
	class 12: 0.8294687
	class 13: 0.7385041
	class 14: 0.77410054
	class 15: 0.82746726
	class 16: 0.06974778
Class Acc:
	class 0: 0.9840168
	class 1: 0.94505274
	class 2: 0.79366773
	class 3: 0.7752439
	class 4: 0.6906156
	class 5: 0.7455645
	class 6: 0.9055672
	class 7: 0.87789625
	class 8: 0.8997158
	class 9: 0.43439478
	class 10: 0.682122
	class 11: 0.4822543
	class 12: 0.85725313
	class 13: 0.8960896
	class 14: 0.8056726
	class 15: 0.85362583
	class 16: 0.076793164

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.7981774210929871, Reg Loss=1.102229356765747
Clinet index 0, End of Epoch 1/6, Average Loss=1.900406837463379, Class Loss=0.7981774210929871, Reg Loss=1.102229356765747
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7702481746673584, Reg Loss=1.2026143074035645
Clinet index 0, End of Epoch 2/6, Average Loss=1.9728624820709229, Class Loss=0.7702481746673584, Reg Loss=1.2026143074035645
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7731085419654846, Reg Loss=1.0590262413024902
Clinet index 0, End of Epoch 3/6, Average Loss=1.83213472366333, Class Loss=0.7731085419654846, Reg Loss=1.0590262413024902
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.7188912630081177, Reg Loss=1.0759296417236328
Clinet index 0, End of Epoch 4/6, Average Loss=1.7948209047317505, Class Loss=0.7188912630081177, Reg Loss=1.0759296417236328
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.6419070363044739, Reg Loss=1.0888664722442627
Clinet index 0, End of Epoch 5/6, Average Loss=1.7307734489440918, Class Loss=0.6419070363044739, Reg Loss=1.0888664722442627
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.6507871747016907, Reg Loss=1.018322229385376
Clinet index 0, End of Epoch 6/6, Average Loss=1.6691093444824219, Class Loss=0.6507871747016907, Reg Loss=1.018322229385376
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7580056190490723, Reg Loss=1.107313632965088
Clinet index 2, End of Epoch 1/6, Average Loss=1.8653192520141602, Class Loss=0.7580056190490723, Reg Loss=1.107313632965088
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.6998293399810791, Reg Loss=1.1382468938827515
Clinet index 2, End of Epoch 2/6, Average Loss=1.8380762338638306, Class Loss=0.6998293399810791, Reg Loss=1.1382468938827515
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6835047006607056, Reg Loss=1.016149878501892
Clinet index 2, End of Epoch 3/6, Average Loss=1.6996545791625977, Class Loss=0.6835047006607056, Reg Loss=1.016149878501892
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.612762451171875, Reg Loss=1.0356727838516235
Clinet index 2, End of Epoch 4/6, Average Loss=1.6484352350234985, Class Loss=0.612762451171875, Reg Loss=1.0356727838516235
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5900476574897766, Reg Loss=1.058666706085205
Clinet index 2, End of Epoch 5/6, Average Loss=1.648714303970337, Class Loss=0.5900476574897766, Reg Loss=1.058666706085205
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5990738868713379, Reg Loss=1.042891025543213
Clinet index 2, End of Epoch 6/6, Average Loss=1.6419649124145508, Class Loss=0.5990738868713379, Reg Loss=1.042891025543213
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7488863468170166, Reg Loss=1.1032395362854004
Clinet index 8, End of Epoch 1/6, Average Loss=1.852125883102417, Class Loss=0.7488863468170166, Reg Loss=1.1032395362854004
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7489262819290161, Reg Loss=1.046030044555664
Clinet index 8, End of Epoch 2/6, Average Loss=1.7949563264846802, Class Loss=0.7489262819290161, Reg Loss=1.046030044555664
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6830107569694519, Reg Loss=1.0361558198928833
Clinet index 8, End of Epoch 3/6, Average Loss=1.7191665172576904, Class Loss=0.6830107569694519, Reg Loss=1.0361558198928833
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6313729286193848, Reg Loss=1.0541247129440308
Clinet index 8, End of Epoch 4/6, Average Loss=1.6854976415634155, Class Loss=0.6313729286193848, Reg Loss=1.0541247129440308
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5871962308883667, Reg Loss=0.9918461441993713
Clinet index 8, End of Epoch 5/6, Average Loss=1.5790424346923828, Class Loss=0.5871962308883667, Reg Loss=0.9918461441993713
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.564918041229248, Reg Loss=0.9857925772666931
Clinet index 8, End of Epoch 6/6, Average Loss=1.550710678100586, Class Loss=0.564918041229248, Reg Loss=0.9857925772666931
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6923086047172546, Reg Loss=1.0295757055282593
Clinet index 4, End of Epoch 1/6, Average Loss=1.7218842506408691, Class Loss=0.6923086047172546, Reg Loss=1.0295757055282593
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.66255122423172, Reg Loss=0.9991490244865417
Clinet index 4, End of Epoch 2/6, Average Loss=1.6617002487182617, Class Loss=0.66255122423172, Reg Loss=0.9991490244865417
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5970738530158997, Reg Loss=1.016480565071106
Clinet index 4, End of Epoch 3/6, Average Loss=1.6135544776916504, Class Loss=0.5970738530158997, Reg Loss=1.016480565071106
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5879272818565369, Reg Loss=0.9833618402481079
Clinet index 4, End of Epoch 4/6, Average Loss=1.5712890625, Class Loss=0.5879272818565369, Reg Loss=0.9833618402481079
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5505284070968628, Reg Loss=1.0326924324035645
Clinet index 4, End of Epoch 5/6, Average Loss=1.5832208395004272, Class Loss=0.5505284070968628, Reg Loss=1.0326924324035645
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5161598324775696, Reg Loss=0.9720233082771301
Clinet index 4, End of Epoch 6/6, Average Loss=1.4881831407546997, Class Loss=0.5161598324775696, Reg Loss=0.9720233082771301
federated aggregation...
Validation, Class Loss=0.23027260601520538, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.918041
Mean Acc: 0.740934
FreqW Acc: 0.863042
Mean IoU: 0.664836
Class IoU:
	class 0: 0.9134007
	class 1: 0.8976729
	class 2: 0.39934424
	class 3: 0.44484007
	class 4: 0.6202294
	class 5: 0.5750371
	class 6: 0.9031942
	class 7: 0.85906595
	class 8: 0.87112004
	class 9: 0.38312578
	class 10: 0.6760945
	class 11: 0.49379098
	class 12: 0.8251147
	class 13: 0.75033706
	class 14: 0.7093251
	class 15: 0.83550745
	class 16: 0.14501433
Class Acc:
	class 0: 0.9732919
	class 1: 0.9221002
	class 2: 0.7215702
	class 3: 0.44665894
	class 4: 0.67651707
	class 5: 0.6126812
	class 6: 0.91765577
	class 7: 0.87553674
	class 8: 0.88785625
	class 9: 0.43833706
	class 10: 0.6929486
	class 11: 0.5102747
	class 12: 0.84520966
	class 13: 0.9003548
	class 14: 0.73147845
	class 15: 0.86372095
	class 16: 0.5796886

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5443507432937622, Reg Loss=0.8956446051597595
Clinet index 9, End of Epoch 1/6, Average Loss=1.439995288848877, Class Loss=0.5443507432937622, Reg Loss=0.8956446051597595
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5369852781295776, Reg Loss=0.8690564632415771
Clinet index 9, End of Epoch 2/6, Average Loss=1.4060417413711548, Class Loss=0.5369852781295776, Reg Loss=0.8690564632415771
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5214442014694214, Reg Loss=0.9082999229431152
Clinet index 9, End of Epoch 3/6, Average Loss=1.4297441244125366, Class Loss=0.5214442014694214, Reg Loss=0.9082999229431152
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5251630544662476, Reg Loss=0.8550466299057007
Clinet index 9, End of Epoch 4/6, Average Loss=1.3802096843719482, Class Loss=0.5251630544662476, Reg Loss=0.8550466299057007
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.52699214220047, Reg Loss=0.8704798221588135
Clinet index 9, End of Epoch 5/6, Average Loss=1.3974719047546387, Class Loss=0.52699214220047, Reg Loss=0.8704798221588135
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5092800259590149, Reg Loss=0.863494336605072
Clinet index 9, End of Epoch 6/6, Average Loss=1.372774362564087, Class Loss=0.5092800259590149, Reg Loss=0.863494336605072
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5670768022537231, Reg Loss=0.9939107894897461
Clinet index 13, End of Epoch 1/6, Average Loss=1.5609875917434692, Class Loss=0.5670768022537231, Reg Loss=0.9939107894897461
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5681941509246826, Reg Loss=0.9383813738822937
Clinet index 13, End of Epoch 2/6, Average Loss=1.506575584411621, Class Loss=0.5681941509246826, Reg Loss=0.9383813738822937
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5174465775489807, Reg Loss=0.9567452669143677
Clinet index 13, End of Epoch 3/6, Average Loss=1.4741919040679932, Class Loss=0.5174465775489807, Reg Loss=0.9567452669143677
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5217536091804504, Reg Loss=0.9717946648597717
Clinet index 13, End of Epoch 4/6, Average Loss=1.4935482740402222, Class Loss=0.5217536091804504, Reg Loss=0.9717946648597717
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.550975501537323, Reg Loss=0.9917876720428467
Clinet index 13, End of Epoch 5/6, Average Loss=1.5427632331848145, Class Loss=0.550975501537323, Reg Loss=0.9917876720428467
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5323710441589355, Reg Loss=0.9651157855987549
Clinet index 13, End of Epoch 6/6, Average Loss=1.4974868297576904, Class Loss=0.5323710441589355, Reg Loss=0.9651157855987549
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5901481509208679, Reg Loss=0.9847267866134644
Clinet index 1, End of Epoch 1/6, Average Loss=1.5748748779296875, Class Loss=0.5901481509208679, Reg Loss=0.9847267866134644
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5989651679992676, Reg Loss=1.0234992504119873
Clinet index 1, End of Epoch 2/6, Average Loss=1.6224644184112549, Class Loss=0.5989651679992676, Reg Loss=1.0234992504119873
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.600866436958313, Reg Loss=1.0016554594039917
Clinet index 1, End of Epoch 3/6, Average Loss=1.6025218963623047, Class Loss=0.600866436958313, Reg Loss=1.0016554594039917
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5874544382095337, Reg Loss=1.0154106616973877
Clinet index 1, End of Epoch 4/6, Average Loss=1.6028650999069214, Class Loss=0.5874544382095337, Reg Loss=1.0154106616973877
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5375486612319946, Reg Loss=0.9936400055885315
Clinet index 1, End of Epoch 5/6, Average Loss=1.531188726425171, Class Loss=0.5375486612319946, Reg Loss=0.9936400055885315
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5433877110481262, Reg Loss=0.9660464525222778
Clinet index 1, End of Epoch 6/6, Average Loss=1.5094342231750488, Class Loss=0.5433877110481262, Reg Loss=0.9660464525222778
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5542150139808655, Reg Loss=1.0398833751678467
Clinet index 11, End of Epoch 1/6, Average Loss=1.5940983295440674, Class Loss=0.5542150139808655, Reg Loss=1.0398833751678467
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5376255512237549, Reg Loss=1.0220260620117188
Clinet index 11, End of Epoch 2/6, Average Loss=1.5596516132354736, Class Loss=0.5376255512237549, Reg Loss=1.0220260620117188
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5533761382102966, Reg Loss=0.9640296101570129
Clinet index 11, End of Epoch 3/6, Average Loss=1.5174057483673096, Class Loss=0.5533761382102966, Reg Loss=0.9640296101570129
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5624909996986389, Reg Loss=1.0073407888412476
Clinet index 11, End of Epoch 4/6, Average Loss=1.5698318481445312, Class Loss=0.5624909996986389, Reg Loss=1.0073407888412476
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5342276692390442, Reg Loss=0.9853917360305786
Clinet index 11, End of Epoch 5/6, Average Loss=1.5196194648742676, Class Loss=0.5342276692390442, Reg Loss=0.9853917360305786
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5003159046173096, Reg Loss=0.97072434425354
Clinet index 11, End of Epoch 6/6, Average Loss=1.4710402488708496, Class Loss=0.5003159046173096, Reg Loss=0.97072434425354
federated aggregation...
Validation, Class Loss=0.24346338212490082, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.911816
Mean Acc: 0.719487
FreqW Acc: 0.856980
Mean IoU: 0.641777
Class IoU:
	class 0: 0.9117641
	class 1: 0.8689847
	class 2: 0.3949691
	class 3: 0.25371215
	class 4: 0.5931354
	class 5: 0.5174926
	class 6: 0.8913407
	class 7: 0.8469154
	class 8: 0.86885875
	class 9: 0.37524408
	class 10: 0.6471845
	class 11: 0.49746153
	class 12: 0.8183963
	class 13: 0.746154
	class 14: 0.70928997
	class 15: 0.83666766
	class 16: 0.13264342
Class Acc:
	class 0: 0.97148997
	class 1: 0.8859487
	class 2: 0.6821052
	class 3: 0.25411528
	class 4: 0.6432145
	class 5: 0.54414135
	class 6: 0.90347975
	class 7: 0.860303
	class 8: 0.8862815
	class 9: 0.42782396
	class 10: 0.6589701
	class 11: 0.50916606
	class 12: 0.8417006
	class 13: 0.8922721
	class 14: 0.7319452
	class 15: 0.86310697
	class 16: 0.67522126

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5428766012191772, Reg Loss=0.9334587454795837
Clinet index 8, End of Epoch 1/6, Average Loss=1.4763352870941162, Class Loss=0.5428766012191772, Reg Loss=0.9334587454795837
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5334015488624573, Reg Loss=0.9143986105918884
Clinet index 8, End of Epoch 2/6, Average Loss=1.4478001594543457, Class Loss=0.5334015488624573, Reg Loss=0.9143986105918884
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5087165832519531, Reg Loss=0.9442009925842285
Clinet index 8, End of Epoch 3/6, Average Loss=1.4529175758361816, Class Loss=0.5087165832519531, Reg Loss=0.9442009925842285
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5219833254814148, Reg Loss=0.976375162601471
Clinet index 8, End of Epoch 4/6, Average Loss=1.4983584880828857, Class Loss=0.5219833254814148, Reg Loss=0.976375162601471
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.5049484968185425, Reg Loss=0.95591139793396
Clinet index 8, End of Epoch 5/6, Average Loss=1.4608598947525024, Class Loss=0.5049484968185425, Reg Loss=0.95591139793396
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.4947620630264282, Reg Loss=0.9162383079528809
Clinet index 8, End of Epoch 6/6, Average Loss=1.411000370979309, Class Loss=0.4947620630264282, Reg Loss=0.9162383079528809
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5914188027381897, Reg Loss=1.021088719367981
Clinet index 5, End of Epoch 1/6, Average Loss=1.6125075817108154, Class Loss=0.5914188027381897, Reg Loss=1.021088719367981
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.5821249485015869, Reg Loss=1.0190436840057373
Clinet index 5, End of Epoch 2/6, Average Loss=1.6011686325073242, Class Loss=0.5821249485015869, Reg Loss=1.0190436840057373
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.5707201361656189, Reg Loss=1.008134365081787
Clinet index 5, End of Epoch 3/6, Average Loss=1.5788545608520508, Class Loss=0.5707201361656189, Reg Loss=1.008134365081787
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.5708057284355164, Reg Loss=1.0229392051696777
Clinet index 5, End of Epoch 4/6, Average Loss=1.5937449932098389, Class Loss=0.5708057284355164, Reg Loss=1.0229392051696777
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5301904678344727, Reg Loss=1.0302850008010864
Clinet index 5, End of Epoch 5/6, Average Loss=1.560475468635559, Class Loss=0.5301904678344727, Reg Loss=1.0302850008010864
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5335457921028137, Reg Loss=1.0368623733520508
Clinet index 5, End of Epoch 6/6, Average Loss=1.5704081058502197, Class Loss=0.5335457921028137, Reg Loss=1.0368623733520508
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5310922265052795, Reg Loss=1.0384433269500732
Clinet index 2, End of Epoch 1/6, Average Loss=1.569535493850708, Class Loss=0.5310922265052795, Reg Loss=1.0384433269500732
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5080864429473877, Reg Loss=0.9804842472076416
Clinet index 2, End of Epoch 2/6, Average Loss=1.4885706901550293, Class Loss=0.5080864429473877, Reg Loss=0.9804842472076416
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5236261487007141, Reg Loss=0.9919537305831909
Clinet index 2, End of Epoch 3/6, Average Loss=1.5155799388885498, Class Loss=0.5236261487007141, Reg Loss=0.9919537305831909
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5071592926979065, Reg Loss=0.9812981486320496
Clinet index 2, End of Epoch 4/6, Average Loss=1.488457441329956, Class Loss=0.5071592926979065, Reg Loss=0.9812981486320496
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.4989319443702698, Reg Loss=0.955621063709259
Clinet index 2, End of Epoch 5/6, Average Loss=1.4545530080795288, Class Loss=0.4989319443702698, Reg Loss=0.955621063709259
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.4995572566986084, Reg Loss=0.9224537014961243
Clinet index 2, End of Epoch 6/6, Average Loss=1.422010898590088, Class Loss=0.4995572566986084, Reg Loss=0.9224537014961243
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.5014659762382507, Reg Loss=0.8045306205749512
Clinet index 9, End of Epoch 1/6, Average Loss=1.3059966564178467, Class Loss=0.5014659762382507, Reg Loss=0.8045306205749512
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.5044943690299988, Reg Loss=0.8250411748886108
Clinet index 9, End of Epoch 2/6, Average Loss=1.3295354843139648, Class Loss=0.5044943690299988, Reg Loss=0.8250411748886108
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.4847653806209564, Reg Loss=0.8350646495819092
Clinet index 9, End of Epoch 3/6, Average Loss=1.319830060005188, Class Loss=0.4847653806209564, Reg Loss=0.8350646495819092
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.49521881341934204, Reg Loss=0.8446599245071411
Clinet index 9, End of Epoch 4/6, Average Loss=1.339878797531128, Class Loss=0.49521881341934204, Reg Loss=0.8446599245071411
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.4989287257194519, Reg Loss=0.8258152604103088
Clinet index 9, End of Epoch 5/6, Average Loss=1.3247439861297607, Class Loss=0.4989287257194519, Reg Loss=0.8258152604103088
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.48649653792381287, Reg Loss=0.8049256801605225
Clinet index 9, End of Epoch 6/6, Average Loss=1.2914222478866577, Class Loss=0.48649653792381287, Reg Loss=0.8049256801605225
federated aggregation...
Validation, Class Loss=0.24719278514385223, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.910239
Mean Acc: 0.714420
FreqW Acc: 0.856118
Mean IoU: 0.636094
Class IoU:
	class 0: 0.9116006
	class 1: 0.8450663
	class 2: 0.39160323
	class 3: 0.16851118
	class 4: 0.5801247
	class 5: 0.51090837
	class 6: 0.8945559
	class 7: 0.84539306
	class 8: 0.86903447
	class 9: 0.38064566
	class 10: 0.6615559
	class 11: 0.50023097
	class 12: 0.8294344
	class 13: 0.7592279
	class 14: 0.69742763
	class 15: 0.83753103
	class 16: 0.1307505
Class Acc:
	class 0: 0.97049016
	class 1: 0.85984445
	class 2: 0.67625815
	class 3: 0.16863759
	class 4: 0.6281507
	class 5: 0.53629196
	class 6: 0.9076233
	class 7: 0.86006695
	class 8: 0.88598466
	class 9: 0.43795615
	class 10: 0.67398363
	class 11: 0.5133085
	class 12: 0.85767746
	class 13: 0.8674043
	class 14: 0.7180378
	class 15: 0.8637687
	class 16: 0.71965146

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.5053612589836121, Reg Loss=0.9289095401763916
Clinet index 8, End of Epoch 1/6, Average Loss=1.4342708587646484, Class Loss=0.5053612589836121, Reg Loss=0.9289095401763916
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.514582097530365, Reg Loss=0.9135712385177612
Clinet index 8, End of Epoch 2/6, Average Loss=1.4281532764434814, Class Loss=0.514582097530365, Reg Loss=0.9135712385177612
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.4906255006790161, Reg Loss=0.9557538032531738
Clinet index 8, End of Epoch 3/6, Average Loss=1.44637930393219, Class Loss=0.4906255006790161, Reg Loss=0.9557538032531738
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.49628499150276184, Reg Loss=0.9557784795761108
Clinet index 8, End of Epoch 4/6, Average Loss=1.4520634412765503, Class Loss=0.49628499150276184, Reg Loss=0.9557784795761108
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.4941970407962799, Reg Loss=0.9257053136825562
Clinet index 8, End of Epoch 5/6, Average Loss=1.4199023246765137, Class Loss=0.4941970407962799, Reg Loss=0.9257053136825562
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.4876118004322052, Reg Loss=0.919964611530304
Clinet index 8, End of Epoch 6/6, Average Loss=1.4075764417648315, Class Loss=0.4876118004322052, Reg Loss=0.919964611530304
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.49278101325035095, Reg Loss=0.8001914024353027
Clinet index 9, End of Epoch 1/6, Average Loss=1.292972445487976, Class Loss=0.49278101325035095, Reg Loss=0.8001914024353027
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.4787501394748688, Reg Loss=0.8419823050498962
Clinet index 9, End of Epoch 2/6, Average Loss=1.3207324743270874, Class Loss=0.4787501394748688, Reg Loss=0.8419823050498962
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.4571881890296936, Reg Loss=0.8635547161102295
Clinet index 9, End of Epoch 3/6, Average Loss=1.3207428455352783, Class Loss=0.4571881890296936, Reg Loss=0.8635547161102295
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.4939754009246826, Reg Loss=0.8297010064125061
Clinet index 9, End of Epoch 4/6, Average Loss=1.323676347732544, Class Loss=0.4939754009246826, Reg Loss=0.8297010064125061
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.47434002161026, Reg Loss=0.8297571539878845
Clinet index 9, End of Epoch 5/6, Average Loss=1.3040971755981445, Class Loss=0.47434002161026, Reg Loss=0.8297571539878845
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.47663405537605286, Reg Loss=0.8166137933731079
Clinet index 9, End of Epoch 6/6, Average Loss=1.2932478189468384, Class Loss=0.47663405537605286, Reg Loss=0.8166137933731079
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.4834109842777252, Reg Loss=0.9321890473365784
Clinet index 12, End of Epoch 1/6, Average Loss=1.415600061416626, Class Loss=0.4834109842777252, Reg Loss=0.9321890473365784
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.47902587056159973, Reg Loss=0.9292396306991577
Clinet index 12, End of Epoch 2/6, Average Loss=1.408265471458435, Class Loss=0.47902587056159973, Reg Loss=0.9292396306991577
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.4775654673576355, Reg Loss=0.8923646807670593
Clinet index 12, End of Epoch 3/6, Average Loss=1.3699301481246948, Class Loss=0.4775654673576355, Reg Loss=0.8923646807670593
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.47270387411117554, Reg Loss=0.9022325873374939
Clinet index 12, End of Epoch 4/6, Average Loss=1.3749364614486694, Class Loss=0.47270387411117554, Reg Loss=0.9022325873374939
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.4785020351409912, Reg Loss=0.9121432900428772
Clinet index 12, End of Epoch 5/6, Average Loss=1.3906452655792236, Class Loss=0.4785020351409912, Reg Loss=0.9121432900428772
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.46764546632766724, Reg Loss=0.9319688081741333
Clinet index 12, End of Epoch 6/6, Average Loss=1.3996143341064453, Class Loss=0.46764546632766724, Reg Loss=0.9319688081741333
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.4680613875389099, Reg Loss=0.949048638343811
Clinet index 4, End of Epoch 1/6, Average Loss=1.4171099662780762, Class Loss=0.4680613875389099, Reg Loss=0.949048638343811
Pseudo labeling is: None
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.4798426926136017, Reg Loss=0.9431740641593933
Clinet index 4, End of Epoch 2/6, Average Loss=1.4230167865753174, Class Loss=0.4798426926136017, Reg Loss=0.9431740641593933
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.4557613134384155, Reg Loss=0.9571012854576111
Clinet index 4, End of Epoch 3/6, Average Loss=1.4128625392913818, Class Loss=0.4557613134384155, Reg Loss=0.9571012854576111
Pseudo labeling is: None
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.46517181396484375, Reg Loss=0.9219148755073547
Clinet index 4, End of Epoch 4/6, Average Loss=1.3870866298675537, Class Loss=0.46517181396484375, Reg Loss=0.9219148755073547
Pseudo labeling is: None
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.47282788157463074, Reg Loss=0.9321805238723755
Clinet index 4, End of Epoch 5/6, Average Loss=1.4050084352493286, Class Loss=0.47282788157463074, Reg Loss=0.9321805238723755
Pseudo labeling is: None
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.461696982383728, Reg Loss=0.9929909706115723
Clinet index 4, End of Epoch 6/6, Average Loss=1.4546879529953003, Class Loss=0.461696982383728, Reg Loss=0.9929909706115723
federated aggregation...
Validation, Class Loss=0.24433745443820953, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.911558
Mean Acc: 0.717885
FreqW Acc: 0.857987
Mean IoU: 0.638669
Class IoU:
	class 0: 0.91296524
	class 1: 0.84342444
	class 2: 0.39228368
	class 3: 0.17326795
	class 4: 0.5691554
	class 5: 0.5257805
	class 6: 0.8958631
	class 7: 0.8465931
	class 8: 0.8740434
	class 9: 0.37747514
	class 10: 0.6663859
	class 11: 0.50779366
	class 12: 0.83275694
	class 13: 0.7635124
	class 14: 0.7011282
	class 15: 0.8401824
	class 16: 0.13475524
Class Acc:
	class 0: 0.970633
	class 1: 0.85848534
	class 2: 0.67955005
	class 3: 0.1733899
	class 4: 0.614079
	class 5: 0.5524714
	class 6: 0.9092257
	class 7: 0.860118
	class 8: 0.8918743
	class 9: 0.43404824
	class 10: 0.67952424
	class 11: 0.5219251
	class 12: 0.8630197
	class 13: 0.87715036
	class 14: 0.72145367
	class 15: 0.8677656
	class 16: 0.7293352

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.916297435760498, Reg Loss=2.4516985416412354
Clinet index 14, End of Epoch 1/6, Average Loss=4.3679962158203125, Class Loss=1.916297435760498, Reg Loss=2.4516985416412354
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.88114595413208, Reg Loss=1.7409298419952393
Clinet index 14, End of Epoch 2/6, Average Loss=3.6220757961273193, Class Loss=1.88114595413208, Reg Loss=1.7409298419952393
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.8262298107147217, Reg Loss=1.8216733932495117
Clinet index 14, End of Epoch 3/6, Average Loss=3.6479032039642334, Class Loss=1.8262298107147217, Reg Loss=1.8216733932495117
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.3334628343582153, Reg Loss=1.5689361095428467
Clinet index 14, End of Epoch 4/6, Average Loss=2.9023990631103516, Class Loss=1.3334628343582153, Reg Loss=1.5689361095428467
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.262955904006958, Reg Loss=1.663785696029663
Clinet index 14, End of Epoch 5/6, Average Loss=2.926741600036621, Class Loss=1.262955904006958, Reg Loss=1.663785696029663
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9996578693389893, Reg Loss=1.4489235877990723
Clinet index 14, End of Epoch 6/6, Average Loss=2.4485814571380615, Class Loss=0.9996578693389893, Reg Loss=1.4489235877990723
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.8236092329025269, Reg Loss=2.5415563583374023
Clinet index 6, End of Epoch 1/6, Average Loss=4.365165710449219, Class Loss=1.8236092329025269, Reg Loss=2.5415563583374023
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.7543728351593018, Reg Loss=1.7113096714019775
Clinet index 6, End of Epoch 2/6, Average Loss=3.4656825065612793, Class Loss=1.7543728351593018, Reg Loss=1.7113096714019775
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6169111728668213, Reg Loss=1.6472718715667725
Clinet index 6, End of Epoch 3/6, Average Loss=3.2641830444335938, Class Loss=1.6169111728668213, Reg Loss=1.6472718715667725
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.4757177829742432, Reg Loss=1.6180437803268433
Clinet index 6, End of Epoch 4/6, Average Loss=3.093761444091797, Class Loss=1.4757177829742432, Reg Loss=1.6180437803268433
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.1915606260299683, Reg Loss=1.6109843254089355
Clinet index 6, End of Epoch 5/6, Average Loss=2.8025450706481934, Class Loss=1.1915606260299683, Reg Loss=1.6109843254089355
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9038347005844116, Reg Loss=1.502970814704895
Clinet index 6, End of Epoch 6/6, Average Loss=2.4068055152893066, Class Loss=0.9038347005844116, Reg Loss=1.502970814704895
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=1.958821177482605, Reg Loss=2.9338605403900146
Clinet index 0, End of Epoch 1/6, Average Loss=4.89268159866333, Class Loss=1.958821177482605, Reg Loss=2.9338605403900146
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.751317024230957, Reg Loss=1.9733182191848755
Clinet index 0, End of Epoch 2/6, Average Loss=3.724635124206543, Class Loss=1.751317024230957, Reg Loss=1.9733182191848755
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.6208430528640747, Reg Loss=1.6826568841934204
Clinet index 0, End of Epoch 3/6, Average Loss=3.303499937057495, Class Loss=1.6208430528640747, Reg Loss=1.6826568841934204
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.4506443738937378, Reg Loss=1.6499289274215698
Clinet index 0, End of Epoch 4/6, Average Loss=3.1005733013153076, Class Loss=1.4506443738937378, Reg Loss=1.6499289274215698
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.176291584968567, Reg Loss=1.540873646736145
Clinet index 0, End of Epoch 5/6, Average Loss=2.717165231704712, Class Loss=1.176291584968567, Reg Loss=1.540873646736145
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=1.0487781763076782, Reg Loss=1.6635158061981201
Clinet index 0, End of Epoch 6/6, Average Loss=2.712294101715088, Class Loss=1.0487781763076782, Reg Loss=1.6635158061981201
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.6747541427612305, Reg Loss=2.4546804428100586
Clinet index 16, End of Epoch 1/6, Average Loss=4.129434585571289, Class Loss=1.6747541427612305, Reg Loss=2.4546804428100586
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.5971479415893555, Reg Loss=1.5856401920318604
Clinet index 16, End of Epoch 2/6, Average Loss=3.182788133621216, Class Loss=1.5971479415893555, Reg Loss=1.5856401920318604
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5822718143463135, Reg Loss=1.6505085229873657
Clinet index 16, End of Epoch 3/6, Average Loss=3.2327804565429688, Class Loss=1.5822718143463135, Reg Loss=1.6505085229873657
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.224258542060852, Reg Loss=1.470261812210083
Clinet index 16, End of Epoch 4/6, Average Loss=2.6945204734802246, Class Loss=1.224258542060852, Reg Loss=1.470261812210083
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.113535761833191, Reg Loss=1.560761570930481
Clinet index 16, End of Epoch 5/6, Average Loss=2.674297332763672, Class Loss=1.113535761833191, Reg Loss=1.560761570930481
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8818668127059937, Reg Loss=1.5258234739303589
Clinet index 16, End of Epoch 6/6, Average Loss=2.4076902866363525, Class Loss=0.8818668127059937, Reg Loss=1.5258234739303589
federated aggregation...
Validation, Class Loss=0.4180432856082916, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.836946
Mean Acc: 0.414356
FreqW Acc: 0.707944
Mean IoU: 0.390825
Class IoU:
	class 0: 0.816572
	class 1: 0.46725786
	class 2: 0.30401248
	class 3: 0.267672
	class 4: 0.4534101
	class 5: 0.412248
	class 6: 0.7943336
	class 7: 0.73664594
	class 8: 0.4068352
	class 9: 0.09943177
	class 10: 0.2548988
	class 11: 0.10622435
	class 12: 0.34740722
	class 13: 0.46038815
	class 14: 0.44752535
	class 15: 0.6237715
	class 16: 0.035629988
	class 17: 0.00059240457
Class Acc:
	class 0: 0.9947239
	class 1: 0.46854773
	class 2: 0.3987708
	class 3: 0.26793033
	class 4: 0.4766761
	class 5: 0.42062283
	class 6: 0.8003314
	class 7: 0.7741849
	class 8: 0.40794364
	class 9: 0.10042689
	class 10: 0.2579142
	class 11: 0.10686778
	class 12: 0.36226764
	class 13: 0.48082182
	class 14: 0.45254976
	class 15: 0.6406628
	class 16: 0.04657292
	class 17: 0.00060054543

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.8921315670013428, Reg Loss=1.672866940498352
Clinet index 0, End of Epoch 1/6, Average Loss=2.5649986267089844, Class Loss=0.8921315670013428, Reg Loss=1.672866940498352
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.8429638147354126, Reg Loss=1.540102481842041
Clinet index 0, End of Epoch 2/6, Average Loss=2.383066177368164, Class Loss=0.8429638147354126, Reg Loss=1.540102481842041
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7862251996994019, Reg Loss=1.4873754978179932
Clinet index 0, End of Epoch 3/6, Average Loss=2.2736005783081055, Class Loss=0.7862251996994019, Reg Loss=1.4873754978179932
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.6611129641532898, Reg Loss=1.5318681001663208
Clinet index 0, End of Epoch 4/6, Average Loss=2.192981004714966, Class Loss=0.6611129641532898, Reg Loss=1.5318681001663208
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5813703536987305, Reg Loss=1.4443202018737793
Clinet index 0, End of Epoch 5/6, Average Loss=2.0256905555725098, Class Loss=0.5813703536987305, Reg Loss=1.4443202018737793
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5263035893440247, Reg Loss=1.5455061197280884
Clinet index 0, End of Epoch 6/6, Average Loss=2.071809768676758, Class Loss=0.5263035893440247, Reg Loss=1.5455061197280884
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8662035465240479, Reg Loss=1.630998969078064
Clinet index 12, End of Epoch 1/6, Average Loss=2.4972023963928223, Class Loss=0.8662035465240479, Reg Loss=1.630998969078064
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.9014971852302551, Reg Loss=1.6316330432891846
Clinet index 12, End of Epoch 2/6, Average Loss=2.533130168914795, Class Loss=0.9014971852302551, Reg Loss=1.6316330432891846
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.8157007098197937, Reg Loss=1.5873643159866333
Clinet index 12, End of Epoch 3/6, Average Loss=2.4030649662017822, Class Loss=0.8157007098197937, Reg Loss=1.5873643159866333
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5827133059501648, Reg Loss=1.405719518661499
Clinet index 12, End of Epoch 4/6, Average Loss=1.9884328842163086, Class Loss=0.5827133059501648, Reg Loss=1.405719518661499
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4915088415145874, Reg Loss=1.3733620643615723
Clinet index 12, End of Epoch 5/6, Average Loss=1.8648709058761597, Class Loss=0.4915088415145874, Reg Loss=1.3733620643615723
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.441099613904953, Reg Loss=1.5029122829437256
Clinet index 12, End of Epoch 6/6, Average Loss=1.944011926651001, Class Loss=0.441099613904953, Reg Loss=1.5029122829437256
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8929581642150879, Reg Loss=1.6534066200256348
Clinet index 10, End of Epoch 1/6, Average Loss=2.5463647842407227, Class Loss=0.8929581642150879, Reg Loss=1.6534066200256348
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.8553057312965393, Reg Loss=1.4934204816818237
Clinet index 10, End of Epoch 2/6, Average Loss=2.348726272583008, Class Loss=0.8553057312965393, Reg Loss=1.4934204816818237
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.7929489612579346, Reg Loss=1.5949546098709106
Clinet index 10, End of Epoch 3/6, Average Loss=2.3879036903381348, Class Loss=0.7929489612579346, Reg Loss=1.5949546098709106
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6092699766159058, Reg Loss=1.3921765089035034
Clinet index 10, End of Epoch 4/6, Average Loss=2.001446485519409, Class Loss=0.6092699766159058, Reg Loss=1.3921765089035034
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5516566038131714, Reg Loss=1.3577167987823486
Clinet index 10, End of Epoch 5/6, Average Loss=1.90937340259552, Class Loss=0.5516566038131714, Reg Loss=1.3577167987823486
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.43133947253227234, Reg Loss=1.408290982246399
Clinet index 10, End of Epoch 6/6, Average Loss=1.8396304845809937, Class Loss=0.43133947253227234, Reg Loss=1.408290982246399
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8112788200378418, Reg Loss=1.379624605178833
Clinet index 17, End of Epoch 1/6, Average Loss=2.190903425216675, Class Loss=0.8112788200378418, Reg Loss=1.379624605178833
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.8106215000152588, Reg Loss=1.5425605773925781
Clinet index 17, End of Epoch 2/6, Average Loss=2.353182077407837, Class Loss=0.8106215000152588, Reg Loss=1.5425605773925781
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.7307561635971069, Reg Loss=1.4215059280395508
Clinet index 17, End of Epoch 3/6, Average Loss=2.1522622108459473, Class Loss=0.7307561635971069, Reg Loss=1.4215059280395508
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6427084803581238, Reg Loss=1.4262969493865967
Clinet index 17, End of Epoch 4/6, Average Loss=2.0690054893493652, Class Loss=0.6427084803581238, Reg Loss=1.4262969493865967
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5307977795600891, Reg Loss=1.4614018201828003
Clinet index 17, End of Epoch 5/6, Average Loss=1.9921996593475342, Class Loss=0.5307977795600891, Reg Loss=1.4614018201828003
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.47102200984954834, Reg Loss=1.4848352670669556
Clinet index 17, End of Epoch 6/6, Average Loss=1.955857276916504, Class Loss=0.47102200984954834, Reg Loss=1.4848352670669556
federated aggregation...
Validation, Class Loss=0.41812771558761597, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.838017
Mean Acc: 0.433683
FreqW Acc: 0.722677
Mean IoU: 0.399933
Class IoU:
	class 0: 0.83754873
	class 1: 0.46453232
	class 2: 0.2843313
	class 3: 0.24513382
	class 4: 0.4973058
	class 5: 0.4628606
	class 6: 0.8202224
	class 7: 0.687331
	class 8: 0.42039633
	class 9: 0.08268965
	class 10: 0.1868582
	class 11: 0.11106922
	class 12: 0.36243254
	class 13: 0.5070521
	class 14: 0.47964832
	class 15: 0.5912485
	class 16: 0.0436574
	class 17: 0.114482485
Class Acc:
	class 0: 0.99447453
	class 1: 0.46561074
	class 2: 0.35225606
	class 3: 0.24530989
	class 4: 0.53231466
	class 5: 0.47383928
	class 6: 0.8303572
	class 7: 0.694539
	class 8: 0.42125916
	class 9: 0.083811335
	class 10: 0.18766779
	class 11: 0.11178548
	class 12: 0.3654714
	class 13: 0.5180003
	class 14: 0.48640764
	class 15: 0.59990925
	class 16: 0.05066603
	class 17: 0.39261526

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.42068013548851013, Reg Loss=1.4904321432113647
Clinet index 14, End of Epoch 1/6, Average Loss=1.9111123085021973, Class Loss=0.42068013548851013, Reg Loss=1.4904321432113647
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.4126957356929779, Reg Loss=1.4289381504058838
Clinet index 14, End of Epoch 2/6, Average Loss=1.841633915901184, Class Loss=0.4126957356929779, Reg Loss=1.4289381504058838
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.4589557945728302, Reg Loss=1.494490623474121
Clinet index 14, End of Epoch 3/6, Average Loss=1.953446388244629, Class Loss=0.4589557945728302, Reg Loss=1.494490623474121
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3595229983329773, Reg Loss=1.3804000616073608
Clinet index 14, End of Epoch 4/6, Average Loss=1.7399230003356934, Class Loss=0.3595229983329773, Reg Loss=1.3804000616073608
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.35079225897789, Reg Loss=1.519254207611084
Clinet index 14, End of Epoch 5/6, Average Loss=1.8700464963912964, Class Loss=0.35079225897789, Reg Loss=1.519254207611084
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.2679963707923889, Reg Loss=1.3224526643753052
Clinet index 14, End of Epoch 6/6, Average Loss=1.5904490947723389, Class Loss=0.2679963707923889, Reg Loss=1.3224526643753052
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.38028085231781006, Reg Loss=1.364669680595398
Clinet index 8, End of Epoch 1/6, Average Loss=1.744950532913208, Class Loss=0.38028085231781006, Reg Loss=1.364669680595398
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.31858038902282715, Reg Loss=1.242315411567688
Clinet index 8, End of Epoch 2/6, Average Loss=1.5608958005905151, Class Loss=0.31858038902282715, Reg Loss=1.242315411567688
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3346499800682068, Reg Loss=1.20936918258667
Clinet index 8, End of Epoch 3/6, Average Loss=1.5440192222595215, Class Loss=0.3346499800682068, Reg Loss=1.20936918258667
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.2942656874656677, Reg Loss=1.2232236862182617
Clinet index 8, End of Epoch 4/6, Average Loss=1.5174894332885742, Class Loss=0.2942656874656677, Reg Loss=1.2232236862182617
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.24165642261505127, Reg Loss=1.216681957244873
Clinet index 8, End of Epoch 5/6, Average Loss=1.4583383798599243, Class Loss=0.24165642261505127, Reg Loss=1.216681957244873
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.22228798270225525, Reg Loss=1.2070039510726929
Clinet index 8, End of Epoch 6/6, Average Loss=1.4292919635772705, Class Loss=0.22228798270225525, Reg Loss=1.2070039510726929
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3729549050331116, Reg Loss=1.3771628141403198
Clinet index 16, End of Epoch 1/6, Average Loss=1.7501177787780762, Class Loss=0.3729549050331116, Reg Loss=1.3771628141403198
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.3373733162879944, Reg Loss=1.2480729818344116
Clinet index 16, End of Epoch 2/6, Average Loss=1.5854463577270508, Class Loss=0.3373733162879944, Reg Loss=1.2480729818344116
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.40711814165115356, Reg Loss=1.4570657014846802
Clinet index 16, End of Epoch 3/6, Average Loss=1.8641839027404785, Class Loss=0.40711814165115356, Reg Loss=1.4570657014846802
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.2952333390712738, Reg Loss=1.2611335515975952
Clinet index 16, End of Epoch 4/6, Average Loss=1.5563669204711914, Class Loss=0.2952333390712738, Reg Loss=1.2611335515975952
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.31047067046165466, Reg Loss=1.34376859664917
Clinet index 16, End of Epoch 5/6, Average Loss=1.654239296913147, Class Loss=0.31047067046165466, Reg Loss=1.34376859664917
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.2821553349494934, Reg Loss=1.331884503364563
Clinet index 16, End of Epoch 6/6, Average Loss=1.6140398979187012, Class Loss=0.2821553349494934, Reg Loss=1.331884503364563
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.37905153632164, Reg Loss=1.2513384819030762
Clinet index 3, End of Epoch 1/6, Average Loss=1.6303900480270386, Class Loss=0.37905153632164, Reg Loss=1.2513384819030762
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.4696201682090759, Reg Loss=1.2444114685058594
Clinet index 3, End of Epoch 2/6, Average Loss=1.71403169631958, Class Loss=0.4696201682090759, Reg Loss=1.2444114685058594
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.4231056869029999, Reg Loss=1.3487889766693115
Clinet index 3, End of Epoch 3/6, Average Loss=1.7718946933746338, Class Loss=0.4231056869029999, Reg Loss=1.3487889766693115
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3339087665081024, Reg Loss=1.3099254369735718
Clinet index 3, End of Epoch 4/6, Average Loss=1.6438342332839966, Class Loss=0.3339087665081024, Reg Loss=1.3099254369735718
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.24976928532123566, Reg Loss=1.2100069522857666
Clinet index 3, End of Epoch 5/6, Average Loss=1.4597762823104858, Class Loss=0.24976928532123566, Reg Loss=1.2100069522857666
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.26741474866867065, Reg Loss=1.3456658124923706
Clinet index 3, End of Epoch 6/6, Average Loss=1.6130805015563965, Class Loss=0.26741474866867065, Reg Loss=1.3456658124923706
federated aggregation...
Validation, Class Loss=0.4713633358478546, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.819755
Mean Acc: 0.387388
FreqW Acc: 0.721743
Mean IoU: 0.336428
Class IoU:
	class 0: 0.86451787
	class 1: 0.40440091
	class 2: 0.26036528
	class 3: 0.030040238
	class 4: 0.45331714
	class 5: 0.4517742
	class 6: 0.7930296
	class 7: 0.6073683
	class 8: 0.23271535
	class 9: 0.06698517
	class 10: 0.02379678
	class 11: 0.08992888
	class 12: 0.1857359
	class 13: 0.38868105
	class 14: 0.45399594
	class 15: 0.62073416
	class 16: 0.035284106
	class 17: 0.093026444
Class Acc:
	class 0: 0.9919609
	class 1: 0.4049354
	class 2: 0.3144653
	class 3: 0.030040422
	class 4: 0.47882175
	class 5: 0.46246853
	class 6: 0.80092734
	class 7: 0.6096117
	class 8: 0.23301399
	class 9: 0.06764645
	class 10: 0.023801105
	class 11: 0.09027009
	class 12: 0.18623382
	class 13: 0.39315963
	class 14: 0.45941356
	class 15: 0.6295799
	class 16: 0.03587525
	class 17: 0.760752

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.2361297309398651, Reg Loss=1.3121147155761719
Clinet index 17, End of Epoch 1/6, Average Loss=1.5482444763183594, Class Loss=0.2361297309398651, Reg Loss=1.3121147155761719
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.2389899641275406, Reg Loss=1.3190420866012573
Clinet index 17, End of Epoch 2/6, Average Loss=1.5580320358276367, Class Loss=0.2389899641275406, Reg Loss=1.3190420866012573
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.22593551874160767, Reg Loss=1.2719041109085083
Clinet index 17, End of Epoch 3/6, Average Loss=1.4978396892547607, Class Loss=0.22593551874160767, Reg Loss=1.2719041109085083
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.2260027825832367, Reg Loss=1.2605645656585693
Clinet index 17, End of Epoch 4/6, Average Loss=1.4865673780441284, Class Loss=0.2260027825832367, Reg Loss=1.2605645656585693
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.19433414936065674, Reg Loss=1.390537142753601
Clinet index 17, End of Epoch 5/6, Average Loss=1.5848712921142578, Class Loss=0.19433414936065674, Reg Loss=1.390537142753601
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.21270941197872162, Reg Loss=1.3456459045410156
Clinet index 17, End of Epoch 6/6, Average Loss=1.5583553314208984, Class Loss=0.21270941197872162, Reg Loss=1.3456459045410156
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2223149836063385, Reg Loss=1.1806974411010742
Clinet index 13, End of Epoch 1/6, Average Loss=1.4030123949050903, Class Loss=0.2223149836063385, Reg Loss=1.1806974411010742
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.21571336686611176, Reg Loss=1.1122634410858154
Clinet index 13, End of Epoch 2/6, Average Loss=1.3279768228530884, Class Loss=0.21571336686611176, Reg Loss=1.1122634410858154
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.22295984625816345, Reg Loss=1.094104290008545
Clinet index 13, End of Epoch 3/6, Average Loss=1.3170641660690308, Class Loss=0.22295984625816345, Reg Loss=1.094104290008545
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.22367459535598755, Reg Loss=1.132154941558838
Clinet index 13, End of Epoch 4/6, Average Loss=1.3558294773101807, Class Loss=0.22367459535598755, Reg Loss=1.132154941558838
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.1893748939037323, Reg Loss=0.9959155321121216
Clinet index 13, End of Epoch 5/6, Average Loss=1.1852904558181763, Class Loss=0.1893748939037323, Reg Loss=0.9959155321121216
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1974738985300064, Reg Loss=1.1546862125396729
Clinet index 13, End of Epoch 6/6, Average Loss=1.352160096168518, Class Loss=0.1974738985300064, Reg Loss=1.1546862125396729
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.18228574097156525, Reg Loss=1.141174077987671
Clinet index 11, End of Epoch 1/6, Average Loss=1.3234598636627197, Class Loss=0.18228574097156525, Reg Loss=1.141174077987671
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.22306379675865173, Reg Loss=1.2004272937774658
Clinet index 11, End of Epoch 2/6, Average Loss=1.42349112033844, Class Loss=0.22306379675865173, Reg Loss=1.2004272937774658
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.1998676061630249, Reg Loss=1.1503734588623047
Clinet index 11, End of Epoch 3/6, Average Loss=1.3502410650253296, Class Loss=0.1998676061630249, Reg Loss=1.1503734588623047
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.19085291028022766, Reg Loss=1.2516883611679077
Clinet index 11, End of Epoch 4/6, Average Loss=1.442541241645813, Class Loss=0.19085291028022766, Reg Loss=1.2516883611679077
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.20251789689064026, Reg Loss=1.3587067127227783
Clinet index 11, End of Epoch 5/6, Average Loss=1.5612245798110962, Class Loss=0.20251789689064026, Reg Loss=1.3587067127227783
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.17179933190345764, Reg Loss=1.136145830154419
Clinet index 11, End of Epoch 6/6, Average Loss=1.3079451322555542, Class Loss=0.17179933190345764, Reg Loss=1.136145830154419
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.33465883135795593, Reg Loss=1.5595300197601318
Clinet index 7, End of Epoch 1/6, Average Loss=1.8941888809204102, Class Loss=0.33465883135795593, Reg Loss=1.5595300197601318
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2844773828983307, Reg Loss=1.4576749801635742
Clinet index 7, End of Epoch 2/6, Average Loss=1.7421523332595825, Class Loss=0.2844773828983307, Reg Loss=1.4576749801635742
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.23239503800868988, Reg Loss=1.3852242231369019
Clinet index 7, End of Epoch 3/6, Average Loss=1.617619276046753, Class Loss=0.23239503800868988, Reg Loss=1.3852242231369019
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.21152105927467346, Reg Loss=1.3555182218551636
Clinet index 7, End of Epoch 4/6, Average Loss=1.5670392513275146, Class Loss=0.21152105927467346, Reg Loss=1.3555182218551636
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.26172566413879395, Reg Loss=1.3553236722946167
Clinet index 7, End of Epoch 5/6, Average Loss=1.6170493364334106, Class Loss=0.26172566413879395, Reg Loss=1.3553236722946167
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.20486417412757874, Reg Loss=1.3416244983673096
Clinet index 7, End of Epoch 6/6, Average Loss=1.546488642692566, Class Loss=0.20486417412757874, Reg Loss=1.3416244983673096
federated aggregation...
Validation, Class Loss=0.5136064887046814, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.809631
Mean Acc: 0.367857
FreqW Acc: 0.721104
Mean IoU: 0.310486
Class IoU:
	class 0: 0.8769087
	class 1: 0.380358
	class 2: 0.25227028
	class 3: 0.00084526744
	class 4: 0.47258344
	class 5: 0.42651743
	class 6: 0.7946573
	class 7: 0.5419836
	class 8: 0.12745853
	class 9: 0.053296674
	class 10: 0.0067638718
	class 11: 0.08737732
	class 12: 0.073512495
	class 13: 0.30624056
	class 14: 0.463865
	class 15: 0.6313462
	class 16: 0.008694497
	class 17: 0.08406004
Class Acc:
	class 0: 0.9889911
	class 1: 0.3808447
	class 2: 0.3045487
	class 3: 0.00084526767
	class 4: 0.5011573
	class 5: 0.4356662
	class 6: 0.8028201
	class 7: 0.54306257
	class 8: 0.1275125
	class 9: 0.05370667
	class 10: 0.0067640804
	class 11: 0.08763054
	class 12: 0.07359919
	class 13: 0.30846024
	class 14: 0.4693481
	class 15: 0.64056945
	class 16: 0.008739301
	class 17: 0.88715225

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.18294119834899902, Reg Loss=1.2570509910583496
Clinet index 17, End of Epoch 1/6, Average Loss=1.4399921894073486, Class Loss=0.18294119834899902, Reg Loss=1.2570509910583496
Pseudo labeling is: None
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.19059967994689941, Reg Loss=1.3967000246047974
Clinet index 17, End of Epoch 2/6, Average Loss=1.5872997045516968, Class Loss=0.19059967994689941, Reg Loss=1.3967000246047974
Pseudo labeling is: None
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.18453338742256165, Reg Loss=1.2396786212921143
Clinet index 17, End of Epoch 3/6, Average Loss=1.4242119789123535, Class Loss=0.18453338742256165, Reg Loss=1.2396786212921143
Pseudo labeling is: None
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.1887480616569519, Reg Loss=1.2664844989776611
Clinet index 17, End of Epoch 4/6, Average Loss=1.4552326202392578, Class Loss=0.1887480616569519, Reg Loss=1.2664844989776611
Pseudo labeling is: None
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.18458440899848938, Reg Loss=1.4221503734588623
Clinet index 17, End of Epoch 5/6, Average Loss=1.6067347526550293, Class Loss=0.18458440899848938, Reg Loss=1.4221503734588623
Pseudo labeling is: None
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.1932598054409027, Reg Loss=1.352089762687683
Clinet index 17, End of Epoch 6/6, Average Loss=1.5453495979309082, Class Loss=0.1932598054409027, Reg Loss=1.352089762687683
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19572405517101288, Reg Loss=1.052774429321289
Clinet index 4, End of Epoch 1/6, Average Loss=1.2484984397888184, Class Loss=0.19572405517101288, Reg Loss=1.052774429321289
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.18000414967536926, Reg Loss=1.0563054084777832
Clinet index 4, End of Epoch 2/6, Average Loss=1.23630952835083, Class Loss=0.18000414967536926, Reg Loss=1.0563054084777832
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.18452398478984833, Reg Loss=1.2350554466247559
Clinet index 4, End of Epoch 3/6, Average Loss=1.4195793867111206, Class Loss=0.18452398478984833, Reg Loss=1.2350554466247559
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.186551034450531, Reg Loss=1.0843253135681152
Clinet index 4, End of Epoch 4/6, Average Loss=1.270876407623291, Class Loss=0.186551034450531, Reg Loss=1.0843253135681152
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.18254710733890533, Reg Loss=1.1682480573654175
Clinet index 4, End of Epoch 5/6, Average Loss=1.3507951498031616, Class Loss=0.18254710733890533, Reg Loss=1.1682480573654175
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1965244561433792, Reg Loss=1.1165401935577393
Clinet index 4, End of Epoch 6/6, Average Loss=1.313064694404602, Class Loss=0.1965244561433792, Reg Loss=1.1165401935577393
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.18743225932121277, Reg Loss=1.1783097982406616
Clinet index 5, End of Epoch 1/6, Average Loss=1.3657420873641968, Class Loss=0.18743225932121277, Reg Loss=1.1783097982406616
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.20116311311721802, Reg Loss=1.2428195476531982
Clinet index 5, End of Epoch 2/6, Average Loss=1.4439826011657715, Class Loss=0.20116311311721802, Reg Loss=1.2428195476531982
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.24010713398456573, Reg Loss=1.2285996675491333
Clinet index 5, End of Epoch 3/6, Average Loss=1.4687068462371826, Class Loss=0.24010713398456573, Reg Loss=1.2285996675491333
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.17055316269397736, Reg Loss=1.1795467138290405
Clinet index 5, End of Epoch 4/6, Average Loss=1.3500999212265015, Class Loss=0.17055316269397736, Reg Loss=1.1795467138290405
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.19386397302150726, Reg Loss=1.3125139474868774
Clinet index 5, End of Epoch 5/6, Average Loss=1.506377935409546, Class Loss=0.19386397302150726, Reg Loss=1.3125139474868774
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1704128235578537, Reg Loss=1.1356711387634277
Clinet index 5, End of Epoch 6/6, Average Loss=1.3060839176177979, Class Loss=0.1704128235578537, Reg Loss=1.1356711387634277
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.27091023325920105, Reg Loss=1.3580844402313232
Clinet index 2, End of Epoch 1/6, Average Loss=1.6289947032928467, Class Loss=0.27091023325920105, Reg Loss=1.3580844402313232
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.22436758875846863, Reg Loss=1.0651202201843262
Clinet index 2, End of Epoch 2/6, Average Loss=1.2894878387451172, Class Loss=0.22436758875846863, Reg Loss=1.0651202201843262
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2578813135623932, Reg Loss=1.2845538854599
Clinet index 2, End of Epoch 3/6, Average Loss=1.5424351692199707, Class Loss=0.2578813135623932, Reg Loss=1.2845538854599
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2302490770816803, Reg Loss=1.1178566217422485
Clinet index 2, End of Epoch 4/6, Average Loss=1.3481056690216064, Class Loss=0.2302490770816803, Reg Loss=1.1178566217422485
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.20391511917114258, Reg Loss=1.175291657447815
Clinet index 2, End of Epoch 5/6, Average Loss=1.3792067766189575, Class Loss=0.20391511917114258, Reg Loss=1.175291657447815
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.20471331477165222, Reg Loss=1.1822823286056519
Clinet index 2, End of Epoch 6/6, Average Loss=1.3869956731796265, Class Loss=0.20471331477165222, Reg Loss=1.1822823286056519
federated aggregation...
Validation, Class Loss=0.5286204218864441, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.807056
Mean Acc: 0.358828
FreqW Acc: 0.718828
Mean IoU: 0.300948
Class IoU:
	class 0: 0.87742853
	class 1: 0.34378004
	class 2: 0.24104969
	class 3: 5.655684e-06
	class 4: 0.47976357
	class 5: 0.4127073
	class 6: 0.7920767
	class 7: 0.5101335
	class 8: 0.10824311
	class 9: 0.05266981
	class 10: 0.0039191195
	class 11: 0.07950565
	class 12: 0.0569684
	class 13: 0.27329567
	class 14: 0.45873296
	class 15: 0.63671666
	class 16: 0.0072488952
	class 17: 0.082812734
Class Acc:
	class 0: 0.98893094
	class 1: 0.3441371
	class 2: 0.28892982
	class 3: 5.655684e-06
	class 4: 0.51033753
	class 5: 0.42157632
	class 6: 0.80030495
	class 7: 0.5109964
	class 8: 0.10827964
	class 9: 0.053099122
	class 10: 0.003919177
	class 11: 0.079674296
	class 12: 0.057015814
	class 13: 0.27471203
	class 14: 0.4639264
	class 15: 0.6458905
	class 16: 0.007288865
	class 17: 0.8998811

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.371089458465576, Reg Loss=1.962784767150879
Clinet index 17, End of Epoch 1/6, Average Loss=4.333874225616455, Class Loss=2.371089458465576, Reg Loss=1.962784767150879
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.9489585161209106, Reg Loss=1.7671843767166138
Clinet index 17, End of Epoch 2/6, Average Loss=3.7161428928375244, Class Loss=1.9489585161209106, Reg Loss=1.7671843767166138
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.4964368343353271, Reg Loss=1.7872306108474731
Clinet index 17, End of Epoch 3/6, Average Loss=3.28366756439209, Class Loss=1.4964368343353271, Reg Loss=1.7872306108474731
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1833549737930298, Reg Loss=1.7914737462997437
Clinet index 17, End of Epoch 4/6, Average Loss=2.9748287200927734, Class Loss=1.1833549737930298, Reg Loss=1.7914737462997437
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9431819915771484, Reg Loss=1.741283655166626
Clinet index 17, End of Epoch 5/6, Average Loss=2.6844656467437744, Class Loss=0.9431819915771484, Reg Loss=1.741283655166626
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7541444897651672, Reg Loss=1.7008821964263916
Clinet index 17, End of Epoch 6/6, Average Loss=2.455026626586914, Class Loss=0.7541444897651672, Reg Loss=1.7008821964263916
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.4671478271484375, Reg Loss=2.0749800205230713
Clinet index 21, End of Epoch 1/6, Average Loss=4.54212760925293, Class Loss=2.4671478271484375, Reg Loss=2.0749800205230713
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.9809486865997314, Reg Loss=1.8038885593414307
Clinet index 21, End of Epoch 2/6, Average Loss=3.784837245941162, Class Loss=1.9809486865997314, Reg Loss=1.8038885593414307
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5460542440414429, Reg Loss=1.8147289752960205
Clinet index 21, End of Epoch 3/6, Average Loss=3.360783100128174, Class Loss=1.5460542440414429, Reg Loss=1.8147289752960205
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.2012611627578735, Reg Loss=1.827006220817566
Clinet index 21, End of Epoch 4/6, Average Loss=3.0282673835754395, Class Loss=1.2012611627578735, Reg Loss=1.827006220817566
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9458068609237671, Reg Loss=1.8110300302505493
Clinet index 21, End of Epoch 5/6, Average Loss=2.7568368911743164, Class Loss=0.9458068609237671, Reg Loss=1.8110300302505493
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7179324626922607, Reg Loss=1.785326361656189
Clinet index 21, End of Epoch 6/6, Average Loss=2.50325870513916, Class Loss=0.7179324626922607, Reg Loss=1.785326361656189
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.4710915088653564, Reg Loss=1.9743951559066772
Clinet index 10, End of Epoch 1/6, Average Loss=4.445486545562744, Class Loss=2.4710915088653564, Reg Loss=1.9743951559066772
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.9688667058944702, Reg Loss=1.7357769012451172
Clinet index 10, End of Epoch 2/6, Average Loss=3.704643726348877, Class Loss=1.9688667058944702, Reg Loss=1.7357769012451172
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5294904708862305, Reg Loss=1.8229719400405884
Clinet index 10, End of Epoch 3/6, Average Loss=3.3524622917175293, Class Loss=1.5294904708862305, Reg Loss=1.8229719400405884
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1895607709884644, Reg Loss=1.8243111371994019
Clinet index 10, End of Epoch 4/6, Average Loss=3.013871908187866, Class Loss=1.1895607709884644, Reg Loss=1.8243111371994019
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.936139702796936, Reg Loss=1.823455572128296
Clinet index 10, End of Epoch 5/6, Average Loss=2.7595953941345215, Class Loss=0.936139702796936, Reg Loss=1.823455572128296
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7111219763755798, Reg Loss=1.7680108547210693
Clinet index 10, End of Epoch 6/6, Average Loss=2.479132890701294, Class Loss=0.7111219763755798, Reg Loss=1.7680108547210693
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=2.3650121688842773, Reg Loss=2.0611350536346436
Clinet index 5, End of Epoch 1/6, Average Loss=4.4261474609375, Class Loss=2.3650121688842773, Reg Loss=2.0611350536346436
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.9013980627059937, Reg Loss=1.8628032207489014
Clinet index 5, End of Epoch 2/6, Average Loss=3.7642011642456055, Class Loss=1.9013980627059937, Reg Loss=1.8628032207489014
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.508362054824829, Reg Loss=1.919657588005066
Clinet index 5, End of Epoch 3/6, Average Loss=3.4280195236206055, Class Loss=1.508362054824829, Reg Loss=1.919657588005066
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1885945796966553, Reg Loss=1.8282930850982666
Clinet index 5, End of Epoch 4/6, Average Loss=3.016887664794922, Class Loss=1.1885945796966553, Reg Loss=1.8282930850982666
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9222699403762817, Reg Loss=1.7711061239242554
Clinet index 5, End of Epoch 5/6, Average Loss=2.693376064300537, Class Loss=0.9222699403762817, Reg Loss=1.7711061239242554
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7310484051704407, Reg Loss=1.7785934209823608
Clinet index 5, End of Epoch 6/6, Average Loss=2.5096418857574463, Class Loss=0.7310484051704407, Reg Loss=1.7785934209823608
federated aggregation...
Validation, Class Loss=0.5492260456085205, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.794078
Mean Acc: 0.364252
FreqW Acc: 0.671833
Mean IoU: 0.330514
Class IoU:
	class 0: 0.8224201
	class 1: 0.5503086
	class 2: 0.3011617
	class 3: 0.024343763
	class 4: 0.4997504
	class 5: 0.4645171
	class 6: 0.8226178
	class 7: 0.48541182
	class 8: 0.07121866
	class 9: 0.023008391
	class 10: 0.4128197
	class 11: 0.06440326
	class 12: 0.06579698
	class 13: 0.48578924
	class 14: 0.59324056
	class 15: 0.44530842
	class 16: 2.6329597e-05
	class 17: 0.042211358
	class 18: 0.10541609
Class Acc:
	class 0: 0.99115837
	class 1: 0.5521331
	class 2: 0.38588268
	class 3: 0.024343863
	class 4: 0.5330395
	class 5: 0.4742346
	class 6: 0.8316516
	class 7: 0.48614344
	class 8: 0.07122883
	class 9: 0.023038175
	class 10: 0.41795474
	class 11: 0.06442916
	class 12: 0.06582739
	class 13: 0.49025208
	class 14: 0.61087716
	class 15: 0.447009
	class 16: 2.6337362e-05
	class 17: 0.21217647
	class 18: 0.2393726

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6789752840995789, Reg Loss=1.744026780128479
Clinet index 19, End of Epoch 1/6, Average Loss=2.423002004623413, Class Loss=0.6789752840995789, Reg Loss=1.744026780128479
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.6137074828147888, Reg Loss=1.6836742162704468
Clinet index 19, End of Epoch 2/6, Average Loss=2.297381639480591, Class Loss=0.6137074828147888, Reg Loss=1.6836742162704468
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5511667728424072, Reg Loss=1.6960221529006958
Clinet index 19, End of Epoch 3/6, Average Loss=2.2471890449523926, Class Loss=0.5511667728424072, Reg Loss=1.6960221529006958
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.49627432227134705, Reg Loss=1.6995755434036255
Clinet index 19, End of Epoch 4/6, Average Loss=2.195849895477295, Class Loss=0.49627432227134705, Reg Loss=1.6995755434036255
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4449847936630249, Reg Loss=1.6003607511520386
Clinet index 19, End of Epoch 5/6, Average Loss=2.0453455448150635, Class Loss=0.4449847936630249, Reg Loss=1.6003607511520386
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4470963180065155, Reg Loss=1.674556016921997
Clinet index 19, End of Epoch 6/6, Average Loss=2.121652364730835, Class Loss=0.4470963180065155, Reg Loss=1.674556016921997
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.695483922958374, Reg Loss=1.7666277885437012
Clinet index 11, End of Epoch 1/6, Average Loss=2.462111711502075, Class Loss=0.695483922958374, Reg Loss=1.7666277885437012
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.6228129863739014, Reg Loss=1.7682011127471924
Clinet index 11, End of Epoch 2/6, Average Loss=2.3910140991210938, Class Loss=0.6228129863739014, Reg Loss=1.7682011127471924
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5297526717185974, Reg Loss=1.6755788326263428
Clinet index 11, End of Epoch 3/6, Average Loss=2.205331563949585, Class Loss=0.5297526717185974, Reg Loss=1.6755788326263428
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5074160695075989, Reg Loss=1.6980488300323486
Clinet index 11, End of Epoch 4/6, Average Loss=2.2054648399353027, Class Loss=0.5074160695075989, Reg Loss=1.6980488300323486
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.46826234459877014, Reg Loss=1.7051281929016113
Clinet index 11, End of Epoch 5/6, Average Loss=2.1733906269073486, Class Loss=0.46826234459877014, Reg Loss=1.7051281929016113
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4252449870109558, Reg Loss=1.6560171842575073
Clinet index 11, End of Epoch 6/6, Average Loss=2.0812621116638184, Class Loss=0.4252449870109558, Reg Loss=1.6560171842575073
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6932190656661987, Reg Loss=1.8658108711242676
Clinet index 9, End of Epoch 1/6, Average Loss=2.559030055999756, Class Loss=0.6932190656661987, Reg Loss=1.8658108711242676
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.6704418659210205, Reg Loss=1.8292014598846436
Clinet index 9, End of Epoch 2/6, Average Loss=2.499643325805664, Class Loss=0.6704418659210205, Reg Loss=1.8292014598846436
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5671502351760864, Reg Loss=1.8176374435424805
Clinet index 9, End of Epoch 3/6, Average Loss=2.3847875595092773, Class Loss=0.5671502351760864, Reg Loss=1.8176374435424805
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5158036947250366, Reg Loss=1.7852569818496704
Clinet index 9, End of Epoch 4/6, Average Loss=2.301060676574707, Class Loss=0.5158036947250366, Reg Loss=1.7852569818496704
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5003047585487366, Reg Loss=1.8232287168502808
Clinet index 9, End of Epoch 5/6, Average Loss=2.323533535003662, Class Loss=0.5003047585487366, Reg Loss=1.8232287168502808
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.48034265637397766, Reg Loss=1.7412364482879639
Clinet index 9, End of Epoch 6/6, Average Loss=2.221579074859619, Class Loss=0.48034265637397766, Reg Loss=1.7412364482879639
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6766296625137329, Reg Loss=1.8046300411224365
Clinet index 1, End of Epoch 1/6, Average Loss=2.481259822845459, Class Loss=0.6766296625137329, Reg Loss=1.8046300411224365
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.608348548412323, Reg Loss=1.751697063446045
Clinet index 1, End of Epoch 2/6, Average Loss=2.3600456714630127, Class Loss=0.608348548412323, Reg Loss=1.751697063446045
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5473383069038391, Reg Loss=1.7072882652282715
Clinet index 1, End of Epoch 3/6, Average Loss=2.254626512527466, Class Loss=0.5473383069038391, Reg Loss=1.7072882652282715
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4870898127555847, Reg Loss=1.6480861902236938
Clinet index 1, End of Epoch 4/6, Average Loss=2.135175943374634, Class Loss=0.4870898127555847, Reg Loss=1.6480861902236938
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4693763554096222, Reg Loss=1.6664410829544067
Clinet index 1, End of Epoch 5/6, Average Loss=2.135817527770996, Class Loss=0.4693763554096222, Reg Loss=1.6664410829544067
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4531743824481964, Reg Loss=1.6761271953582764
Clinet index 1, End of Epoch 6/6, Average Loss=2.1293015480041504, Class Loss=0.4531743824481964, Reg Loss=1.6761271953582764
federated aggregation...
Validation, Class Loss=0.7225275635719299, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.733148
Mean Acc: 0.290882
FreqW Acc: 0.653945
Mean IoU: 0.238329
Class IoU:
	class 0: 0.8300607
	class 1: 0.4495028
	class 2: 0.17990167
	class 3: 0.008906153
	class 4: 0.35405472
	class 5: 0.3419106
	class 6: 0.8002757
	class 7: 0.045973048
	class 8: 0.027477328
	class 9: 0.001548757
	class 10: 0.15232582
	class 11: 0.015183109
	class 12: 0.046426866
	class 13: 0.17991386
	class 14: 0.48530248
	class 15: 0.48577523
	class 16: 0.0
	class 17: 0.053190734
	class 18: 0.07052129
Class Acc:
	class 0: 0.9248449
	class 1: 0.4508613
	class 2: 0.19972621
	class 3: 0.00890616
	class 4: 0.37567967
	class 5: 0.34443185
	class 6: 0.80871516
	class 7: 0.04597453
	class 8: 0.027479097
	class 9: 0.0015487579
	class 10: 0.1525766
	class 11: 0.015183575
	class 12: 0.046435084
	class 13: 0.1805078
	class 14: 0.4938514
	class 15: 0.48768675
	class 16: 0.0
	class 17: 0.15799342
	class 18: 0.80435824

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4541589021682739, Reg Loss=1.7061697244644165
Clinet index 8, End of Epoch 1/6, Average Loss=2.1603286266326904, Class Loss=0.4541589021682739, Reg Loss=1.7061697244644165
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.4347224235534668, Reg Loss=1.592447280883789
Clinet index 8, End of Epoch 2/6, Average Loss=2.027169704437256, Class Loss=0.4347224235534668, Reg Loss=1.592447280883789
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.4400157928466797, Reg Loss=1.719551920890808
Clinet index 8, End of Epoch 3/6, Average Loss=2.1595678329467773, Class Loss=0.4400157928466797, Reg Loss=1.719551920890808
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4147131145000458, Reg Loss=1.6549047231674194
Clinet index 8, End of Epoch 4/6, Average Loss=2.069617748260498, Class Loss=0.4147131145000458, Reg Loss=1.6549047231674194
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.40698477625846863, Reg Loss=1.676990270614624
Clinet index 8, End of Epoch 5/6, Average Loss=2.083975076675415, Class Loss=0.40698477625846863, Reg Loss=1.676990270614624
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.40477725863456726, Reg Loss=1.6572229862213135
Clinet index 8, End of Epoch 6/6, Average Loss=2.062000274658203, Class Loss=0.40477725863456726, Reg Loss=1.6572229862213135
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.440166711807251, Reg Loss=1.7144439220428467
Clinet index 5, End of Epoch 1/6, Average Loss=2.1546106338500977, Class Loss=0.440166711807251, Reg Loss=1.7144439220428467
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.43050074577331543, Reg Loss=1.6700589656829834
Clinet index 5, End of Epoch 2/6, Average Loss=2.100559711456299, Class Loss=0.43050074577331543, Reg Loss=1.6700589656829834
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.4338110089302063, Reg Loss=1.645851492881775
Clinet index 5, End of Epoch 3/6, Average Loss=2.079662561416626, Class Loss=0.4338110089302063, Reg Loss=1.645851492881775
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.4223862588405609, Reg Loss=1.63948392868042
Clinet index 5, End of Epoch 4/6, Average Loss=2.0618700981140137, Class Loss=0.4223862588405609, Reg Loss=1.63948392868042
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.4119768440723419, Reg Loss=1.6530814170837402
Clinet index 5, End of Epoch 5/6, Average Loss=2.0650582313537598, Class Loss=0.4119768440723419, Reg Loss=1.6530814170837402
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.4025418162345886, Reg Loss=1.659745693206787
Clinet index 5, End of Epoch 6/6, Average Loss=2.0622875690460205, Class Loss=0.4025418162345886, Reg Loss=1.659745693206787
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.4452759623527527, Reg Loss=1.7191181182861328
Clinet index 21, End of Epoch 1/6, Average Loss=2.1643941402435303, Class Loss=0.4452759623527527, Reg Loss=1.7191181182861328
Pseudo labeling is: None
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.4443357288837433, Reg Loss=1.7192835807800293
Clinet index 21, End of Epoch 2/6, Average Loss=2.16361927986145, Class Loss=0.4443357288837433, Reg Loss=1.7192835807800293
Pseudo labeling is: None
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.4183605909347534, Reg Loss=1.6386909484863281
Clinet index 21, End of Epoch 3/6, Average Loss=2.057051658630371, Class Loss=0.4183605909347534, Reg Loss=1.6386909484863281
Pseudo labeling is: None
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.42865628004074097, Reg Loss=1.7098456621170044
Clinet index 21, End of Epoch 4/6, Average Loss=2.1385018825531006, Class Loss=0.42865628004074097, Reg Loss=1.7098456621170044
Pseudo labeling is: None
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.402286559343338, Reg Loss=1.6597963571548462
Clinet index 21, End of Epoch 5/6, Average Loss=2.0620830059051514, Class Loss=0.402286559343338, Reg Loss=1.6597963571548462
Pseudo labeling is: None
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.3861044645309448, Reg Loss=1.6550790071487427
Clinet index 21, End of Epoch 6/6, Average Loss=2.0411834716796875, Class Loss=0.3861044645309448, Reg Loss=1.6550790071487427
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4287639558315277, Reg Loss=1.6854372024536133
Clinet index 7, End of Epoch 1/6, Average Loss=2.114201068878174, Class Loss=0.4287639558315277, Reg Loss=1.6854372024536133
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.411696195602417, Reg Loss=1.651804804801941
Clinet index 7, End of Epoch 2/6, Average Loss=2.0635008811950684, Class Loss=0.411696195602417, Reg Loss=1.651804804801941
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.40238791704177856, Reg Loss=1.666668176651001
Clinet index 7, End of Epoch 3/6, Average Loss=2.0690560340881348, Class Loss=0.40238791704177856, Reg Loss=1.666668176651001
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3850898742675781, Reg Loss=1.592115044593811
Clinet index 7, End of Epoch 4/6, Average Loss=1.9772049188613892, Class Loss=0.3850898742675781, Reg Loss=1.592115044593811
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.40381312370300293, Reg Loss=1.6486433744430542
Clinet index 7, End of Epoch 5/6, Average Loss=2.0524563789367676, Class Loss=0.40381312370300293, Reg Loss=1.6486433744430542
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3811725378036499, Reg Loss=1.6259665489196777
Clinet index 7, End of Epoch 6/6, Average Loss=2.007139205932617, Class Loss=0.3811725378036499, Reg Loss=1.6259665489196777
federated aggregation...
Validation, Class Loss=0.7270169854164124, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.731765
Mean Acc: 0.277834
FreqW Acc: 0.643716
Mean IoU: 0.219433
Class IoU:
	class 0: 0.823721
	class 1: 0.39034474
	class 2: 0.1356474
	class 3: 0.0063996636
	class 4: 0.31255212
	class 5: 0.36073703
	class 6: 0.76819724
	class 7: 0.020640636
	class 8: 0.037371784
	class 9: 0.0011244364
	class 10: 0.12922922
	class 11: 0.018572703
	class 12: 0.032624543
	class 13: 0.12831308
	class 14: 0.39795643
	class 15: 0.4617901
	class 16: 0.0
	class 17: 0.060004655
	class 18: 0.08400905
Class Acc:
	class 0: 0.92957604
	class 1: 0.39115548
	class 2: 0.14600766
	class 3: 0.0063996636
	class 4: 0.32859063
	class 5: 0.36423782
	class 6: 0.7748428
	class 7: 0.020640664
	class 8: 0.03737429
	class 9: 0.0011244407
	class 10: 0.12940156
	class 11: 0.018572716
	class 12: 0.03262731
	class 13: 0.12852414
	class 14: 0.40244517
	class 15: 0.46359545
	class 16: 0.0
	class 17: 0.26081404
	class 18: 0.84292424

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.39550352096557617, Reg Loss=1.5981941223144531
Clinet index 14, End of Epoch 1/6, Average Loss=1.9936976432800293, Class Loss=0.39550352096557617, Reg Loss=1.5981941223144531
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.3908306062221527, Reg Loss=1.5588338375091553
Clinet index 14, End of Epoch 2/6, Average Loss=1.9496644735336304, Class Loss=0.3908306062221527, Reg Loss=1.5588338375091553
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.37697502970695496, Reg Loss=1.5386608839035034
Clinet index 14, End of Epoch 3/6, Average Loss=1.9156359434127808, Class Loss=0.37697502970695496, Reg Loss=1.5386608839035034
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.3751011788845062, Reg Loss=1.5466201305389404
Clinet index 14, End of Epoch 4/6, Average Loss=1.921721339225769, Class Loss=0.3751011788845062, Reg Loss=1.5466201305389404
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.37554430961608887, Reg Loss=1.5542927980422974
Clinet index 14, End of Epoch 5/6, Average Loss=1.9298371076583862, Class Loss=0.37554430961608887, Reg Loss=1.5542927980422974
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3668704628944397, Reg Loss=1.5565712451934814
Clinet index 14, End of Epoch 6/6, Average Loss=1.9234416484832764, Class Loss=0.3668704628944397, Reg Loss=1.5565712451934814
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.42649129033088684, Reg Loss=1.7427986860275269
Clinet index 4, End of Epoch 1/6, Average Loss=2.169290065765381, Class Loss=0.42649129033088684, Reg Loss=1.7427986860275269
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.4370271563529968, Reg Loss=1.7013674974441528
Clinet index 4, End of Epoch 2/6, Average Loss=2.138394594192505, Class Loss=0.4370271563529968, Reg Loss=1.7013674974441528
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.4127749502658844, Reg Loss=1.743632435798645
Clinet index 4, End of Epoch 3/6, Average Loss=2.156407356262207, Class Loss=0.4127749502658844, Reg Loss=1.743632435798645
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.40525949001312256, Reg Loss=1.7354048490524292
Clinet index 4, End of Epoch 4/6, Average Loss=2.1406643390655518, Class Loss=0.40525949001312256, Reg Loss=1.7354048490524292
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.41863054037094116, Reg Loss=1.733845829963684
Clinet index 4, End of Epoch 5/6, Average Loss=2.1524763107299805, Class Loss=0.41863054037094116, Reg Loss=1.733845829963684
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.39335015416145325, Reg Loss=1.6904709339141846
Clinet index 4, End of Epoch 6/6, Average Loss=2.0838210582733154, Class Loss=0.39335015416145325, Reg Loss=1.6904709339141846
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.4034354090690613, Reg Loss=1.6427090167999268
Clinet index 11, End of Epoch 1/6, Average Loss=2.046144485473633, Class Loss=0.4034354090690613, Reg Loss=1.6427090167999268
Pseudo labeling is: None
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.40132349729537964, Reg Loss=1.6640032529830933
Clinet index 11, End of Epoch 2/6, Average Loss=2.065326690673828, Class Loss=0.40132349729537964, Reg Loss=1.6640032529830933
Pseudo labeling is: None
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.38753899931907654, Reg Loss=1.6370501518249512
Clinet index 11, End of Epoch 3/6, Average Loss=2.0245890617370605, Class Loss=0.38753899931907654, Reg Loss=1.6370501518249512
Pseudo labeling is: None
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.3785625696182251, Reg Loss=1.6176540851593018
Clinet index 11, End of Epoch 4/6, Average Loss=1.9962166547775269, Class Loss=0.3785625696182251, Reg Loss=1.6176540851593018
Pseudo labeling is: None
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.377032995223999, Reg Loss=1.6070796251296997
Clinet index 11, End of Epoch 5/6, Average Loss=1.9841126203536987, Class Loss=0.377032995223999, Reg Loss=1.6070796251296997
Pseudo labeling is: None
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.36148154735565186, Reg Loss=1.5845224857330322
Clinet index 11, End of Epoch 6/6, Average Loss=1.946004033088684, Class Loss=0.36148154735565186, Reg Loss=1.5845224857330322
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.4024958312511444, Reg Loss=1.6947510242462158
Clinet index 21, End of Epoch 1/6, Average Loss=2.0972468852996826, Class Loss=0.4024958312511444, Reg Loss=1.6947510242462158
Pseudo labeling is: None
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.4095379114151001, Reg Loss=1.6984574794769287
Clinet index 21, End of Epoch 2/6, Average Loss=2.1079955101013184, Class Loss=0.4095379114151001, Reg Loss=1.6984574794769287
Pseudo labeling is: None
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.39620083570480347, Reg Loss=1.6729310750961304
Clinet index 21, End of Epoch 3/6, Average Loss=2.069131851196289, Class Loss=0.39620083570480347, Reg Loss=1.6729310750961304
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.4058834910392761, Reg Loss=1.6497585773468018
Clinet index 21, End of Epoch 4/6, Average Loss=2.0556421279907227, Class Loss=0.4058834910392761, Reg Loss=1.6497585773468018
Pseudo labeling is: None
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.38784700632095337, Reg Loss=1.6247384548187256
Clinet index 21, End of Epoch 5/6, Average Loss=2.012585401535034, Class Loss=0.38784700632095337, Reg Loss=1.6247384548187256
Pseudo labeling is: None
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.3685590624809265, Reg Loss=1.6292915344238281
Clinet index 21, End of Epoch 6/6, Average Loss=1.9978506565093994, Class Loss=0.3685590624809265, Reg Loss=1.6292915344238281
federated aggregation...
Validation, Class Loss=0.7345497608184814, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.730674
Mean Acc: 0.277166
FreqW Acc: 0.641779
Mean IoU: 0.215219
Class IoU:
	class 0: 0.8199748
	class 1: 0.35916948
	class 2: 0.14538418
	class 3: 0.0058734277
	class 4: 0.2816406
	class 5: 0.3650808
	class 6: 0.75266266
	class 7: 0.011198774
	class 8: 0.04946924
	class 9: 0.0013147376
	class 10: 0.11033552
	class 11: 0.020803457
	class 12: 0.030177504
	class 13: 0.10062462
	class 14: 0.38908872
	class 15: 0.49290964
	class 16: 0.0
	class 17: 0.06451963
	class 18: 0.08893546
Class Acc:
	class 0: 0.9259739
	class 1: 0.3597361
	class 2: 0.1591352
	class 3: 0.0058734277
	class 4: 0.29464644
	class 5: 0.3683652
	class 6: 0.75854397
	class 7: 0.011198774
	class 8: 0.049472816
	class 9: 0.0013147405
	class 10: 0.110465124
	class 11: 0.020804103
	class 12: 0.030180294
	class 13: 0.10073151
	class 14: 0.39323837
	class 15: 0.49510863
	class 16: 0.0
	class 17: 0.32073522
	class 18: 0.8606369

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3780628442764282, Reg Loss=1.5514925718307495
Clinet index 15, End of Epoch 1/6, Average Loss=1.9295554161071777, Class Loss=0.3780628442764282, Reg Loss=1.5514925718307495
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.3756236433982849, Reg Loss=1.6049795150756836
Clinet index 15, End of Epoch 2/6, Average Loss=1.9806032180786133, Class Loss=0.3756236433982849, Reg Loss=1.6049795150756836
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.3752708435058594, Reg Loss=1.5614004135131836
Clinet index 15, End of Epoch 3/6, Average Loss=1.936671257019043, Class Loss=0.3752708435058594, Reg Loss=1.5614004135131836
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.36649858951568604, Reg Loss=1.5392111539840698
Clinet index 15, End of Epoch 4/6, Average Loss=1.9057097434997559, Class Loss=0.36649858951568604, Reg Loss=1.5392111539840698
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.3637692928314209, Reg Loss=1.5733455419540405
Clinet index 15, End of Epoch 5/6, Average Loss=1.9371148347854614, Class Loss=0.3637692928314209, Reg Loss=1.5733455419540405
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.36479490995407104, Reg Loss=1.5647097826004028
Clinet index 15, End of Epoch 6/6, Average Loss=1.929504632949829, Class Loss=0.36479490995407104, Reg Loss=1.5647097826004028
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3584385812282562, Reg Loss=1.5978775024414062
Clinet index 12, End of Epoch 1/6, Average Loss=1.9563161134719849, Class Loss=0.3584385812282562, Reg Loss=1.5978775024414062
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.3516333997249603, Reg Loss=1.4960310459136963
Clinet index 12, End of Epoch 2/6, Average Loss=1.847664475440979, Class Loss=0.3516333997249603, Reg Loss=1.4960310459136963
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.3439944088459015, Reg Loss=1.527687907218933
Clinet index 12, End of Epoch 3/6, Average Loss=1.8716822862625122, Class Loss=0.3439944088459015, Reg Loss=1.527687907218933
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.35362496972084045, Reg Loss=1.5412551164627075
Clinet index 12, End of Epoch 4/6, Average Loss=1.8948800563812256, Class Loss=0.35362496972084045, Reg Loss=1.5412551164627075
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.3441601097583771, Reg Loss=1.5352447032928467
Clinet index 12, End of Epoch 5/6, Average Loss=1.8794047832489014, Class Loss=0.3441601097583771, Reg Loss=1.5352447032928467
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.34597742557525635, Reg Loss=1.5387263298034668
Clinet index 12, End of Epoch 6/6, Average Loss=1.8847037553787231, Class Loss=0.34597742557525635, Reg Loss=1.5387263298034668
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.3720761835575104, Reg Loss=1.6442701816558838
Clinet index 21, End of Epoch 1/6, Average Loss=2.0163464546203613, Class Loss=0.3720761835575104, Reg Loss=1.6442701816558838
Pseudo labeling is: None
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.3786415159702301, Reg Loss=1.6653292179107666
Clinet index 21, End of Epoch 2/6, Average Loss=2.043970823287964, Class Loss=0.3786415159702301, Reg Loss=1.6653292179107666
Pseudo labeling is: None
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.37591153383255005, Reg Loss=1.6415455341339111
Clinet index 21, End of Epoch 3/6, Average Loss=2.0174570083618164, Class Loss=0.37591153383255005, Reg Loss=1.6415455341339111
Pseudo labeling is: None
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.38657116889953613, Reg Loss=1.6889336109161377
Clinet index 21, End of Epoch 4/6, Average Loss=2.075504779815674, Class Loss=0.38657116889953613, Reg Loss=1.6889336109161377
Pseudo labeling is: None
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.3693012297153473, Reg Loss=1.6083606481552124
Clinet index 21, End of Epoch 5/6, Average Loss=1.9776618480682373, Class Loss=0.3693012297153473, Reg Loss=1.6083606481552124
Pseudo labeling is: None
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.3553900122642517, Reg Loss=1.584818959236145
Clinet index 21, End of Epoch 6/6, Average Loss=1.940208911895752, Class Loss=0.3553900122642517, Reg Loss=1.584818959236145
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3832375407218933, Reg Loss=1.5832549333572388
Clinet index 16, End of Epoch 1/6, Average Loss=1.9664924144744873, Class Loss=0.3832375407218933, Reg Loss=1.5832549333572388
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.39194390177726746, Reg Loss=1.5972884893417358
Clinet index 16, End of Epoch 2/6, Average Loss=1.9892324209213257, Class Loss=0.39194390177726746, Reg Loss=1.5972884893417358
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.3772425353527069, Reg Loss=1.5843676328659058
Clinet index 16, End of Epoch 3/6, Average Loss=1.961610198020935, Class Loss=0.3772425353527069, Reg Loss=1.5843676328659058
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3643553853034973, Reg Loss=1.5995550155639648
Clinet index 16, End of Epoch 4/6, Average Loss=1.9639103412628174, Class Loss=0.3643553853034973, Reg Loss=1.5995550155639648
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.39555034041404724, Reg Loss=1.641872525215149
Clinet index 16, End of Epoch 5/6, Average Loss=2.0374228954315186, Class Loss=0.39555034041404724, Reg Loss=1.641872525215149
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.3692236840724945, Reg Loss=1.5980098247528076
Clinet index 16, End of Epoch 6/6, Average Loss=1.9672335386276245, Class Loss=0.3692236840724945, Reg Loss=1.5980098247528076
federated aggregation...
Validation, Class Loss=0.7277919054031372, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.730961
Mean Acc: 0.275399
FreqW Acc: 0.636720
Mean IoU: 0.211797
Class IoU:
	class 0: 0.8144656
	class 1: 0.3611543
	class 2: 0.13889475
	class 3: 0.0052299653
	class 4: 0.27942675
	class 5: 0.3740025
	class 6: 0.7356576
	class 7: 0.009152924
	class 8: 0.062079884
	class 9: 0.0013893148
	class 10: 0.11808416
	class 11: 0.020642154
	class 12: 0.031361636
	class 13: 0.09343605
	class 14: 0.3356999
	class 15: 0.48261112
	class 16: 0.0
	class 17: 0.06334711
	class 18: 0.097506754
Class Acc:
	class 0: 0.92791146
	class 1: 0.3616607
	class 2: 0.1515415
	class 3: 0.0052299653
	class 4: 0.29147148
	class 5: 0.37801394
	class 6: 0.7409
	class 7: 0.009152924
	class 8: 0.06208684
	class 9: 0.0013893174
	class 10: 0.11826559
	class 11: 0.020642435
	class 12: 0.031364486
	class 13: 0.0935139
	class 14: 0.33836994
	class 15: 0.48473963
	class 16: 0.0
	class 17: 0.35497263
	class 18: 0.86134833

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.6122751235961914, Reg Loss=1.71753990650177
Clinet index 9, End of Epoch 1/6, Average Loss=4.329814910888672, Class Loss=2.6122751235961914, Reg Loss=1.71753990650177
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.2162067890167236, Reg Loss=1.1108137369155884
Clinet index 9, End of Epoch 2/6, Average Loss=3.3270206451416016, Class Loss=2.2162067890167236, Reg Loss=1.1108137369155884
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.5941879749298096, Reg Loss=1.0656367540359497
Clinet index 9, End of Epoch 3/6, Average Loss=2.659824848175049, Class Loss=1.5941879749298096, Reg Loss=1.0656367540359497
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.073898434638977, Reg Loss=1.0056568384170532
Clinet index 9, End of Epoch 4/6, Average Loss=2.0795552730560303, Class Loss=1.073898434638977, Reg Loss=1.0056568384170532
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8210610151290894, Reg Loss=0.9583806991577148
Clinet index 9, End of Epoch 5/6, Average Loss=1.7794417142868042, Class Loss=0.8210610151290894, Reg Loss=0.9583806991577148
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5561541318893433, Reg Loss=1.0071927309036255
Clinet index 9, End of Epoch 6/6, Average Loss=1.5633468627929688, Class Loss=0.5561541318893433, Reg Loss=1.0071927309036255
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.500286817550659, Reg Loss=1.6484102010726929
Clinet index 12, End of Epoch 1/6, Average Loss=4.1486968994140625, Class Loss=2.500286817550659, Reg Loss=1.6484102010726929
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.2154178619384766, Reg Loss=0.9027637243270874
Clinet index 12, End of Epoch 2/6, Average Loss=3.1181817054748535, Class Loss=2.2154178619384766, Reg Loss=0.9027637243270874
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.625959038734436, Reg Loss=0.9755599498748779
Clinet index 12, End of Epoch 3/6, Average Loss=2.6015191078186035, Class Loss=1.625959038734436, Reg Loss=0.9755599498748779
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0998531579971313, Reg Loss=0.9880464673042297
Clinet index 12, End of Epoch 4/6, Average Loss=2.087899684906006, Class Loss=1.0998531579971313, Reg Loss=0.9880464673042297
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7515010833740234, Reg Loss=0.9240319728851318
Clinet index 12, End of Epoch 5/6, Average Loss=1.6755330562591553, Class Loss=0.7515010833740234, Reg Loss=0.9240319728851318
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5194527506828308, Reg Loss=0.8716484308242798
Clinet index 12, End of Epoch 6/6, Average Loss=1.3911011219024658, Class Loss=0.5194527506828308, Reg Loss=0.8716484308242798
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.5347092151641846, Reg Loss=1.662433385848999
Clinet index 24, End of Epoch 1/6, Average Loss=4.197142601013184, Class Loss=2.5347092151641846, Reg Loss=1.662433385848999
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.2348878383636475, Reg Loss=0.7870420813560486
Clinet index 24, End of Epoch 2/6, Average Loss=3.021929979324341, Class Loss=2.2348878383636475, Reg Loss=0.7870420813560486
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.646747350692749, Reg Loss=0.8316333293914795
Clinet index 24, End of Epoch 3/6, Average Loss=2.4783806800842285, Class Loss=1.646747350692749, Reg Loss=0.8316333293914795
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1041617393493652, Reg Loss=0.896239697933197
Clinet index 24, End of Epoch 4/6, Average Loss=2.000401496887207, Class Loss=1.1041617393493652, Reg Loss=0.896239697933197
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7661229372024536, Reg Loss=0.8517122864723206
Clinet index 24, End of Epoch 5/6, Average Loss=1.617835283279419, Class Loss=0.7661229372024536, Reg Loss=0.8517122864723206
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5183331370353699, Reg Loss=0.8069478273391724
Clinet index 24, End of Epoch 6/6, Average Loss=1.3252809047698975, Class Loss=0.5183331370353699, Reg Loss=0.8069478273391724
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=2.6853930950164795, Reg Loss=1.6864327192306519
Clinet index 8, End of Epoch 1/6, Average Loss=4.371825695037842, Class Loss=2.6853930950164795, Reg Loss=1.6864327192306519
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=2.283461570739746, Reg Loss=0.9231113791465759
Clinet index 8, End of Epoch 2/6, Average Loss=3.206573009490967, Class Loss=2.283461570739746, Reg Loss=0.9231113791465759
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.7025302648544312, Reg Loss=0.9172826409339905
Clinet index 8, End of Epoch 3/6, Average Loss=2.6198129653930664, Class Loss=1.7025302648544312, Reg Loss=0.9172826409339905
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1310738325119019, Reg Loss=0.9551082253456116
Clinet index 8, End of Epoch 4/6, Average Loss=2.086182117462158, Class Loss=1.1310738325119019, Reg Loss=0.9551082253456116
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7226746082305908, Reg Loss=0.8779443502426147
Clinet index 8, End of Epoch 5/6, Average Loss=1.6006189584732056, Class Loss=0.7226746082305908, Reg Loss=0.8779443502426147
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.48541784286499023, Reg Loss=0.8447633385658264
Clinet index 8, End of Epoch 6/6, Average Loss=1.3301811218261719, Class Loss=0.48541784286499023, Reg Loss=0.8447633385658264
federated aggregation...
Validation, Class Loss=0.9170283675193787, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.706300
Mean Acc: 0.112867
FreqW Acc: 0.556684
Mean IoU: 0.079933
Class IoU:
	class 0: 0.78677666
	class 1: 0.01759805
	class 2: 0.0137313325
	class 3: 0.00023985242
	class 4: 0.16118309
	class 5: 0.22421688
	class 6: 0.043640196
	class 7: 0.018678281
	class 8: 0.04900251
	class 9: 5.786144e-06
	class 10: 0.08658318
	class 11: 0.0023753794
	class 12: 0.0074969134
	class 13: 0.0055315634
	class 14: 0.002695272
	class 15: 0.090002336
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0104360515
	class 19: 0.07846474
Class Acc:
	class 0: 0.99101835
	class 1: 0.01759819
	class 2: 0.013756822
	class 3: 0.00023985242
	class 4: 0.16399835
	class 5: 0.22448611
	class 6: 0.043714285
	class 7: 0.01867836
	class 8: 0.049006365
	class 9: 5.786144e-06
	class 10: 0.0868413
	class 11: 0.0023754297
	class 12: 0.0074970163
	class 13: 0.0055315634
	class 14: 0.0026952736
	class 15: 0.09002275
	class 16: 0.0
	class 17: 0.0
	class 18: 0.010508575
	class 19: 0.52937084

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.49756476283073425, Reg Loss=0.8355579972267151
Clinet index 5, End of Epoch 1/6, Average Loss=1.333122730255127, Class Loss=0.49756476283073425, Reg Loss=0.8355579972267151
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3942835032939911, Reg Loss=0.726266086101532
Clinet index 5, End of Epoch 2/6, Average Loss=1.1205495595932007, Class Loss=0.3942835032939911, Reg Loss=0.726266086101532
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3460615575313568, Reg Loss=0.7662316560745239
Clinet index 5, End of Epoch 3/6, Average Loss=1.1122932434082031, Class Loss=0.3460615575313568, Reg Loss=0.7662316560745239
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2706817090511322, Reg Loss=0.7432061433792114
Clinet index 5, End of Epoch 4/6, Average Loss=1.013887882232666, Class Loss=0.2706817090511322, Reg Loss=0.7432061433792114
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.22133372724056244, Reg Loss=0.7222711443901062
Clinet index 5, End of Epoch 5/6, Average Loss=0.9436048865318298, Class Loss=0.22133372724056244, Reg Loss=0.7222711443901062
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.19943776726722717, Reg Loss=0.6681651473045349
Clinet index 5, End of Epoch 6/6, Average Loss=0.8676029443740845, Class Loss=0.19943776726722717, Reg Loss=0.6681651473045349
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.43236634135246277, Reg Loss=0.9114328026771545
Clinet index 8, End of Epoch 1/6, Average Loss=1.343799114227295, Class Loss=0.43236634135246277, Reg Loss=0.9114328026771545
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.3689127266407013, Reg Loss=0.8162696957588196
Clinet index 8, End of Epoch 2/6, Average Loss=1.1851824522018433, Class Loss=0.3689127266407013, Reg Loss=0.8162696957588196
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.28621378540992737, Reg Loss=0.773325502872467
Clinet index 8, End of Epoch 3/6, Average Loss=1.0595393180847168, Class Loss=0.28621378540992737, Reg Loss=0.773325502872467
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.2623410224914551, Reg Loss=0.7725077867507935
Clinet index 8, End of Epoch 4/6, Average Loss=1.0348488092422485, Class Loss=0.2623410224914551, Reg Loss=0.7725077867507935
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.21756906807422638, Reg Loss=0.7299198508262634
Clinet index 8, End of Epoch 5/6, Average Loss=0.9474889039993286, Class Loss=0.21756906807422638, Reg Loss=0.7299198508262634
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.20003066956996918, Reg Loss=0.7089394330978394
Clinet index 8, End of Epoch 6/6, Average Loss=0.9089701175689697, Class Loss=0.20003066956996918, Reg Loss=0.7089394330978394
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.39935728907585144, Reg Loss=0.9153043627738953
Clinet index 0, End of Epoch 1/6, Average Loss=1.3146616220474243, Class Loss=0.39935728907585144, Reg Loss=0.9153043627738953
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.34617048501968384, Reg Loss=0.9046944975852966
Clinet index 0, End of Epoch 2/6, Average Loss=1.2508649826049805, Class Loss=0.34617048501968384, Reg Loss=0.9046944975852966
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.28337562084198, Reg Loss=0.8448615074157715
Clinet index 0, End of Epoch 3/6, Average Loss=1.1282371282577515, Class Loss=0.28337562084198, Reg Loss=0.8448615074157715
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.23218657076358795, Reg Loss=0.7514348030090332
Clinet index 0, End of Epoch 4/6, Average Loss=0.98362135887146, Class Loss=0.23218657076358795, Reg Loss=0.7514348030090332
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.22683700919151306, Reg Loss=0.8098528385162354
Clinet index 0, End of Epoch 5/6, Average Loss=1.0366898775100708, Class Loss=0.22683700919151306, Reg Loss=0.8098528385162354
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.1968340426683426, Reg Loss=0.7653307914733887
Clinet index 0, End of Epoch 6/6, Average Loss=0.9621648192405701, Class Loss=0.1968340426683426, Reg Loss=0.7653307914733887
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.48894259333610535, Reg Loss=0.9108492136001587
Clinet index 6, End of Epoch 1/6, Average Loss=1.3997918367385864, Class Loss=0.48894259333610535, Reg Loss=0.9108492136001587
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.37657666206359863, Reg Loss=0.8552447557449341
Clinet index 6, End of Epoch 2/6, Average Loss=1.2318214178085327, Class Loss=0.37657666206359863, Reg Loss=0.8552447557449341
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.30728769302368164, Reg Loss=0.7572522163391113
Clinet index 6, End of Epoch 3/6, Average Loss=1.064539909362793, Class Loss=0.30728769302368164, Reg Loss=0.7572522163391113
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.25005924701690674, Reg Loss=0.7208482623100281
Clinet index 6, End of Epoch 4/6, Average Loss=0.9709075093269348, Class Loss=0.25005924701690674, Reg Loss=0.7208482623100281
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.22924567759037018, Reg Loss=0.7454742789268494
Clinet index 6, End of Epoch 5/6, Average Loss=0.9747199416160583, Class Loss=0.22924567759037018, Reg Loss=0.7454742789268494
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.20046356320381165, Reg Loss=0.6830412745475769
Clinet index 6, End of Epoch 6/6, Average Loss=0.8835048675537109, Class Loss=0.20046356320381165, Reg Loss=0.6830412745475769
federated aggregation...
Validation, Class Loss=1.2265552282333374, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.684067
Mean Acc: 0.105163
FreqW Acc: 0.602308
Mean IoU: 0.059652
Class IoU:
	class 0: 0.8617903
	class 1: 2.212784e-05
	class 2: 0.0011229618
	class 3: 0.0
	class 4: 0.09980682
	class 5: 0.0013940099
	class 6: 0.0
	class 7: 0.0010112186
	class 8: 0.003001914
	class 9: 6.55763e-05
	class 10: 9.816104e-07
	class 11: 0.00013628537
	class 12: 0.0
	class 13: 4.1548532e-07
	class 14: 0.0
	class 15: 0.09641441
	class 16: 0.0
	class 17: 0.0
	class 18: 0.060570695
	class 19: 0.06769544
Class Acc:
	class 0: 0.9569743
	class 1: 2.212784e-05
	class 2: 0.0011231083
	class 3: 0.0
	class 4: 0.101003975
	class 5: 0.0013940099
	class 6: 0.0
	class 7: 0.0010112186
	class 8: 0.003001914
	class 9: 6.55763e-05
	class 10: 9.816104e-07
	class 11: 0.00013628937
	class 12: 0.0
	class 13: 4.1548532e-07
	class 14: 0.0
	class 15: 0.09644074
	class 16: 0.0
	class 17: 0.0
	class 18: 0.062382538
	class 19: 0.8796938

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.19333994388580322, Reg Loss=0.753909707069397
Clinet index 8, End of Epoch 1/6, Average Loss=0.9472496509552002, Class Loss=0.19333994388580322, Reg Loss=0.753909707069397
Pseudo labeling is: None
Epoch 2, lr = 0.000600
Epoch 2, Class Loss=0.17882464826107025, Reg Loss=0.7724767327308655
Clinet index 8, End of Epoch 2/6, Average Loss=0.9513013958930969, Class Loss=0.17882464826107025, Reg Loss=0.7724767327308655
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.1735602170228958, Reg Loss=0.7098441123962402
Clinet index 8, End of Epoch 3/6, Average Loss=0.8834043145179749, Class Loss=0.1735602170228958, Reg Loss=0.7098441123962402
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18239691853523254, Reg Loss=0.7107197046279907
Clinet index 8, End of Epoch 4/6, Average Loss=0.8931165933609009, Class Loss=0.18239691853523254, Reg Loss=0.7107197046279907
Pseudo labeling is: None
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.17670604586601257, Reg Loss=0.6942523121833801
Clinet index 8, End of Epoch 5/6, Average Loss=0.8709583282470703, Class Loss=0.17670604586601257, Reg Loss=0.6942523121833801
Pseudo labeling is: None
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.1624305248260498, Reg Loss=0.642228364944458
Clinet index 8, End of Epoch 6/6, Average Loss=0.8046588897705078, Class Loss=0.1624305248260498, Reg Loss=0.642228364944458
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19135069847106934, Reg Loss=0.7432574033737183
Clinet index 25, End of Epoch 1/6, Average Loss=0.9346081018447876, Class Loss=0.19135069847106934, Reg Loss=0.7432574033737183
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.1919352114200592, Reg Loss=0.7091168165206909
Clinet index 25, End of Epoch 2/6, Average Loss=0.9010519981384277, Class Loss=0.1919352114200592, Reg Loss=0.7091168165206909
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.17217296361923218, Reg Loss=0.6724482178688049
Clinet index 25, End of Epoch 3/6, Average Loss=0.8446211814880371, Class Loss=0.17217296361923218, Reg Loss=0.6724482178688049
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.1711256504058838, Reg Loss=0.653683066368103
Clinet index 25, End of Epoch 4/6, Average Loss=0.8248087167739868, Class Loss=0.1711256504058838, Reg Loss=0.653683066368103
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.16123095154762268, Reg Loss=0.6582251787185669
Clinet index 25, End of Epoch 5/6, Average Loss=0.8194561004638672, Class Loss=0.16123095154762268, Reg Loss=0.6582251787185669
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.16252465546131134, Reg Loss=0.7019451260566711
Clinet index 25, End of Epoch 6/6, Average Loss=0.8644697666168213, Class Loss=0.16252465546131134, Reg Loss=0.7019451260566711
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2017478346824646, Reg Loss=0.7463207244873047
Clinet index 22, End of Epoch 1/6, Average Loss=0.9480685591697693, Class Loss=0.2017478346824646, Reg Loss=0.7463207244873047
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.18733589351177216, Reg Loss=0.7303551435470581
Clinet index 22, End of Epoch 2/6, Average Loss=0.9176910519599915, Class Loss=0.18733589351177216, Reg Loss=0.7303551435470581
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.18212856352329254, Reg Loss=0.6945090889930725
Clinet index 22, End of Epoch 3/6, Average Loss=0.8766376376152039, Class Loss=0.18212856352329254, Reg Loss=0.6945090889930725
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.17000114917755127, Reg Loss=0.7079761624336243
Clinet index 22, End of Epoch 4/6, Average Loss=0.8779773116111755, Class Loss=0.17000114917755127, Reg Loss=0.7079761624336243
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.16428862512111664, Reg Loss=0.6422327756881714
Clinet index 22, End of Epoch 5/6, Average Loss=0.8065214157104492, Class Loss=0.16428862512111664, Reg Loss=0.6422327756881714
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.16014805436134338, Reg Loss=0.6772210597991943
Clinet index 22, End of Epoch 6/6, Average Loss=0.8373690843582153, Class Loss=0.16014805436134338, Reg Loss=0.6772210597991943
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.21212473511695862, Reg Loss=0.7052123546600342
Clinet index 5, End of Epoch 1/6, Average Loss=0.9173370599746704, Class Loss=0.21212473511695862, Reg Loss=0.7052123546600342
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.21124820411205292, Reg Loss=0.6730954647064209
Clinet index 5, End of Epoch 2/6, Average Loss=0.884343683719635, Class Loss=0.21124820411205292, Reg Loss=0.6730954647064209
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.21587775647640228, Reg Loss=0.715340256690979
Clinet index 5, End of Epoch 3/6, Average Loss=0.9312180280685425, Class Loss=0.21587775647640228, Reg Loss=0.715340256690979
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.19528158009052277, Reg Loss=0.6822491884231567
Clinet index 5, End of Epoch 4/6, Average Loss=0.8775307536125183, Class Loss=0.19528158009052277, Reg Loss=0.6822491884231567
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.17272831499576569, Reg Loss=0.6334149241447449
Clinet index 5, End of Epoch 5/6, Average Loss=0.8061432242393494, Class Loss=0.17272831499576569, Reg Loss=0.6334149241447449
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.17677521705627441, Reg Loss=0.5999020934104919
Clinet index 5, End of Epoch 6/6, Average Loss=0.7766773104667664, Class Loss=0.17677521705627441, Reg Loss=0.5999020934104919
federated aggregation...
Validation, Class Loss=1.2914025783538818, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.682547
Mean Acc: 0.107142
FreqW Acc: 0.599443
Mean IoU: 0.059993
Class IoU:
	class 0: 0.85564667
	class 1: 0.0
	class 2: 0.00024439784
	class 3: 0.0
	class 4: 0.06534517
	class 5: 0.0
	class 6: 0.0
	class 7: 0.00015715101
	class 8: 0.0005626108
	class 9: 6.429049e-06
	class 10: 0.0
	class 11: 4.229666e-06
	class 12: 0.0
	class 13: 0.0
	class 14: 0.0
	class 15: 0.115056634
	class 16: 0.0
	class 17: 0.0
	class 18: 0.09267924
	class 19: 0.07015029
Class Acc:
	class 0: 0.95187986
	class 1: 0.0
	class 2: 0.0002444033
	class 3: 0.0
	class 4: 0.06585188
	class 5: 0.0
	class 6: 0.0
	class 7: 0.00015715101
	class 8: 0.0005626108
	class 9: 6.429049e-06
	class 10: 0.0
	class 11: 4.22967e-06
	class 12: 0.0
	class 13: 0.0
	class 14: 0.0
	class 15: 0.11510877
	class 16: 0.0
	class 17: 0.0
	class 18: 0.09889308
	class 19: 0.9101372

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.16330881416797638, Reg Loss=0.6647800207138062
Clinet index 3, End of Epoch 1/6, Average Loss=0.8280888199806213, Class Loss=0.16330881416797638, Reg Loss=0.6647800207138062
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.16838392615318298, Reg Loss=0.7044647336006165
Clinet index 3, End of Epoch 2/6, Average Loss=0.872848629951477, Class Loss=0.16838392615318298, Reg Loss=0.7044647336006165
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.15605413913726807, Reg Loss=0.662649929523468
Clinet index 3, End of Epoch 3/6, Average Loss=0.8187040686607361, Class Loss=0.15605413913726807, Reg Loss=0.662649929523468
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.17758114635944366, Reg Loss=0.6555030941963196
Clinet index 3, End of Epoch 4/6, Average Loss=0.833084225654602, Class Loss=0.17758114635944366, Reg Loss=0.6555030941963196
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.15008586645126343, Reg Loss=0.6777212023735046
Clinet index 3, End of Epoch 5/6, Average Loss=0.8278070688247681, Class Loss=0.15008586645126343, Reg Loss=0.6777212023735046
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.14609567821025848, Reg Loss=0.6804922223091125
Clinet index 3, End of Epoch 6/6, Average Loss=0.8265879154205322, Class Loss=0.14609567821025848, Reg Loss=0.6804922223091125
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1740487813949585, Reg Loss=0.6870089173316956
Clinet index 19, End of Epoch 1/6, Average Loss=0.861057698726654, Class Loss=0.1740487813949585, Reg Loss=0.6870089173316956
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.1576678454875946, Reg Loss=0.6562153697013855
Clinet index 19, End of Epoch 2/6, Average Loss=0.8138831853866577, Class Loss=0.1576678454875946, Reg Loss=0.6562153697013855
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.15414974093437195, Reg Loss=0.6719658970832825
Clinet index 19, End of Epoch 3/6, Average Loss=0.826115608215332, Class Loss=0.15414974093437195, Reg Loss=0.6719658970832825
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.15833576023578644, Reg Loss=0.671118438243866
Clinet index 19, End of Epoch 4/6, Average Loss=0.8294541835784912, Class Loss=0.15833576023578644, Reg Loss=0.671118438243866
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.14919261634349823, Reg Loss=0.6697149872779846
Clinet index 19, End of Epoch 5/6, Average Loss=0.818907618522644, Class Loss=0.14919261634349823, Reg Loss=0.6697149872779846
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.14652207493782043, Reg Loss=0.6448415517807007
Clinet index 19, End of Epoch 6/6, Average Loss=0.7913635969161987, Class Loss=0.14652207493782043, Reg Loss=0.6448415517807007
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1838526874780655, Reg Loss=0.7446314692497253
Clinet index 1, End of Epoch 1/6, Average Loss=0.9284841418266296, Class Loss=0.1838526874780655, Reg Loss=0.7446314692497253
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.17492522299289703, Reg Loss=0.723179042339325
Clinet index 1, End of Epoch 2/6, Average Loss=0.8981042504310608, Class Loss=0.17492522299289703, Reg Loss=0.723179042339325
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.17458556592464447, Reg Loss=0.7409502267837524
Clinet index 1, End of Epoch 3/6, Average Loss=0.9155358076095581, Class Loss=0.17458556592464447, Reg Loss=0.7409502267837524
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.1586698442697525, Reg Loss=0.7138637900352478
Clinet index 1, End of Epoch 4/6, Average Loss=0.8725336194038391, Class Loss=0.1586698442697525, Reg Loss=0.7138637900352478
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.16371750831604004, Reg Loss=0.7104610204696655
Clinet index 1, End of Epoch 5/6, Average Loss=0.8741785287857056, Class Loss=0.16371750831604004, Reg Loss=0.7104610204696655
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1512582004070282, Reg Loss=0.7170038819313049
Clinet index 1, End of Epoch 6/6, Average Loss=0.8682620525360107, Class Loss=0.1512582004070282, Reg Loss=0.7170038819313049
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.17172878980636597, Reg Loss=0.7753438949584961
Clinet index 11, End of Epoch 1/6, Average Loss=0.9470726847648621, Class Loss=0.17172878980636597, Reg Loss=0.7753438949584961
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.17086216807365417, Reg Loss=0.7728716135025024
Clinet index 11, End of Epoch 2/6, Average Loss=0.943733811378479, Class Loss=0.17086216807365417, Reg Loss=0.7728716135025024
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.15972229838371277, Reg Loss=0.7405952215194702
Clinet index 11, End of Epoch 3/6, Average Loss=0.9003175497055054, Class Loss=0.15972229838371277, Reg Loss=0.7405952215194702
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.15613962709903717, Reg Loss=0.7509926557540894
Clinet index 11, End of Epoch 4/6, Average Loss=0.9071322679519653, Class Loss=0.15613962709903717, Reg Loss=0.7509926557540894
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.15385974943637848, Reg Loss=0.7126504778862
Clinet index 11, End of Epoch 5/6, Average Loss=0.8665102124214172, Class Loss=0.15385974943637848, Reg Loss=0.7126504778862
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.15556971728801727, Reg Loss=0.7501832842826843
Clinet index 11, End of Epoch 6/6, Average Loss=0.9057530164718628, Class Loss=0.15556971728801727, Reg Loss=0.7501832842826843
federated aggregation...
Validation, Class Loss=1.3601226806640625, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.676981
Mean Acc: 0.107684
FreqW Acc: 0.596649
Mean IoU: 0.059566
Class IoU:
	class 0: 0.85139906
	class 1: 0.0
	class 2: 0.0
	class 3: 0.0
	class 4: 0.048599336
	class 5: 0.0
	class 6: 0.0
	class 7: 4.6022797e-05
	class 8: 6.3088933e-06
	class 9: 0.0
	class 10: 0.0
	class 11: 0.0
	class 12: 0.0
	class 13: 0.0
	class 14: 0.0
	class 15: 0.11639375
	class 16: 0.0
	class 17: 0.0
	class 18: 0.105527885
	class 19: 0.069352984
Class Acc:
	class 0: 0.94293284
	class 1: 0.0
	class 2: 0.0
	class 3: 0.0
	class 4: 0.048906352
	class 5: 0.0
	class 6: 0.0
	class 7: 4.6022797e-05
	class 8: 6.3088933e-06
	class 9: 0.0
	class 10: 0.0
	class 11: 0.0
	class 12: 0.0
	class 13: 0.0
	class 14: 0.0
	class 15: 0.11646505
	class 16: 0.0
	class 17: 0.0
	class 18: 0.11605198
	class 19: 0.92927396

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1587827503681183, Reg Loss=0.6459665894508362
Clinet index 4, End of Epoch 1/6, Average Loss=0.8047493696212769, Class Loss=0.1587827503681183, Reg Loss=0.6459665894508362
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.15273647010326385, Reg Loss=0.6538598537445068
Clinet index 4, End of Epoch 2/6, Average Loss=0.8065963387489319, Class Loss=0.15273647010326385, Reg Loss=0.6538598537445068
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.14298780262470245, Reg Loss=0.6911662817001343
Clinet index 4, End of Epoch 3/6, Average Loss=0.8341540694236755, Class Loss=0.14298780262470245, Reg Loss=0.6911662817001343
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.14649681746959686, Reg Loss=0.6175316572189331
Clinet index 4, End of Epoch 4/6, Average Loss=0.7640284895896912, Class Loss=0.14649681746959686, Reg Loss=0.6175316572189331
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.15542858839035034, Reg Loss=0.6745209693908691
Clinet index 4, End of Epoch 5/6, Average Loss=0.8299495577812195, Class Loss=0.15542858839035034, Reg Loss=0.6745209693908691
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1530197411775589, Reg Loss=0.637459933757782
Clinet index 4, End of Epoch 6/6, Average Loss=0.7904796600341797, Class Loss=0.1530197411775589, Reg Loss=0.637459933757782
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14980612695217133, Reg Loss=0.6638645529747009
Clinet index 13, End of Epoch 1/6, Average Loss=0.8136706948280334, Class Loss=0.14980612695217133, Reg Loss=0.6638645529747009
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1405150592327118, Reg Loss=0.6114479899406433
Clinet index 13, End of Epoch 2/6, Average Loss=0.7519630193710327, Class Loss=0.1405150592327118, Reg Loss=0.6114479899406433
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.13518010079860687, Reg Loss=0.5980516672134399
Clinet index 13, End of Epoch 3/6, Average Loss=0.733231782913208, Class Loss=0.13518010079860687, Reg Loss=0.5980516672134399
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.13486908376216888, Reg Loss=0.6703026294708252
Clinet index 13, End of Epoch 4/6, Average Loss=0.8051717281341553, Class Loss=0.13486908376216888, Reg Loss=0.6703026294708252
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.13213087618350983, Reg Loss=0.6456153392791748
Clinet index 13, End of Epoch 5/6, Average Loss=0.7777462005615234, Class Loss=0.13213087618350983, Reg Loss=0.6456153392791748
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.13230212032794952, Reg Loss=0.639931321144104
Clinet index 13, End of Epoch 6/6, Average Loss=0.7722334265708923, Class Loss=0.13230212032794952, Reg Loss=0.639931321144104
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14300565421581268, Reg Loss=0.5756754875183105
Clinet index 18, End of Epoch 1/6, Average Loss=0.7186811566352844, Class Loss=0.14300565421581268, Reg Loss=0.5756754875183105
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.14819343388080597, Reg Loss=0.5742051601409912
Clinet index 18, End of Epoch 2/6, Average Loss=0.722398579120636, Class Loss=0.14819343388080597, Reg Loss=0.5742051601409912
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.14725537598133087, Reg Loss=0.5606727600097656
Clinet index 18, End of Epoch 3/6, Average Loss=0.7079281210899353, Class Loss=0.14725537598133087, Reg Loss=0.5606727600097656
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.14117109775543213, Reg Loss=0.5925995707511902
Clinet index 18, End of Epoch 4/6, Average Loss=0.7337706685066223, Class Loss=0.14117109775543213, Reg Loss=0.5925995707511902
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.13599491119384766, Reg Loss=0.602436900138855
Clinet index 18, End of Epoch 5/6, Average Loss=0.7384318113327026, Class Loss=0.13599491119384766, Reg Loss=0.602436900138855
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.13570736348628998, Reg Loss=0.5905147194862366
Clinet index 18, End of Epoch 6/6, Average Loss=0.7262220978736877, Class Loss=0.13570736348628998, Reg Loss=0.5905147194862366
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.16306889057159424, Reg Loss=0.8020746111869812
Clinet index 9, End of Epoch 1/6, Average Loss=0.9651435017585754, Class Loss=0.16306889057159424, Reg Loss=0.8020746111869812
Pseudo labeling is: None
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.16906216740608215, Reg Loss=0.8066158294677734
Clinet index 9, End of Epoch 2/6, Average Loss=0.9756779670715332, Class Loss=0.16906216740608215, Reg Loss=0.8066158294677734
Pseudo labeling is: None
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.15890513360500336, Reg Loss=0.8176680207252502
Clinet index 9, End of Epoch 3/6, Average Loss=0.9765731692314148, Class Loss=0.15890513360500336, Reg Loss=0.8176680207252502
Pseudo labeling is: None
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.1642882525920868, Reg Loss=0.7670036554336548
Clinet index 9, End of Epoch 4/6, Average Loss=0.931291937828064, Class Loss=0.1642882525920868, Reg Loss=0.7670036554336548
Pseudo labeling is: None
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.142750546336174, Reg Loss=0.7281796932220459
Clinet index 9, End of Epoch 5/6, Average Loss=0.8709302544593811, Class Loss=0.142750546336174, Reg Loss=0.7281796932220459
Pseudo labeling is: None
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.15543389320373535, Reg Loss=0.7840356826782227
Clinet index 9, End of Epoch 6/6, Average Loss=0.939469575881958, Class Loss=0.15543389320373535, Reg Loss=0.7840356826782227
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=1.3933191299438477, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.675122
Mean Acc: 0.106474
FreqW Acc: 0.590034
Mean IoU: 0.057701
Class IoU:
	class 0: 0.8441906
	class 1: 0.0
	class 2: 0.0
	class 3: 0.0
	class 4: 0.036865134
	class 5: 0.0
	class 6: 0.0
	class 7: 2.1808712e-05
	class 8: 0.0
	class 9: 0.0
	class 10: 0.0
	class 11: 0.0
	class 12: 0.0
	class 13: 0.0
	class 14: 0.0
	class 15: 0.088905655
	class 16: 0.0
	class 17: 0.0
	class 18: 0.113049194
	class 19: 0.07099209
Class Acc:
	class 0: 0.9424607
	class 1: 0.0
	class 2: 0.0
	class 3: 0.0
	class 4: 0.037037577
	class 5: 0.0
	class 6: 0.0
	class 7: 2.1808712e-05
	class 8: 0.0
	class 9: 0.0
	class 10: 0.0
	class 11: 0.0
	class 12: 0.0
	class 13: 0.0
	class 14: 0.0
	class 15: 0.08894809
	class 16: 0.0
	class 17: 0.0
	class 18: 0.125399
	class 19: 0.9356151

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.776932954788208, Reg Loss=2.9210705757141113
Clinet index 29, End of Epoch 1/6, Average Loss=4.698003768920898, Class Loss=1.776932954788208, Reg Loss=2.9210705757141113
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4389622211456299, Reg Loss=2.80700945854187
Clinet index 29, End of Epoch 2/6, Average Loss=4.2459716796875, Class Loss=1.4389622211456299, Reg Loss=2.80700945854187
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2696892023086548, Reg Loss=2.6950831413269043
Clinet index 29, End of Epoch 3/6, Average Loss=3.9647722244262695, Class Loss=1.2696892023086548, Reg Loss=2.6950831413269043
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0776748657226562, Reg Loss=2.6716253757476807
Clinet index 29, End of Epoch 4/6, Average Loss=3.749300241470337, Class Loss=1.0776748657226562, Reg Loss=2.6716253757476807
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9427353739738464, Reg Loss=2.6827456951141357
Clinet index 29, End of Epoch 5/6, Average Loss=3.625481128692627, Class Loss=0.9427353739738464, Reg Loss=2.6827456951141357
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8415253758430481, Reg Loss=2.64095401763916
Clinet index 29, End of Epoch 6/6, Average Loss=3.4824793338775635, Class Loss=0.8415253758430481, Reg Loss=2.64095401763916
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.7572530508041382, Reg Loss=3.024988889694214
Clinet index 3, End of Epoch 1/6, Average Loss=4.7822418212890625, Class Loss=1.7572530508041382, Reg Loss=3.024988889694214
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4791069030761719, Reg Loss=2.868314504623413
Clinet index 3, End of Epoch 2/6, Average Loss=4.347421646118164, Class Loss=1.4791069030761719, Reg Loss=2.868314504623413
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2819674015045166, Reg Loss=2.727241277694702
Clinet index 3, End of Epoch 3/6, Average Loss=4.009208679199219, Class Loss=1.2819674015045166, Reg Loss=2.727241277694702
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.0434186458587646, Reg Loss=2.684340238571167
Clinet index 3, End of Epoch 4/6, Average Loss=3.7277588844299316, Class Loss=1.0434186458587646, Reg Loss=2.684340238571167
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9316690564155579, Reg Loss=2.667341947555542
Clinet index 3, End of Epoch 5/6, Average Loss=3.599010944366455, Class Loss=0.9316690564155579, Reg Loss=2.667341947555542
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8247874975204468, Reg Loss=2.654841661453247
Clinet index 3, End of Epoch 6/6, Average Loss=3.4796290397644043, Class Loss=0.8247874975204468, Reg Loss=2.654841661453247
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.874519944190979, Reg Loss=2.9382803440093994
Clinet index 8, End of Epoch 1/6, Average Loss=4.812800407409668, Class Loss=1.874519944190979, Reg Loss=2.9382803440093994
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.4514633417129517, Reg Loss=2.758453607559204
Clinet index 8, End of Epoch 2/6, Average Loss=4.209917068481445, Class Loss=1.4514633417129517, Reg Loss=2.758453607559204
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.2448374032974243, Reg Loss=2.6872007846832275
Clinet index 8, End of Epoch 3/6, Average Loss=3.9320383071899414, Class Loss=1.2448374032974243, Reg Loss=2.6872007846832275
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.067699670791626, Reg Loss=2.676429510116577
Clinet index 8, End of Epoch 4/6, Average Loss=3.744129180908203, Class Loss=1.067699670791626, Reg Loss=2.676429510116577
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8996873497962952, Reg Loss=2.63130784034729
Clinet index 8, End of Epoch 5/6, Average Loss=3.5309951305389404, Class Loss=0.8996873497962952, Reg Loss=2.63130784034729
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7866585850715637, Reg Loss=2.6145987510681152
Clinet index 8, End of Epoch 6/6, Average Loss=3.401257276535034, Class Loss=0.7866585850715637, Reg Loss=2.6145987510681152
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.9364365339279175, Reg Loss=2.934042453765869
Clinet index 19, End of Epoch 1/6, Average Loss=4.870479106903076, Class Loss=1.9364365339279175, Reg Loss=2.934042453765869
Pseudo labeling is: None
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=1.6083470582962036, Reg Loss=2.707697868347168
Clinet index 19, End of Epoch 2/6, Average Loss=4.316044807434082, Class Loss=1.6083470582962036, Reg Loss=2.707697868347168
Pseudo labeling is: None
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=1.330542802810669, Reg Loss=2.6539692878723145
Clinet index 19, End of Epoch 3/6, Average Loss=3.9845120906829834, Class Loss=1.330542802810669, Reg Loss=2.6539692878723145
Pseudo labeling is: None
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=1.1086183786392212, Reg Loss=2.658241033554077
Clinet index 19, End of Epoch 4/6, Average Loss=3.766859531402588, Class Loss=1.1086183786392212, Reg Loss=2.658241033554077
Pseudo labeling is: None
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9758472442626953, Reg Loss=2.639272689819336
Clinet index 19, End of Epoch 5/6, Average Loss=3.6151199340820312, Class Loss=0.9758472442626953, Reg Loss=2.639272689819336
Pseudo labeling is: None
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8338538408279419, Reg Loss=2.5777060985565186
Clinet index 19, End of Epoch 6/6, Average Loss=3.41156005859375, Class Loss=0.8338538408279419, Reg Loss=2.5777060985565186
federated aggregation...
Validation, Class Loss=1.1199108362197876, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.679513
Mean Acc: 0.085024
FreqW Acc: 0.572973
Mean IoU: 0.050952
Class IoU:
	class 0: 0.8281082
	class 1: 0.002523367
	class 2: 0.0047233934
	class 3: 0.0
	class 4: 0.11477378
	class 5: 0.010148013
	class 6: 0.0
	class 7: 5.9973958e-05
	class 8: 0.002744667
	class 9: 4.0181556e-05
	class 10: 0.0
	class 11: 0.009363315
	class 12: 0.0
	class 13: 0.00029769496
	class 14: 1.7312075e-06
	class 15: 0.03748222
	class 16: 0.0
	class 17: 0.0
	class 18: 0.003463089
	class 19: 0.05460814
	class 20: 0.0016528422
Class Acc:
	class 0: 0.9669602
	class 1: 0.0025233934
	class 2: 0.0047318195
	class 3: 0.0
	class 4: 0.11890145
	class 5: 0.010148085
	class 6: 0.0
	class 7: 5.9973958e-05
	class 8: 0.002744674
	class 9: 4.0181556e-05
	class 10: 0.0
	class 11: 0.009363315
	class 12: 0.0
	class 13: 0.00029769522
	class 14: 1.7312075e-06
	class 15: 0.037485942
	class 16: 0.0
	class 17: 0.0
	class 18: 0.003467933
	class 19: 0.6271218
	class 20: 0.001658928

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.790978729724884, Reg Loss=2.655402421951294
Clinet index 4, End of Epoch 1/6, Average Loss=3.446381092071533, Class Loss=0.790978729724884, Reg Loss=2.655402421951294
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.7237928509712219, Reg Loss=2.6216506958007812
Clinet index 4, End of Epoch 2/6, Average Loss=3.3454434871673584, Class Loss=0.7237928509712219, Reg Loss=2.6216506958007812
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6218920946121216, Reg Loss=2.6000754833221436
Clinet index 4, End of Epoch 3/6, Average Loss=3.2219676971435547, Class Loss=0.6218920946121216, Reg Loss=2.6000754833221436
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5695965886116028, Reg Loss=2.562870740890503
Clinet index 4, End of Epoch 4/6, Average Loss=3.132467269897461, Class Loss=0.5695965886116028, Reg Loss=2.562870740890503
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5528241395950317, Reg Loss=2.607008695602417
Clinet index 4, End of Epoch 5/6, Average Loss=3.1598329544067383, Class Loss=0.5528241395950317, Reg Loss=2.607008695602417
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5458510518074036, Reg Loss=2.5573625564575195
Clinet index 4, End of Epoch 6/6, Average Loss=3.1032135486602783, Class Loss=0.5458510518074036, Reg Loss=2.5573625564575195
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7247147560119629, Reg Loss=2.6719791889190674
Clinet index 0, End of Epoch 1/6, Average Loss=3.3966939449310303, Class Loss=0.7247147560119629, Reg Loss=2.6719791889190674
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.6623445153236389, Reg Loss=2.658849000930786
Clinet index 0, End of Epoch 2/6, Average Loss=3.3211934566497803, Class Loss=0.6623445153236389, Reg Loss=2.658849000930786
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.604908287525177, Reg Loss=2.694035053253174
Clinet index 0, End of Epoch 3/6, Average Loss=3.298943281173706, Class Loss=0.604908287525177, Reg Loss=2.694035053253174
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5740772485733032, Reg Loss=2.6389553546905518
Clinet index 0, End of Epoch 4/6, Average Loss=3.2130327224731445, Class Loss=0.5740772485733032, Reg Loss=2.6389553546905518
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5218151807785034, Reg Loss=2.649548292160034
Clinet index 0, End of Epoch 5/6, Average Loss=3.171363353729248, Class Loss=0.5218151807785034, Reg Loss=2.649548292160034
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5161877870559692, Reg Loss=2.616179943084717
Clinet index 0, End of Epoch 6/6, Average Loss=3.1323676109313965, Class Loss=0.5161877870559692, Reg Loss=2.616179943084717
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.7497459650039673, Reg Loss=2.6232621669769287
Clinet index 29, End of Epoch 1/6, Average Loss=3.3730082511901855, Class Loss=0.7497459650039673, Reg Loss=2.6232621669769287
Pseudo labeling is: None
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.6984996795654297, Reg Loss=2.6819865703582764
Clinet index 29, End of Epoch 2/6, Average Loss=3.380486249923706, Class Loss=0.6984996795654297, Reg Loss=2.6819865703582764
Pseudo labeling is: None
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.6660293936729431, Reg Loss=2.5882246494293213
Clinet index 29, End of Epoch 3/6, Average Loss=3.254254102706909, Class Loss=0.6660293936729431, Reg Loss=2.5882246494293213
Pseudo labeling is: None
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.5951425433158875, Reg Loss=2.6293981075286865
Clinet index 29, End of Epoch 4/6, Average Loss=3.2245407104492188, Class Loss=0.5951425433158875, Reg Loss=2.6293981075286865
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5489087700843811, Reg Loss=2.54227876663208
Clinet index 29, End of Epoch 5/6, Average Loss=3.0911874771118164, Class Loss=0.5489087700843811, Reg Loss=2.54227876663208
Pseudo labeling is: None
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5326845049858093, Reg Loss=2.617577075958252
Clinet index 29, End of Epoch 6/6, Average Loss=3.150261640548706, Class Loss=0.5326845049858093, Reg Loss=2.617577075958252
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.7641463875770569, Reg Loss=2.6525750160217285
Clinet index 20, End of Epoch 1/6, Average Loss=3.4167213439941406, Class Loss=0.7641463875770569, Reg Loss=2.6525750160217285
Pseudo labeling is: None
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.724327802658081, Reg Loss=2.6384713649749756
Clinet index 20, End of Epoch 2/6, Average Loss=3.3627991676330566, Class Loss=0.724327802658081, Reg Loss=2.6384713649749756
Pseudo labeling is: None
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6303918361663818, Reg Loss=2.642146587371826
Clinet index 20, End of Epoch 3/6, Average Loss=3.272538423538208, Class Loss=0.6303918361663818, Reg Loss=2.642146587371826
Pseudo labeling is: None
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5824306011199951, Reg Loss=2.5677783489227295
Clinet index 20, End of Epoch 4/6, Average Loss=3.1502089500427246, Class Loss=0.5824306011199951, Reg Loss=2.5677783489227295
Pseudo labeling is: None
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5283751487731934, Reg Loss=2.624511241912842
Clinet index 20, End of Epoch 5/6, Average Loss=3.152886390686035, Class Loss=0.5283751487731934, Reg Loss=2.624511241912842
Pseudo labeling is: None
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5171298980712891, Reg Loss=2.5640645027160645
Clinet index 20, End of Epoch 6/6, Average Loss=3.0811944007873535, Class Loss=0.5171298980712891, Reg Loss=2.5640645027160645
federated aggregation...
Validation, Class Loss=1.2058830261230469, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.665595
Mean Acc: 0.110185
FreqW Acc: 0.566736
Mean IoU: 0.054531
Class IoU:
	class 0: 0.818107
	class 1: 0.0050620213
	class 2: 0.00062636257
	class 3: 0.0
	class 4: 0.13947476
	class 5: 0.007167421
	class 6: 1.1974317e-05
	class 7: 7.440619e-05
	class 8: 0.0011704015
	class 9: 0.00015301137
	class 10: 0.0
	class 11: 0.0032653054
	class 12: 0.0
	class 13: 0.00057129026
	class 14: 1.3416859e-05
	class 15: 0.03581029
	class 16: 0.0
	class 17: 0.0
	class 18: 2.4452453e-05
	class 19: 0.065270916
	class 20: 0.068343416
Class Acc:
	class 0: 0.9397727
	class 1: 0.0050626313
	class 2: 0.00062641775
	class 3: 0.0
	class 4: 0.1454141
	class 5: 0.007167421
	class 6: 1.1974317e-05
	class 7: 7.440619e-05
	class 8: 0.0011704015
	class 9: 0.00015301137
	class 10: 0.0
	class 11: 0.0032653054
	class 12: 0.0
	class 13: 0.0005712923
	class 14: 1.3416859e-05
	class 15: 0.035813205
	class 16: 0.0
	class 17: 0.0
	class 18: 2.4453857e-05
	class 19: 0.66691315
	class 20: 0.507828

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5666136145591736, Reg Loss=2.668290376663208
Clinet index 13, End of Epoch 1/6, Average Loss=3.2349040508270264, Class Loss=0.5666136145591736, Reg Loss=2.668290376663208
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5620516538619995, Reg Loss=2.5470454692840576
Clinet index 13, End of Epoch 2/6, Average Loss=3.1090970039367676, Class Loss=0.5620516538619995, Reg Loss=2.5470454692840576
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5237730145454407, Reg Loss=2.650738000869751
Clinet index 13, End of Epoch 3/6, Average Loss=3.174510955810547, Class Loss=0.5237730145454407, Reg Loss=2.650738000869751
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5098340511322021, Reg Loss=2.638890504837036
Clinet index 13, End of Epoch 4/6, Average Loss=3.1487245559692383, Class Loss=0.5098340511322021, Reg Loss=2.638890504837036
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5160256028175354, Reg Loss=2.6164512634277344
Clinet index 13, End of Epoch 5/6, Average Loss=3.132476806640625, Class Loss=0.5160256028175354, Reg Loss=2.6164512634277344
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.4987967908382416, Reg Loss=2.5707969665527344
Clinet index 13, End of Epoch 6/6, Average Loss=3.069593667984009, Class Loss=0.4987967908382416, Reg Loss=2.5707969665527344
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5271142721176147, Reg Loss=2.682593822479248
Clinet index 12, End of Epoch 1/6, Average Loss=3.2097082138061523, Class Loss=0.5271142721176147, Reg Loss=2.682593822479248
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5339640378952026, Reg Loss=2.680114269256592
Clinet index 12, End of Epoch 2/6, Average Loss=3.214078426361084, Class Loss=0.5339640378952026, Reg Loss=2.680114269256592
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5110746622085571, Reg Loss=2.6507253646850586
Clinet index 12, End of Epoch 3/6, Average Loss=3.161799907684326, Class Loss=0.5110746622085571, Reg Loss=2.6507253646850586
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.48524999618530273, Reg Loss=2.6320345401763916
Clinet index 12, End of Epoch 4/6, Average Loss=3.1172845363616943, Class Loss=0.48524999618530273, Reg Loss=2.6320345401763916
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.49550384283065796, Reg Loss=2.656177043914795
Clinet index 12, End of Epoch 5/6, Average Loss=3.1516809463500977, Class Loss=0.49550384283065796, Reg Loss=2.656177043914795
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.46830326318740845, Reg Loss=2.6501057147979736
Clinet index 12, End of Epoch 6/6, Average Loss=3.1184089183807373, Class Loss=0.46830326318740845, Reg Loss=2.6501057147979736
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5262752771377563, Reg Loss=2.5697662830352783
Clinet index 20, End of Epoch 1/6, Average Loss=3.096041679382324, Class Loss=0.5262752771377563, Reg Loss=2.5697662830352783
Pseudo labeling is: None
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.5336968898773193, Reg Loss=2.5811140537261963
Clinet index 20, End of Epoch 2/6, Average Loss=3.1148109436035156, Class Loss=0.5336968898773193, Reg Loss=2.5811140537261963
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.5031106472015381, Reg Loss=2.5891621112823486
Clinet index 20, End of Epoch 3/6, Average Loss=3.0922727584838867, Class Loss=0.5031106472015381, Reg Loss=2.5891621112823486
Pseudo labeling is: None
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.5180571675300598, Reg Loss=2.552421808242798
Clinet index 20, End of Epoch 4/6, Average Loss=3.070478916168213, Class Loss=0.5180571675300598, Reg Loss=2.552421808242798
Pseudo labeling is: None
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.4680730104446411, Reg Loss=2.539421558380127
Clinet index 20, End of Epoch 5/6, Average Loss=3.0074944496154785, Class Loss=0.4680730104446411, Reg Loss=2.539421558380127
Pseudo labeling is: None
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.4763646721839905, Reg Loss=2.5945122241973877
Clinet index 20, End of Epoch 6/6, Average Loss=3.0708768367767334, Class Loss=0.4763646721839905, Reg Loss=2.5945122241973877
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5525417923927307, Reg Loss=2.643069267272949
Clinet index 15, End of Epoch 1/6, Average Loss=3.195611000061035, Class Loss=0.5525417923927307, Reg Loss=2.643069267272949
Pseudo labeling is: None
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.5328758955001831, Reg Loss=2.589400291442871
Clinet index 15, End of Epoch 2/6, Average Loss=3.1222763061523438, Class Loss=0.5328758955001831, Reg Loss=2.589400291442871
Pseudo labeling is: None
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.511892557144165, Reg Loss=2.5787832736968994
Clinet index 15, End of Epoch 3/6, Average Loss=3.0906758308410645, Class Loss=0.511892557144165, Reg Loss=2.5787832736968994
Pseudo labeling is: None
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4981019198894501, Reg Loss=2.64726185798645
Clinet index 15, End of Epoch 4/6, Average Loss=3.1453638076782227, Class Loss=0.4981019198894501, Reg Loss=2.64726185798645
Pseudo labeling is: None
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5057303309440613, Reg Loss=2.6530539989471436
Clinet index 15, End of Epoch 5/6, Average Loss=3.1587843894958496, Class Loss=0.5057303309440613, Reg Loss=2.6530539989471436
Pseudo labeling is: None
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5001379251480103, Reg Loss=2.611534357070923
Clinet index 15, End of Epoch 6/6, Average Loss=3.1116724014282227, Class Loss=0.5001379251480103, Reg Loss=2.611534357070923
federated aggregation...
Validation, Class Loss=1.2867680788040161, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.663796
Mean Acc: 0.112986
FreqW Acc: 0.563580
Mean IoU: 0.052053
Class IoU:
	class 0: 0.8146795
	class 1: 0.0023266105
	class 2: 7.16719e-07
	class 3: 0.0
	class 4: 0.10939631
	class 5: 7.327564e-05
	class 6: 1.0526873e-06
	class 7: 8.017909e-06
	class 8: 7.652077e-05
	class 9: 0.0
	class 10: 0.0
	class 11: 0.00014709853
	class 12: 0.0
	class 13: 0.00019174603
	class 14: 0.0
	class 15: 0.027457077
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.06896497
	class 20: 0.06978028
Class Acc:
	class 0: 0.93717414
	class 1: 0.0023267015
	class 2: 7.1672514e-07
	class 3: 0.0
	class 4: 0.113472104
	class 5: 7.327564e-05
	class 6: 1.0526873e-06
	class 7: 8.017909e-06
	class 8: 7.652077e-05
	class 9: 0.0
	class 10: 0.0
	class 11: 0.00014709853
	class 12: 0.0
	class 13: 0.00019174647
	class 14: 0.0
	class 15: 0.027457595
	class 16: 0.0
	class 17: 0.0
	class 18: 0.0
	class 19: 0.6619322
	class 20: 0.6298428

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4800252914428711, Reg Loss=2.6221649646759033
Clinet index 6, End of Epoch 1/6, Average Loss=3.1021902561187744, Class Loss=0.4800252914428711, Reg Loss=2.6221649646759033
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.5123794674873352, Reg Loss=2.5835087299346924
Clinet index 6, End of Epoch 2/6, Average Loss=3.095888137817383, Class Loss=0.5123794674873352, Reg Loss=2.5835087299346924
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.5013399124145508, Reg Loss=2.575115919113159
Clinet index 6, End of Epoch 3/6, Average Loss=3.07645583152771, Class Loss=0.5013399124145508, Reg Loss=2.575115919113159
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4654633104801178, Reg Loss=2.6347808837890625
Clinet index 6, End of Epoch 4/6, Average Loss=3.1002442836761475, Class Loss=0.4654633104801178, Reg Loss=2.6347808837890625
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4755905568599701, Reg Loss=2.547208070755005
Clinet index 6, End of Epoch 5/6, Average Loss=3.022798538208008, Class Loss=0.4755905568599701, Reg Loss=2.547208070755005
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.4724298119544983, Reg Loss=2.5589115619659424
Clinet index 6, End of Epoch 6/6, Average Loss=3.031341314315796, Class Loss=0.4724298119544983, Reg Loss=2.5589115619659424
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.48195743560791016, Reg Loss=2.5519604682922363
Clinet index 29, End of Epoch 1/6, Average Loss=3.0339179039001465, Class Loss=0.48195743560791016, Reg Loss=2.5519604682922363
Pseudo labeling is: None
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.4711824655532837, Reg Loss=2.5776844024658203
Clinet index 29, End of Epoch 2/6, Average Loss=3.0488667488098145, Class Loss=0.4711824655532837, Reg Loss=2.5776844024658203
Pseudo labeling is: None
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.471267968416214, Reg Loss=2.5408449172973633
Clinet index 29, End of Epoch 3/6, Average Loss=3.012112855911255, Class Loss=0.471267968416214, Reg Loss=2.5408449172973633
Pseudo labeling is: None
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.45578643679618835, Reg Loss=2.5732052326202393
Clinet index 29, End of Epoch 4/6, Average Loss=3.02899169921875, Class Loss=0.45578643679618835, Reg Loss=2.5732052326202393
Pseudo labeling is: None
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.4505094587802887, Reg Loss=2.529628038406372
Clinet index 29, End of Epoch 5/6, Average Loss=2.980137586593628, Class Loss=0.4505094587802887, Reg Loss=2.529628038406372
Pseudo labeling is: None
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.4454246759414673, Reg Loss=2.539292097091675
Clinet index 29, End of Epoch 6/6, Average Loss=2.9847168922424316, Class Loss=0.4454246759414673, Reg Loss=2.539292097091675
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.5086066126823425, Reg Loss=2.609485149383545
Clinet index 13, End of Epoch 1/6, Average Loss=3.1180918216705322, Class Loss=0.5086066126823425, Reg Loss=2.609485149383545
Pseudo labeling is: None
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.5098808407783508, Reg Loss=2.5688202381134033
Clinet index 13, End of Epoch 2/6, Average Loss=3.0787010192871094, Class Loss=0.5098808407783508, Reg Loss=2.5688202381134033
Pseudo labeling is: None
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.49345773458480835, Reg Loss=2.5428762435913086
Clinet index 13, End of Epoch 3/6, Average Loss=3.0363340377807617, Class Loss=0.49345773458480835, Reg Loss=2.5428762435913086
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.47066202759742737, Reg Loss=2.6192407608032227
Clinet index 13, End of Epoch 4/6, Average Loss=3.089902877807617, Class Loss=0.47066202759742737, Reg Loss=2.6192407608032227
Pseudo labeling is: None
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.4815016984939575, Reg Loss=2.5517208576202393
Clinet index 13, End of Epoch 5/6, Average Loss=3.0332226753234863, Class Loss=0.4815016984939575, Reg Loss=2.5517208576202393
Pseudo labeling is: None
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.47746849060058594, Reg Loss=2.589622974395752
Clinet index 13, End of Epoch 6/6, Average Loss=3.067091464996338, Class Loss=0.47746849060058594, Reg Loss=2.589622974395752
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4864850640296936, Reg Loss=2.601813554763794
Clinet index 2, End of Epoch 1/6, Average Loss=3.0882985591888428, Class Loss=0.4864850640296936, Reg Loss=2.601813554763794
Pseudo labeling is: None
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.47241565585136414, Reg Loss=2.608604669570923
Clinet index 2, End of Epoch 2/6, Average Loss=3.0810203552246094, Class Loss=0.47241565585136414, Reg Loss=2.608604669570923
Pseudo labeling is: None
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.47839370369911194, Reg Loss=2.600642204284668
Clinet index 2, End of Epoch 3/6, Average Loss=3.079035997390747, Class Loss=0.47839370369911194, Reg Loss=2.600642204284668
Pseudo labeling is: None
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4514303207397461, Reg Loss=2.6213364601135254
Clinet index 2, End of Epoch 4/6, Average Loss=3.0727667808532715, Class Loss=0.4514303207397461, Reg Loss=2.6213364601135254
Pseudo labeling is: None
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.44439834356307983, Reg Loss=2.5569584369659424
Clinet index 2, End of Epoch 5/6, Average Loss=3.001356840133667, Class Loss=0.44439834356307983, Reg Loss=2.5569584369659424
Pseudo labeling is: None
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.45938974618911743, Reg Loss=2.583298921585083
Clinet index 2, End of Epoch 6/6, Average Loss=3.0426886081695557, Class Loss=0.45938974618911743, Reg Loss=2.583298921585083
federated aggregation...
Validation, Class Loss=1.3145538568496704, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.666129
Mean Acc: 0.116777
FreqW Acc: 0.564339
Mean IoU: 0.052112
Class IoU:
	class 0: 0.8155785
	class 1: 0.001976448
	class 2: 0.0
	class 3: 0.0
	class 4: 0.09518971
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 0.00010898105
	class 9: 1.0929383e-05
	class 10: 0.0
	class 11: 2.0913369e-05
	class 12: 0.0
	class 13: 0.0001044944
	class 14: 0.0
	class 15: 0.0288831
	class 16: 0.0
	class 17: 0.0
	class 18: 1.5048462e-06
	class 19: 0.07284131
	class 20: 0.07964401
Class Acc:
	class 0: 0.93883824
	class 1: 0.0019764805
	class 2: 0.0
	class 3: 0.0
	class 4: 0.097924374
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 0.00010898105
	class 9: 1.0929383e-05
	class 10: 0.0
	class 11: 2.0913369e-05
	class 12: 0.0
	class 13: 0.00010449455
	class 14: 0.0
	class 15: 0.028883588
	class 16: 0.0
	class 17: 0.0
	class 18: 1.5048527e-06
	class 19: 0.70261943
	class 20: 0.6818229

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.4611968398094177, Reg Loss=2.5848329067230225
Clinet index 6, End of Epoch 1/6, Average Loss=3.046029806137085, Class Loss=0.4611968398094177, Reg Loss=2.5848329067230225
Pseudo labeling is: None
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.4786514341831207, Reg Loss=2.608757972717285
Clinet index 6, End of Epoch 2/6, Average Loss=3.087409496307373, Class Loss=0.4786514341831207, Reg Loss=2.608757972717285
Pseudo labeling is: None
Epoch 3, lr = 0.000372
Epoch 3, Class Loss=0.47665873169898987, Reg Loss=2.6038291454315186
Clinet index 6, End of Epoch 3/6, Average Loss=3.0804879665374756, Class Loss=0.47665873169898987, Reg Loss=2.6038291454315186
Pseudo labeling is: None
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.46348825097084045, Reg Loss=2.5732581615448
Clinet index 6, End of Epoch 4/6, Average Loss=3.0367465019226074, Class Loss=0.46348825097084045, Reg Loss=2.5732581615448
Pseudo labeling is: None
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.4642774760723114, Reg Loss=2.5497264862060547
Clinet index 6, End of Epoch 5/6, Average Loss=3.0140039920806885, Class Loss=0.4642774760723114, Reg Loss=2.5497264862060547
Pseudo labeling is: None
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.4556235373020172, Reg Loss=2.574368476867676
Clinet index 6, End of Epoch 6/6, Average Loss=3.02999210357666, Class Loss=0.4556235373020172, Reg Loss=2.574368476867676
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.498077929019928, Reg Loss=2.62825083732605
Clinet index 16, End of Epoch 1/6, Average Loss=3.126328706741333, Class Loss=0.498077929019928, Reg Loss=2.62825083732605
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.46499618887901306, Reg Loss=2.663078784942627
Clinet index 16, End of Epoch 2/6, Average Loss=3.128074884414673, Class Loss=0.46499618887901306, Reg Loss=2.663078784942627
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.46572229266166687, Reg Loss=2.6080873012542725
Clinet index 16, End of Epoch 3/6, Average Loss=3.0738096237182617, Class Loss=0.46572229266166687, Reg Loss=2.6080873012542725
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.45849981904029846, Reg Loss=2.6004390716552734
Clinet index 16, End of Epoch 4/6, Average Loss=3.058938980102539, Class Loss=0.45849981904029846, Reg Loss=2.6004390716552734
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4605351686477661, Reg Loss=2.598417043685913
Clinet index 16, End of Epoch 5/6, Average Loss=3.0589523315429688, Class Loss=0.4605351686477661, Reg Loss=2.598417043685913
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.44512680172920227, Reg Loss=2.658245086669922
Clinet index 16, End of Epoch 6/6, Average Loss=3.1033718585968018, Class Loss=0.44512680172920227, Reg Loss=2.658245086669922
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.49411827325820923, Reg Loss=2.571880340576172
Clinet index 13, End of Epoch 1/6, Average Loss=3.0659985542297363, Class Loss=0.49411827325820923, Reg Loss=2.571880340576172
Pseudo labeling is: None
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.47834184765815735, Reg Loss=2.583346366882324
Clinet index 13, End of Epoch 2/6, Average Loss=3.061688184738159, Class Loss=0.47834184765815735, Reg Loss=2.583346366882324
Pseudo labeling is: None
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.4755866229534149, Reg Loss=2.55238938331604
Clinet index 13, End of Epoch 3/6, Average Loss=3.0279760360717773, Class Loss=0.4755866229534149, Reg Loss=2.55238938331604
Pseudo labeling is: None
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.461650013923645, Reg Loss=2.6035878658294678
Clinet index 13, End of Epoch 4/6, Average Loss=3.0652379989624023, Class Loss=0.461650013923645, Reg Loss=2.6035878658294678
Pseudo labeling is: None
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.4797736406326294, Reg Loss=2.5578742027282715
Clinet index 13, End of Epoch 5/6, Average Loss=3.0376477241516113, Class Loss=0.4797736406326294, Reg Loss=2.5578742027282715
Pseudo labeling is: None
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.4738578200340271, Reg Loss=2.5776336193084717
Clinet index 13, End of Epoch 6/6, Average Loss=3.0514914989471436, Class Loss=0.4738578200340271, Reg Loss=2.5776336193084717
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: None
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4391458332538605, Reg Loss=2.5404932498931885
Clinet index 22, End of Epoch 1/6, Average Loss=2.9796390533447266, Class Loss=0.4391458332538605, Reg Loss=2.5404932498931885
Pseudo labeling is: None
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.43471065163612366, Reg Loss=2.568270683288574
Clinet index 22, End of Epoch 2/6, Average Loss=3.002981424331665, Class Loss=0.43471065163612366, Reg Loss=2.568270683288574
Pseudo labeling is: None
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.43065977096557617, Reg Loss=2.5232577323913574
Clinet index 22, End of Epoch 3/6, Average Loss=2.9539175033569336, Class Loss=0.43065977096557617, Reg Loss=2.5232577323913574
Pseudo labeling is: None
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.42357364296913147, Reg Loss=2.5494394302368164
Clinet index 22, End of Epoch 4/6, Average Loss=2.973013162612915, Class Loss=0.42357364296913147, Reg Loss=2.5494394302368164
Pseudo labeling is: None
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.42889082431793213, Reg Loss=2.5080788135528564
Clinet index 22, End of Epoch 5/6, Average Loss=2.936969757080078, Class Loss=0.42889082431793213, Reg Loss=2.5080788135528564
Pseudo labeling is: None
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.420319139957428, Reg Loss=2.5968129634857178
Clinet index 22, End of Epoch 6/6, Average Loss=3.017132043838501, Class Loss=0.420319139957428, Reg Loss=2.5968129634857178
federated aggregation...
Validation, Class Loss=1.3307075500488281, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.667282
Mean Acc: 0.117294
FreqW Acc: 0.564362
Mean IoU: 0.052065
Class IoU:
	class 0: 0.8156076
	class 1: 0.0017516488
	class 2: 0.0
	class 3: 0.0
	class 4: 0.08870253
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 7.4790914e-05
	class 9: 6.429049e-06
	class 10: 0.0
	class 11: 2.3498167e-07
	class 12: 0.0
	class 13: 8.018861e-05
	class 14: 0.0
	class 15: 0.02910374
	class 16: 0.0
	class 17: 0.0
	class 18: 6.019369e-06
	class 19: 0.07215654
	class 20: 0.08587659
Class Acc:
	class 0: 0.9404545
	class 1: 0.0017516508
	class 2: 0.0
	class 3: 0.0
	class 4: 0.09121643
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 7.4790914e-05
	class 9: 6.429049e-06
	class 10: 0.0
	class 11: 2.3498167e-07
	class 12: 0.0
	class 13: 8.018866e-05
	class 14: 0.0
	class 15: 0.029104335
	class 16: 0.0
	class 17: 0.0
	class 18: 6.0194106e-06
	class 19: 0.6982386
	class 20: 0.702235

voc_15-1_LWF On GPUs 2
Run in 20310s
