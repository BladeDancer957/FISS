nohup: ignoring input
30
kvoc_15-1_PLOP On GPUs 2\Writing in results/seed_2023-ov/2023-03-09_voc_15-1_PLOP.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch 1, Class Loss=0.5815698504447937, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.5815698504447937, Class Loss=0.5815698504447937, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4561346769332886, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.4561346769332886, Class Loss=0.4561346769332886, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4288351237773895, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.4288351237773895, Class Loss=0.4288351237773895, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.41246360540390015, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.41246360540390015, Class Loss=0.41246360540390015, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4279495179653168, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.4279495179653168, Class Loss=0.4279495179653168, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.41971349716186523, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.41971349716186523, Class Loss=0.41971349716186523, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.576951265335083, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.576951265335083, Class Loss=0.576951265335083, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4368104636669159, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.4368104636669159, Class Loss=0.4368104636669159, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.42052847146987915, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.42052847146987915, Class Loss=0.42052847146987915, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.42218688130378723, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.42218688130378723, Class Loss=0.42218688130378723, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4213947653770447, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.4213947653770447, Class Loss=0.4213947653770447, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4142434000968933, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.4142434000968933, Class Loss=0.4142434000968933, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5958091020584106, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.5958091020584106, Class Loss=0.5958091020584106, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.44852393865585327, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.44852393865585327, Class Loss=0.44852393865585327, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.428494393825531, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.428494393825531, Class Loss=0.428494393825531, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.43993115425109863, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.43993115425109863, Class Loss=0.43993115425109863, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4243212044239044, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.4243212044239044, Class Loss=0.4243212044239044, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4239775538444519, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.4239775538444519, Class Loss=0.4239775538444519, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5338192582130432, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.5338192582130432, Class Loss=0.5338192582130432, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4308330714702606, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.4308330714702606, Class Loss=0.4308330714702606, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4002155661582947, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.4002155661582947, Class Loss=0.4002155661582947, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.40156683325767517, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.40156683325767517, Class Loss=0.40156683325767517, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.3960950970649719, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.3960950970649719, Class Loss=0.3960950970649719, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3930240571498871, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.3930240571498871, Class Loss=0.3930240571498871, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.33801040053367615, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.918722
Mean Acc: 0.866991
FreqW Acc: 0.859503
Mean IoU: 0.685152
Class IoU:
	class 0: 0.90226537
	class 1: 0.70063674
	class 2: 0.3688659
	class 3: 0.819174
	class 4: 0.6006116
	class 5: 0.7392249
	class 6: 0.89815724
	class 7: 0.8591545
	class 8: 0.86065596
	class 9: 0.43656564
	class 10: 0.7000798
	class 11: 0.6015893
	class 12: 0.7962697
	class 13: 0.72031945
	class 14: 0.8204464
	class 15: 0.8235593
	class 16: 0.0
Class Acc:
	class 0: 0.9195164
	class 1: 0.9973586
	class 2: 0.9362738
	class 3: 0.9720869
	class 4: 0.8811044
	class 5: 0.950806
	class 6: 0.993654
	class 7: 0.9680672
	class 8: 0.9597618
	class 9: 0.7357429
	class 10: 0.8143233
	class 11: 0.7446327
	class 12: 0.9851994
	class 13: 0.96482503
	class 14: 0.96153104
	class 15: 0.953954
	class 16: 0.0

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3811124563217163, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.3811124563217163, Class Loss=0.3811124563217163, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.41662123799324036, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.41662123799324036, Class Loss=0.41662123799324036, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.3892267346382141, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.3892267346382141, Class Loss=0.3892267346382141, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.394370436668396, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.394370436668396, Class Loss=0.394370436668396, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3774130046367645, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.3774130046367645, Class Loss=0.3774130046367645, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.36372560262680054, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.36372560262680054, Class Loss=0.36372560262680054, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.44574400782585144, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.44574400782585144, Class Loss=0.44574400782585144, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.43136727809906006, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.43136727809906006, Class Loss=0.43136727809906006, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.39794182777404785, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.39794182777404785, Class Loss=0.39794182777404785, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3942044675350189, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.3942044675350189, Class Loss=0.3942044675350189, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.384127140045166, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.384127140045166, Class Loss=0.384127140045166, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.36921679973602295, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.36921679973602295, Class Loss=0.36921679973602295, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4328252375125885, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.4328252375125885, Class Loss=0.4328252375125885, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.42748478055000305, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.42748478055000305, Class Loss=0.42748478055000305, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.41836053133010864, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.41836053133010864, Class Loss=0.41836053133010864, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.405043363571167, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.405043363571167, Class Loss=0.405043363571167, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3841050863265991, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.3841050863265991, Class Loss=0.3841050863265991, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.3754692077636719, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3754692077636719, Class Loss=0.3754692077636719, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.44258826971054077, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.44258826971054077, Class Loss=0.44258826971054077, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4034275412559509, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.4034275412559509, Class Loss=0.4034275412559509, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4117469787597656, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.4117469787597656, Class Loss=0.4117469787597656, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.40317249298095703, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.40317249298095703, Class Loss=0.40317249298095703, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3991265892982483, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.3991265892982483, Class Loss=0.3991265892982483, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 6, Class Loss=0.3661494553089142, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.3661494553089142, Class Loss=0.3661494553089142, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.33374786376953125, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.917919
Mean Acc: 0.875524
FreqW Acc: 0.858638
Mean IoU: 0.688552
Class IoU:
	class 0: 0.9004486
	class 1: 0.6985302
	class 2: 0.36604708
	class 3: 0.7999003
	class 4: 0.60592467
	class 5: 0.716471
	class 6: 0.89919657
	class 7: 0.8640923
	class 8: 0.86694354
	class 9: 0.44072405
	class 10: 0.6882399
	class 11: 0.59414303
	class 12: 0.79640865
	class 13: 0.7288681
	class 14: 0.8210354
	class 15: 0.8241308
	class 16: 0.09428492
Class Acc:
	class 0: 0.916194
	class 1: 0.99751866
	class 2: 0.9444581
	class 3: 0.9748723
	class 4: 0.8877948
	class 5: 0.95607895
	class 6: 0.9942501
	class 7: 0.96581036
	class 8: 0.9735209
	class 9: 0.72295076
	class 10: 0.8231898
	class 11: 0.75340104
	class 12: 0.9873329
	class 13: 0.96416146
	class 14: 0.96880925
	class 15: 0.9536054
	class 16: 0.09995734

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3871541917324066, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.3871541917324066, Class Loss=0.3871541917324066, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3730027377605438, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.3730027377605438, Class Loss=0.3730027377605438, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.34657058119773865, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.34657058119773865, Class Loss=0.34657058119773865, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3525589108467102, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.3525589108467102, Class Loss=0.3525589108467102, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.33217963576316833, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.33217963576316833, Class Loss=0.33217963576316833, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3186096251010895, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.3186096251010895, Class Loss=0.3186096251010895, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3995332717895508, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.3995332717895508, Class Loss=0.3995332717895508, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3819713592529297, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.3819713592529297, Class Loss=0.3819713592529297, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.36127182841300964, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.36127182841300964, Class Loss=0.36127182841300964, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.37341922521591187, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.37341922521591187, Class Loss=0.37341922521591187, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3737223148345947, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.3737223148345947, Class Loss=0.3737223148345947, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.33692029118537903, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.33692029118537903, Class Loss=0.33692029118537903, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.35578829050064087, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.35578829050064087, Class Loss=0.35578829050064087, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3408302366733551, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.3408302366733551, Class Loss=0.3408302366733551, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3407995402812958, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.3407995402812958, Class Loss=0.3407995402812958, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.329873651266098, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.329873651266098, Class Loss=0.329873651266098, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3156387209892273, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.3156387209892273, Class Loss=0.3156387209892273, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.31529006361961365, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.31529006361961365, Class Loss=0.31529006361961365, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.35852909088134766, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.35852909088134766, Class Loss=0.35852909088134766, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3550308048725128, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.3550308048725128, Class Loss=0.3550308048725128, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.33892732858657837, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.33892732858657837, Class Loss=0.33892732858657837, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3424510359764099, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.3424510359764099, Class Loss=0.3424510359764099, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3197449743747711, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.3197449743747711, Class Loss=0.3197449743747711, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3223959505558014, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.3223959505558014, Class Loss=0.3223959505558014, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.30862829089164734, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.919753
Mean Acc: 0.884116
FreqW Acc: 0.863453
Mean IoU: 0.702496
Class IoU:
	class 0: 0.90296036
	class 1: 0.72328025
	class 2: 0.37245756
	class 3: 0.80680925
	class 4: 0.6183359
	class 5: 0.73424834
	class 6: 0.90995383
	class 7: 0.88192827
	class 8: 0.86465436
	class 9: 0.44620717
	class 10: 0.69565225
	class 11: 0.598665
	class 12: 0.80332166
	class 13: 0.7299521
	class 14: 0.828552
	class 15: 0.8325099
	class 16: 0.19293635
Class Acc:
	class 0: 0.91831094
	class 1: 0.99682426
	class 2: 0.94322747
	class 3: 0.978675
	class 4: 0.87892324
	class 5: 0.95476145
	class 6: 0.99095047
	class 7: 0.9637921
	class 8: 0.970551
	class 9: 0.675162
	class 10: 0.8055467
	class 11: 0.7464202
	class 12: 0.9847103
	class 13: 0.9614654
	class 14: 0.97096634
	class 15: 0.9528141
	class 16: 0.33686945

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.3275715410709381, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.3275715410709381, Class Loss=0.3275715410709381, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3273879885673523, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.3273879885673523, Class Loss=0.3273879885673523, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.3132920563220978, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.3132920563220978, Class Loss=0.3132920563220978, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.3150273263454437, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.3150273263454437, Class Loss=0.3150273263454437, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.31375670433044434, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.31375670433044434, Class Loss=0.31375670433044434, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.3065997362136841, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3065997362136841, Class Loss=0.3065997362136841, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3126559853553772, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.3126559853553772, Class Loss=0.3126559853553772, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.31192827224731445, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.31192827224731445, Class Loss=0.31192827224731445, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.30921825766563416, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.30921825766563416, Class Loss=0.30921825766563416, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.33420297503471375, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.33420297503471375, Class Loss=0.33420297503471375, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3005918562412262, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.3005918562412262, Class Loss=0.3005918562412262, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2927064299583435, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.2927064299583435, Class Loss=0.2927064299583435, Reg Loss=0.0
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.3333980441093445, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.3333980441093445, Class Loss=0.3333980441093445, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3264382481575012, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.3264382481575012, Class Loss=0.3264382481575012, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.3119877874851227, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.3119877874851227, Class Loss=0.3119877874851227, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.31576403975486755, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.31576403975486755, Class Loss=0.31576403975486755, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.31322503089904785, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.31322503089904785, Class Loss=0.31322503089904785, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.3157612085342407, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.3157612085342407, Class Loss=0.3157612085342407, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.33566680550575256, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.33566680550575256, Class Loss=0.33566680550575256, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.3241080939769745, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.3241080939769745, Class Loss=0.3241080939769745, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.32584482431411743, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.32584482431411743, Class Loss=0.32584482431411743, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.32457199692726135, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.32457199692726135, Class Loss=0.32457199692726135, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.31658071279525757, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.31658071279525757, Class Loss=0.31658071279525757, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.2955237329006195, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.2955237329006195, Class Loss=0.2955237329006195, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.29974398016929626, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.917336
Mean Acc: 0.888093
FreqW Acc: 0.862377
Mean IoU: 0.706025
Class IoU:
	class 0: 0.8990234
	class 1: 0.739195
	class 2: 0.37041852
	class 3: 0.8249586
	class 4: 0.6222967
	class 5: 0.7360114
	class 6: 0.9121607
	class 7: 0.88439506
	class 8: 0.8695124
	class 9: 0.44503555
	class 10: 0.71589875
	class 11: 0.5944461
	class 12: 0.8075101
	class 13: 0.7606922
	class 14: 0.82373905
	class 15: 0.8387144
	class 16: 0.15841548
Class Acc:
	class 0: 0.9142839
	class 1: 0.9963467
	class 2: 0.94365895
	class 3: 0.97612095
	class 4: 0.88053477
	class 5: 0.9577152
	class 6: 0.9925812
	class 7: 0.963422
	class 8: 0.96749616
	class 9: 0.66424066
	class 10: 0.82848793
	class 11: 0.74412096
	class 12: 0.9855492
	class 13: 0.95771337
	class 14: 0.9716673
	class 15: 0.949961
	class 16: 0.40368026

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.3204631507396698, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.3204631507396698, Class Loss=0.3204631507396698, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.30607497692108154, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.30607497692108154, Class Loss=0.30607497692108154, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.30355194211006165, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.30355194211006165, Class Loss=0.30355194211006165, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.3065119981765747, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.3065119981765747, Class Loss=0.3065119981765747, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.3010777533054352, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.3010777533054352, Class Loss=0.3010777533054352, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.3051673471927643, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3051673471927643, Class Loss=0.3051673471927643, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.305076003074646, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.305076003074646, Class Loss=0.305076003074646, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.29291269183158875, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.29291269183158875, Class Loss=0.29291269183158875, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.3044193387031555, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.3044193387031555, Class Loss=0.3044193387031555, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.30571940541267395, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.30571940541267395, Class Loss=0.30571940541267395, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.30022603273391724, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.30022603273391724, Class Loss=0.30022603273391724, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.30116361379623413, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.30116361379623413, Class Loss=0.30116361379623413, Reg Loss=0.0
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3206041753292084, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.3206041753292084, Class Loss=0.3206041753292084, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.3115677237510681, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.3115677237510681, Class Loss=0.3115677237510681, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.3065524697303772, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.3065524697303772, Class Loss=0.3065524697303772, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.3065350651741028, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.3065350651741028, Class Loss=0.3065350651741028, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.30151447653770447, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.30151447653770447, Class Loss=0.30151447653770447, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.29592183232307434, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.29592183232307434, Class Loss=0.29592183232307434, Reg Loss=0.0
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.30665406584739685, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.30665406584739685, Class Loss=0.30665406584739685, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.29584169387817383, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.29584169387817383, Class Loss=0.29584169387817383, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.30410289764404297, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.30410289764404297, Class Loss=0.30410289764404297, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.2991240322589874, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.2991240322589874, Class Loss=0.2991240322589874, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.3096051514148712, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.3096051514148712, Class Loss=0.3096051514148712, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.3053132891654968, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.3053132891654968, Class Loss=0.3053132891654968, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.2932320535182953, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.917779
Mean Acc: 0.888375
FreqW Acc: 0.863166
Mean IoU: 0.707994
Class IoU:
	class 0: 0.8994034
	class 1: 0.74438363
	class 2: 0.37553236
	class 3: 0.82940954
	class 4: 0.6250845
	class 5: 0.73353744
	class 6: 0.9138305
	class 7: 0.8868706
	class 8: 0.8724572
	class 9: 0.44270986
	class 10: 0.7187223
	class 11: 0.5918917
	class 12: 0.8121908
	class 13: 0.76632214
	class 14: 0.83130515
	class 15: 0.83739674
	class 16: 0.15485156
Class Acc:
	class 0: 0.9145633
	class 1: 0.99605143
	class 2: 0.93855083
	class 3: 0.9758052
	class 4: 0.8765224
	class 5: 0.95744544
	class 6: 0.99222237
	class 7: 0.96277267
	class 8: 0.96887374
	class 9: 0.6743558
	class 10: 0.8342496
	class 11: 0.74761814
	class 12: 0.9846172
	class 13: 0.9595951
	class 14: 0.97206
	class 15: 0.9513162
	class 16: 0.39575365

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.1497251987457275, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=1.1497251987457275, Class Loss=1.1497251987457275, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.9616124629974365, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.9616124629974365, Class Loss=0.9616124629974365, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8067214488983154, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.8067214488983154, Class Loss=0.8067214488983154, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7437021136283875, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.7437021136283875, Class Loss=0.7437021136283875, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6834551692008972, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.6834551692008972, Class Loss=0.6834551692008972, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6182929277420044, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.6182929277420044, Class Loss=0.6182929277420044, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.1344399452209473, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=1.1344399452209473, Class Loss=1.1344399452209473, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.982114315032959, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.982114315032959, Class Loss=0.982114315032959, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8217572569847107, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.8217572569847107, Class Loss=0.8217572569847107, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7449448108673096, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.7449448108673096, Class Loss=0.7449448108673096, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.666421115398407, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.666421115398407, Class Loss=0.666421115398407, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6103227138519287, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.6103227138519287, Class Loss=0.6103227138519287, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.1416622400283813, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=1.1416622400283813, Class Loss=1.1416622400283813, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.9328869581222534, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.9328869581222534, Class Loss=0.9328869581222534, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8705011010169983, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.8705011010169983, Class Loss=0.8705011010169983, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.735232949256897, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.735232949256897, Class Loss=0.735232949256897, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.646619439125061, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.646619439125061, Class Loss=0.646619439125061, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6286742091178894, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.6286742091178894, Class Loss=0.6286742091178894, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=1.0859787464141846, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=1.0859787464141846, Class Loss=1.0859787464141846, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.9362934827804565, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.9362934827804565, Class Loss=0.9362934827804565, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8025844693183899, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.8025844693183899, Class Loss=0.8025844693183899, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.737795352935791, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.737795352935791, Class Loss=0.737795352935791, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6455886960029602, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.6455886960029602, Class Loss=0.6455886960029602, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.5692487955093384, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.5692487955093384, Class Loss=0.5692487955093384, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.4843877851963043, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.899833
Mean Acc: 0.804209
FreqW Acc: 0.837022
Mean IoU: 0.657501
Class IoU:
	class 0: 0.87998533
	class 1: 0.81856006
	class 2: 0.36636513
	class 3: 0.8271618
	class 4: 0.57327867
	class 5: 0.7505074
	class 6: 0.90297145
	class 7: 0.8524032
	class 8: 0.89144444
	class 9: 0.41356552
	class 10: 0.6737121
	class 11: 0.56726974
	class 12: 0.8176344
	class 13: 0.7630266
	class 14: 0.82678175
	class 15: 0.78303677
	class 16: 0.10665644
	class 17: 0.020648036
Class Acc:
	class 0: 0.9174101
	class 1: 0.967804
	class 2: 0.9342777
	class 3: 0.860935
	class 4: 0.85417515
	class 5: 0.92503196
	class 6: 0.98459184
	class 7: 0.9568933
	class 8: 0.93115544
	class 9: 0.65582216
	class 10: 0.7720693
	class 11: 0.6476899
	class 12: 0.8924387
	class 13: 0.85312676
	class 14: 0.9299787
	class 15: 0.9502164
	class 16: 0.42143354
	class 17: 0.020712648

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.567202627658844, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.567202627658844, Class Loss=0.567202627658844, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.558143138885498, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.558143138885498, Class Loss=0.558143138885498, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.5696998238563538, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.5696998238563538, Class Loss=0.5696998238563538, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.5111045837402344, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.5111045837402344, Class Loss=0.5111045837402344, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5119665265083313, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.5119665265083313, Class Loss=0.5119665265083313, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5082645416259766, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.5082645416259766, Class Loss=0.5082645416259766, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6127028465270996, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.6127028465270996, Class Loss=0.6127028465270996, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.578632652759552, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.578632652759552, Class Loss=0.578632652759552, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5644011497497559, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.5644011497497559, Class Loss=0.5644011497497559, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5173735022544861, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.5173735022544861, Class Loss=0.5173735022544861, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.48333749175071716, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.48333749175071716, Class Loss=0.48333749175071716, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.44448530673980713, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.44448530673980713, Class Loss=0.44448530673980713, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6336731910705566, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.6336731910705566, Class Loss=0.6336731910705566, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5768264532089233, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.5768264532089233, Class Loss=0.5768264532089233, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5554894208908081, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.5554894208908081, Class Loss=0.5554894208908081, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5384376645088196, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.5384376645088196, Class Loss=0.5384376645088196, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.516120195388794, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.516120195388794, Class Loss=0.516120195388794, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4561340808868408, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.4561340808868408, Class Loss=0.4561340808868408, Reg Loss=0.0
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5720218420028687, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.5720218420028687, Class Loss=0.5720218420028687, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5529003143310547, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.5529003143310547, Class Loss=0.5529003143310547, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5344372391700745, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.5344372391700745, Class Loss=0.5344372391700745, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.49817970395088196, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.49817970395088196, Class Loss=0.49817970395088196, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.48439592123031616, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.48439592123031616, Class Loss=0.48439592123031616, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4547279477119446, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.4547279477119446, Class Loss=0.4547279477119446, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.45965898036956787, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.906280
Mean Acc: 0.834885
FreqW Acc: 0.847716
Mean IoU: 0.670799
Class IoU:
	class 0: 0.89457035
	class 1: 0.79676855
	class 2: 0.34743506
	class 3: 0.8412472
	class 4: 0.5330624
	class 5: 0.7457252
	class 6: 0.89306
	class 7: 0.8608953
	class 8: 0.8706578
	class 9: 0.4221858
	class 10: 0.58187616
	class 11: 0.57323486
	class 12: 0.7800662
	class 13: 0.74637586
	class 14: 0.8223653
	class 15: 0.77574545
	class 16: 0.09232542
	class 17: 0.4967834
Class Acc:
	class 0: 0.9193323
	class 1: 0.9646389
	class 2: 0.94540775
	class 3: 0.886665
	class 4: 0.87341315
	class 5: 0.9385513
	class 6: 0.9882916
	class 7: 0.9545452
	class 8: 0.9327479
	class 9: 0.672836
	class 10: 0.60214686
	class 11: 0.6841604
	class 12: 0.84483564
	class 13: 0.89931065
	class 14: 0.9195458
	class 15: 0.95875335
	class 16: 0.272468
	class 17: 0.77027434

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.4638810157775879, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.4638810157775879, Class Loss=0.4638810157775879, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.45720723271369934, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.45720723271369934, Class Loss=0.45720723271369934, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.45304447412490845, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.45304447412490845, Class Loss=0.45304447412490845, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.4485695958137512, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.4485695958137512, Class Loss=0.4485695958137512, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.4197133183479309, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.4197133183479309, Class Loss=0.4197133183479309, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.3898886740207672, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.3898886740207672, Class Loss=0.3898886740207672, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4512658417224884, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.4512658417224884, Class Loss=0.4512658417224884, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.4293891191482544, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.4293891191482544, Class Loss=0.4293891191482544, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.41301020979881287, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.41301020979881287, Class Loss=0.41301020979881287, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3851935863494873, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.3851935863494873, Class Loss=0.3851935863494873, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.39863699674606323, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.39863699674606323, Class Loss=0.39863699674606323, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3632084131240845, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3632084131240845, Class Loss=0.3632084131240845, Reg Loss=0.0
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.4214590787887573, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.4214590787887573, Class Loss=0.4214590787887573, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.4235202968120575, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.4235202968120575, Class Loss=0.4235202968120575, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.4381835460662842, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.4381835460662842, Class Loss=0.4381835460662842, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.4238526225090027, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.4238526225090027, Class Loss=0.4238526225090027, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.4014545679092407, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.4014545679092407, Class Loss=0.4014545679092407, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.35603058338165283, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.35603058338165283, Class Loss=0.35603058338165283, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.46183112263679504, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.46183112263679504, Class Loss=0.46183112263679504, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.44280770421028137, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.44280770421028137, Class Loss=0.44280770421028137, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.4102512300014496, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.4102512300014496, Class Loss=0.4102512300014496, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4074746072292328, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.4074746072292328, Class Loss=0.4074746072292328, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3974282741546631, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.3974282741546631, Class Loss=0.3974282741546631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.36658576130867004, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.36658576130867004, Class Loss=0.36658576130867004, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.41087689995765686, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.912532
Mean Acc: 0.834711
FreqW Acc: 0.855639
Mean IoU: 0.672108
Class IoU:
	class 0: 0.9042316
	class 1: 0.80889666
	class 2: 0.35061592
	class 3: 0.8406244
	class 4: 0.53716433
	class 5: 0.7520412
	class 6: 0.89732355
	class 7: 0.86892354
	class 8: 0.8776143
	class 9: 0.42067903
	class 10: 0.58587235
	class 11: 0.57915324
	class 12: 0.77942
	class 13: 0.7552467
	class 14: 0.8215977
	class 15: 0.787417
	class 16: 0.09082853
	class 17: 0.44028676
Class Acc:
	class 0: 0.9285891
	class 1: 0.96165764
	class 2: 0.950417
	class 3: 0.89166766
	class 4: 0.88552326
	class 5: 0.9349484
	class 6: 0.98712856
	class 7: 0.9517883
	class 8: 0.9239692
	class 9: 0.6755333
	class 10: 0.60615516
	class 11: 0.68560016
	class 12: 0.8304811
	class 13: 0.89614034
	class 14: 0.91323924
	class 15: 0.959624
	class 16: 0.1741163
	class 17: 0.8682262

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.35441645979881287, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.35441645979881287, Class Loss=0.35441645979881287, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3459877371788025, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.3459877371788025, Class Loss=0.3459877371788025, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.34885960817337036, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.34885960817337036, Class Loss=0.34885960817337036, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.3402302861213684, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.3402302861213684, Class Loss=0.3402302861213684, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.33617323637008667, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.33617323637008667, Class Loss=0.33617323637008667, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.31119486689567566, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.31119486689567566, Class Loss=0.31119486689567566, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.35001158714294434, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.35001158714294434, Class Loss=0.35001158714294434, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.37056177854537964, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.37056177854537964, Class Loss=0.37056177854537964, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3570273220539093, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.3570273220539093, Class Loss=0.3570273220539093, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.3634910583496094, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.3634910583496094, Class Loss=0.3634910583496094, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.34332334995269775, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.34332334995269775, Class Loss=0.34332334995269775, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3272874355316162, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.3272874355316162, Class Loss=0.3272874355316162, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3710060119628906, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.3710060119628906, Class Loss=0.3710060119628906, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.38370662927627563, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.38370662927627563, Class Loss=0.38370662927627563, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3525850772857666, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.3525850772857666, Class Loss=0.3525850772857666, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.34369391202926636, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.34369391202926636, Class Loss=0.34369391202926636, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.32162606716156006, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.32162606716156006, Class Loss=0.32162606716156006, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3207617402076721, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.3207617402076721, Class Loss=0.3207617402076721, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3794758915901184, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.3794758915901184, Class Loss=0.3794758915901184, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.37750765681266785, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.37750765681266785, Class Loss=0.37750765681266785, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.334575891494751, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.334575891494751, Class Loss=0.334575891494751, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.33596447110176086, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.33596447110176086, Class Loss=0.33596447110176086, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3511093854904175, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.3511093854904175, Class Loss=0.3511093854904175, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3270965814590454, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.3270965814590454, Class Loss=0.3270965814590454, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.38217154145240784, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.913603
Mean Acc: 0.830544
FreqW Acc: 0.857096
Mean IoU: 0.667616
Class IoU:
	class 0: 0.9075722
	class 1: 0.7906855
	class 2: 0.35873172
	class 3: 0.8455659
	class 4: 0.53705937
	class 5: 0.75772744
	class 6: 0.9089495
	class 7: 0.8730324
	class 8: 0.87598056
	class 9: 0.40590173
	class 10: 0.5468386
	class 11: 0.57507175
	class 12: 0.7680306
	class 13: 0.7665921
	class 14: 0.82062197
	class 15: 0.79113984
	class 16: 0.08488009
	class 17: 0.40271583
Class Acc:
	class 0: 0.93204886
	class 1: 0.9691893
	class 2: 0.94701827
	class 3: 0.9019767
	class 4: 0.8893879
	class 5: 0.93550974
	class 6: 0.98643386
	class 7: 0.9508092
	class 8: 0.9236809
	class 9: 0.6822992
	class 10: 0.5580712
	class 11: 0.6943812
	class 12: 0.8042843
	class 13: 0.884085
	class 14: 0.90399414
	class 15: 0.9604339
	class 16: 0.1253729
	class 17: 0.90081245

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.29775136709213257, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.29775136709213257, Class Loss=0.29775136709213257, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.3043832778930664, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.3043832778930664, Class Loss=0.3043832778930664, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.3153230547904968, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.3153230547904968, Class Loss=0.3153230547904968, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.3079545199871063, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.3079545199871063, Class Loss=0.3079545199871063, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.29404959082603455, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.29404959082603455, Class Loss=0.29404959082603455, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.29462555050849915, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.29462555050849915, Class Loss=0.29462555050849915, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.31860828399658203, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.31860828399658203, Class Loss=0.31860828399658203, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.3138573467731476, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.3138573467731476, Class Loss=0.3138573467731476, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.3076069951057434, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.3076069951057434, Class Loss=0.3076069951057434, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.30463844537734985, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.30463844537734985, Class Loss=0.30463844537734985, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.30157744884490967, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.30157744884490967, Class Loss=0.30157744884490967, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.30382442474365234, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.30382442474365234, Class Loss=0.30382442474365234, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3289949595928192, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.3289949595928192, Class Loss=0.3289949595928192, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.31896984577178955, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.31896984577178955, Class Loss=0.31896984577178955, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.31820178031921387, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.31820178031921387, Class Loss=0.31820178031921387, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2920569181442261, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.2920569181442261, Class Loss=0.2920569181442261, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.29174715280532837, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.29174715280532837, Class Loss=0.29174715280532837, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.28272396326065063, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.28272396326065063, Class Loss=0.28272396326065063, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3277926445007324, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.3277926445007324, Class Loss=0.3277926445007324, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.3432173728942871, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.3432173728942871, Class Loss=0.3432173728942871, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.3237995505332947, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.3237995505332947, Class Loss=0.3237995505332947, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.31669795513153076, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.31669795513153076, Class Loss=0.31669795513153076, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.3289964199066162, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.3289964199066162, Class Loss=0.3289964199066162, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.31354057788848877, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.31354057788848877, Class Loss=0.31354057788848877, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.367954283952713, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.914767
Mean Acc: 0.823280
FreqW Acc: 0.858904
Mean IoU: 0.664041
Class IoU:
	class 0: 0.9111551
	class 1: 0.801852
	class 2: 0.3611806
	class 3: 0.845215
	class 4: 0.5443098
	class 5: 0.76128566
	class 6: 0.90938
	class 7: 0.87849075
	class 8: 0.873992
	class 9: 0.4133215
	class 10: 0.49156278
	class 11: 0.5803777
	class 12: 0.75328326
	class 13: 0.7527182
	class 14: 0.82168895
	class 15: 0.8008567
	class 16: 0.072086275
	class 17: 0.37998295
Class Acc:
	class 0: 0.93693084
	class 1: 0.965845
	class 2: 0.9483492
	class 3: 0.8981802
	class 4: 0.8883661
	class 5: 0.9344112
	class 6: 0.9859436
	class 7: 0.949514
	class 8: 0.9152448
	class 9: 0.68172896
	class 10: 0.49790612
	class 11: 0.6870404
	class 12: 0.78943604
	class 13: 0.88108873
	class 14: 0.89951706
	class 15: 0.95783395
	class 16: 0.09773419
	class 17: 0.9039726

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6837477684020996, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.6837477684020996, Class Loss=0.6837477684020996, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6201993227005005, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.6201993227005005, Class Loss=0.6201993227005005, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5681697130203247, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.5681697130203247, Class Loss=0.5681697130203247, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5154592394828796, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.5154592394828796, Class Loss=0.5154592394828796, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5028245449066162, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.5028245449066162, Class Loss=0.5028245449066162, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4924764931201935, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.4924764931201935, Class Loss=0.4924764931201935, Reg Loss=0.0
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6947442889213562, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.6947442889213562, Class Loss=0.6947442889213562, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5972487330436707, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.5972487330436707, Class Loss=0.5972487330436707, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5768656134605408, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.5768656134605408, Class Loss=0.5768656134605408, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5221064686775208, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.5221064686775208, Class Loss=0.5221064686775208, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4887247085571289, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.4887247085571289, Class Loss=0.4887247085571289, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4823739230632782, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.4823739230632782, Class Loss=0.4823739230632782, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.685790479183197, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.685790479183197, Class Loss=0.685790479183197, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6065338253974915, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.6065338253974915, Class Loss=0.6065338253974915, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5343921780586243, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.5343921780586243, Class Loss=0.5343921780586243, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.49544858932495117, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.49544858932495117, Class Loss=0.49544858932495117, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.5006845593452454, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.5006845593452454, Class Loss=0.5006845593452454, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4759726822376251, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.4759726822376251, Class Loss=0.4759726822376251, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.6516396999359131, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.6516396999359131, Class Loss=0.6516396999359131, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5859139561653137, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.5859139561653137, Class Loss=0.5859139561653137, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5412654280662537, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.5412654280662537, Class Loss=0.5412654280662537, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5052371621131897, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.5052371621131897, Class Loss=0.5052371621131897, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.49598363041877747, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.49598363041877747, Class Loss=0.49598363041877747, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.470210462808609, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.470210462808609, Class Loss=0.470210462808609, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.7048486471176147, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.850932
Mean Acc: 0.842827
FreqW Acc: 0.781398
Mean IoU: 0.603557
Class IoU:
	class 0: 0.8256422
	class 1: 0.70625275
	class 2: 0.30756158
	class 3: 0.73930484
	class 4: 0.47523353
	class 5: 0.68628114
	class 6: 0.83345544
	class 7: 0.8624235
	class 8: 0.8044818
	class 9: 0.40665168
	class 10: 0.5925748
	class 11: 0.51476514
	class 12: 0.78379625
	class 13: 0.7099295
	class 14: 0.75190926
	class 15: 0.8094571
	class 16: 0.12504129
	class 17: 0.38302597
	class 18: 0.14979519
Class Acc:
	class 0: 0.84016746
	class 1: 0.9764519
	class 2: 0.96575415
	class 3: 0.95147526
	class 4: 0.89676964
	class 5: 0.9547653
	class 6: 0.9942609
	class 7: 0.952753
	class 8: 0.9578812
	class 9: 0.66116375
	class 10: 0.65426016
	class 11: 0.7782814
	class 12: 0.9082497
	class 13: 0.84915996
	class 14: 0.9569152
	class 15: 0.95470095
	class 16: 0.55619335
	class 17: 0.7855851
	class 18: 0.4189145

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.46248623728752136, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.46248623728752136, Class Loss=0.46248623728752136, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.44720980525016785, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.44720980525016785, Class Loss=0.44720980525016785, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.43863439559936523, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.43863439559936523, Class Loss=0.43863439559936523, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4180835783481598, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.4180835783481598, Class Loss=0.4180835783481598, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4139325022697449, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.4139325022697449, Class Loss=0.4139325022697449, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.39994481205940247, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.39994481205940247, Class Loss=0.39994481205940247, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.46661266684532166, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.46661266684532166, Class Loss=0.46661266684532166, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4536445736885071, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.4536445736885071, Class Loss=0.4536445736885071, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.44905713200569153, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.44905713200569153, Class Loss=0.44905713200569153, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.41186630725860596, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.41186630725860596, Class Loss=0.41186630725860596, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.40578898787498474, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.40578898787498474, Class Loss=0.40578898787498474, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.383407860994339, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.383407860994339, Class Loss=0.383407860994339, Reg Loss=0.0
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4412180781364441, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.4412180781364441, Class Loss=0.4412180781364441, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4413485527038574, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.4413485527038574, Class Loss=0.4413485527038574, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4190312623977661, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.4190312623977661, Class Loss=0.4190312623977661, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4069705605506897, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.4069705605506897, Class Loss=0.4069705605506897, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.41801297664642334, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.41801297664642334, Class Loss=0.41801297664642334, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.37770920991897583, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.37770920991897583, Class Loss=0.37770920991897583, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.48485320806503296, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.48485320806503296, Class Loss=0.48485320806503296, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.46791595220565796, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.46791595220565796, Class Loss=0.46791595220565796, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.45509254932403564, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.45509254932403564, Class Loss=0.45509254932403564, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4298551082611084, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.4298551082611084, Class Loss=0.4298551082611084, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4076080918312073, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.4076080918312073, Class Loss=0.4076080918312073, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.388874888420105, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.388874888420105, Class Loss=0.388874888420105, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6650794744491577, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.831359
Mean Acc: 0.853416
FreqW Acc: 0.762208
Mean IoU: 0.607998
Class IoU:
	class 0: 0.7956853
	class 1: 0.6963573
	class 2: 0.29289028
	class 3: 0.6847856
	class 4: 0.494887
	class 5: 0.6594492
	class 6: 0.8507573
	class 7: 0.8577081
	class 8: 0.8255914
	class 9: 0.4157531
	class 10: 0.614149
	class 11: 0.50189936
	class 12: 0.8089314
	class 13: 0.7216405
	class 14: 0.75065345
	class 15: 0.8008655
	class 16: 0.15006763
	class 17: 0.49240696
	class 18: 0.13749163
Class Acc:
	class 0: 0.8044118
	class 1: 0.9819587
	class 2: 0.9640483
	class 3: 0.9619604
	class 4: 0.9012069
	class 5: 0.9528578
	class 6: 0.99263644
	class 7: 0.952161
	class 8: 0.9651041
	class 9: 0.63192636
	class 10: 0.7092468
	class 11: 0.78610015
	class 12: 0.9207138
	class 13: 0.8773807
	class 14: 0.955572
	class 15: 0.9587457
	class 16: 0.49349445
	class 17: 0.72121835
	class 18: 0.68416023

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.37073826789855957, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.37073826789855957, Class Loss=0.37073826789855957, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.37260159850120544, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.37260159850120544, Class Loss=0.37260159850120544, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3600271940231323, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.3600271940231323, Class Loss=0.3600271940231323, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.35892611742019653, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.35892611742019653, Class Loss=0.35892611742019653, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.35799264907836914, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.35799264907836914, Class Loss=0.35799264907836914, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3333934247493744, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3333934247493744, Class Loss=0.3333934247493744, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.38397035002708435, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.38397035002708435, Class Loss=0.38397035002708435, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.38383403420448303, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.38383403420448303, Class Loss=0.38383403420448303, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.3622727394104004, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.3622727394104004, Class Loss=0.3622727394104004, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.3448370695114136, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.3448370695114136, Class Loss=0.3448370695114136, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.3461650013923645, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.3461650013923645, Class Loss=0.3461650013923645, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.33493149280548096, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.33493149280548096, Class Loss=0.33493149280548096, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.40339142084121704, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.40339142084121704, Class Loss=0.40339142084121704, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.3844556510448456, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.3844556510448456, Class Loss=0.3844556510448456, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.37963950634002686, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.37963950634002686, Class Loss=0.37963950634002686, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.36537453532218933, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.36537453532218933, Class Loss=0.36537453532218933, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.34625786542892456, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.34625786542892456, Class Loss=0.34625786542892456, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.341211199760437, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.341211199760437, Class Loss=0.341211199760437, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.40178847312927246, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.40178847312927246, Class Loss=0.40178847312927246, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.37330177426338196, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.37330177426338196, Class Loss=0.37330177426338196, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.36493873596191406, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.36493873596191406, Class Loss=0.36493873596191406, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.34956321120262146, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.34956321120262146, Class Loss=0.34956321120262146, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3462379276752472, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.3462379276752472, Class Loss=0.3462379276752472, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3395772874355316, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.3395772874355316, Class Loss=0.3395772874355316, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6408340930938721, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.829561
Mean Acc: 0.848918
FreqW Acc: 0.762193
Mean IoU: 0.607941
Class IoU:
	class 0: 0.79414535
	class 1: 0.68168044
	class 2: 0.2948843
	class 3: 0.6374612
	class 4: 0.4981398
	class 5: 0.65055424
	class 6: 0.8588372
	class 7: 0.86369824
	class 8: 0.83500916
	class 9: 0.41471475
	class 10: 0.6301151
	class 11: 0.5083083
	class 12: 0.8099476
	class 13: 0.72801054
	class 14: 0.7570283
	class 15: 0.8140336
	class 16: 0.16593963
	class 17: 0.47531682
	class 18: 0.13306205
Class Acc:
	class 0: 0.80222
	class 1: 0.9860097
	class 2: 0.9640978
	class 3: 0.96583194
	class 4: 0.9150611
	class 5: 0.9508554
	class 6: 0.9915651
	class 7: 0.95267475
	class 8: 0.95941436
	class 9: 0.6239733
	class 10: 0.73125947
	class 11: 0.7805727
	class 12: 0.92537355
	class 13: 0.89099413
	class 14: 0.95171815
	class 15: 0.95573217
	class 16: 0.41827965
	class 17: 0.6187719
	class 18: 0.7450448

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.33873942494392395, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.33873942494392395, Class Loss=0.33873942494392395, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.34059247374534607, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.34059247374534607, Class Loss=0.34059247374534607, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.33075860142707825, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.33075860142707825, Class Loss=0.33075860142707825, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.31763115525245667, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.31763115525245667, Class Loss=0.31763115525245667, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3098037838935852, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.3098037838935852, Class Loss=0.3098037838935852, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3105510473251343, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.3105510473251343, Class Loss=0.3105510473251343, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3343992233276367, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.3343992233276367, Class Loss=0.3343992233276367, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.3338733911514282, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.3338733911514282, Class Loss=0.3338733911514282, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.30934348702430725, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.30934348702430725, Class Loss=0.30934348702430725, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.307768851518631, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.307768851518631, Class Loss=0.307768851518631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.30851486325263977, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.30851486325263977, Class Loss=0.30851486325263977, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.29883047938346863, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.29883047938346863, Class Loss=0.29883047938346863, Reg Loss=0.0
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.334955632686615, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.334955632686615, Class Loss=0.334955632686615, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3365885615348816, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.3365885615348816, Class Loss=0.3365885615348816, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.3250535726547241, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.3250535726547241, Class Loss=0.3250535726547241, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.3198278546333313, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.3198278546333313, Class Loss=0.3198278546333313, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.30142733454704285, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.30142733454704285, Class Loss=0.30142733454704285, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.29754921793937683, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.29754921793937683, Class Loss=0.29754921793937683, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.34295839071273804, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.34295839071273804, Class Loss=0.34295839071273804, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.328352153301239, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.328352153301239, Class Loss=0.328352153301239, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.3321830630302429, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.3321830630302429, Class Loss=0.3321830630302429, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.3289751410484314, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.3289751410484314, Class Loss=0.3289751410484314, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.31994542479515076, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.31994542479515076, Class Loss=0.31994542479515076, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.30677708983421326, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.30677708983421326, Class Loss=0.30677708983421326, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6191514134407043, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.828719
Mean Acc: 0.834226
FreqW Acc: 0.762976
Mean IoU: 0.603377
Class IoU:
	class 0: 0.7967487
	class 1: 0.6886627
	class 2: 0.29859373
	class 3: 0.62312084
	class 4: 0.50597674
	class 5: 0.64427584
	class 6: 0.86568296
	class 7: 0.8640588
	class 8: 0.8367357
	class 9: 0.41878572
	class 10: 0.6136179
	class 11: 0.51333755
	class 12: 0.80933565
	class 13: 0.7255835
	class 14: 0.7661914
	class 15: 0.81309664
	class 16: 0.17645024
	class 17: 0.37767303
	class 18: 0.12623587
Class Acc:
	class 0: 0.80487955
	class 1: 0.98659956
	class 2: 0.9620415
	class 3: 0.96606356
	class 4: 0.91509587
	class 5: 0.9496079
	class 6: 0.9912257
	class 7: 0.9502269
	class 8: 0.96142924
	class 9: 0.62438536
	class 10: 0.70236456
	class 11: 0.7824255
	class 12: 0.91532767
	class 13: 0.8892121
	class 14: 0.9471164
	class 15: 0.95635206
	class 16: 0.33385006
	class 17: 0.44799066
	class 18: 0.76410174

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.29456228017807007, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.29456228017807007, Class Loss=0.29456228017807007, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.2932707965373993, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.2932707965373993, Class Loss=0.2932707965373993, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.28591030836105347, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.28591030836105347, Class Loss=0.28591030836105347, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2847636640071869, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.2847636640071869, Class Loss=0.2847636640071869, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.2825740575790405, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.2825740575790405, Class Loss=0.2825740575790405, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2789459824562073, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.2789459824562073, Class Loss=0.2789459824562073, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.30648383498191833, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.30648383498191833, Class Loss=0.30648383498191833, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.30501794815063477, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.30501794815063477, Class Loss=0.30501794815063477, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.30201244354248047, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.30201244354248047, Class Loss=0.30201244354248047, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.28876763582229614, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.28876763582229614, Class Loss=0.28876763582229614, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.28663063049316406, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.28663063049316406, Class Loss=0.28663063049316406, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2904392182826996, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.2904392182826996, Class Loss=0.2904392182826996, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.30957597494125366, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.30957597494125366, Class Loss=0.30957597494125366, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.2966335117816925, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.2966335117816925, Class Loss=0.2966335117816925, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.2947865426540375, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.2947865426540375, Class Loss=0.2947865426540375, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.29886865615844727, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.29886865615844727, Class Loss=0.29886865615844727, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.29647180438041687, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.29647180438041687, Class Loss=0.29647180438041687, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.29768577218055725, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.29768577218055725, Class Loss=0.29768577218055725, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3072900176048279, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.3072900176048279, Class Loss=0.3072900176048279, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.30700087547302246, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.30700087547302246, Class Loss=0.30700087547302246, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.28591838479042053, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.28591838479042053, Class Loss=0.28591838479042053, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.289895236492157, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.289895236492157, Class Loss=0.289895236492157, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.28761371970176697, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.28761371970176697, Class Loss=0.28761371970176697, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.2913852035999298, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.2913852035999298, Class Loss=0.2913852035999298, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6235318183898926, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.824703
Mean Acc: 0.826685
FreqW Acc: 0.758420
Mean IoU: 0.596675
Class IoU:
	class 0: 0.7930264
	class 1: 0.67871857
	class 2: 0.29221094
	class 3: 0.6200027
	class 4: 0.5072966
	class 5: 0.63005847
	class 6: 0.8696358
	class 7: 0.8637665
	class 8: 0.83169544
	class 9: 0.41366926
	class 10: 0.61073434
	class 11: 0.51918167
	class 12: 0.8001162
	class 13: 0.7236671
	class 14: 0.7678316
	class 15: 0.80322045
	class 16: 0.17002064
	class 17: 0.3189597
	class 18: 0.123019576
Class Acc:
	class 0: 0.8010448
	class 1: 0.98893005
	class 2: 0.9617878
	class 3: 0.9637329
	class 4: 0.9146182
	class 5: 0.95065564
	class 6: 0.99095887
	class 7: 0.949233
	class 8: 0.9593244
	class 9: 0.6097159
	class 10: 0.6946823
	class 11: 0.7732857
	class 12: 0.9106542
	class 13: 0.8846769
	class 14: 0.9446202
	class 15: 0.9587954
	class 16: 0.3112211
	class 17: 0.36859012
	class 18: 0.77048683

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8045492172241211, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.8045492172241211, Class Loss=0.8045492172241211, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.627371609210968, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.627371609210968, Class Loss=0.627371609210968, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5192481279373169, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.5192481279373169, Class Loss=0.5192481279373169, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.47118404507637024, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.47118404507637024, Class Loss=0.47118404507637024, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.42064598202705383, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.42064598202705383, Class Loss=0.42064598202705383, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3534082770347595, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.3534082770347595, Class Loss=0.3534082770347595, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8566407561302185, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.8566407561302185, Class Loss=0.8566407561302185, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6797882318496704, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.6797882318496704, Class Loss=0.6797882318496704, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5322492718696594, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.5322492718696594, Class Loss=0.5322492718696594, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.47153764963150024, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.47153764963150024, Class Loss=0.47153764963150024, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.43257957696914673, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.43257957696914673, Class Loss=0.43257957696914673, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.40904146432876587, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.40904146432876587, Class Loss=0.40904146432876587, Reg Loss=0.0
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8124280571937561, Reg Loss=0.0
Clinet index 24, End of Epoch 1/6, Average Loss=0.8124280571937561, Class Loss=0.8124280571937561, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6758845448493958, Reg Loss=0.0
Clinet index 24, End of Epoch 2/6, Average Loss=0.6758845448493958, Class Loss=0.6758845448493958, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.570670485496521, Reg Loss=0.0
Clinet index 24, End of Epoch 3/6, Average Loss=0.570670485496521, Class Loss=0.570670485496521, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4677218794822693, Reg Loss=0.0
Clinet index 24, End of Epoch 4/6, Average Loss=0.4677218794822693, Class Loss=0.4677218794822693, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4177378714084625, Reg Loss=0.0
Clinet index 24, End of Epoch 5/6, Average Loss=0.4177378714084625, Class Loss=0.4177378714084625, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.3818548917770386, Reg Loss=0.0
Clinet index 24, End of Epoch 6/6, Average Loss=0.3818548917770386, Class Loss=0.3818548917770386, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.8169108033180237, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.8169108033180237, Class Loss=0.8169108033180237, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6829158067703247, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.6829158067703247, Class Loss=0.6829158067703247, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5646675825119019, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.5646675825119019, Class Loss=0.5646675825119019, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.45529618859291077, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.45529618859291077, Class Loss=0.45529618859291077, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.42269885540008545, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.42269885540008545, Class Loss=0.42269885540008545, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.376930296421051, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.376930296421051, Class Loss=0.376930296421051, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.9418131709098816, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.764071
Mean Acc: 0.756035
FreqW Acc: 0.683830
Mean IoU: 0.513390
Class IoU:
	class 0: 0.73373514
	class 1: 0.7023753
	class 2: 0.2442766
	class 3: 0.63875395
	class 4: 0.5177693
	class 5: 0.6400594
	class 6: 0.8068807
	class 7: 0.7451701
	class 8: 0.78217244
	class 9: 0.1899949
	class 10: 0.46096128
	class 11: 0.37130764
	class 12: 0.65381855
	class 13: 0.61030143
	class 14: 0.74279517
	class 15: 0.68653053
	class 16: 0.09750367
	class 17: 0.3280693
	class 18: 0.06329203
	class 19: 0.2520418
Class Acc:
	class 0: 0.74453986
	class 1: 0.8908447
	class 2: 0.96334165
	class 3: 0.89271396
	class 4: 0.7706178
	class 5: 0.8934909
	class 6: 0.8942015
	class 7: 0.93797314
	class 8: 0.8951079
	class 9: 0.72835696
	class 10: 0.50150096
	class 11: 0.7552222
	class 12: 0.84981155
	class 13: 0.7727042
	class 14: 0.89593
	class 15: 0.9575153
	class 16: 0.25788558
	class 17: 0.44754905
	class 18: 0.29591066
	class 19: 0.7754805

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3963465094566345, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.3963465094566345, Class Loss=0.3963465094566345, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3864212930202484, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.3864212930202484, Class Loss=0.3864212930202484, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3510645925998688, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.3510645925998688, Class Loss=0.3510645925998688, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.32540181279182434, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.32540181279182434, Class Loss=0.32540181279182434, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.30419978499412537, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.30419978499412537, Class Loss=0.30419978499412537, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.29737547039985657, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.29737547039985657, Class Loss=0.29737547039985657, Reg Loss=0.0
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.3514783978462219, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.3514783978462219, Class Loss=0.3514783978462219, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.3505975008010864, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.3505975008010864, Class Loss=0.3505975008010864, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.3253648281097412, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.3253648281097412, Class Loss=0.3253648281097412, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.3176010549068451, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.3176010549068451, Class Loss=0.3176010549068451, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.31076186895370483, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.31076186895370483, Class Loss=0.31076186895370483, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.2870648503303528, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.2870648503303528, Class Loss=0.2870648503303528, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3891345262527466, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.3891345262527466, Class Loss=0.3891345262527466, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.34566813707351685, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.34566813707351685, Class Loss=0.34566813707351685, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.33730846643447876, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.33730846643447876, Class Loss=0.33730846643447876, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3051968216896057, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.3051968216896057, Class Loss=0.3051968216896057, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.30711060762405396, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.30711060762405396, Class Loss=0.30711060762405396, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.2940822243690491, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.2940822243690491, Class Loss=0.2940822243690491, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3777889013290405, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.3777889013290405, Class Loss=0.3777889013290405, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3525376617908478, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.3525376617908478, Class Loss=0.3525376617908478, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3432369828224182, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.3432369828224182, Class Loss=0.3432369828224182, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.31011247634887695, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.31011247634887695, Class Loss=0.31011247634887695, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2977604568004608, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.2977604568004608, Class Loss=0.2977604568004608, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.270852655172348, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.270852655172348, Class Loss=0.270852655172348, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.8191081285476685, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.797289
Mean Acc: 0.756156
FreqW Acc: 0.723639
Mean IoU: 0.540786
Class IoU:
	class 0: 0.77966565
	class 1: 0.7375942
	class 2: 0.26176298
	class 3: 0.71612966
	class 4: 0.5390636
	class 5: 0.67643315
	class 6: 0.81343836
	class 7: 0.763889
	class 8: 0.8214825
	class 9: 0.19962525
	class 10: 0.4826625
	class 11: 0.4469142
	class 12: 0.69106495
	class 13: 0.64009523
	class 14: 0.7612021
	class 15: 0.7147861
	class 16: 0.10383786
	class 17: 0.3621063
	class 18: 0.070269
	class 19: 0.23370427
Class Acc:
	class 0: 0.792766
	class 1: 0.87721944
	class 2: 0.96203864
	class 3: 0.88526726
	class 4: 0.7784592
	class 5: 0.8690053
	class 6: 0.8840429
	class 7: 0.94811577
	class 8: 0.897587
	class 9: 0.7343662
	class 10: 0.5135418
	class 11: 0.75160086
	class 12: 0.84877515
	class 13: 0.77381706
	class 14: 0.8857639
	class 15: 0.9578238
	class 16: 0.20700555
	class 17: 0.48412332
	class 18: 0.23253398
	class 19: 0.8392701

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.26443541049957275, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.26443541049957275, Class Loss=0.26443541049957275, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000600
Epoch 2, Class Loss=0.271947979927063, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.271947979927063, Class Loss=0.271947979927063, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.2504059374332428, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.2504059374332428, Class Loss=0.2504059374332428, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2555351257324219, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.2555351257324219, Class Loss=0.2555351257324219, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.24319441616535187, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.24319441616535187, Class Loss=0.24319441616535187, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.24244040250778198, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.24244040250778198, Class Loss=0.24244040250778198, Reg Loss=0.0
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.29605621099472046, Reg Loss=0.0
Clinet index 25, End of Epoch 1/6, Average Loss=0.29605621099472046, Class Loss=0.29605621099472046, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.2724597454071045, Reg Loss=0.0
Clinet index 25, End of Epoch 2/6, Average Loss=0.2724597454071045, Class Loss=0.2724597454071045, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2713572680950165, Reg Loss=0.0
Clinet index 25, End of Epoch 3/6, Average Loss=0.2713572680950165, Class Loss=0.2713572680950165, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.2594161927700043, Reg Loss=0.0
Clinet index 25, End of Epoch 4/6, Average Loss=0.2594161927700043, Class Loss=0.2594161927700043, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.23979341983795166, Reg Loss=0.0
Clinet index 25, End of Epoch 5/6, Average Loss=0.23979341983795166, Class Loss=0.23979341983795166, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.23806841671466827, Reg Loss=0.0
Clinet index 25, End of Epoch 6/6, Average Loss=0.23806841671466827, Class Loss=0.23806841671466827, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.28193414211273193, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.28193414211273193, Class Loss=0.28193414211273193, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.26586928963661194, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.26586928963661194, Class Loss=0.26586928963661194, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2618267238140106, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.2618267238140106, Class Loss=0.2618267238140106, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.2499585896730423, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.2499585896730423, Class Loss=0.2499585896730423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.2296845018863678, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.2296845018863678, Class Loss=0.2296845018863678, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.22736231982707977, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.22736231982707977, Class Loss=0.22736231982707977, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.3115268349647522, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.3115268349647522, Class Loss=0.3115268349647522, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.2917497456073761, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.2917497456073761, Class Loss=0.2917497456073761, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2959909439086914, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.2959909439086914, Class Loss=0.2959909439086914, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.28524890542030334, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.28524890542030334, Class Loss=0.28524890542030334, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.26205572485923767, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.26205572485923767, Class Loss=0.26205572485923767, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000576
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 6, Class Loss=0.24768789112567902, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.24768789112567902, Class Loss=0.24768789112567902, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.7549101114273071, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.813386
Mean Acc: 0.753599
FreqW Acc: 0.741370
Mean IoU: 0.548912
Class IoU:
	class 0: 0.80242115
	class 1: 0.749799
	class 2: 0.26576638
	class 3: 0.7267114
	class 4: 0.5466723
	class 5: 0.67490953
	class 6: 0.8185872
	class 7: 0.76611435
	class 8: 0.8266285
	class 9: 0.2197373
	class 10: 0.49591917
	class 11: 0.478575
	class 12: 0.70488375
	class 13: 0.64610267
	class 14: 0.76354885
	class 15: 0.716461
	class 16: 0.101290666
	class 17: 0.3602566
	class 18: 0.07610875
	class 19: 0.23774023
Class Acc:
	class 0: 0.81712455
	class 1: 0.90073067
	class 2: 0.9620616
	class 3: 0.89123374
	class 4: 0.7850768
	class 5: 0.8462745
	class 6: 0.8793153
	class 7: 0.94774294
	class 8: 0.87955356
	class 9: 0.7168129
	class 10: 0.525946
	class 11: 0.75158113
	class 12: 0.84132206
	class 13: 0.77981544
	class 14: 0.8851595
	class 15: 0.9608816
	class 16: 0.17582305
	class 17: 0.44531724
	class 18: 0.21072923
	class 19: 0.8694749

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23428550362586975, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.23428550362586975, Class Loss=0.23428550362586975, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2338697910308838, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.2338697910308838, Class Loss=0.2338697910308838, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.2152695506811142, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.2152695506811142, Class Loss=0.2152695506811142, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.21292151510715485, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.21292151510715485, Class Loss=0.21292151510715485, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.21111643314361572, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.21111643314361572, Class Loss=0.21111643314361572, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2112685590982437, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.2112685590982437, Class Loss=0.2112685590982437, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.24039094150066376, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.24039094150066376, Class Loss=0.24039094150066376, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.22332997620105743, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.22332997620105743, Class Loss=0.22332997620105743, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.21848712861537933, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.21848712861537933, Class Loss=0.21848712861537933, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.22008241713047028, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.22008241713047028, Class Loss=0.22008241713047028, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.22224390506744385, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.22224390506744385, Class Loss=0.22224390506744385, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.20214127004146576, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.20214127004146576, Class Loss=0.20214127004146576, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.22273337841033936, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.22273337841033936, Class Loss=0.22273337841033936, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.23478248715400696, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.23478248715400696, Class Loss=0.23478248715400696, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.21645893156528473, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.21645893156528473, Class Loss=0.21645893156528473, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.20837828516960144, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.20837828516960144, Class Loss=0.20837828516960144, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.212593674659729, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.212593674659729, Class Loss=0.212593674659729, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1974741667509079, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.1974741667509079, Class Loss=0.1974741667509079, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.24509212374687195, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.24509212374687195, Class Loss=0.24509212374687195, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.22524990141391754, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.22524990141391754, Class Loss=0.22524990141391754, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.21876148879528046, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.21876148879528046, Class Loss=0.21876148879528046, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.2107730209827423, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.2107730209827423, Class Loss=0.2107730209827423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.21683120727539062, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.21683120727539062, Class Loss=0.21683120727539062, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.2081964761018753, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.2081964761018753, Class Loss=0.2081964761018753, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.7238449454307556, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.820706
Mean Acc: 0.753019
FreqW Acc: 0.748792
Mean IoU: 0.552058
Class IoU:
	class 0: 0.81252134
	class 1: 0.75302595
	class 2: 0.2693085
	class 3: 0.72000426
	class 4: 0.55909276
	class 5: 0.6703484
	class 6: 0.83143735
	class 7: 0.78151613
	class 8: 0.82806134
	class 9: 0.23045571
	class 10: 0.5056061
	class 11: 0.4818094
	class 12: 0.70706236
	class 13: 0.6664743
	class 14: 0.7664838
	class 15: 0.70968
	class 16: 0.11384149
	class 17: 0.3250688
	class 18: 0.07984564
	class 19: 0.22950889
Class Acc:
	class 0: 0.8273395
	class 1: 0.9129398
	class 2: 0.9580508
	class 3: 0.9064393
	class 4: 0.79737765
	class 5: 0.8388474
	class 6: 0.89519656
	class 7: 0.9455097
	class 8: 0.8742186
	class 9: 0.6968343
	class 10: 0.54162747
	class 11: 0.7497903
	class 12: 0.8470683
	class 13: 0.79710126
	class 14: 0.88572884
	class 15: 0.96459144
	class 16: 0.18203539
	class 17: 0.37732467
	class 18: 0.17981146
	class 19: 0.8825423

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.20356902480125427, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.20356902480125427, Class Loss=0.20356902480125427, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19344809651374817, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.19344809651374817, Class Loss=0.19344809651374817, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19132907688617706, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.19132907688617706, Class Loss=0.19132907688617706, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.20160681009292603, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.20160681009292603, Class Loss=0.20160681009292603, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.1973990648984909, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.1973990648984909, Class Loss=0.1973990648984909, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.19332754611968994, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.19332754611968994, Class Loss=0.19332754611968994, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.21819990873336792, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.21819990873336792, Class Loss=0.21819990873336792, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.21989285945892334, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.21989285945892334, Class Loss=0.21989285945892334, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.20465466380119324, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.20465466380119324, Class Loss=0.20465466380119324, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.19796162843704224, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.19796162843704224, Class Loss=0.19796162843704224, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.20143026113510132, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.20143026113510132, Class Loss=0.20143026113510132, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.19493511319160461, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.19493511319160461, Class Loss=0.19493511319160461, Reg Loss=0.0
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.1963987648487091, Reg Loss=0.0
Clinet index 18, End of Epoch 1/6, Average Loss=0.1963987648487091, Class Loss=0.1963987648487091, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19951632618904114, Reg Loss=0.0
Clinet index 18, End of Epoch 2/6, Average Loss=0.19951632618904114, Class Loss=0.19951632618904114, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.19686104357242584, Reg Loss=0.0
Clinet index 18, End of Epoch 3/6, Average Loss=0.19686104357242584, Class Loss=0.19686104357242584, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18563227355480194, Reg Loss=0.0
Clinet index 18, End of Epoch 4/6, Average Loss=0.18563227355480194, Class Loss=0.18563227355480194, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.19311915338039398, Reg Loss=0.0
Clinet index 18, End of Epoch 5/6, Average Loss=0.19311915338039398, Class Loss=0.19311915338039398, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.1771802008152008, Reg Loss=0.0
Clinet index 18, End of Epoch 6/6, Average Loss=0.1771802008152008, Class Loss=0.1771802008152008, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.19255796074867249, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.19255796074867249, Class Loss=0.19255796074867249, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.17864805459976196, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.17864805459976196, Class Loss=0.17864805459976196, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.17150336503982544, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.17150336503982544, Class Loss=0.17150336503982544, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.17596575617790222, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.17596575617790222, Class Loss=0.17596575617790222, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000304
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 5, Class Loss=0.17869709432125092, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.17869709432125092, Class Loss=0.17869709432125092, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.1735815405845642, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.1735815405845642, Class Loss=0.1735815405845642, Reg Loss=0.0
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=0.6934678554534912, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.826468
Mean Acc: 0.750336
FreqW Acc: 0.756427
Mean IoU: 0.557746
Class IoU:
	class 0: 0.8204874
	class 1: 0.7574623
	class 2: 0.27317172
	class 3: 0.7409936
	class 4: 0.56628084
	class 5: 0.67921925
	class 6: 0.8398621
	class 7: 0.7840456
	class 8: 0.8238026
	class 9: 0.25146475
	class 10: 0.51449573
	class 11: 0.4996936
	class 12: 0.719525
	class 13: 0.67168367
	class 14: 0.7774832
	class 15: 0.7231667
	class 16: 0.10715102
	class 17: 0.29118878
	class 18: 0.086638525
	class 19: 0.22709337
Class Acc:
	class 0: 0.836594
	class 1: 0.9134198
	class 2: 0.96002966
	class 3: 0.8987527
	class 4: 0.8082472
	class 5: 0.83628064
	class 6: 0.9045214
	class 7: 0.9465467
	class 8: 0.8610086
	class 9: 0.67625755
	class 10: 0.5508699
	class 11: 0.74230266
	class 12: 0.84255505
	class 13: 0.8038066
	class 14: 0.8910218
	class 15: 0.9634229
	class 16: 0.16016738
	class 17: 0.32588094
	class 18: 0.20045917
	class 19: 0.88457096

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.2845897674560547, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.2845897674560547, Class Loss=0.2845897674560547, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.2615036368370056, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.2615036368370056, Class Loss=0.2615036368370056, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.24095994234085083, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.24095994234085083, Class Loss=0.24095994234085083, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.23907630145549774, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.23907630145549774, Class Loss=0.23907630145549774, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.23312902450561523, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.23312902450561523, Class Loss=0.23312902450561523, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.21337586641311646, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.21337586641311646, Class Loss=0.21337586641311646, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.25951746106147766, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.25951746106147766, Class Loss=0.25951746106147766, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.2749963700771332, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.2749963700771332, Class Loss=0.2749963700771332, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.25228145718574524, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.25228145718574524, Class Loss=0.25228145718574524, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.2541106343269348, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.2541106343269348, Class Loss=0.2541106343269348, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.2280052751302719, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.2280052751302719, Class Loss=0.2280052751302719, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.22800840437412262, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.22800840437412262, Class Loss=0.22800840437412262, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.23388133943080902, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.23388133943080902, Class Loss=0.23388133943080902, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.2298276722431183, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.2298276722431183, Class Loss=0.2298276722431183, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.21358509361743927, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.21358509361743927, Class Loss=0.21358509361743927, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.21210841834545135, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.21210841834545135, Class Loss=0.21210841834545135, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.21786274015903473, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.21786274015903473, Class Loss=0.21786274015903473, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.19547337293624878, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.19547337293624878, Class Loss=0.19547337293624878, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.2894870638847351, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.2894870638847351, Class Loss=0.2894870638847351, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.27855947613716125, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.27855947613716125, Class Loss=0.27855947613716125, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.25797635316848755, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.25797635316848755, Class Loss=0.25797635316848755, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.2510712146759033, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.2510712146759033, Class Loss=0.2510712146759033, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.24813824892044067, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.24813824892044067, Class Loss=0.24813824892044067, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.23830223083496094, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.23830223083496094, Class Loss=0.23830223083496094, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.2049741744995117, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.694559
Mean Acc: 0.752491
FreqW Acc: 0.603706
Mean IoU: 0.460239
Class IoU:
	class 0: 0.63578403
	class 1: 0.5626839
	class 2: 0.22724779
	class 3: 0.5455743
	class 4: 0.43314838
	class 5: 0.5933377
	class 6: 0.807456
	class 7: 0.6618235
	class 8: 0.711403
	class 9: 0.27774104
	class 10: 0.41580334
	class 11: 0.47973686
	class 12: 0.61132276
	class 13: 0.47427124
	class 14: 0.63197345
	class 15: 0.7098395
	class 16: 0.13866676
	class 17: 0.42809263
	class 18: 0.10190556
	class 19: 0.1647531
	class 20: 0.052458167
Class Acc:
	class 0: 0.64028233
	class 1: 0.92817193
	class 2: 0.9447684
	class 3: 0.8779784
	class 4: 0.826143
	class 5: 0.8249259
	class 6: 0.8599768
	class 7: 0.92045736
	class 8: 0.85558283
	class 9: 0.6493031
	class 10: 0.49856734
	class 11: 0.74496734
	class 12: 0.849539
	class 13: 0.84303695
	class 14: 0.8987895
	class 15: 0.96033734
	class 16: 0.45958555
	class 17: 0.6388464
	class 18: 0.54373205
	class 19: 0.9146006
	class 20: 0.12270983

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22802816331386566, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.22802816331386566, Class Loss=0.22802816331386566, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.22627809643745422, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.22627809643745422, Class Loss=0.22627809643745422, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.20383162796497345, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.20383162796497345, Class Loss=0.20383162796497345, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.22037559747695923, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.22037559747695923, Class Loss=0.22037559747695923, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2037101686000824, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.2037101686000824, Class Loss=0.2037101686000824, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.19943521916866302, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.19943521916866302, Class Loss=0.19943521916866302, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.22983461618423462, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.22983461618423462, Class Loss=0.22983461618423462, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.21892312169075012, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.21892312169075012, Class Loss=0.21892312169075012, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.18916894495487213, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.18916894495487213, Class Loss=0.18916894495487213, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2171471267938614, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.2171471267938614, Class Loss=0.2171471267938614, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.19216114282608032, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.19216114282608032, Class Loss=0.19216114282608032, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.20024581253528595, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.20024581253528595, Class Loss=0.20024581253528595, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.22265444695949554, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.22265444695949554, Class Loss=0.22265444695949554, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.20244070887565613, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.20244070887565613, Class Loss=0.20244070887565613, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.209783136844635, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.209783136844635, Class Loss=0.209783136844635, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.2113538682460785, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.2113538682460785, Class Loss=0.2113538682460785, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.1981184482574463, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.1981184482574463, Class Loss=0.1981184482574463, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.18276280164718628, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.18276280164718628, Class Loss=0.18276280164718628, Reg Loss=0.0
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19691063463687897, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.19691063463687897, Class Loss=0.19691063463687897, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.19057774543762207, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.19057774543762207, Class Loss=0.19057774543762207, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.20338980853557587, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.20338980853557587, Class Loss=0.20338980853557587, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.2110666185617447, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.2110666185617447, Class Loss=0.2110666185617447, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.2159913331270218, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.2159913331270218, Class Loss=0.2159913331270218, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.1786128729581833, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.1786128729581833, Class Loss=0.1786128729581833, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.174196481704712, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.702300
Mean Acc: 0.770938
FreqW Acc: 0.605972
Mean IoU: 0.458584
Class IoU:
	class 0: 0.6397137
	class 1: 0.5351291
	class 2: 0.21036348
	class 3: 0.50569403
	class 4: 0.43224537
	class 5: 0.59452367
	class 6: 0.83121794
	class 7: 0.63538134
	class 8: 0.7178968
	class 9: 0.27623358
	class 10: 0.43067384
	class 11: 0.46786356
	class 12: 0.6064722
	class 13: 0.46959665
	class 14: 0.60477763
	class 15: 0.7022715
	class 16: 0.1420376
	class 17: 0.4463833
	class 18: 0.10597661
	class 19: 0.19492115
	class 20: 0.08088788
Class Acc:
	class 0: 0.64450145
	class 1: 0.9489923
	class 2: 0.9532917
	class 3: 0.89078516
	class 4: 0.85190445
	class 5: 0.86137253
	class 6: 0.9138911
	class 7: 0.942095
	class 8: 0.8820404
	class 9: 0.6662526
	class 10: 0.525295
	class 11: 0.76494503
	class 12: 0.84809935
	class 13: 0.846747
	class 14: 0.89457273
	class 15: 0.9645004
	class 16: 0.48159042
	class 17: 0.68087286
	class 18: 0.5469882
	class 19: 0.8959848
	class 20: 0.18497814

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19993750751018524, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.19993750751018524, Class Loss=0.19993750751018524, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.1940189152956009, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.1940189152956009, Class Loss=0.1940189152956009, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.20333653688430786, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.20333653688430786, Class Loss=0.20333653688430786, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.19208942353725433, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.19208942353725433, Class Loss=0.19208942353725433, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.19214719533920288, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.19214719533920288, Class Loss=0.19214719533920288, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.1805381327867508, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.1805381327867508, Class Loss=0.1805381327867508, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20327666401863098, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.20327666401863098, Class Loss=0.20327666401863098, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.20999540388584137, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.20999540388584137, Class Loss=0.20999540388584137, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.19936956465244293, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.19936956465244293, Class Loss=0.19936956465244293, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.18308912217617035, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.18308912217617035, Class Loss=0.18308912217617035, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.17859409749507904, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.17859409749507904, Class Loss=0.17859409749507904, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.18587438762187958, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.18587438762187958, Class Loss=0.18587438762187958, Reg Loss=0.0
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.1840677559375763, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.1840677559375763, Class Loss=0.1840677559375763, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.18887758255004883, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.18887758255004883, Class Loss=0.18887758255004883, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.18200841546058655, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.18200841546058655, Class Loss=0.18200841546058655, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000655
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.18059475719928741, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.18059475719928741, Class Loss=0.18059475719928741, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.19030211865901947, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.19030211865901947, Class Loss=0.19030211865901947, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.17695501446723938, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.17695501446723938, Class Loss=0.17695501446723938, Reg Loss=0.0
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.17381566762924194, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.17381566762924194, Class Loss=0.17381566762924194, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.20410144329071045, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.20410144329071045, Class Loss=0.20410144329071045, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.17627812922000885, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.17627812922000885, Class Loss=0.17627812922000885, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.17221415042877197, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.17221415042877197, Class Loss=0.17221415042877197, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.1654723435640335, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.1654723435640335, Class Loss=0.1654723435640335, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.16421577334403992, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.16421577334403992, Class Loss=0.16421577334403992, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.1755363941192627, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.695105
Mean Acc: 0.779917
FreqW Acc: 0.596501
Mean IoU: 0.456054
Class IoU:
	class 0: 0.62661135
	class 1: 0.5346555
	class 2: 0.20387968
	class 3: 0.49710223
	class 4: 0.43221557
	class 5: 0.5969576
	class 6: 0.8273515
	class 7: 0.6287827
	class 8: 0.7306452
	class 9: 0.26563466
	class 10: 0.43241024
	class 11: 0.4576949
	class 12: 0.58878654
	class 13: 0.4667786
	class 14: 0.6051157
	class 15: 0.70037735
	class 16: 0.13963151
	class 17: 0.4458351
	class 18: 0.1072914
	class 19: 0.20835947
	class 20: 0.08100861
Class Acc:
	class 0: 0.6308182
	class 1: 0.9453994
	class 2: 0.95756197
	class 3: 0.89067614
	class 4: 0.8523244
	class 5: 0.8810565
	class 6: 0.92503893
	class 7: 0.9461554
	class 8: 0.89275247
	class 9: 0.6934932
	class 10: 0.5306381
	class 11: 0.77419835
	class 12: 0.8640983
	class 13: 0.84787214
	class 14: 0.9053376
	class 15: 0.9650192
	class 16: 0.48990926
	class 17: 0.6807672
	class 18: 0.52930933
	class 19: 0.8834903
	class 20: 0.29234567

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.17655646800994873, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.17655646800994873, Class Loss=0.17655646800994873, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.17963586747646332, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.17963586747646332, Class Loss=0.17963586747646332, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.18230997025966644, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.18230997025966644, Class Loss=0.18230997025966644, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.15696275234222412, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.15696275234222412, Class Loss=0.15696275234222412, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.18845553696155548, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.18845553696155548, Class Loss=0.18845553696155548, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.17373742163181305, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.17373742163181305, Class Loss=0.17373742163181305, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.17061813175678253, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.17061813175678253, Class Loss=0.17061813175678253, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.1898169070482254, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.1898169070482254, Class Loss=0.1898169070482254, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.19129858911037445, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.19129858911037445, Class Loss=0.19129858911037445, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.1881912648677826, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.1881912648677826, Class Loss=0.1881912648677826, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.1789763867855072, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.1789763867855072, Class Loss=0.1789763867855072, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.17392095923423767, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.17392095923423767, Class Loss=0.17392095923423767, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.1842706948518753, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.1842706948518753, Class Loss=0.1842706948518753, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.1967557668685913, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.1967557668685913, Class Loss=0.1967557668685913, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.19456560909748077, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.19456560909748077, Class Loss=0.19456560909748077, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.19001629948616028, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.19001629948616028, Class Loss=0.19001629948616028, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.18582145869731903, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.18582145869731903, Class Loss=0.18582145869731903, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.18991059064865112, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.18991059064865112, Class Loss=0.18991059064865112, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2001974731683731, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.2001974731683731, Class Loss=0.2001974731683731, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.20077826082706451, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.20077826082706451, Class Loss=0.20077826082706451, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.1982734650373459, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.1982734650373459, Class Loss=0.1982734650373459, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.190291628241539, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.190291628241539, Class Loss=0.190291628241539, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.18615345656871796, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.18615345656871796, Class Loss=0.18615345656871796, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.1784534752368927, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.1784534752368927, Class Loss=0.1784534752368927, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.1712708473205566, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.694766
Mean Acc: 0.777740
FreqW Acc: 0.595768
Mean IoU: 0.455612
Class IoU:
	class 0: 0.62761074
	class 1: 0.54389447
	class 2: 0.2001842
	class 3: 0.5076439
	class 4: 0.4395128
	class 5: 0.60281545
	class 6: 0.8250836
	class 7: 0.61786366
	class 8: 0.74736595
	class 9: 0.23941404
	class 10: 0.43327534
	class 11: 0.43939844
	class 12: 0.5878199
	class 13: 0.47422415
	class 14: 0.61535805
	class 15: 0.6680586
	class 16: 0.14090018
	class 17: 0.45247734
	class 18: 0.10190761
	class 19: 0.22295249
	class 20: 0.080083616
Class Acc:
	class 0: 0.6317916
	class 1: 0.9413809
	class 2: 0.95718426
	class 3: 0.8839428
	class 4: 0.84660184
	class 5: 0.883781
	class 6: 0.9242493
	class 7: 0.9478834
	class 8: 0.8837729
	class 9: 0.7187969
	class 10: 0.52958703
	class 11: 0.78394985
	class 12: 0.8498778
	class 13: 0.8459727
	class 14: 0.8989016
	class 15: 0.96935034
	class 16: 0.47987944
	class 17: 0.6599916
	class 18: 0.4799278
	class 19: 0.87573403
	class 20: 0.33997962

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.16612476110458374, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.16612476110458374, Class Loss=0.16612476110458374, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.17213550209999084, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.17213550209999084, Class Loss=0.17213550209999084, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000372
Epoch 3, Class Loss=0.1822720319032669, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.1822720319032669, Class Loss=0.1822720319032669, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.16528980433940887, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.16528980433940887, Class Loss=0.16528980433940887, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.16353382170200348, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.16353382170200348, Class Loss=0.16353382170200348, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.1709151566028595, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.1709151566028595, Class Loss=0.1709151566028595, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1757776141166687, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.1757776141166687, Class Loss=0.1757776141166687, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.16982115805149078, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.16982115805149078, Class Loss=0.16982115805149078, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.1682593822479248, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.1682593822479248, Class Loss=0.1682593822479248, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.17475953698158264, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.17475953698158264, Class Loss=0.17475953698158264, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.1673237383365631, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.1673237383365631, Class Loss=0.1673237383365631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.15780672430992126, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.15780672430992126, Class Loss=0.15780672430992126, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.1727830171585083, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.1727830171585083, Class Loss=0.1727830171585083, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.17705756425857544, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.17705756425857544, Class Loss=0.17705756425857544, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.1776127964258194, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.1776127964258194, Class Loss=0.1776127964258194, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.1657635122537613, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.1657635122537613, Class Loss=0.1657635122537613, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.17883388698101044, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.17883388698101044, Class Loss=0.17883388698101044, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.17830486595630646, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.17830486595630646, Class Loss=0.17830486595630646, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.18524891138076782, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.18524891138076782, Class Loss=0.18524891138076782, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.19273598492145538, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.19273598492145538, Class Loss=0.19273598492145538, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.17274439334869385, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.17274439334869385, Class Loss=0.17274439334869385, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.1923261284828186, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.1923261284828186, Class Loss=0.1923261284828186, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.1931411623954773, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.1931411623954773, Class Loss=0.1931411623954773, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.18981726467609406, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.18981726467609406, Class Loss=0.18981726467609406, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.165881633758545, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.695194
Mean Acc: 0.779496
FreqW Acc: 0.595651
Mean IoU: 0.455467
Class IoU:
	class 0: 0.62740016
	class 1: 0.5513248
	class 2: 0.20014974
	class 3: 0.49581733
	class 4: 0.44251934
	class 5: 0.60102427
	class 6: 0.8239845
	class 7: 0.6136185
	class 8: 0.7452604
	class 9: 0.24154168
	class 10: 0.43663722
	class 11: 0.4385679
	class 12: 0.5762293
	class 13: 0.48254895
	class 14: 0.61229897
	class 15: 0.67291176
	class 16: 0.14555715
	class 17: 0.44386357
	class 18: 0.10417683
	class 19: 0.22914125
	class 20: 0.08023366
Class Acc:
	class 0: 0.63165975
	class 1: 0.9406873
	class 2: 0.9583188
	class 3: 0.88949025
	class 4: 0.8489044
	class 5: 0.8839713
	class 6: 0.922215
	class 7: 0.9492583
	class 8: 0.8876457
	class 9: 0.71898276
	class 10: 0.53222597
	class 11: 0.7861857
	class 12: 0.8653041
	class 13: 0.8389519
	class 14: 0.8931375
	class 15: 0.9691119
	class 16: 0.4804316
	class 17: 0.64773536
	class 18: 0.47995433
	class 19: 0.8713721
	class 20: 0.37387654

voc_15-1_PLOP On GPUs 2
Run in 29436s
