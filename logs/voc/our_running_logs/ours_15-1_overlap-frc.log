nohup: ignoring input
30
kvoc_15-1_OURS-FRC On GPUs 0\Writing in results/seed_2023-ov/2023-03-16_voc_15-1_OURS-FRC.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.7405981421470642, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.7405981421470642, Class Loss=0.7405981421470642, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5410436391830444, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.5410436391830444, Class Loss=0.5410436391830444, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5669517517089844, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.5669517517089844, Class Loss=0.5669517517089844, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6242725253105164, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.6242725253105164, Class Loss=0.6242725253105164, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6551477909088135, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.6551477909088135, Class Loss=0.6551477909088135, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6535608172416687, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.6535608172416687, Class Loss=0.6535608172416687, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.6972475647926331, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.6972475647926331, Class Loss=0.6972475647926331, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5401764512062073, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.5401764512062073, Class Loss=0.5401764512062073, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5098085403442383, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.5098085403442383, Class Loss=0.5098085403442383, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5360747575759888, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.5360747575759888, Class Loss=0.5360747575759888, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6154798269271851, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.6154798269271851, Class Loss=0.6154798269271851, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6469244956970215, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.6469244956970215, Class Loss=0.6469244956970215, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.8643211126327515, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.8643211126327515, Class Loss=0.8643211126327515, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5305760502815247, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.5305760502815247, Class Loss=0.5305760502815247, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5146802663803101, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.5146802663803101, Class Loss=0.5146802663803101, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5640043616294861, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.5640043616294861, Class Loss=0.5640043616294861, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6164095997810364, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.6164095997810364, Class Loss=0.6164095997810364, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6793409585952759, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.6793409585952759, Class Loss=0.6793409585952759, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.60951828956604, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.60951828956604, Class Loss=0.60951828956604, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.5509300231933594, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.5509300231933594, Class Loss=0.5509300231933594, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5287227034568787, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.5287227034568787, Class Loss=0.5287227034568787, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6218501925468445, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.6218501925468445, Class Loss=0.6218501925468445, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6618735194206238, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.6618735194206238, Class Loss=0.6618735194206238, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7106982469558716, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.7106982469558716, Class Loss=0.7106982469558716, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.29217392206192017, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.931895
Mean Acc: 0.860451
FreqW Acc: 0.879804
Mean IoU: 0.713279
Class IoU:
	class 0: 0.918952
	class 1: 0.77385575
	class 2: 0.39409995
	class 3: 0.8735463
	class 4: 0.62814826
	class 5: 0.77380395
	class 6: 0.9139085
	class 7: 0.8905067
	class 8: 0.8867745
	class 9: 0.44845623
	class 10: 0.733041
	class 11: 0.6147612
	class 12: 0.83145034
	class 13: 0.7523733
	class 14: 0.8416577
	class 15: 0.8504134
	class 16: 0.0
Class Acc:
	class 0: 0.941686
	class 1: 0.99387276
	class 2: 0.92973083
	class 3: 0.9652831
	class 4: 0.86143607
	class 5: 0.94085324
	class 6: 0.9920793
	class 7: 0.961443
	class 8: 0.96241426
	class 9: 0.69697964
	class 10: 0.8165311
	class 11: 0.7224695
	class 12: 0.97894484
	class 13: 0.9597995
	class 14: 0.9650065
	class 15: 0.9391426
	class 16: 0.0

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.6148476004600525, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.6148476004600525, Class Loss=0.6148476004600525, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7509703636169434, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.7509703636169434, Class Loss=0.7509703636169434, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.64229416847229, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.64229416847229, Class Loss=0.64229416847229, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.8774626851081848, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.8774626851081848, Class Loss=0.8774626851081848, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.730713963508606, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.730713963508606, Class Loss=0.730713963508606, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.693164050579071, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.693164050579071, Class Loss=0.693164050579071, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4581289291381836, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.4581289291381836, Class Loss=0.4581289291381836, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.48541346192359924, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.48541346192359924, Class Loss=0.48541346192359924, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4895825982093811, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.4895825982093811, Class Loss=0.4895825982093811, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5208233594894409, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.5208233594894409, Class Loss=0.5208233594894409, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5542476177215576, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.5542476177215576, Class Loss=0.5542476177215576, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5397768020629883, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.5397768020629883, Class Loss=0.5397768020629883, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4442264437675476, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.4442264437675476, Class Loss=0.4442264437675476, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4924682676792145, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.4924682676792145, Class Loss=0.4924682676792145, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5148265361785889, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.5148265361785889, Class Loss=0.5148265361785889, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5307722091674805, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5307722091674805, Class Loss=0.5307722091674805, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6025512218475342, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.6025512218475342, Class Loss=0.6025512218475342, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5787894129753113, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5787894129753113, Class Loss=0.5787894129753113, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4468057453632355, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.4468057453632355, Class Loss=0.4468057453632355, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.4572772681713104, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.4572772681713104, Class Loss=0.4572772681713104, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5089582204818726, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.5089582204818726, Class Loss=0.5089582204818726, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5452723503112793, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.5452723503112793, Class Loss=0.5452723503112793, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6042437553405762, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.6042437553405762, Class Loss=0.6042437553405762, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 6, Class Loss=0.5634320974349976, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.5634320974349976, Class Loss=0.5634320974349976, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.2712332308292389, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.933347
Mean Acc: 0.861605
FreqW Acc: 0.882144
Mean IoU: 0.716931
Class IoU:
	class 0: 0.9201951
	class 1: 0.7748847
	class 2: 0.4015405
	class 3: 0.8663576
	class 4: 0.6395636
	class 5: 0.76814294
	class 6: 0.91874427
	class 7: 0.8962687
	class 8: 0.89824307
	class 9: 0.44390228
	class 10: 0.7362821
	class 11: 0.6024743
	class 12: 0.84114677
	class 13: 0.77133733
	class 14: 0.85407245
	class 15: 0.85464746
	class 16: 2.257488e-05
Class Acc:
	class 0: 0.9434582
	class 1: 0.9941162
	class 2: 0.93283355
	class 3: 0.9686475
	class 4: 0.863854
	class 5: 0.94194144
	class 6: 0.9920996
	class 7: 0.9578192
	class 8: 0.9695829
	class 9: 0.67856425
	class 10: 0.83601433
	class 11: 0.7304154
	class 12: 0.9805735
	class 13: 0.9577541
	class 14: 0.96452713
	class 15: 0.9350556
	class 16: 2.257488e-05

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4158259630203247, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.4158259630203247, Class Loss=0.4158259630203247, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.43489235639572144, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.43489235639572144, Class Loss=0.43489235639572144, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.4328247606754303, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.4328247606754303, Class Loss=0.4328247606754303, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4895173907279968, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.4895173907279968, Class Loss=0.4895173907279968, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.520917534828186, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.520917534828186, Class Loss=0.520917534828186, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5061957240104675, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.5061957240104675, Class Loss=0.5061957240104675, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.41755491495132446, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.41755491495132446, Class Loss=0.41755491495132446, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.43626871705055237, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.43626871705055237, Class Loss=0.43626871705055237, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.44960010051727295, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.44960010051727295, Class Loss=0.44960010051727295, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.495591938495636, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.495591938495636, Class Loss=0.495591938495636, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5531391501426697, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.5531391501426697, Class Loss=0.5531391501426697, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.530482828617096, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.530482828617096, Class Loss=0.530482828617096, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.36302071809768677, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.36302071809768677, Class Loss=0.36302071809768677, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.39147281646728516, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.39147281646728516, Class Loss=0.39147281646728516, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.42803576588630676, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.42803576588630676, Class Loss=0.42803576588630676, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.47269994020462036, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.47269994020462036, Class Loss=0.47269994020462036, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.4896838366985321, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.4896838366985321, Class Loss=0.4896838366985321, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5389649271965027, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.5389649271965027, Class Loss=0.5389649271965027, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.37163257598876953, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.37163257598876953, Class Loss=0.37163257598876953, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.4037121534347534, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.4037121534347534, Class Loss=0.4037121534347534, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.43554580211639404, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.43554580211639404, Class Loss=0.43554580211639404, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.469145804643631, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.469145804643631, Class Loss=0.469145804643631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.4627753794193268, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.4627753794193268, Class Loss=0.4627753794193268, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5321980118751526, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.5321980118751526, Class Loss=0.5321980118751526, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.2508913278579712, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.936266
Mean Acc: 0.857258
FreqW Acc: 0.886495
Mean IoU: 0.723630
Class IoU:
	class 0: 0.9245977
	class 1: 0.7984045
	class 2: 0.40511918
	class 3: 0.86110103
	class 4: 0.64745855
	class 5: 0.77580327
	class 6: 0.9266916
	class 7: 0.905472
	class 8: 0.89642864
	class 9: 0.44641742
	class 10: 0.73330367
	class 11: 0.60609704
	class 12: 0.84102416
	class 13: 0.7639744
	class 14: 0.8586596
	class 15: 0.8580528
	class 16: 0.05310952
Class Acc:
	class 0: 0.9497743
	class 1: 0.99269426
	class 2: 0.9263622
	class 3: 0.97046834
	class 4: 0.8499914
	class 5: 0.9399178
	class 6: 0.98757195
	class 7: 0.95558304
	class 8: 0.9670279
	class 9: 0.6259846
	class 10: 0.80678004
	class 11: 0.7197926
	class 12: 0.97554225
	class 13: 0.9550042
	class 14: 0.9643464
	class 15: 0.93273693
	class 16: 0.053802058

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5601509213447571, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.5601509213447571, Class Loss=0.5601509213447571, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5887839794158936, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.5887839794158936, Class Loss=0.5887839794158936, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.51893550157547, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.51893550157547, Class Loss=0.51893550157547, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5537306070327759, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5537306070327759, Class Loss=0.5537306070327759, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.5164778232574463, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5164778232574463, Class Loss=0.5164778232574463, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.5051611661911011, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5051611661911011, Class Loss=0.5051611661911011, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3351149260997772, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.3351149260997772, Class Loss=0.3351149260997772, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.36193838715553284, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.36193838715553284, Class Loss=0.36193838715553284, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.38623207807540894, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.38623207807540894, Class Loss=0.38623207807540894, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.44599097967147827, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.44599097967147827, Class Loss=0.44599097967147827, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5199906229972839, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.5199906229972839, Class Loss=0.5199906229972839, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5405367016792297, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.5405367016792297, Class Loss=0.5405367016792297, Reg Loss=0.0
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5436879992485046, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.5436879992485046, Class Loss=0.5436879992485046, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5347306728363037, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.5347306728363037, Class Loss=0.5347306728363037, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5334292054176331, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.5334292054176331, Class Loss=0.5334292054176331, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5393815636634827, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.5393815636634827, Class Loss=0.5393815636634827, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.5228219032287598, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.5228219032287598, Class Loss=0.5228219032287598, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.5135471820831299, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.5135471820831299, Class Loss=0.5135471820831299, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.5443943738937378, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.5443943738937378, Class Loss=0.5443943738937378, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.5204207897186279, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.5204207897186279, Class Loss=0.5204207897186279, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.5150171518325806, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.5150171518325806, Class Loss=0.5150171518325806, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.5170668363571167, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.5170668363571167, Class Loss=0.5170668363571167, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.5160576105117798, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.5160576105117798, Class Loss=0.5160576105117798, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.5098620057106018, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.5098620057106018, Class Loss=0.5098620057106018, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.2405415177345276, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.938081
Mean Acc: 0.859268
FreqW Acc: 0.889674
Mean IoU: 0.732115
Class IoU:
	class 0: 0.9265996
	class 1: 0.81538874
	class 2: 0.40617383
	class 3: 0.86678547
	class 4: 0.6551618
	class 5: 0.7785453
	class 6: 0.92807126
	class 7: 0.90705895
	class 8: 0.9011597
	class 9: 0.43868768
	class 10: 0.7490012
	class 11: 0.60311365
	class 12: 0.8426548
	class 13: 0.7858951
	class 14: 0.8591452
	class 15: 0.8610055
	class 16: 0.121505246
Class Acc:
	class 0: 0.95253277
	class 1: 0.99197936
	class 2: 0.9213358
	class 3: 0.9680148
	class 4: 0.8478198
	class 5: 0.9397763
	class 6: 0.9889978
	class 7: 0.954626
	class 8: 0.96321213
	class 9: 0.59699154
	class 10: 0.8184292
	class 11: 0.71572316
	class 12: 0.97374237
	class 13: 0.9479004
	class 14: 0.9631086
	class 15: 0.9307419
	class 16: 0.13262649

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.5279064774513245, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.5279064774513245, Class Loss=0.5279064774513245, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.5157509446144104, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.5157509446144104, Class Loss=0.5157509446144104, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.4913606643676758, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.4913606643676758, Class Loss=0.4913606643676758, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.5092536807060242, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5092536807060242, Class Loss=0.5092536807060242, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.5003030300140381, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5003030300140381, Class Loss=0.5003030300140381, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.5005514621734619, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5005514621734619, Class Loss=0.5005514621734619, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.48669686913490295, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.48669686913490295, Class Loss=0.48669686913490295, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.47317230701446533, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.47317230701446533, Class Loss=0.47317230701446533, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.5159804224967957, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.5159804224967957, Class Loss=0.5159804224967957, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.5020372271537781, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.5020372271537781, Class Loss=0.5020372271537781, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.49497830867767334, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.49497830867767334, Class Loss=0.49497830867767334, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.4839366674423218, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.4839366674423218, Class Loss=0.4839366674423218, Reg Loss=0.0
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.5446689128875732, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.5446689128875732, Class Loss=0.5446689128875732, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.5376051664352417, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.5376051664352417, Class Loss=0.5376051664352417, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.5147572159767151, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.5147572159767151, Class Loss=0.5147572159767151, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.5183184146881104, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.5183184146881104, Class Loss=0.5183184146881104, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.5462796092033386, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.5462796092033386, Class Loss=0.5462796092033386, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.4886902868747711, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.4886902868747711, Class Loss=0.4886902868747711, Reg Loss=0.0
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5076180100440979, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.5076180100440979, Class Loss=0.5076180100440979, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.483998566865921, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.483998566865921, Class Loss=0.483998566865921, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.49984776973724365, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.49984776973724365, Class Loss=0.49984776973724365, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.4996181130409241, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.4996181130409241, Class Loss=0.4996181130409241, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.5100973844528198, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.5100973844528198, Class Loss=0.5100973844528198, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.4909674823284149, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.4909674823284149, Class Loss=0.4909674823284149, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.23098942637443542, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.939101
Mean Acc: 0.858245
FreqW Acc: 0.891214
Mean IoU: 0.734973
Class IoU:
	class 0: 0.9276481
	class 1: 0.82277256
	class 2: 0.41124913
	class 3: 0.8737227
	class 4: 0.65740854
	class 5: 0.7774353
	class 6: 0.9299228
	class 7: 0.9089596
	class 8: 0.9036264
	class 9: 0.43980053
	class 10: 0.75767386
	class 11: 0.6013315
	class 12: 0.847842
	class 13: 0.7932707
	class 14: 0.8637808
	class 15: 0.86120886
	class 16: 0.116895825
Class Acc:
	class 0: 0.954187
	class 1: 0.99048615
	class 2: 0.91259825
	class 3: 0.9666983
	class 4: 0.840748
	class 5: 0.936972
	class 6: 0.9884053
	class 7: 0.952682
	class 8: 0.96330535
	class 9: 0.60298246
	class 10: 0.82919806
	class 11: 0.71339685
	class 12: 0.9717688
	class 13: 0.9486512
	class 14: 0.96217334
	class 15: 0.9303118
	class 16: 0.12559395

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5140994191169739, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.5140994191169739, Class Loss=0.5140994191169739, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.7856232523918152, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.7856232523918152, Class Loss=0.7856232523918152, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8349979519844055, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.8349979519844055, Class Loss=0.8349979519844055, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8734203577041626, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.8734203577041626, Class Loss=0.8734203577041626, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.0095912218093872, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=1.0095912218093872, Class Loss=1.0095912218093872, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8446005582809448, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.8446005582809448, Class Loss=0.8446005582809448, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5215504765510559, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.5215504765510559, Class Loss=0.5215504765510559, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.8571203947067261, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.8571203947067261, Class Loss=0.8571203947067261, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8676605820655823, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.8676605820655823, Class Loss=0.8676605820655823, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8774851560592651, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.8774851560592651, Class Loss=0.8774851560592651, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.89478600025177, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.89478600025177, Class Loss=0.89478600025177, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8088645935058594, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.8088645935058594, Class Loss=0.8088645935058594, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5413627028465271, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.5413627028465271, Class Loss=0.5413627028465271, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.720685601234436, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.720685601234436, Class Loss=0.720685601234436, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.9314401149749756, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.9314401149749756, Class Loss=0.9314401149749756, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8847475647926331, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.8847475647926331, Class Loss=0.8847475647926331, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9697370529174805, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.9697370529174805, Class Loss=0.9697370529174805, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.879401445388794, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.879401445388794, Class Loss=0.879401445388794, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5780692100524902, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.5780692100524902, Class Loss=0.5780692100524902, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.7593328356742859, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.7593328356742859, Class Loss=0.7593328356742859, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8478835821151733, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.8478835821151733, Class Loss=0.8478835821151733, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8752821683883667, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.8752821683883667, Class Loss=0.8752821683883667, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=1.177986741065979, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=1.177986741065979, Class Loss=1.177986741065979, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8138262033462524, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.8138262033462524, Class Loss=0.8138262033462524, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.4866916239261627, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.911169
Mean Acc: 0.777963
FreqW Acc: 0.849942
Mean IoU: 0.668241
Class IoU:
	class 0: 0.89258474
	class 1: 0.85541683
	class 2: 0.4060415
	class 3: 0.84310687
	class 4: 0.6034537
	class 5: 0.773222
	class 6: 0.91792274
	class 7: 0.88458765
	class 8: 0.8820003
	class 9: 0.41148096
	class 10: 0.66722137
	class 11: 0.55073494
	class 12: 0.8060028
	class 13: 0.7598358
	class 14: 0.8374074
	class 15: 0.82436526
	class 16: 0.08353323
	class 17: 0.029417539
Class Acc:
	class 0: 0.9431125
	class 1: 0.9499001
	class 2: 0.90035874
	class 3: 0.87594515
	class 4: 0.81894404
	class 5: 0.8995722
	class 6: 0.9802197
	class 7: 0.9452303
	class 8: 0.9071868
	class 9: 0.6062892
	class 10: 0.7710064
	class 11: 0.6009715
	class 12: 0.8569524
	class 13: 0.8295532
	class 14: 0.90890646
	class 15: 0.93170035
	class 16: 0.24790137
	class 17: 0.029588679

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=1.1122997999191284, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=1.1122997999191284, Class Loss=1.1122997999191284, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7980620265007019, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.7980620265007019, Class Loss=0.7980620265007019, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7820265889167786, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.7820265889167786, Class Loss=0.7820265889167786, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.6751890182495117, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.6751890182495117, Class Loss=0.6751890182495117, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.7062996029853821, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.7062996029853821, Class Loss=0.7062996029853821, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.6574791669845581, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.6574791669845581, Class Loss=0.6574791669845581, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.34203028678894043, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.34203028678894043, Class Loss=0.34203028678894043, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5164527893066406, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.5164527893066406, Class Loss=0.5164527893066406, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6390775442123413, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.6390775442123413, Class Loss=0.6390775442123413, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6598453521728516, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.6598453521728516, Class Loss=0.6598453521728516, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7432441711425781, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.7432441711425781, Class Loss=0.7432441711425781, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.787548303604126, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.787548303604126, Class Loss=0.787548303604126, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.31457751989364624, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.31457751989364624, Class Loss=0.31457751989364624, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.5235339999198914, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.5235339999198914, Class Loss=0.5235339999198914, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.642256498336792, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.642256498336792, Class Loss=0.642256498336792, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6858493089675903, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.6858493089675903, Class Loss=0.6858493089675903, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6579350233078003, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.6579350233078003, Class Loss=0.6579350233078003, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6771434545516968, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.6771434545516968, Class Loss=0.6771434545516968, Reg Loss=0.0
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2782244086265564, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.2782244086265564, Class Loss=0.2782244086265564, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.494116872549057, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.494116872549057, Class Loss=0.494116872549057, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.6142334342002869, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.6142334342002869, Class Loss=0.6142334342002869, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6536919474601746, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.6536919474601746, Class Loss=0.6536919474601746, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6728156805038452, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.6728156805038452, Class Loss=0.6728156805038452, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6622048020362854, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.6622048020362854, Class Loss=0.6622048020362854, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.4315701127052307, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.920962
Mean Acc: 0.810152
FreqW Acc: 0.864918
Mean IoU: 0.687527
Class IoU:
	class 0: 0.9106322
	class 1: 0.8395818
	class 2: 0.3963806
	class 3: 0.849681
	class 4: 0.5829623
	class 5: 0.77566123
	class 6: 0.91283846
	class 7: 0.8870648
	class 8: 0.8700462
	class 9: 0.42086604
	class 10: 0.6044272
	class 11: 0.5667182
	class 12: 0.77420354
	class 13: 0.7610429
	class 14: 0.82661134
	class 15: 0.8229269
	class 16: 0.058883898
	class 17: 0.51495516
Class Acc:
	class 0: 0.9491542
	class 1: 0.9473278
	class 2: 0.913077
	class 3: 0.88610303
	class 4: 0.83339214
	class 5: 0.91487974
	class 6: 0.9846859
	class 7: 0.9393208
	class 8: 0.91262424
	class 9: 0.6077136
	class 10: 0.62503505
	class 11: 0.64227307
	class 12: 0.8181098
	class 13: 0.8961426
	class 14: 0.89426583
	class 15: 0.93756944
	class 16: 0.11468604
	class 17: 0.7663836

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.6695899367332458, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.6695899367332458, Class Loss=0.6695899367332458, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.689630925655365, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.689630925655365, Class Loss=0.689630925655365, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.7062808275222778, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.7062808275222778, Class Loss=0.7062808275222778, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.6258703470230103, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.6258703470230103, Class Loss=0.6258703470230103, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.6149038076400757, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.6149038076400757, Class Loss=0.6149038076400757, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.6090902090072632, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.6090902090072632, Class Loss=0.6090902090072632, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.25993645191192627, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.25993645191192627, Class Loss=0.25993645191192627, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.40669435262680054, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.40669435262680054, Class Loss=0.40669435262680054, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5088866353034973, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.5088866353034973, Class Loss=0.5088866353034973, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5186159610748291, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5186159610748291, Class Loss=0.5186159610748291, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.6138112545013428, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.6138112545013428, Class Loss=0.6138112545013428, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5524467825889587, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5524467825889587, Class Loss=0.5524467825889587, Reg Loss=0.0
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.6359714269638062, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.6359714269638062, Class Loss=0.6359714269638062, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.6027424335479736, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.6027424335479736, Class Loss=0.6027424335479736, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.6211546659469604, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.6211546659469604, Class Loss=0.6211546659469604, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.6236723065376282, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.6236723065376282, Class Loss=0.6236723065376282, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.6779893040657043, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.6779893040657043, Class Loss=0.6779893040657043, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.5585865378379822, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.5585865378379822, Class Loss=0.5585865378379822, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.29700544476509094, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.29700544476509094, Class Loss=0.29700544476509094, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.42985647916793823, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.42985647916793823, Class Loss=0.42985647916793823, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.5130434036254883, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.5130434036254883, Class Loss=0.5130434036254883, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5493078827857971, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.5493078827857971, Class Loss=0.5493078827857971, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5456238985061646, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.5456238985061646, Class Loss=0.5456238985061646, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.6418500542640686, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.6418500542640686, Class Loss=0.6418500542640686, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.37042349576950073, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.926026
Mean Acc: 0.809793
FreqW Acc: 0.871187
Mean IoU: 0.688159
Class IoU:
	class 0: 0.91829664
	class 1: 0.8453926
	class 2: 0.40407836
	class 3: 0.8463648
	class 4: 0.58452964
	class 5: 0.77889574
	class 6: 0.91526383
	class 7: 0.8889686
	class 8: 0.87178236
	class 9: 0.42024103
	class 10: 0.6263286
	class 11: 0.5707903
	class 12: 0.77172
	class 13: 0.76958245
	class 14: 0.8222292
	class 15: 0.83319515
	class 16: 0.02818173
	class 17: 0.4910248
Class Acc:
	class 0: 0.95682424
	class 1: 0.9440578
	class 2: 0.91536194
	class 3: 0.8848528
	class 4: 0.84657216
	class 5: 0.9057581
	class 6: 0.98297817
	class 7: 0.93253475
	class 8: 0.9002583
	class 9: 0.6043354
	class 10: 0.6551016
	class 11: 0.63980365
	class 12: 0.80789685
	class 13: 0.89221895
	class 14: 0.88443714
	class 15: 0.9373494
	class 16: 0.03496849
	class 17: 0.85095847

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.633955180644989, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.633955180644989, Class Loss=0.633955180644989, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5793401598930359, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.5793401598930359, Class Loss=0.5793401598930359, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5657477974891663, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.5657477974891663, Class Loss=0.5657477974891663, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.597206175327301, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.597206175327301, Class Loss=0.597206175327301, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.5412642359733582, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.5412642359733582, Class Loss=0.5412642359733582, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.5487255454063416, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.5487255454063416, Class Loss=0.5487255454063416, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20127646625041962, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.20127646625041962, Class Loss=0.20127646625041962, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.3512877821922302, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.3512877821922302, Class Loss=0.3512877821922302, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.4379861354827881, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.4379861354827881, Class Loss=0.4379861354827881, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4902005195617676, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.4902005195617676, Class Loss=0.4902005195617676, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5055562257766724, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.5055562257766724, Class Loss=0.5055562257766724, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5504652857780457, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.5504652857780457, Class Loss=0.5504652857780457, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.18833202123641968, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.18833202123641968, Class Loss=0.18833202123641968, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.38724687695503235, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.38724687695503235, Class Loss=0.38724687695503235, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.44670993089675903, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.44670993089675903, Class Loss=0.44670993089675903, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.47701215744018555, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.47701215744018555, Class Loss=0.47701215744018555, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5225019454956055, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.5225019454956055, Class Loss=0.5225019454956055, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.6679976582527161, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.6679976582527161, Class Loss=0.6679976582527161, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.20369020104408264, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.20369020104408264, Class Loss=0.20369020104408264, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.37800222635269165, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.37800222635269165, Class Loss=0.37800222635269165, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.4293755292892456, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.4293755292892456, Class Loss=0.4293755292892456, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.502685546875, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.502685546875, Class Loss=0.502685546875, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5476959943771362, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.5476959943771362, Class Loss=0.5476959943771362, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5514940023422241, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.5514940023422241, Class Loss=0.5514940023422241, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.338331013917923, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.926154
Mean Acc: 0.805160
FreqW Acc: 0.871094
Mean IoU: 0.683885
Class IoU:
	class 0: 0.9196147
	class 1: 0.8345312
	class 2: 0.41159
	class 3: 0.85278744
	class 4: 0.5841515
	class 5: 0.78065544
	class 6: 0.9240467
	class 7: 0.88907737
	class 8: 0.86750644
	class 9: 0.41122115
	class 10: 0.60045993
	class 11: 0.5720752
	class 12: 0.75738466
	class 13: 0.7753544
	class 14: 0.81500083
	class 15: 0.8352491
	class 16: 0.0115809925
	class 17: 0.4676376
Class Acc:
	class 0: 0.95922333
	class 1: 0.9553747
	class 2: 0.9062638
	class 3: 0.8917736
	class 4: 0.8510818
	class 5: 0.9016399
	class 6: 0.98146427
	class 7: 0.92947125
	class 8: 0.8995849
	class 9: 0.59675074
	class 10: 0.6191472
	class 11: 0.6501438
	class 12: 0.78177243
	class 13: 0.8785314
	class 14: 0.87108976
	class 15: 0.9368384
	class 16: 0.012592551
	class 17: 0.8701428

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.6234813332557678, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.6234813332557678, Class Loss=0.6234813332557678, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.6844836473464966, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.6844836473464966, Class Loss=0.6844836473464966, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.553870439529419, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.553870439529419, Class Loss=0.553870439529419, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.5650382041931152, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.5650382041931152, Class Loss=0.5650382041931152, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.5452236533164978, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.5452236533164978, Class Loss=0.5452236533164978, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.541667103767395, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.541667103767395, Class Loss=0.541667103767395, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19538667798042297, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.19538667798042297, Class Loss=0.19538667798042297, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.32579872012138367, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.32579872012138367, Class Loss=0.32579872012138367, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.4055236577987671, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.4055236577987671, Class Loss=0.4055236577987671, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.4516257047653198, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.4516257047653198, Class Loss=0.4516257047653198, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.514270544052124, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.514270544052124, Class Loss=0.514270544052124, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5090081095695496, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.5090081095695496, Class Loss=0.5090081095695496, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.21174205839633942, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.21174205839633942, Class Loss=0.21174205839633942, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.3265282213687897, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.3265282213687897, Class Loss=0.3265282213687897, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.4566766619682312, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.4566766619682312, Class Loss=0.4566766619682312, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.43098288774490356, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.43098288774490356, Class Loss=0.43098288774490356, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.5555440783500671, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.5555440783500671, Class Loss=0.5555440783500671, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5477995276451111, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.5477995276451111, Class Loss=0.5477995276451111, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19428984820842743, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.19428984820842743, Class Loss=0.19428984820842743, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.36017662286758423, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.36017662286758423, Class Loss=0.36017662286758423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.4222091734409332, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.4222091734409332, Class Loss=0.4222091734409332, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.47171977162361145, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.47171977162361145, Class Loss=0.47171977162361145, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.6045761704444885, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.6045761704444885, Class Loss=0.6045761704444885, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5070698857307434, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.5070698857307434, Class Loss=0.5070698857307434, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.3268752992153168, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.926388
Mean Acc: 0.802001
FreqW Acc: 0.871339
Mean IoU: 0.682044
Class IoU:
	class 0: 0.9205635
	class 1: 0.83916515
	class 2: 0.41112056
	class 3: 0.8536193
	class 4: 0.59231675
	class 5: 0.77878505
	class 6: 0.9229088
	class 7: 0.8887762
	class 8: 0.86711305
	class 9: 0.41488257
	class 10: 0.5726618
	class 11: 0.57693726
	class 12: 0.7530244
	class 13: 0.7655696
	class 14: 0.8119109
	class 15: 0.83920634
	class 16: 0.007889636
	class 17: 0.460334
Class Acc:
	class 0: 0.96110463
	class 1: 0.95200664
	class 2: 0.9083925
	class 3: 0.8912998
	class 4: 0.8528878
	class 5: 0.89935327
	class 6: 0.9813964
	class 7: 0.927182
	class 8: 0.89590955
	class 9: 0.602822
	class 10: 0.58594143
	class 11: 0.64471734
	class 12: 0.780851
	class 13: 0.87829316
	class 14: 0.8666174
	class 15: 0.93409055
	class 16: 0.008413376
	class 17: 0.8647385

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1656864881515503, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.1656864881515503, Class Loss=0.1656864881515503, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.306951105594635, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.306951105594635, Class Loss=0.306951105594635, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.6140940189361572, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.6140940189361572, Class Loss=0.6140940189361572, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7753782272338867, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.7753782272338867, Class Loss=0.7753782272338867, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8512715697288513, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.8512715697288513, Class Loss=0.8512715697288513, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.875220537185669, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.875220537185669, Class Loss=0.875220537185669, Reg Loss=0.0
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.21313636004924774, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.21313636004924774, Class Loss=0.21313636004924774, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.32991349697113037, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.32991349697113037, Class Loss=0.32991349697113037, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.6175386905670166, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.6175386905670166, Class Loss=0.6175386905670166, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7701083421707153, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.7701083421707153, Class Loss=0.7701083421707153, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.834511935710907, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.834511935710907, Class Loss=0.834511935710907, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8694447875022888, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.8694447875022888, Class Loss=0.8694447875022888, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2342308610677719, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.2342308610677719, Class Loss=0.2342308610677719, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.32484742999076843, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.32484742999076843, Class Loss=0.32484742999076843, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.5792117118835449, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.5792117118835449, Class Loss=0.5792117118835449, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7452797889709473, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.7452797889709473, Class Loss=0.7452797889709473, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8820123672485352, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.8820123672485352, Class Loss=0.8820123672485352, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8348127603530884, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.8348127603530884, Class Loss=0.8348127603530884, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.19650033116340637, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.19650033116340637, Class Loss=0.19650033116340637, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.35927486419677734, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.35927486419677734, Class Loss=0.35927486419677734, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.601719081401825, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.601719081401825, Class Loss=0.601719081401825, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.7424102425575256, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.7424102425575256, Class Loss=0.7424102425575256, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8349072933197021, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.8349072933197021, Class Loss=0.8349072933197021, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8618311285972595, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.8618311285972595, Class Loss=0.8618311285972595, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5491815805435181, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.907812
Mean Acc: 0.794801
FreqW Acc: 0.841757
Mean IoU: 0.643778
Class IoU:
	class 0: 0.897831
	class 1: 0.79629284
	class 2: 0.38161084
	class 3: 0.8031982
	class 4: 0.5536646
	class 5: 0.75470823
	class 6: 0.89552677
	class 7: 0.8881762
	class 8: 0.85588956
	class 9: 0.41523868
	class 10: 0.6435959
	class 11: 0.5552119
	class 12: 0.8075574
	class 13: 0.73152745
	class 14: 0.8005563
	class 15: 0.8403488
	class 16: 0.16124739
	class 17: 0.44351852
	class 18: 0.0060808477
Class Acc:
	class 0: 0.9400374
	class 1: 0.96339756
	class 2: 0.94430614
	class 3: 0.95914125
	class 4: 0.84325373
	class 5: 0.9253776
	class 6: 0.9909896
	class 7: 0.9297416
	class 8: 0.94944173
	class 9: 0.6052554
	class 10: 0.737912
	class 11: 0.730785
	class 12: 0.9040948
	class 13: 0.8425192
	class 14: 0.94026405
	class 15: 0.94014287
	class 16: 0.27897805
	class 17: 0.6694098
	class 18: 0.006163312

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.0948268324136734, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.0948268324136734, Class Loss=0.0948268324136734, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.24456608295440674, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.24456608295440674, Class Loss=0.24456608295440674, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.44558262825012207, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.44558262825012207, Class Loss=0.44558262825012207, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6169881820678711, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.6169881820678711, Class Loss=0.6169881820678711, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7365469932556152, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.7365469932556152, Class Loss=0.7365469932556152, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7533296346664429, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.7533296346664429, Class Loss=0.7533296346664429, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.09907282143831253, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.09907282143831253, Class Loss=0.09907282143831253, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.2482064813375473, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.2482064813375473, Class Loss=0.2482064813375473, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4629254639148712, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.4629254639148712, Class Loss=0.4629254639148712, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6069351434707642, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.6069351434707642, Class Loss=0.6069351434707642, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7360626459121704, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.7360626459121704, Class Loss=0.7360626459121704, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7421430349349976, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.7421430349349976, Class Loss=0.7421430349349976, Reg Loss=0.0
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.11131062358617783, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.11131062358617783, Class Loss=0.11131062358617783, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.23609621822834015, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.23609621822834015, Class Loss=0.23609621822834015, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4392678737640381, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.4392678737640381, Class Loss=0.4392678737640381, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6109751462936401, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.6109751462936401, Class Loss=0.6109751462936401, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7265132069587708, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.7265132069587708, Class Loss=0.7265132069587708, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7292392253875732, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.7292392253875732, Class Loss=0.7292392253875732, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.10274513065814972, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.10274513065814972, Class Loss=0.10274513065814972, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.26604363322257996, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.26604363322257996, Class Loss=0.26604363322257996, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.4698159694671631, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.4698159694671631, Class Loss=0.4698159694671631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.6318327784538269, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.6318327784538269, Class Loss=0.6318327784538269, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7099511623382568, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.7099511623382568, Class Loss=0.7099511623382568, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.769038736820221, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.769038736820221, Class Loss=0.769038736820221, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5109307169914246, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.901226
Mean Acc: 0.810583
FreqW Acc: 0.837623
Mean IoU: 0.651511
Class IoU:
	class 0: 0.88810015
	class 1: 0.78827405
	class 2: 0.36845464
	class 3: 0.77537596
	class 4: 0.57139397
	class 5: 0.73618317
	class 6: 0.89966214
	class 7: 0.8848379
	class 8: 0.8627816
	class 9: 0.41507733
	class 10: 0.6493066
	class 11: 0.5422022
	class 12: 0.8254307
	class 13: 0.7502999
	class 14: 0.80239123
	class 15: 0.83245426
	class 16: 0.15260892
	class 17: 0.47237158
	class 18: 0.16150147
Class Acc:
	class 0: 0.9213261
	class 1: 0.97135645
	class 2: 0.9478353
	class 3: 0.96731013
	class 4: 0.8524754
	class 5: 0.9269702
	class 6: 0.989366
	class 7: 0.9315229
	class 8: 0.9577572
	class 9: 0.6059289
	class 10: 0.7821779
	class 11: 0.7423978
	class 12: 0.91786456
	class 13: 0.8712033
	class 14: 0.94290435
	class 15: 0.94789815
	class 16: 0.21162541
	class 17: 0.614982
	class 18: 0.2981704

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.07869285345077515, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.07869285345077515, Class Loss=0.07869285345077515, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.22193147242069244, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.22193147242069244, Class Loss=0.22193147242069244, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3843691945075989, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.3843691945075989, Class Loss=0.3843691945075989, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5374807715415955, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5374807715415955, Class Loss=0.5374807715415955, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.6382119655609131, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.6382119655609131, Class Loss=0.6382119655609131, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.7143733501434326, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.7143733501434326, Class Loss=0.7143733501434326, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.7942230105400085, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.7942230105400085, Class Loss=0.7942230105400085, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.7810950875282288, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.7810950875282288, Class Loss=0.7810950875282288, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.7201279997825623, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.7201279997825623, Class Loss=0.7201279997825623, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.6913297772407532, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.6913297772407532, Class Loss=0.6913297772407532, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.6903582811355591, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.6903582811355591, Class Loss=0.6903582811355591, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.7010245323181152, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.7010245323181152, Class Loss=0.7010245323181152, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.7879919409751892, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.7879919409751892, Class Loss=0.7879919409751892, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.7531623840332031, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.7531623840332031, Class Loss=0.7531623840332031, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.7249453067779541, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.7249453067779541, Class Loss=0.7249453067779541, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.7276235818862915, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.7276235818862915, Class Loss=0.7276235818862915, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.6714766025543213, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.6714766025543213, Class Loss=0.6714766025543213, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.6512792110443115, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.6512792110443115, Class Loss=0.6512792110443115, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.08214841783046722, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.08214841783046722, Class Loss=0.08214841783046722, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.20084047317504883, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.20084047317504883, Class Loss=0.20084047317504883, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3910579979419708, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.3910579979419708, Class Loss=0.3910579979419708, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.5377495884895325, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.5377495884895325, Class Loss=0.5377495884895325, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.6522899866104126, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.6522899866104126, Class Loss=0.6522899866104126, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.7195481061935425, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.7195481061935425, Class Loss=0.7195481061935425, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.45077475905418396, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.904058
Mean Acc: 0.800795
FreqW Acc: 0.842336
Mean IoU: 0.653375
Class IoU:
	class 0: 0.89172256
	class 1: 0.8037839
	class 2: 0.38440153
	class 3: 0.78239506
	class 4: 0.5894592
	class 5: 0.742477
	class 6: 0.9100722
	class 7: 0.888112
	class 8: 0.8696423
	class 9: 0.41391248
	class 10: 0.6621475
	class 11: 0.5522364
	class 12: 0.8282619
	class 13: 0.762771
	class 14: 0.81697035
	class 15: 0.8462572
	class 16: 0.05285495
	class 17: 0.40271392
	class 18: 0.21394055
Class Acc:
	class 0: 0.9264283
	class 1: 0.97361076
	class 2: 0.9409633
	class 3: 0.96766776
	class 4: 0.8539372
	class 5: 0.91150934
	class 6: 0.98656243
	class 7: 0.92778385
	class 8: 0.94899666
	class 9: 0.5982124
	class 10: 0.79986674
	class 11: 0.7172332
	class 12: 0.920016
	class 13: 0.8814394
	class 14: 0.9331832
	class 15: 0.9431697
	class 16: 0.055191822
	class 17: 0.45856056
	class 18: 0.4707706

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.06984907388687134, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.06984907388687134, Class Loss=0.06984907388687134, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.1802341490983963, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.1802341490983963, Class Loss=0.1802341490983963, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3360307216644287, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.3360307216644287, Class Loss=0.3360307216644287, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4755939543247223, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.4755939543247223, Class Loss=0.4755939543247223, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5809189081192017, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.5809189081192017, Class Loss=0.5809189081192017, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.6492784023284912, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.6492784023284912, Class Loss=0.6492784023284912, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.09079695492982864, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.09079695492982864, Class Loss=0.09079695492982864, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.1928517073392868, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.1928517073392868, Class Loss=0.1928517073392868, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3268425762653351, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.3268425762653351, Class Loss=0.3268425762653351, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4653896689414978, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.4653896689414978, Class Loss=0.4653896689414978, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5723105072975159, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.5723105072975159, Class Loss=0.5723105072975159, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.6702644228935242, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.6702644228935242, Class Loss=0.6702644228935242, Reg Loss=0.0
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.6990939974784851, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.6990939974784851, Class Loss=0.6990939974784851, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.6872044801712036, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.6872044801712036, Class Loss=0.6872044801712036, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.668019711971283, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.668019711971283, Class Loss=0.668019711971283, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.6447411179542542, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.6447411179542542, Class Loss=0.6447411179542542, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.6386017799377441, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.6386017799377441, Class Loss=0.6386017799377441, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.611821174621582, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.611821174621582, Class Loss=0.611821174621582, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.7037227749824524, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.7037227749824524, Class Loss=0.7037227749824524, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.6690080165863037, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.6690080165863037, Class Loss=0.6690080165863037, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.6500556468963623, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.6500556468963623, Class Loss=0.6500556468963623, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.6810630559921265, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.6810630559921265, Class Loss=0.6810630559921265, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.632047712802887, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.632047712802887, Class Loss=0.632047712802887, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.6145867109298706, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.6145867109298706, Class Loss=0.6145867109298706, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.43037933111190796, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.901322
Mean Acc: 0.797696
FreqW Acc: 0.839982
Mean IoU: 0.648831
Class IoU:
	class 0: 0.8895653
	class 1: 0.8035378
	class 2: 0.38726658
	class 3: 0.779844
	class 4: 0.5922491
	class 5: 0.744983
	class 6: 0.91267073
	class 7: 0.8833704
	class 8: 0.86728996
	class 9: 0.4180223
	class 10: 0.6485653
	class 11: 0.55636597
	class 12: 0.82689315
	class 13: 0.7629111
	class 14: 0.81971085
	class 15: 0.8463325
	class 16: 0.030870229
	class 17: 0.3338278
	class 18: 0.22350632
Class Acc:
	class 0: 0.9225026
	class 1: 0.9709213
	class 2: 0.9348748
	class 3: 0.9655086
	class 4: 0.85665584
	class 5: 0.9125621
	class 6: 0.9856849
	class 7: 0.92244744
	class 8: 0.9520986
	class 9: 0.6043161
	class 10: 0.7833005
	class 11: 0.7142914
	class 12: 0.91361266
	class 13: 0.88571036
	class 14: 0.9304864
	class 15: 0.9442734
	class 16: 0.03123611
	class 17: 0.36045793
	class 18: 0.56528866

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.06328338384628296, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.06328338384628296, Class Loss=0.06328338384628296, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.16199836134910583, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.16199836134910583, Class Loss=0.16199836134910583, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2928640842437744, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.2928640842437744, Class Loss=0.2928640842437744, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.4210919141769409, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.4210919141769409, Class Loss=0.4210919141769409, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.5261731147766113, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.5261731147766113, Class Loss=0.5261731147766113, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.630229115486145, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.630229115486145, Class Loss=0.630229115486145, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.05845711752772331, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.05845711752772331, Class Loss=0.05845711752772331, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1629001647233963, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.1629001647233963, Class Loss=0.1629001647233963, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.31639206409454346, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.31639206409454346, Class Loss=0.31639206409454346, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.4313814640045166, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.4313814640045166, Class Loss=0.4313814640045166, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.538670539855957, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.538670539855957, Class Loss=0.538670539855957, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.626404881477356, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.626404881477356, Class Loss=0.626404881477356, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.6873628497123718, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.6873628497123718, Class Loss=0.6873628497123718, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.6363864541053772, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.6363864541053772, Class Loss=0.6363864541053772, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.628908634185791, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.628908634185791, Class Loss=0.628908634185791, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.6466982960700989, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.6466982960700989, Class Loss=0.6466982960700989, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.626960813999176, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.626960813999176, Class Loss=0.626960813999176, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.6133137941360474, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.6133137941360474, Class Loss=0.6133137941360474, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.07448037713766098, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.07448037713766098, Class Loss=0.07448037713766098, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.17125365138053894, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.17125365138053894, Class Loss=0.17125365138053894, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.29720044136047363, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.29720044136047363, Class Loss=0.29720044136047363, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.4311484098434448, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.4311484098434448, Class Loss=0.4311484098434448, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.5389693379402161, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.5389693379402161, Class Loss=0.5389693379402161, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.6332419514656067, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.6332419514656067, Class Loss=0.6332419514656067, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.4656655788421631, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.892410
Mean Acc: 0.808713
FreqW Acc: 0.829886
Mean IoU: 0.640488
Class IoU:
	class 0: 0.87901074
	class 1: 0.7674
	class 2: 0.3710457
	class 3: 0.73843217
	class 4: 0.5745109
	class 5: 0.7277371
	class 6: 0.90425813
	class 7: 0.88381785
	class 8: 0.8582753
	class 9: 0.41762328
	class 10: 0.6491761
	class 11: 0.55183274
	class 12: 0.81808627
	class 13: 0.75595045
	class 14: 0.8140276
	class 15: 0.83294976
	class 16: 0.042078067
	class 17: 0.3680965
	class 18: 0.21495803
Class Acc:
	class 0: 0.90506226
	class 1: 0.9804144
	class 2: 0.9441642
	class 3: 0.96888447
	class 4: 0.8684815
	class 5: 0.9278179
	class 6: 0.9875668
	class 7: 0.93113595
	class 8: 0.95506835
	class 9: 0.6114312
	class 10: 0.78779805
	class 11: 0.7236989
	class 12: 0.9159031
	class 13: 0.89291406
	class 14: 0.934883
	class 15: 0.9504561
	class 16: 0.04362972
	class 17: 0.405932
	class 18: 0.63030624

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03449675068259239, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.03449675068259239, Class Loss=0.03449675068259239, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.12976039946079254, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.12976039946079254, Class Loss=0.12976039946079254, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.45989304780960083, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.45989304780960083, Class Loss=0.45989304780960083, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8491933941841125, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.8491933941841125, Class Loss=0.8491933941841125, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9444241523742676, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.9444241523742676, Class Loss=0.9444241523742676, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.881751537322998, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.881751537322998, Class Loss=0.881751537322998, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02131728269159794, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.02131728269159794, Class Loss=0.02131728269159794, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.16054844856262207, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.16054844856262207, Class Loss=0.16054844856262207, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4812629520893097, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.4812629520893097, Class Loss=0.4812629520893097, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8506740927696228, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.8506740927696228, Class Loss=0.8506740927696228, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9696011543273926, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.9696011543273926, Class Loss=0.9696011543273926, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9076399803161621, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.9076399803161621, Class Loss=0.9076399803161621, Reg Loss=0.0
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.028930703178048134, Reg Loss=0.0
Clinet index 24, End of Epoch 1/6, Average Loss=0.028930703178048134, Class Loss=0.028930703178048134, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.14764223992824554, Reg Loss=0.0
Clinet index 24, End of Epoch 2/6, Average Loss=0.14764223992824554, Class Loss=0.14764223992824554, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.504429042339325, Reg Loss=0.0
Clinet index 24, End of Epoch 3/6, Average Loss=0.504429042339325, Class Loss=0.504429042339325, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8451302647590637, Reg Loss=0.0
Clinet index 24, End of Epoch 4/6, Average Loss=0.8451302647590637, Class Loss=0.8451302647590637, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9681758880615234, Reg Loss=0.0
Clinet index 24, End of Epoch 5/6, Average Loss=0.9681758880615234, Class Loss=0.9681758880615234, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.8924574255943298, Reg Loss=0.0
Clinet index 24, End of Epoch 6/6, Average Loss=0.8924574255943298, Class Loss=0.8924574255943298, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.029203705489635468, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.029203705489635468, Class Loss=0.029203705489635468, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.13845235109329224, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.13845235109329224, Class Loss=0.13845235109329224, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.48496612906455994, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.48496612906455994, Class Loss=0.48496612906455994, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8339231014251709, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.8339231014251709, Class Loss=0.8339231014251709, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.987533450126648, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.987533450126648, Class Loss=0.987533450126648, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9091756343841553, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.9091756343841553, Class Loss=0.9091756343841553, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.730667233467102, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.877793
Mean Acc: 0.710984
FreqW Acc: 0.799983
Mean IoU: 0.577542
Class IoU:
	class 0: 0.8705552
	class 1: 0.7514588
	class 2: 0.38104784
	class 3: 0.7570757
	class 4: 0.5614649
	class 5: 0.7041659
	class 6: 0.81669945
	class 7: 0.82260334
	class 8: 0.8134566
	class 9: 0.25573143
	class 10: 0.5544035
	class 11: 0.4844426
	class 12: 0.70475835
	class 13: 0.6707844
	class 14: 0.781139
	class 15: 0.78571254
	class 16: 0.00048405988
	class 17: 0.26320994
	class 18: 0.040707596
	class 19: 0.53094494
Class Acc:
	class 0: 0.92939806
	class 1: 0.86559415
	class 2: 0.9318194
	class 3: 0.89517367
	class 4: 0.7177928
	class 5: 0.8461602
	class 6: 0.8803084
	class 7: 0.91543156
	class 8: 0.8618788
	class 9: 0.64834803
	class 10: 0.6256713
	class 11: 0.6794629
	class 12: 0.8405529
	class 13: 0.78299433
	class 14: 0.8635945
	class 15: 0.94198245
	class 16: 0.0005008802
	class 17: 0.29528323
	class 18: 0.06867489
	class 19: 0.6290511

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.020117301493883133, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.020117301493883133, Class Loss=0.020117301493883133, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.10071784257888794, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.10071784257888794, Class Loss=0.10071784257888794, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.32450902462005615, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.32450902462005615, Class Loss=0.32450902462005615, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5944452285766602, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.5944452285766602, Class Loss=0.5944452285766602, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 5, Class Loss=0.7342748641967773, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.7342748641967773, Class Loss=0.7342748641967773, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7555994987487793, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.7555994987487793, Class Loss=0.7555994987487793, Reg Loss=0.0
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.8623694181442261, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.8623694181442261, Class Loss=0.8623694181442261, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7898485064506531, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.7898485064506531, Class Loss=0.7898485064506531, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7033690810203552, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.7033690810203552, Class Loss=0.7033690810203552, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.6374467611312866, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.6374467611312866, Class Loss=0.6374467611312866, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5951253175735474, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5951253175735474, Class Loss=0.5951253175735474, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5701929330825806, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5701929330825806, Class Loss=0.5701929330825806, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.021967142820358276, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.021967142820358276, Class Loss=0.021967142820358276, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.08000053465366364, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.08000053465366364, Class Loss=0.08000053465366364, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3045966625213623, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.3045966625213623, Class Loss=0.3045966625213623, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5628035068511963, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.5628035068511963, Class Loss=0.5628035068511963, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.72486412525177, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.72486412525177, Class Loss=0.72486412525177, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7556589245796204, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.7556589245796204, Class Loss=0.7556589245796204, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.0169829111546278, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.0169829111546278, Class Loss=0.0169829111546278, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.09258664399385452, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.09258664399385452, Class Loss=0.09258664399385452, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3121400475502014, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.3121400475502014, Class Loss=0.3121400475502014, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5667285323143005, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.5667285323143005, Class Loss=0.5667285323143005, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.7178511619567871, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.7178511619567871, Class Loss=0.7178511619567871, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7431614995002747, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.7431614995002747, Class Loss=0.7431614995002747, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5934590101242065, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.888506
Mean Acc: 0.703310
FreqW Acc: 0.812897
Mean IoU: 0.584210
Class IoU:
	class 0: 0.88631713
	class 1: 0.7837602
	class 2: 0.3932323
	class 3: 0.808725
	class 4: 0.5775015
	class 5: 0.70175225
	class 6: 0.8272442
	class 7: 0.84616417
	class 8: 0.8127822
	class 9: 0.28165483
	class 10: 0.574793
	class 11: 0.5391266
	class 12: 0.7242519
	class 13: 0.68801063
	class 14: 0.78863645
	class 15: 0.8089826
	class 16: 0.0014268429
	class 17: 0.19923635
	class 18: 0.01749532
	class 19: 0.42310035
Class Acc:
	class 0: 0.9468803
	class 1: 0.85733825
	class 2: 0.92301154
	class 3: 0.8834662
	class 4: 0.716638
	class 5: 0.8113873
	class 6: 0.8774655
	class 7: 0.92091936
	class 8: 0.8410419
	class 9: 0.604871
	class 10: 0.62899095
	class 11: 0.660639
	class 12: 0.8256249
	class 13: 0.7790989
	class 14: 0.8490833
	class 15: 0.9383773
	class 16: 0.0014325643
	class 17: 0.2113899
	class 18: 0.020209795
	class 19: 0.7683306

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.6653350591659546, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.6653350591659546, Class Loss=0.6653350591659546, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000600
Epoch 2, Class Loss=0.6261906623840332, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.6261906623840332, Class Loss=0.6261906623840332, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.5761136412620544, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.5761136412620544, Class Loss=0.5761136412620544, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.5728533864021301, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5728533864021301, Class Loss=0.5728533864021301, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.5403323769569397, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5403323769569397, Class Loss=0.5403323769569397, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.5238332152366638, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5238332152366638, Class Loss=0.5238332152366638, Reg Loss=0.0
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.016299152746796608, Reg Loss=0.0
Clinet index 25, End of Epoch 1/6, Average Loss=0.016299152746796608, Class Loss=0.016299152746796608, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.058643534779548645, Reg Loss=0.0
Clinet index 25, End of Epoch 2/6, Average Loss=0.058643534779548645, Class Loss=0.058643534779548645, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.23861226439476013, Reg Loss=0.0
Clinet index 25, End of Epoch 3/6, Average Loss=0.23861226439476013, Class Loss=0.23861226439476013, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.46149781346321106, Reg Loss=0.0
Clinet index 25, End of Epoch 4/6, Average Loss=0.46149781346321106, Class Loss=0.46149781346321106, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5968462228775024, Reg Loss=0.0
Clinet index 25, End of Epoch 5/6, Average Loss=0.5968462228775024, Class Loss=0.5968462228775024, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.6077452301979065, Reg Loss=0.0
Clinet index 25, End of Epoch 6/6, Average Loss=0.6077452301979065, Class Loss=0.6077452301979065, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.01663939282298088, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.01663939282298088, Class Loss=0.01663939282298088, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.0650046244263649, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.0650046244263649, Class Loss=0.0650046244263649, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.2365007996559143, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.2365007996559143, Class Loss=0.2365007996559143, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.45011240243911743, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.45011240243911743, Class Loss=0.45011240243911743, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5870674252510071, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.5870674252510071, Class Loss=0.5870674252510071, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5982895493507385, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.5982895493507385, Class Loss=0.5982895493507385, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.6802794933319092, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.6802794933319092, Class Loss=0.6802794933319092, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.640567421913147, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.640567421913147, Class Loss=0.640567421913147, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.6082374453544617, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.6082374453544617, Class Loss=0.6082374453544617, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000655
Epoch 4, Class Loss=0.5945147275924683, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.5945147275924683, Class Loss=0.5945147275924683, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.5582522749900818, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.5582522749900818, Class Loss=0.5582522749900818, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000576
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 6, Class Loss=0.53590989112854, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.53590989112854, Class Loss=0.53590989112854, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5013617873191833, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.892147
Mean Acc: 0.689658
FreqW Acc: 0.814720
Mean IoU: 0.583612
Class IoU:
	class 0: 0.88900185
	class 1: 0.811106
	class 2: 0.40313417
	class 3: 0.81899637
	class 4: 0.58351344
	class 5: 0.6936917
	class 6: 0.8334734
	class 7: 0.85626197
	class 8: 0.77828217
	class 9: 0.30822042
	class 10: 0.58697325
	class 11: 0.553862
	class 12: 0.73032326
	class 13: 0.69595486
	class 14: 0.7938178
	class 15: 0.81745255
	class 16: 9.823395e-05
	class 17: 0.08954169
	class 18: 0.0056925355
	class 19: 0.42283958
Class Acc:
	class 0: 0.9574737
	class 1: 0.8748947
	class 2: 0.9125409
	class 3: 0.8791591
	class 4: 0.70988536
	class 5: 0.7837592
	class 6: 0.87934744
	class 7: 0.9170934
	class 8: 0.79550606
	class 9: 0.5434887
	class 10: 0.63644433
	class 11: 0.6443435
	class 12: 0.8076443
	class 13: 0.78518265
	class 14: 0.8467096
	class 15: 0.9378491
	class 16: 9.82948e-05
	class 17: 0.0910463
	class 18: 0.0058704303
	class 19: 0.7848317

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.010094469413161278, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.010094469413161278, Class Loss=0.010094469413161278, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.06032727658748627, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.06032727658748627, Class Loss=0.06032727658748627, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.18973897397518158, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.18973897397518158, Class Loss=0.18973897397518158, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.3835034966468811, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.3835034966468811, Class Loss=0.3835034966468811, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5259691476821899, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.5259691476821899, Class Loss=0.5259691476821899, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5549004673957825, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.5549004673957825, Class Loss=0.5549004673957825, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.009803366847336292, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.009803366847336292, Class Loss=0.009803366847336292, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.05270569398999214, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.05270569398999214, Class Loss=0.05270569398999214, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.1932675689458847, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.1932675689458847, Class Loss=0.1932675689458847, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.39056596159935, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.39056596159935, Class Loss=0.39056596159935, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5259811282157898, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.5259811282157898, Class Loss=0.5259811282157898, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5549306869506836, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.5549306869506836, Class Loss=0.5549306869506836, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.013676134869456291, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.013676134869456291, Class Loss=0.013676134869456291, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.06060406565666199, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.06060406565666199, Class Loss=0.06060406565666199, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.19346538186073303, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.19346538186073303, Class Loss=0.19346538186073303, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.3761069178581238, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.3761069178581238, Class Loss=0.3761069178581238, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5207746624946594, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.5207746624946594, Class Loss=0.5207746624946594, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5502756237983704, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.5502756237983704, Class Loss=0.5502756237983704, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.015758933499455452, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.015758933499455452, Class Loss=0.015758933499455452, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.06108629330992699, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.06108629330992699, Class Loss=0.06108629330992699, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.1927701085805893, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.1927701085805893, Class Loss=0.1927701085805893, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.37267470359802246, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.37267470359802246, Class Loss=0.37267470359802246, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.527220606803894, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.527220606803894, Class Loss=0.527220606803894, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5721392631530762, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.5721392631530762, Class Loss=0.5721392631530762, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5029315948486328, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.891785
Mean Acc: 0.712205
FreqW Acc: 0.816992
Mean IoU: 0.590820
Class IoU:
	class 0: 0.89010775
	class 1: 0.8192675
	class 2: 0.38961166
	class 3: 0.81867725
	class 4: 0.5950471
	class 5: 0.70177823
	class 6: 0.8594541
	class 7: 0.85961133
	class 8: 0.7943645
	class 9: 0.30703732
	class 10: 0.5957407
	class 11: 0.557862
	class 12: 0.7435807
	class 13: 0.71125853
	class 14: 0.8016269
	class 15: 0.80182356
	class 16: 0.0028055
	class 17: 0.14361429
	class 18: 0.01017167
	class 19: 0.41296822
Class Acc:
	class 0: 0.9471493
	class 1: 0.90900594
	class 2: 0.92435396
	class 3: 0.91056716
	class 4: 0.7498206
	class 5: 0.80973184
	class 6: 0.91480994
	class 7: 0.92524135
	class 8: 0.8141068
	class 9: 0.5746049
	class 10: 0.6597081
	class 11: 0.6658878
	class 12: 0.83579123
	class 13: 0.819262
	class 14: 0.8656191
	class 15: 0.94671667
	class 16: 0.002815276
	class 17: 0.14743587
	class 18: 0.010618429
	class 19: 0.810854

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.0150719890370965, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.0150719890370965, Class Loss=0.0150719890370965, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.0528884083032608, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.0528884083032608, Class Loss=0.0528884083032608, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.1846524029970169, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.1846524029970169, Class Loss=0.1846524029970169, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3704666495323181, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.3704666495323181, Class Loss=0.3704666495323181, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4969780147075653, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.4969780147075653, Class Loss=0.4969780147075653, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5629209280014038, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.5629209280014038, Class Loss=0.5629209280014038, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.011983569711446762, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.011983569711446762, Class Loss=0.011983569711446762, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.058143097907304764, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.058143097907304764, Class Loss=0.058143097907304764, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.1956251710653305, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.1956251710653305, Class Loss=0.1956251710653305, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3644919991493225, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.3644919991493225, Class Loss=0.3644919991493225, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.5054119229316711, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.5054119229316711, Class Loss=0.5054119229316711, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5508232116699219, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.5508232116699219, Class Loss=0.5508232116699219, Reg Loss=0.0
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.008230580948293209, Reg Loss=0.0
Clinet index 18, End of Epoch 1/6, Average Loss=0.008230580948293209, Class Loss=0.008230580948293209, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.05306117236614227, Reg Loss=0.0
Clinet index 18, End of Epoch 2/6, Average Loss=0.05306117236614227, Class Loss=0.05306117236614227, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.17856086790561676, Reg Loss=0.0
Clinet index 18, End of Epoch 3/6, Average Loss=0.17856086790561676, Class Loss=0.17856086790561676, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.35708385705947876, Reg Loss=0.0
Clinet index 18, End of Epoch 4/6, Average Loss=0.35708385705947876, Class Loss=0.35708385705947876, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4941602945327759, Reg Loss=0.0
Clinet index 18, End of Epoch 5/6, Average Loss=0.4941602945327759, Class Loss=0.4941602945327759, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.564298152923584, Reg Loss=0.0
Clinet index 18, End of Epoch 6/6, Average Loss=0.564298152923584, Class Loss=0.564298152923584, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.5656052231788635, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.5656052231788635, Class Loss=0.5656052231788635, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.5360941290855408, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.5360941290855408, Class Loss=0.5360941290855408, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.5049813985824585, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.5049813985824585, Class Loss=0.5049813985824585, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.5165329575538635, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.5165329575538635, Class Loss=0.5165329575538635, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000304
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 5, Class Loss=0.4654318690299988, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.4654318690299988, Class Loss=0.4654318690299988, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.5015518665313721, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.5015518665313721, Class Loss=0.5015518665313721, Reg Loss=0.0
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=0.4802585542201996, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.893998
Mean Acc: 0.713905
FreqW Acc: 0.818956
Mean IoU: 0.596280
Class IoU:
	class 0: 0.89036125
	class 1: 0.82084376
	class 2: 0.3892863
	class 3: 0.8275319
	class 4: 0.604878
	class 5: 0.713268
	class 6: 0.866821
	class 7: 0.8645629
	class 8: 0.78155816
	class 9: 0.3187645
	class 10: 0.6115956
	class 11: 0.560254
	class 12: 0.7532071
	class 13: 0.71831155
	class 14: 0.8117163
	class 15: 0.80906165
	class 16: 0.0020176924
	class 17: 0.14063218
	class 18: 0.012484675
	class 19: 0.42843497
Class Acc:
	class 0: 0.9500532
	class 1: 0.91285646
	class 2: 0.9278903
	class 3: 0.90326315
	class 4: 0.7638191
	class 5: 0.8137044
	class 6: 0.92997575
	class 7: 0.931017
	class 8: 0.79953784
	class 9: 0.5572105
	class 10: 0.68227905
	class 11: 0.6560383
	class 12: 0.8346778
	class 13: 0.8301388
	class 14: 0.8796043
	class 15: 0.9452284
	class 16: 0.0020251551
	class 17: 0.1439786
	class 18: 0.013102188
	class 19: 0.801707

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.0351325124502182, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.0351325124502182, Class Loss=0.0351325124502182, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.10661874711513519, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.10661874711513519, Class Loss=0.10661874711513519, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.2530922293663025, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.2530922293663025, Class Loss=0.2530922293663025, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4775184988975525, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.4775184988975525, Class Loss=0.4775184988975525, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6555468440055847, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.6555468440055847, Class Loss=0.6555468440055847, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7343420386314392, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.7343420386314392, Class Loss=0.7343420386314392, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 1, Class Loss=0.03578420355916023, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.03578420355916023, Class Loss=0.03578420355916023, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.10170869529247284, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.10170869529247284, Class Loss=0.10170869529247284, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.25919309258461, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.25919309258461, Class Loss=0.25919309258461, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.47256073355674744, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.47256073355674744, Class Loss=0.47256073355674744, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6189777255058289, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.6189777255058289, Class Loss=0.6189777255058289, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7476022243499756, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.7476022243499756, Class Loss=0.7476022243499756, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.03252972289919853, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.03252972289919853, Class Loss=0.03252972289919853, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.07019606232643127, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.07019606232643127, Class Loss=0.07019606232643127, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.220632866024971, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.220632866024971, Class Loss=0.220632866024971, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.43819305300712585, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.43819305300712585, Class Loss=0.43819305300712585, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6709464192390442, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.6709464192390442, Class Loss=0.6709464192390442, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7676841020584106, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.7676841020584106, Class Loss=0.7676841020584106, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0
Epoch 1, Class Loss=0.04157208651304245, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.04157208651304245, Class Loss=0.04157208651304245, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.12635762989521027, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.12635762989521027, Class Loss=0.12635762989521027, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.2848464548587799, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.2848464548587799, Class Loss=0.2848464548587799, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4733413755893707, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.4733413755893707, Class Loss=0.4733413755893707, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6673002243041992, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.6673002243041992, Class Loss=0.6673002243041992, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.750834584236145, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.750834584236145, Class Loss=0.750834584236145, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.7054001688957214, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.876950
Mean Acc: 0.718292
FreqW Acc: 0.796684
Mean IoU: 0.569580
Class IoU:
	class 0: 0.86775637
	class 1: 0.725316
	class 2: 0.37022045
	class 3: 0.76075006
	class 4: 0.56700116
	class 5: 0.71512157
	class 6: 0.880659
	class 7: 0.8292703
	class 8: 0.7969145
	class 9: 0.342196
	class 10: 0.5927306
	class 11: 0.56405616
	class 12: 0.7561845
	class 13: 0.6421734
	class 14: 0.7601582
	class 15: 0.7945272
	class 16: 0.10267505
	class 17: 0.42007622
	class 18: 0.09606375
	class 19: 0.37731948
	class 20: 0.0
Class Acc:
	class 0: 0.9226219
	class 1: 0.94387835
	class 2: 0.9307894
	class 3: 0.9203276
	class 4: 0.81639814
	class 5: 0.8642613
	class 6: 0.9349477
	class 7: 0.9218892
	class 8: 0.8220495
	class 9: 0.5834195
	class 10: 0.6961963
	class 11: 0.65690446
	class 12: 0.88349074
	class 13: 0.880909
	class 14: 0.9134877
	class 15: 0.95097643
	class 16: 0.12020231
	class 17: 0.529542
	class 18: 0.14203909
	class 19: 0.649811
	class 20: 0.0

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.025932857766747475, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.025932857766747475, Class Loss=0.025932857766747475, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.08104215562343597, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.08104215562343597, Class Loss=0.08104215562343597, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.18564291298389435, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.18564291298389435, Class Loss=0.18564291298389435, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3624282479286194, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.3624282479286194, Class Loss=0.3624282479286194, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5530011057853699, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.5530011057853699, Class Loss=0.5530011057853699, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6742960214614868, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.6742960214614868, Class Loss=0.6742960214614868, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02777888812124729, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.02777888812124729, Class Loss=0.02777888812124729, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.07444408535957336, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.07444408535957336, Class Loss=0.07444408535957336, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.1723983734846115, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.1723983734846115, Class Loss=0.1723983734846115, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3686746656894684, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.3686746656894684, Class Loss=0.3686746656894684, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5180503726005554, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.5180503726005554, Class Loss=0.5180503726005554, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6320808529853821, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.6320808529853821, Class Loss=0.6320808529853821, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.8000552654266357, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.8000552654266357, Class Loss=0.8000552654266357, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7470556497573853, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.7470556497573853, Class Loss=0.7470556497573853, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.6804267764091492, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.6804267764091492, Class Loss=0.6804267764091492, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.6535181999206543, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.6535181999206543, Class Loss=0.6535181999206543, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.6199038624763489, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.6199038624763489, Class Loss=0.6199038624763489, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.6071932315826416, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.6071932315826416, Class Loss=0.6071932315826416, Reg Loss=0.0
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.024900883436203003, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.024900883436203003, Class Loss=0.024900883436203003, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.06948617845773697, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.06948617845773697, Class Loss=0.06948617845773697, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.18972134590148926, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.18972134590148926, Class Loss=0.18972134590148926, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3790566325187683, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.3790566325187683, Class Loss=0.3790566325187683, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.5359690189361572, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.5359690189361572, Class Loss=0.5359690189361572, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6418474912643433, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.6418474912643433, Class Loss=0.6418474912643433, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6071158647537231, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.884945
Mean Acc: 0.702640
FreqW Acc: 0.801316
Mean IoU: 0.570054
Class IoU:
	class 0: 0.873954
	class 1: 0.73545104
	class 2: 0.37558058
	class 3: 0.75081533
	class 4: 0.57875067
	class 5: 0.73509693
	class 6: 0.86610115
	class 7: 0.8374814
	class 8: 0.80659103
	class 9: 0.35642326
	class 10: 0.60120326
	class 11: 0.56952095
	class 12: 0.75784147
	class 13: 0.6613039
	class 14: 0.77196103
	class 15: 0.789249
	class 16: 0.06902902
	class 17: 0.35206982
	class 18: 0.052523464
	class 19: 0.4301885
	class 20: 0.0
Class Acc:
	class 0: 0.94049907
	class 1: 0.9478561
	class 2: 0.92632425
	class 3: 0.91969985
	class 4: 0.81263596
	class 5: 0.87793046
	class 6: 0.9498154
	class 7: 0.9311119
	class 8: 0.8358855
	class 9: 0.5649347
	class 10: 0.70167
	class 11: 0.6594575
	class 12: 0.87279207
	class 13: 0.8665949
	class 14: 0.902137
	class 15: 0.95412123
	class 16: 0.07487383
	class 17: 0.42544356
	class 18: 0.062020056
	class 19: 0.5296341
	class 20: 0.0

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02918919548392296, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.02918919548392296, Class Loss=0.02918919548392296, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.08425542712211609, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.08425542712211609, Class Loss=0.08425542712211609, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.17732244729995728, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.17732244729995728, Class Loss=0.17732244729995728, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.32266440987586975, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.32266440987586975, Class Loss=0.32266440987586975, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.4996870458126068, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.4996870458126068, Class Loss=0.4996870458126068, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.6172552704811096, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.6172552704811096, Class Loss=0.6172552704811096, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03487882390618324, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.03487882390618324, Class Loss=0.03487882390618324, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.08146568387746811, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.08146568387746811, Class Loss=0.08146568387746811, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.1661948412656784, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.1661948412656784, Class Loss=0.1661948412656784, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.29839402437210083, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.29839402437210083, Class Loss=0.29839402437210083, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.47260475158691406, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.47260475158691406, Class Loss=0.47260475158691406, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.608530580997467, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.608530580997467, Class Loss=0.608530580997467, Reg Loss=0.0
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.7325356006622314, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.7325356006622314, Class Loss=0.7325356006622314, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.6759887337684631, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.6759887337684631, Class Loss=0.6759887337684631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.6463568806648254, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.6463568806648254, Class Loss=0.6463568806648254, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000655
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.6277876496315002, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.6277876496315002, Class Loss=0.6277876496315002, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.6083933711051941, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.6083933711051941, Class Loss=0.6083933711051941, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.5908298492431641, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.5908298492431641, Class Loss=0.5908298492431641, Reg Loss=0.0
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.023060450330376625, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.023060450330376625, Class Loss=0.023060450330376625, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.06885578483343124, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.06885578483343124, Class Loss=0.06885578483343124, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.167500302195549, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.167500302195549, Class Loss=0.167500302195549, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.30472034215927124, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.30472034215927124, Class Loss=0.30472034215927124, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.44954025745391846, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.44954025745391846, Class Loss=0.44954025745391846, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5852886438369751, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.5852886438369751, Class Loss=0.5852886438369751, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5956247448921204, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.885220
Mean Acc: 0.708130
FreqW Acc: 0.801837
Mean IoU: 0.568448
Class IoU:
	class 0: 0.87547326
	class 1: 0.7341598
	class 2: 0.3674553
	class 3: 0.7298063
	class 4: 0.5782497
	class 5: 0.74266803
	class 6: 0.8483552
	class 7: 0.8408594
	class 8: 0.8250157
	class 9: 0.35296276
	class 10: 0.5953744
	class 11: 0.5694145
	class 12: 0.75237715
	class 13: 0.65984637
	class 14: 0.7717475
	class 15: 0.78565145
	class 16: 0.07147827
	class 17: 0.34490037
	class 18: 0.042374007
	class 19: 0.43393618
	class 20: 0.0152932
Class Acc:
	class 0: 0.9380901
	class 1: 0.9476349
	class 2: 0.9307808
	class 3: 0.9271221
	class 4: 0.8097671
	class 5: 0.9011535
	class 6: 0.95844334
	class 7: 0.9372921
	class 8: 0.8587516
	class 9: 0.5883094
	class 10: 0.7036664
	class 11: 0.66753805
	class 12: 0.89689684
	class 13: 0.86753744
	class 14: 0.9133141
	class 15: 0.9545758
	class 16: 0.07749251
	class 17: 0.41039258
	class 18: 0.047733925
	class 19: 0.5189383
	class 20: 0.0152932

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02037934586405754, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.02037934586405754, Class Loss=0.02037934586405754, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.05661744624376297, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.05661744624376297, Class Loss=0.05661744624376297, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.15541842579841614, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.15541842579841614, Class Loss=0.15541842579841614, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.27911150455474854, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.27911150455474854, Class Loss=0.27911150455474854, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5078094601631165, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.5078094601631165, Class Loss=0.5078094601631165, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.6187118887901306, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.6187118887901306, Class Loss=0.6187118887901306, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.6763186454772949, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.6763186454772949, Class Loss=0.6763186454772949, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.6616479754447937, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.6616479754447937, Class Loss=0.6616479754447937, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.6326592564582825, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.6326592564582825, Class Loss=0.6326592564582825, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.605280876159668, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.605280876159668, Class Loss=0.605280876159668, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.5705907940864563, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.5705907940864563, Class Loss=0.5705907940864563, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.5793318748474121, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.5793318748474121, Class Loss=0.5793318748474121, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.701384425163269, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.701384425163269, Class Loss=0.701384425163269, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.6881244778633118, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.6881244778633118, Class Loss=0.6881244778633118, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.6535196900367737, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.6535196900367737, Class Loss=0.6535196900367737, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.6357774138450623, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.6357774138450623, Class Loss=0.6357774138450623, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.6052868366241455, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.6052868366241455, Class Loss=0.6052868366241455, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.6127037405967712, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.6127037405967712, Class Loss=0.6127037405967712, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.027860714122653008, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.027860714122653008, Class Loss=0.027860714122653008, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.07767487317323685, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.07767487317323685, Class Loss=0.07767487317323685, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.17572003602981567, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.17572003602981567, Class Loss=0.17572003602981567, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.31851115822792053, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.31851115822792053, Class Loss=0.31851115822792053, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4713841676712036, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.4713841676712036, Class Loss=0.4713841676712036, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.596275806427002, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.596275806427002, Class Loss=0.596275806427002, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5535662770271301, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.887418
Mean Acc: 0.690969
FreqW Acc: 0.802507
Mean IoU: 0.568313
Class IoU:
	class 0: 0.87788063
	class 1: 0.7625354
	class 2: 0.37652943
	class 3: 0.75104946
	class 4: 0.585582
	class 5: 0.7440647
	class 6: 0.84778225
	class 7: 0.85142416
	class 8: 0.81070393
	class 9: 0.3459981
	class 10: 0.5900986
	class 11: 0.5717006
	class 12: 0.75210667
	class 13: 0.68415624
	class 14: 0.79246706
	class 15: 0.7756428
	class 16: 0.046044808
	class 17: 0.25788015
	class 18: 0.018883461
	class 19: 0.40949768
	class 20: 0.08254741
Class Acc:
	class 0: 0.9487038
	class 1: 0.93909246
	class 2: 0.9226224
	class 3: 0.9127292
	class 4: 0.7863433
	class 5: 0.8781358
	class 6: 0.95456576
	class 7: 0.9302942
	class 8: 0.8389217
	class 9: 0.57329756
	class 10: 0.6874423
	class 11: 0.657732
	class 12: 0.87324196
	class 13: 0.85910976
	class 14: 0.9003026
	class 15: 0.9574822
	class 16: 0.04792083
	class 17: 0.28769016
	class 18: 0.019636823
	class 19: 0.45251018
	class 20: 0.082579024

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.6524360179901123, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.6524360179901123, Class Loss=0.6524360179901123, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.6413421034812927, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.6413421034812927, Class Loss=0.6413421034812927, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000372
Epoch 3, Class Loss=0.6306354999542236, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.6306354999542236, Class Loss=0.6306354999542236, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.605191707611084, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.605191707611084, Class Loss=0.605191707611084, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.5968964099884033, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.5968964099884033, Class Loss=0.5968964099884033, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.6102908253669739, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.6102908253669739, Class Loss=0.6102908253669739, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03077624924480915, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.03077624924480915, Class Loss=0.03077624924480915, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.06556413322687149, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.06556413322687149, Class Loss=0.06556413322687149, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.13111670315265656, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.13111670315265656, Class Loss=0.13111670315265656, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2512661814689636, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.2512661814689636, Class Loss=0.2512661814689636, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4016026556491852, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.4016026556491852, Class Loss=0.4016026556491852, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5377322435379028, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.5377322435379028, Class Loss=0.5377322435379028, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.6612975001335144, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.6612975001335144, Class Loss=0.6612975001335144, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.6403668522834778, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.6403668522834778, Class Loss=0.6403668522834778, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.6372343301773071, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.6372343301773071, Class Loss=0.6372343301773071, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.6164553761482239, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.6164553761482239, Class Loss=0.6164553761482239, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.6366684436798096, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.6366684436798096, Class Loss=0.6366684436798096, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.6121480464935303, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.6121480464935303, Class Loss=0.6121480464935303, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.027499839663505554, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.027499839663505554, Class Loss=0.027499839663505554, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.07421644777059555, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.07421644777059555, Class Loss=0.07421644777059555, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.14114812016487122, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.14114812016487122, Class Loss=0.14114812016487122, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.2998889684677124, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.2998889684677124, Class Loss=0.2998889684677124, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4550727307796478, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.4550727307796478, Class Loss=0.4550727307796478, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5753415822982788, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.5753415822982788, Class Loss=0.5753415822982788, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5582193732261658, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.887578
Mean Acc: 0.699512
FreqW Acc: 0.803593
Mean IoU: 0.570930
Class IoU:
	class 0: 0.87866515
	class 1: 0.7564227
	class 2: 0.37271586
	class 3: 0.73152333
	class 4: 0.58394796
	class 5: 0.74274224
	class 6: 0.84182465
	class 7: 0.8450892
	class 8: 0.8210925
	class 9: 0.3433889
	class 10: 0.5917184
	class 11: 0.57272774
	class 12: 0.74625844
	class 13: 0.6830454
	class 14: 0.7913944
	class 15: 0.77719355
	class 16: 0.052611373
	class 17: 0.26733872
	class 18: 0.01927769
	class 19: 0.41990665
	class 20: 0.15064576
Class Acc:
	class 0: 0.9455259
	class 1: 0.94086784
	class 2: 0.92554444
	class 3: 0.9202947
	class 4: 0.7923427
	class 5: 0.8867543
	class 6: 0.95238155
	class 7: 0.9345487
	class 8: 0.8503053
	class 9: 0.57733506
	class 10: 0.69537705
	class 11: 0.66910774
	class 12: 0.89129066
	class 13: 0.85431176
	class 14: 0.89973646
	class 15: 0.95818305
	class 16: 0.05503756
	class 17: 0.29880193
	class 18: 0.020047648
	class 19: 0.46960267
	class 20: 0.15234698

voc_15-1_OURS-FRC On GPUs 0
Run in 30459s
