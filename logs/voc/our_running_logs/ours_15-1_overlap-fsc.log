nohup: ignoring input
30
kvoc_15-1_OURS-FSC On GPUs 0\Writing in results/seed_2023-ov/2023-03-16_voc_15-1_OURS-FSC.csv
Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 0, step: 0
select part of clients to conduct local training
[6, 7, 9, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 1, step: 0
select part of clients to conduct local training
[1, 7, 2, 9]
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  7
Current Client Index:  2
Current Client Index:  9
federated aggregation...
federated global round: 2, step: 0
select part of clients to conduct local training
[8, 6, 2, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  6
Current Client Index:  2
Current Client Index:  7
federated aggregation...
federated global round: 3, step: 0
select part of clients to conduct local training
[9, 5, 0, 3]
Current Client Index:  9
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
federated aggregation...
federated global round: 4, step: 0
select part of clients to conduct local training
[7, 1, 6, 8]
Current Client Index:  7
Current Client Index:  1
Current Client Index:  6
Current Client Index:  8
federated aggregation...
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
Validation, Class Loss=0.1457791030406952, Reg Loss=0.0 (without scaling)

Total samples: 1240.000000
Overall Acc: 0.951776
Mean Acc: 0.881545
FreqW Acc: 0.912099
Mean IoU: 0.794359
Class IoU:
	class 0: 0.9435678441258032
	class 1: 0.9052423932314888
	class 2: 0.4213606004092534
	class 3: 0.8972771305496867
	class 4: 0.6901223685917613
	class 5: 0.8225643420979045
	class 6: 0.9389549813330007
	class 7: 0.9135277370452521
	class 8: 0.9198215099829363
	class 9: 0.43938349027396006
	class 10: 0.7777990824907851
	class 11: 0.6195788152128043
	class 12: 0.864871312975591
	class 13: 0.807772381198587
	class 14: 0.8770910277444374
	class 15: 0.8708080530270558
Class Acc:
	class 0: 0.973328795212368
	class 1: 0.9683061028854518
	class 2: 0.9023232645390187
	class 3: 0.9371807751986593
	class 4: 0.8242437144899553
	class 5: 0.9136934141450599
	class 6: 0.9610899155454063
	class 7: 0.9434665268341859
	class 8: 0.9562913760377284
	class 9: 0.5435478064083014
	class 10: 0.8131002178976983
	class 11: 0.6503240044823576
	class 12: 0.9597874531163153
	class 13: 0.8984842680642833
	class 14: 0.9376804242841374
	class 15: 0.9218656821409732

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 5, step: 1
select part of clients to conduct local training
[3, 6, 12, 0]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ImportError("/lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/apex-0.1-py3.6-linux-x86_64.egg/amp_C.cpython-36m-x86_64-linux-gnu.so)",)
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
/home/amax/anaconda3/envs/FCIL/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:127: UserWarning: Seems like `optimizer.step()` has been overridden after learning rate scheduler initialization. Please, make sure to call `optimizer.step()` before `lr_scheduler.step()`. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch 1, Class Loss=0.5156630277633667, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.5156630277633667, Class Loss=0.5156630277633667, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4270564317703247, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.4270564317703247, Class Loss=0.4270564317703247, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.41342806816101074, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.41342806816101074, Class Loss=0.41342806816101074, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.41469377279281616, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.41469377279281616, Class Loss=0.41469377279281616, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4569043815135956, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.4569043815135956, Class Loss=0.4569043815135956, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.457954078912735, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.457954078912735, Class Loss=0.457954078912735, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5139745473861694, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.5139745473861694, Class Loss=0.5139745473861694, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.40845417976379395, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.40845417976379395, Class Loss=0.40845417976379395, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4089401066303253, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.4089401066303253, Class Loss=0.4089401066303253, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.42502307891845703, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.42502307891845703, Class Loss=0.42502307891845703, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.45080509781837463, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.45080509781837463, Class Loss=0.45080509781837463, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4566182792186737, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.4566182792186737, Class Loss=0.4566182792186737, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.5201985836029053, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.5201985836029053, Class Loss=0.5201985836029053, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.4188942611217499, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.4188942611217499, Class Loss=0.4188942611217499, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.41414016485214233, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.41414016485214233, Class Loss=0.41414016485214233, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4433331787586212, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.4433331787586212, Class Loss=0.4433331787586212, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.46106231212615967, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.46106231212615967, Class Loss=0.46106231212615967, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.4752458333969116, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.4752458333969116, Class Loss=0.4752458333969116, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.46561408042907715, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.46561408042907715, Class Loss=0.46561408042907715, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.3999564051628113, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.3999564051628113, Class Loss=0.3999564051628113, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.3861876428127289, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.3861876428127289, Class Loss=0.3861876428127289, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4052177965641022, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.4052177965641022, Class Loss=0.4052177965641022, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.427384614944458, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.427384614944458, Class Loss=0.427384614944458, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.439358115196228, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.439358115196228, Class Loss=0.439358115196228, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.3278377652168274, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.920600
Mean Acc: 0.866927
FreqW Acc: 0.862509
Mean IoU: 0.691279
Class IoU:
	class 0: 0.9045055
	class 1: 0.7391783
	class 2: 0.37177706
	class 3: 0.83964634
	class 4: 0.6137344
	class 5: 0.7306643
	class 6: 0.91093636
	class 7: 0.8738809
	class 8: 0.8587936
	class 9: 0.4350343
	class 10: 0.6997278
	class 11: 0.60170907
	class 12: 0.79791194
	class 13: 0.7217569
	class 14: 0.82913005
	class 15: 0.8233616
	class 16: 0.0
Class Acc:
	class 0: 0.9222247
	class 1: 0.99554604
	class 2: 0.93698555
	class 3: 0.9666538
	class 4: 0.8731413
	class 5: 0.9547009
	class 6: 0.9906928
	class 7: 0.96504354
	class 8: 0.9631767
	class 9: 0.74514157
	class 10: 0.8137351
	class 11: 0.7463784
	class 12: 0.98533326
	class 13: 0.96358186
	class 14: 0.96118957
	class 15: 0.95422673
	class 16: 0.0

federated global round: 6, step: 1
select part of clients to conduct local training
[0, 2, 8, 4]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.4364195168018341, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.4364195168018341, Class Loss=0.4364195168018341, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.4747534990310669, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.4747534990310669, Class Loss=0.4747534990310669, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.43921375274658203, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.43921375274658203, Class Loss=0.43921375274658203, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.4400990903377533, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.4400990903377533, Class Loss=0.4400990903377533, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4259475767612457, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.4259475767612457, Class Loss=0.4259475767612457, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.4077877104282379, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.4077877104282379, Class Loss=0.4077877104282379, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.38408103585243225, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.38408103585243225, Class Loss=0.38408103585243225, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.3988766670227051, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.3988766670227051, Class Loss=0.3988766670227051, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3885954022407532, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.3885954022407532, Class Loss=0.3885954022407532, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4017597734928131, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.4017597734928131, Class Loss=0.4017597734928131, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.42308861017227173, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.42308861017227173, Class Loss=0.42308861017227173, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.40742209553718567, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.40742209553718567, Class Loss=0.40742209553718567, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.374830037355423, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.374830037355423, Class Loss=0.374830037355423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.39770475029945374, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.39770475029945374, Class Loss=0.39770475029945374, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.40299588441848755, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.40299588441848755, Class Loss=0.40299588441848755, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.41098690032958984, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.41098690032958984, Class Loss=0.41098690032958984, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4192746877670288, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.4192746877670288, Class Loss=0.4192746877670288, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.4168850779533386, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.4168850779533386, Class Loss=0.4168850779533386, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.38022202253341675, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.38022202253341675, Class Loss=0.38022202253341675, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.37445464730262756, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.37445464730262756, Class Loss=0.37445464730262756, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.40081268548965454, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.40081268548965454, Class Loss=0.40081268548965454, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.41233718395233154, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.41233718395233154, Class Loss=0.41233718395233154, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4353886842727661, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.4353886842727661, Class Loss=0.4353886842727661, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 6, Class Loss=0.4075678288936615, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.4075678288936615, Class Loss=0.4075678288936615, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.3265399932861328, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.920208
Mean Acc: 0.875631
FreqW Acc: 0.862256
Mean IoU: 0.696246
Class IoU:
	class 0: 0.9032691
	class 1: 0.7399455
	class 2: 0.3691913
	class 3: 0.8286647
	class 4: 0.61953443
	class 5: 0.70457065
	class 6: 0.9108598
	class 7: 0.8786411
	class 8: 0.86374664
	class 9: 0.43801922
	class 10: 0.69717026
	class 11: 0.59301066
	class 12: 0.79257137
	class 13: 0.7384189
	class 14: 0.82921237
	class 15: 0.82421815
	class 16: 0.10513056
Class Acc:
	class 0: 0.91949093
	class 1: 0.9956351
	class 2: 0.94047236
	class 3: 0.9688382
	class 4: 0.8758118
	class 5: 0.96092695
	class 6: 0.99145585
	class 7: 0.96256536
	class 8: 0.97368175
	class 9: 0.73120755
	class 10: 0.83144414
	class 11: 0.75514907
	class 12: 0.9875819
	class 13: 0.959786
	class 14: 0.9671296
	class 15: 0.95401233
	class 16: 0.11053321

federated global round: 7, step: 1
select part of clients to conduct local training
[9, 13, 1, 11]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.3307659924030304, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.3307659924030304, Class Loss=0.3307659924030304, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.338958740234375, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.338958740234375, Class Loss=0.338958740234375, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.33300554752349854, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.33300554752349854, Class Loss=0.33300554752349854, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3561249375343323, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.3561249375343323, Class Loss=0.3561249375343323, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.36057794094085693, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.36057794094085693, Class Loss=0.36057794094085693, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3571231961250305, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.3571231961250305, Class Loss=0.3571231961250305, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.338200181722641, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.338200181722641, Class Loss=0.338200181722641, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3459841012954712, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.3459841012954712, Class Loss=0.3459841012954712, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.34767118096351624, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.34767118096351624, Class Loss=0.34767118096351624, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.3767722547054291, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.3767722547054291, Class Loss=0.3767722547054291, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3980492055416107, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.3980492055416107, Class Loss=0.3980492055416107, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3709978461265564, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.3709978461265564, Class Loss=0.3709978461265564, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2922431528568268, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.2922431528568268, Class Loss=0.2922431528568268, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.304019033908844, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.304019033908844, Class Loss=0.304019033908844, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.32563984394073486, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.32563984394073486, Class Loss=0.32563984394073486, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.33727195858955383, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.33727195858955383, Class Loss=0.33727195858955383, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.34629595279693604, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.34629595279693604, Class Loss=0.34629595279693604, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.35491305589675903, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.35491305589675903, Class Loss=0.35491305589675903, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2983343303203583, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.2983343303203583, Class Loss=0.2983343303203583, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3191843032836914, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.3191843032836914, Class Loss=0.3191843032836914, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.32691124081611633, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.32691124081611633, Class Loss=0.32691124081611633, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.34748324751853943, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.34748324751853943, Class Loss=0.34748324751853943, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3455534875392914, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.3455534875392914, Class Loss=0.3455534875392914, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.3586486577987671, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.3586486577987671, Class Loss=0.3586486577987671, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.3098495602607727, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.919200
Mean Acc: 0.885666
FreqW Acc: 0.863443
Mean IoU: 0.705661
Class IoU:
	class 0: 0.90233916
	class 1: 0.76666194
	class 2: 0.3706424
	class 3: 0.83792025
	class 4: 0.6231917
	class 5: 0.7169058
	class 6: 0.91868645
	class 7: 0.8921828
	class 8: 0.85792655
	class 9: 0.44397414
	class 10: 0.68946123
	class 11: 0.594268
	class 12: 0.79886085
	class 13: 0.7233493
	class 14: 0.8342306
	class 15: 0.82959765
	class 16: 0.19602987
Class Acc:
	class 0: 0.9173284
	class 1: 0.9943757
	class 2: 0.93998504
	class 3: 0.97240025
	class 4: 0.86661613
	class 5: 0.9602675
	class 6: 0.9876274
	class 7: 0.9606922
	class 8: 0.97187585
	class 9: 0.69375354
	class 10: 0.7903934
	class 11: 0.74993694
	class 12: 0.9852338
	class 13: 0.96012294
	class 14: 0.9687186
	class 15: 0.95478934
	class 16: 0.38220778

federated global round: 8, step: 1
select part of clients to conduct local training
[8, 5, 2, 9]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.3743152320384979, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.3743152320384979, Class Loss=0.3743152320384979, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3704547882080078, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.3704547882080078, Class Loss=0.3704547882080078, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.35277852416038513, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.35277852416038513, Class Loss=0.35277852416038513, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.35275259613990784, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.35275259613990784, Class Loss=0.35275259613990784, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.3517363667488098, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.3517363667488098, Class Loss=0.3517363667488098, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.33910322189331055, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.33910322189331055, Class Loss=0.33910322189331055, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.26040130853652954, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.26040130853652954, Class Loss=0.26040130853652954, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.277651846408844, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.277651846408844, Class Loss=0.277651846408844, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2928420603275299, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.2928420603275299, Class Loss=0.2928420603275299, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.33648306131362915, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.33648306131362915, Class Loss=0.33648306131362915, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.33602142333984375, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.33602142333984375, Class Loss=0.33602142333984375, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.3348805606365204, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.3348805606365204, Class Loss=0.3348805606365204, Reg Loss=0.0
Current Client Index:  2
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.3790702521800995, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.3790702521800995, Class Loss=0.3790702521800995, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.3682990074157715, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.3682990074157715, Class Loss=0.3682990074157715, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.3534291982650757, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.3534291982650757, Class Loss=0.3534291982650757, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.35674452781677246, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.35674452781677246, Class Loss=0.35674452781677246, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.3552207052707672, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.3552207052707672, Class Loss=0.3552207052707672, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.3525086045265198, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.3525086045265198, Class Loss=0.3525086045265198, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.37490537762641907, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.37490537762641907, Class Loss=0.37490537762641907, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.360733300447464, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.360733300447464, Class Loss=0.360733300447464, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.35907042026519775, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.35907042026519775, Class Loss=0.35907042026519775, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.36158183217048645, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.36158183217048645, Class Loss=0.36158183217048645, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.3477446734905243, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.3477446734905243, Class Loss=0.3477446734905243, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.3291369378566742, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.3291369378566742, Class Loss=0.3291369378566742, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.2957784831523895, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.917795
Mean Acc: 0.888893
FreqW Acc: 0.864027
Mean IoU: 0.711677
Class IoU:
	class 0: 0.89958245
	class 1: 0.7824947
	class 2: 0.37137717
	class 3: 0.8584776
	class 4: 0.6323524
	class 5: 0.72003746
	class 6: 0.9212744
	class 7: 0.8949417
	class 8: 0.8658098
	class 9: 0.44336098
	class 10: 0.7190717
	class 11: 0.5922645
	class 12: 0.80506384
	class 13: 0.7605615
	class 14: 0.83321273
	class 15: 0.8392208
	class 16: 0.1593978
Class Acc:
	class 0: 0.91498435
	class 1: 0.994126
	class 2: 0.9390576
	class 3: 0.96686286
	class 4: 0.8672251
	class 5: 0.9641393
	class 6: 0.989366
	class 7: 0.96025765
	class 8: 0.96776134
	class 9: 0.67441756
	class 10: 0.8244341
	class 11: 0.74569625
	class 12: 0.985878
	class 13: 0.9550368
	class 14: 0.96924794
	class 15: 0.95058274
	class 16: 0.44210553

federated global round: 9, step: 1
select part of clients to conduct local training
[8, 9, 12, 4]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.36101245880126953, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.36101245880126953, Class Loss=0.36101245880126953, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.3403792083263397, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.3403792083263397, Class Loss=0.3403792083263397, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.33635902404785156, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.33635902404785156, Class Loss=0.33635902404785156, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.34579652547836304, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.34579652547836304, Class Loss=0.34579652547836304, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.34070852398872375, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.34070852398872375, Class Loss=0.34070852398872375, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.3396983742713928, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.3396983742713928, Class Loss=0.3396983742713928, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.3374200761318207, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.3374200761318207, Class Loss=0.3374200761318207, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.32649120688438416, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.32649120688438416, Class Loss=0.32649120688438416, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.33702337741851807, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.33702337741851807, Class Loss=0.33702337741851807, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.3422456681728363, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.3422456681728363, Class Loss=0.3422456681728363, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.33235597610473633, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.33235597610473633, Class Loss=0.33235597610473633, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.3341445028781891, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.3341445028781891, Class Loss=0.3341445028781891, Reg Loss=0.0
Current Client Index:  12
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.36230459809303284, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.36230459809303284, Class Loss=0.36230459809303284, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.3483988344669342, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.3483988344669342, Class Loss=0.3483988344669342, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.34184661507606506, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.34184661507606506, Class Loss=0.34184661507606506, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.3403242230415344, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.3403242230415344, Class Loss=0.3403242230415344, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.33733388781547546, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.33733388781547546, Class Loss=0.33733388781547546, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.32917025685310364, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.32917025685310364, Class Loss=0.32917025685310364, Reg Loss=0.0
Current Client Index:  4
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.34067124128341675, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.34067124128341675, Class Loss=0.34067124128341675, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000655
Epoch 2, Class Loss=0.3328552842140198, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.3328552842140198, Class Loss=0.3328552842140198, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.33751046657562256, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.33751046657562256, Class Loss=0.33751046657562256, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000414
Epoch 4, Class Loss=0.3384420871734619, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.3384420871734619, Class Loss=0.3384420871734619, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000287
Epoch 5, Class Loss=0.3432227373123169, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.3432227373123169, Class Loss=0.3432227373123169, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000154
Epoch 6, Class Loss=0.3352915942668915, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.3352915942668915, Class Loss=0.3352915942668915, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.28670021891593933, Reg Loss=0.0 (without scaling)

Total samples: 1277.000000
Overall Acc: 0.919063
Mean Acc: 0.889016
FreqW Acc: 0.865864
Mean IoU: 0.714947
Class IoU:
	class 0: 0.90091664
	class 1: 0.7913659
	class 2: 0.37781027
	class 3: 0.8617723
	class 4: 0.6351539
	class 5: 0.7186943
	class 6: 0.9222768
	class 7: 0.8965932
	class 8: 0.86959255
	class 9: 0.4408995
	class 10: 0.7273909
	class 11: 0.58967453
	class 12: 0.8111605
	class 13: 0.7734469
	class 14: 0.84037435
	class 15: 0.8391984
	class 16: 0.15778188
Class Acc:
	class 0: 0.91644937
	class 1: 0.9929568
	class 2: 0.932726
	class 3: 0.96618545
	class 4: 0.8633153
	class 5: 0.96345526
	class 6: 0.98911613
	class 7: 0.95937115
	class 8: 0.9694208
	class 9: 0.68282574
	class 10: 0.8411862
	class 11: 0.7472027
	class 12: 0.9848878
	class 13: 0.9554988
	class 14: 0.9694096
	class 15: 0.95111424
	class 16: 0.4281458

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 10, step: 2
select part of clients to conduct local training
[14, 6, 0, 16]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4515751302242279, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.4515751302242279, Class Loss=0.4515751302242279, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6530857682228088, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.6530857682228088, Class Loss=0.6530857682228088, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7767861485481262, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.7767861485481262, Class Loss=0.7767861485481262, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8402042984962463, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.8402042984962463, Class Loss=0.8402042984962463, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.8310345411300659, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.8310345411300659, Class Loss=0.8310345411300659, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.775122880935669, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.775122880935669, Class Loss=0.775122880935669, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4102729260921478, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.4102729260921478, Class Loss=0.4102729260921478, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.7814561128616333, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.7814561128616333, Class Loss=0.7814561128616333, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8226134181022644, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.8226134181022644, Class Loss=0.8226134181022644, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8312007784843445, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.8312007784843445, Class Loss=0.8312007784843445, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7923722267150879, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.7923722267150879, Class Loss=0.7923722267150879, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7492120265960693, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.7492120265960693, Class Loss=0.7492120265960693, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4361916184425354, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.4361916184425354, Class Loss=0.4361916184425354, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6132462620735168, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.6132462620735168, Class Loss=0.6132462620735168, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.8157843947410583, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.8157843947410583, Class Loss=0.8157843947410583, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8439601063728333, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.8439601063728333, Class Loss=0.8439601063728333, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7862704992294312, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.7862704992294312, Class Loss=0.7862704992294312, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7943633198738098, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.7943633198738098, Class Loss=0.7943633198738098, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.4586627781391144, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.4586627781391144, Class Loss=0.4586627781391144, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.6755574941635132, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.6755574941635132, Class Loss=0.6755574941635132, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.7509642243385315, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.7509642243385315, Class Loss=0.7509642243385315, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.8427172303199768, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.8427172303199768, Class Loss=0.8427172303199768, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7919955253601074, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.7919955253601074, Class Loss=0.7919955253601074, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7241767644882202, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.7241767644882202, Class Loss=0.7241767644882202, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5120847225189209, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.888945
Mean Acc: 0.800210
FreqW Acc: 0.826720
Mean IoU: 0.652765
Class IoU:
	class 0: 0.8677411
	class 1: 0.8368975
	class 2: 0.3707205
	class 3: 0.7877176
	class 4: 0.56212795
	class 5: 0.74085116
	class 6: 0.9186399
	class 7: 0.8659897
	class 8: 0.88491243
	class 9: 0.4134153
	class 10: 0.6702813
	class 11: 0.56756425
	class 12: 0.82268775
	class 13: 0.75885415
	class 14: 0.82659954
	class 15: 0.7619099
	class 16: 0.09222761
	class 17: 0.0006315136
Class Acc:
	class 0: 0.90247613
	class 1: 0.94747424
	class 2: 0.9083158
	class 3: 0.8032259
	class 4: 0.81879723
	class 5: 0.9259733
	class 6: 0.97749
	class 7: 0.95203304
	class 8: 0.9222434
	class 9: 0.65104795
	class 10: 0.79341954
	class 11: 0.6280686
	class 12: 0.91981834
	class 13: 0.8394947
	class 14: 0.925145
	class 15: 0.9557808
	class 16: 0.53234863
	class 17: 0.0006315511

federated global round: 11, step: 2
select part of clients to conduct local training
[0, 12, 10, 17]
Current Client Index:  0
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.7520876526832581, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.7520876526832581, Class Loss=0.7520876526832581, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7025879621505737, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.7025879621505737, Class Loss=0.7025879621505737, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7148158550262451, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.7148158550262451, Class Loss=0.7148158550262451, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.6113554239273071, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.6113554239273071, Class Loss=0.6113554239273071, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5898465514183044, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.5898465514183044, Class Loss=0.5898465514183044, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5887883901596069, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.5887883901596069, Class Loss=0.5887883901596069, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2769778370857239, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.2769778370857239, Class Loss=0.2769778370857239, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.43481239676475525, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.43481239676475525, Class Loss=0.43481239676475525, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5838357210159302, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.5838357210159302, Class Loss=0.5838357210159302, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5981398820877075, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.5981398820877075, Class Loss=0.5981398820877075, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6013575196266174, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.6013575196266174, Class Loss=0.6013575196266174, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5981538891792297, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.5981538891792297, Class Loss=0.5981538891792297, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2367161214351654, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.2367161214351654, Class Loss=0.2367161214351654, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.44435861706733704, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.44435861706733704, Class Loss=0.44435861706733704, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5493212342262268, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.5493212342262268, Class Loss=0.5493212342262268, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.642479419708252, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.642479419708252, Class Loss=0.642479419708252, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6370292901992798, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.6370292901992798, Class Loss=0.6370292901992798, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5984806418418884, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.5984806418418884, Class Loss=0.5984806418418884, Reg Loss=0.0
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.23604121804237366, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.23604121804237366, Class Loss=0.23604121804237366, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.40543290972709656, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.40543290972709656, Class Loss=0.40543290972709656, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.5330719947814941, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.5330719947814941, Class Loss=0.5330719947814941, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5855831503868103, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.5855831503868103, Class Loss=0.5855831503868103, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6303730607032776, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.6303730607032776, Class Loss=0.6303730607032776, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5952589511871338, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.5952589511871338, Class Loss=0.5952589511871338, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.47338229417800903, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.902535
Mean Acc: 0.827235
FreqW Acc: 0.844217
Mean IoU: 0.674299
Class IoU:
	class 0: 0.889395
	class 1: 0.8190127
	class 2: 0.36113235
	class 3: 0.8035276
	class 4: 0.5325727
	class 5: 0.737349
	class 6: 0.90872717
	class 7: 0.8693446
	class 8: 0.87196976
	class 9: 0.4234122
	class 10: 0.60571617
	class 11: 0.57742
	class 12: 0.7901848
	class 13: 0.7552831
	class 14: 0.8209466
	class 15: 0.75676525
	class 16: 0.09547099
	class 17: 0.51914483
Class Acc:
	class 0: 0.91481405
	class 1: 0.9369761
	class 2: 0.9101829
	class 3: 0.82494503
	class 4: 0.83179736
	class 5: 0.9404027
	class 6: 0.9828878
	class 7: 0.94716984
	class 8: 0.9313857
	class 9: 0.64865184
	class 10: 0.637903
	class 11: 0.65808076
	class 12: 0.88908815
	class 13: 0.89278734
	class 14: 0.90517765
	class 15: 0.9639772
	class 16: 0.37561077
	class 17: 0.6984016

federated global round: 12, step: 2
select part of clients to conduct local training
[14, 8, 16, 3]
Current Client Index:  14
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.5851001143455505, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.5851001143455505, Class Loss=0.5851001143455505, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.5742753744125366, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.5742753744125366, Class Loss=0.5742753744125366, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.5826058983802795, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.5826058983802795, Class Loss=0.5826058983802795, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.5385817289352417, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.5385817289352417, Class Loss=0.5385817289352417, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.5044214725494385, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.5044214725494385, Class Loss=0.5044214725494385, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.4733218252658844, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.4733218252658844, Class Loss=0.4733218252658844, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1985897421836853, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.1985897421836853, Class Loss=0.1985897421836853, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.3230011761188507, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.3230011761188507, Class Loss=0.3230011761188507, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.40673738718032837, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.40673738718032837, Class Loss=0.40673738718032837, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4518677592277527, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.4518677592277527, Class Loss=0.4518677592277527, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.4920853078365326, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.4920853078365326, Class Loss=0.4920853078365326, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.48395588994026184, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.48395588994026184, Class Loss=0.48395588994026184, Reg Loss=0.0
Current Client Index:  16
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.5610798001289368, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.5610798001289368, Class Loss=0.5610798001289368, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.528538167476654, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.528538167476654, Class Loss=0.528538167476654, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.5237469673156738, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.5237469673156738, Class Loss=0.5237469673156738, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.5123885869979858, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.5123885869979858, Class Loss=0.5123885869979858, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.4908362627029419, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.4908362627029419, Class Loss=0.4908362627029419, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.42538338899612427, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.42538338899612427, Class Loss=0.42538338899612427, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.2148917317390442, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.2148917317390442, Class Loss=0.2148917317390442, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.35720109939575195, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.35720109939575195, Class Loss=0.35720109939575195, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.41708654165267944, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.41708654165267944, Class Loss=0.41708654165267944, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.469756543636322, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.469756543636322, Class Loss=0.469756543636322, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.48851317167282104, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.48851317167282104, Class Loss=0.48851317167282104, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.48285502195358276, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.48285502195358276, Class Loss=0.48285502195358276, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.41661617159843445, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.912947
Mean Acc: 0.824342
FreqW Acc: 0.856288
Mean IoU: 0.677139
Class IoU:
	class 0: 0.9043761
	class 1: 0.82492125
	class 2: 0.36834386
	class 3: 0.80020094
	class 4: 0.5441299
	class 5: 0.7508519
	class 6: 0.9129507
	class 7: 0.8774786
	class 8: 0.87210995
	class 9: 0.4200325
	class 10: 0.61634785
	class 11: 0.5820712
	class 12: 0.79588515
	class 13: 0.7607158
	class 14: 0.81999934
	class 15: 0.77315724
	class 16: 0.10250305
	class 17: 0.46242788
Class Acc:
	class 0: 0.9309499
	class 1: 0.9238436
	class 2: 0.9131172
	class 3: 0.82341874
	class 4: 0.8390101
	class 5: 0.9295989
	class 6: 0.9802925
	class 7: 0.9406885
	class 8: 0.9142015
	class 9: 0.62923
	class 10: 0.65453774
	class 11: 0.6528968
	class 12: 0.8707868
	class 13: 0.89121497
	class 14: 0.89957136
	class 15: 0.9641709
	class 16: 0.2391898
	class 17: 0.84144217

federated global round: 13, step: 2
select part of clients to conduct local training
[17, 13, 11, 7]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.44797152280807495, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.44797152280807495, Class Loss=0.44797152280807495, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.4538037180900574, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.4538037180900574, Class Loss=0.4538037180900574, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.4374437928199768, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.4374437928199768, Class Loss=0.4374437928199768, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.4344337582588196, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.4344337582588196, Class Loss=0.4344337582588196, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.41632211208343506, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.41632211208343506, Class Loss=0.41632211208343506, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.39350056648254395, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.39350056648254395, Class Loss=0.39350056648254395, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14892517030239105, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.14892517030239105, Class Loss=0.14892517030239105, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.27766427397727966, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.27766427397727966, Class Loss=0.27766427397727966, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.34739071130752563, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.34739071130752563, Class Loss=0.34739071130752563, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.4054734706878662, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.4054734706878662, Class Loss=0.4054734706878662, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4152427911758423, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.4152427911758423, Class Loss=0.4152427911758423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.42501652240753174, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.42501652240753174, Class Loss=0.42501652240753174, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.13459378480911255, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.13459378480911255, Class Loss=0.13459378480911255, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2789769768714905, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.2789769768714905, Class Loss=0.2789769768714905, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3477685749530792, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.3477685749530792, Class Loss=0.3477685749530792, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.3897128999233246, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.3897128999233246, Class Loss=0.3897128999233246, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.41218307614326477, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.41218307614326477, Class Loss=0.41218307614326477, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.4363894462585449, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.4363894462585449, Class Loss=0.4363894462585449, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.13991431891918182, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.13991431891918182, Class Loss=0.13991431891918182, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.2513461112976074, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.2513461112976074, Class Loss=0.2513461112976074, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.3195429742336273, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.3195429742336273, Class Loss=0.3195429742336273, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.38520562648773193, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.38520562648773193, Class Loss=0.38520562648773193, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.45132333040237427, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.45132333040237427, Class Loss=0.45132333040237427, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.44115373492240906, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.44115373492240906, Class Loss=0.44115373492240906, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.3874392807483673, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.915149
Mean Acc: 0.820111
FreqW Acc: 0.858673
Mean IoU: 0.675595
Class IoU:
	class 0: 0.90813696
	class 1: 0.81699234
	class 2: 0.3752541
	class 3: 0.8132612
	class 4: 0.5425703
	class 5: 0.75610405
	class 6: 0.91996837
	class 7: 0.8786194
	class 8: 0.8728111
	class 9: 0.40915018
	class 10: 0.59321046
	class 11: 0.5776048
	class 12: 0.79887134
	class 13: 0.7733905
	class 14: 0.8171283
	class 15: 0.77295595
	class 16: 0.10062183
	class 17: 0.43405303
Class Acc:
	class 0: 0.93506515
	class 1: 0.9379918
	class 2: 0.89774626
	class 3: 0.8400431
	class 4: 0.8437226
	class 5: 0.928402
	class 6: 0.9796214
	class 7: 0.9406928
	class 8: 0.91731715
	class 9: 0.6127562
	class 10: 0.61851287
	class 11: 0.65744793
	class 12: 0.8645649
	class 13: 0.8750636
	class 14: 0.88677686
	class 15: 0.96684927
	class 16: 0.18365325
	class 17: 0.87576294

federated global round: 14, step: 2
select part of clients to conduct local training
[17, 4, 5, 2]
Current Client Index:  17
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000414
Epoch 1, Class Loss=0.40425777435302734, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.40425777435302734, Class Loss=0.40425777435302734, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000351
Epoch 2, Class Loss=0.4231773614883423, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.4231773614883423, Class Loss=0.4231773614883423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000287
Epoch 3, Class Loss=0.41028425097465515, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.41028425097465515, Class Loss=0.41028425097465515, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000222
Epoch 4, Class Loss=0.4013577699661255, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.4013577699661255, Class Loss=0.4013577699661255, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000154
Epoch 5, Class Loss=0.3969200849533081, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.3969200849533081, Class Loss=0.3969200849533081, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000082
Epoch 6, Class Loss=0.38349494338035583, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.38349494338035583, Class Loss=0.38349494338035583, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.12739388644695282, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.12739388644695282, Class Loss=0.12739388644695282, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.2254316508769989, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.2254316508769989, Class Loss=0.2254316508769989, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.29132285714149475, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.29132285714149475, Class Loss=0.29132285714149475, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.34976309537887573, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.34976309537887573, Class Loss=0.34976309537887573, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.3966420590877533, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.3966420590877533, Class Loss=0.3966420590877533, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.4020170271396637, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.4020170271396637, Class Loss=0.4020170271396637, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.14275607466697693, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.14275607466697693, Class Loss=0.14275607466697693, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.23807740211486816, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.23807740211486816, Class Loss=0.23807740211486816, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.31017038226127625, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.31017038226127625, Class Loss=0.31017038226127625, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3343644142150879, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.3343644142150879, Class Loss=0.3343644142150879, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.37667590379714966, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.37667590379714966, Class Loss=0.37667590379714966, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.3903004825115204, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.3903004825115204, Class Loss=0.3903004825115204, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1222287118434906, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.1222287118434906, Class Loss=0.1222287118434906, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.26295340061187744, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.26295340061187744, Class Loss=0.26295340061187744, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.3107399642467499, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.3107399642467499, Class Loss=0.3107399642467499, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3548343777656555, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.3548343777656555, Class Loss=0.3548343777656555, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.40325403213500977, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.40325403213500977, Class Loss=0.40325403213500977, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.4037345349788666, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.4037345349788666, Class Loss=0.4037345349788666, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.37257641553878784, Reg Loss=0.0 (without scaling)

Total samples: 1329.000000
Overall Acc: 0.917289
Mean Acc: 0.817322
FreqW Acc: 0.861338
Mean IoU: 0.676236
Class IoU:
	class 0: 0.9112847
	class 1: 0.8228825
	class 2: 0.37529704
	class 3: 0.814495
	class 4: 0.55191123
	class 5: 0.7593599
	class 6: 0.9196861
	class 7: 0.8824429
	class 8: 0.8736051
	class 9: 0.41209242
	class 10: 0.57649297
	class 11: 0.58386844
	class 12: 0.79604405
	class 13: 0.7661455
	class 14: 0.8196018
	class 15: 0.7812138
	class 16: 0.096331686
	class 17: 0.42948848
Class Acc:
	class 0: 0.93891025
	class 1: 0.93488675
	class 2: 0.899556
	class 3: 0.84249306
	class 4: 0.84524715
	class 5: 0.92580456
	class 6: 0.97920406
	class 7: 0.938519
	class 8: 0.91518945
	class 9: 0.61651206
	class 10: 0.5968952
	class 11: 0.6539162
	class 12: 0.87440383
	class 13: 0.8776655
	class 14: 0.88726115
	class 15: 0.96537805
	class 16: 0.1593481
	class 17: 0.8605991

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 15, step: 3
select part of clients to conduct local training
[17, 21, 10, 5]
Current Client Index:  17
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1180354505777359, Reg Loss=0.0
Clinet index 17, End of Epoch 1/6, Average Loss=0.1180354505777359, Class Loss=0.1180354505777359, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.23764759302139282, Reg Loss=0.0
Clinet index 17, End of Epoch 2/6, Average Loss=0.23764759302139282, Class Loss=0.23764759302139282, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4652099609375, Reg Loss=0.0
Clinet index 17, End of Epoch 3/6, Average Loss=0.4652099609375, Class Loss=0.4652099609375, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6251740455627441, Reg Loss=0.0
Clinet index 17, End of Epoch 4/6, Average Loss=0.6251740455627441, Class Loss=0.6251740455627441, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7339219450950623, Reg Loss=0.0
Clinet index 17, End of Epoch 5/6, Average Loss=0.7339219450950623, Class Loss=0.7339219450950623, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7771268486976624, Reg Loss=0.0
Clinet index 17, End of Epoch 6/6, Average Loss=0.7771268486976624, Class Loss=0.7771268486976624, Reg Loss=0.0
Current Client Index:  21
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1290530413389206, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.1290530413389206, Class Loss=0.1290530413389206, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.25452348589897156, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.25452348589897156, Class Loss=0.25452348589897156, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4614499509334564, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.4614499509334564, Class Loss=0.4614499509334564, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.6185722351074219, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.6185722351074219, Class Loss=0.6185722351074219, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.6987165808677673, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.6987165808677673, Class Loss=0.6987165808677673, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7516909837722778, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.7516909837722778, Class Loss=0.7516909837722778, Reg Loss=0.0
Current Client Index:  10
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1380559504032135, Reg Loss=0.0
Clinet index 10, End of Epoch 1/6, Average Loss=0.1380559504032135, Class Loss=0.1380559504032135, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.25639307498931885, Reg Loss=0.0
Clinet index 10, End of Epoch 2/6, Average Loss=0.25639307498931885, Class Loss=0.25639307498931885, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4316466748714447, Reg Loss=0.0
Clinet index 10, End of Epoch 3/6, Average Loss=0.4316466748714447, Class Loss=0.4316466748714447, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5986397862434387, Reg Loss=0.0
Clinet index 10, End of Epoch 4/6, Average Loss=0.5986397862434387, Class Loss=0.5986397862434387, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7198306918144226, Reg Loss=0.0
Clinet index 10, End of Epoch 5/6, Average Loss=0.7198306918144226, Class Loss=0.7198306918144226, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7443482279777527, Reg Loss=0.0
Clinet index 10, End of Epoch 6/6, Average Loss=0.7443482279777527, Class Loss=0.7443482279777527, Reg Loss=0.0
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.1291917860507965, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.1291917860507965, Class Loss=0.1291917860507965, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.24629415571689606, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.24629415571689606, Class Loss=0.24629415571689606, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.4415913224220276, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.4415913224220276, Class Loss=0.4415913224220276, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.5989604592323303, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.5989604592323303, Class Loss=0.5989604592323303, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.7148665189743042, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.7148665189743042, Class Loss=0.7148665189743042, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.7383794188499451, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.7383794188499451, Class Loss=0.7383794188499451, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.7569465041160583, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.841203
Mean Acc: 0.834240
FreqW Acc: 0.770538
Mean IoU: 0.602729
Class IoU:
	class 0: 0.81194836
	class 1: 0.7488313
	class 2: 0.33087605
	class 3: 0.783628
	class 4: 0.47811052
	class 5: 0.6533095
	class 6: 0.86975235
	class 7: 0.8789378
	class 8: 0.78497165
	class 9: 0.40313873
	class 10: 0.6048059
	class 11: 0.51099646
	class 12: 0.7509227
	class 13: 0.71710086
	class 14: 0.7623554
	class 15: 0.79242724
	class 16: 0.114230365
	class 17: 0.3367164
	class 18: 0.11879061
Class Acc:
	class 0: 0.8273848
	class 1: 0.9564644
	class 2: 0.9425609
	class 3: 0.91366935
	class 4: 0.84935063
	class 5: 0.96043795
	class 6: 0.99004173
	class 7: 0.9444075
	class 8: 0.95615137
	class 9: 0.66314095
	class 10: 0.696885
	class 11: 0.7729074
	class 12: 0.954821
	class 13: 0.82756364
	class 14: 0.94676644
	class 15: 0.9612502
	class 16: 0.6089603
	class 17: 0.73549783
	class 18: 0.34230697

federated global round: 16, step: 3
select part of clients to conduct local training
[19, 11, 9, 1]
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.09230630844831467, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.09230630844831467, Class Loss=0.09230630844831467, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.20224079489707947, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.20224079489707947, Class Loss=0.20224079489707947, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.3601192533969879, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.3601192533969879, Class Loss=0.3601192533969879, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5041428208351135, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.5041428208351135, Class Loss=0.5041428208351135, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.613991379737854, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.613991379737854, Class Loss=0.613991379737854, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6570097804069519, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.6570097804069519, Class Loss=0.6570097804069519, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.09696098417043686, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.09696098417043686, Class Loss=0.09696098417043686, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.2024175077676773, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.2024175077676773, Class Loss=0.2024175077676773, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.37319308519363403, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.37319308519363403, Class Loss=0.37319308519363403, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.4976789355278015, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.4976789355278015, Class Loss=0.4976789355278015, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6035446524620056, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.6035446524620056, Class Loss=0.6035446524620056, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6335662603378296, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.6335662603378296, Class Loss=0.6335662603378296, Reg Loss=0.0
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.10608241707086563, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.10608241707086563, Class Loss=0.10608241707086563, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.1876366287469864, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.1876366287469864, Class Loss=0.1876366287469864, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.34528520703315735, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.34528520703315735, Class Loss=0.34528520703315735, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.48654359579086304, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.48654359579086304, Class Loss=0.48654359579086304, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6129305958747864, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.6129305958747864, Class Loss=0.6129305958747864, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6142423152923584, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.6142423152923584, Class Loss=0.6142423152923584, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.09956918656826019, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.09956918656826019, Class Loss=0.09956918656826019, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.21752212941646576, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.21752212941646576, Class Loss=0.21752212941646576, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.38004887104034424, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.38004887104034424, Class Loss=0.38004887104034424, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.5278184413909912, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.5278184413909912, Class Loss=0.5278184413909912, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6049171686172485, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.6049171686172485, Class Loss=0.6049171686172485, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6513876914978027, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.6513876914978027, Class Loss=0.6513876914978027, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.70579993724823, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.827959
Mean Acc: 0.846440
FreqW Acc: 0.756909
Mean IoU: 0.608200
Class IoU:
	class 0: 0.7899002
	class 1: 0.7370968
	class 2: 0.31569847
	class 3: 0.73937726
	class 4: 0.49391603
	class 5: 0.6114509
	class 6: 0.8840947
	class 7: 0.87807983
	class 8: 0.807955
	class 9: 0.4109763
	class 10: 0.62398076
	class 11: 0.49406835
	class 12: 0.77878445
	class 13: 0.72898453
	class 14: 0.75941974
	class 15: 0.7801133
	class 16: 0.14350526
	class 17: 0.45398355
	class 18: 0.12441685
Class Acc:
	class 0: 0.80061346
	class 1: 0.96205515
	class 2: 0.93859744
	class 3: 0.9282343
	class 4: 0.8505071
	class 5: 0.96211916
	class 6: 0.98843503
	class 7: 0.94080216
	class 8: 0.9651749
	class 9: 0.6520628
	class 10: 0.75458014
	class 11: 0.78341764
	class 12: 0.96144813
	class 13: 0.85507476
	class 14: 0.9432064
	class 15: 0.964915
	class 16: 0.53234345
	class 17: 0.7043074
	class 18: 0.59447473

federated global round: 17, step: 3
select part of clients to conduct local training
[8, 5, 21, 7]
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.07724060118198395, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.07724060118198395, Class Loss=0.07724060118198395, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.17859335243701935, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.17859335243701935, Class Loss=0.17859335243701935, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.30503273010253906, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.30503273010253906, Class Loss=0.30503273010253906, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4451083540916443, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.4451083540916443, Class Loss=0.4451083540916443, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5379078984260559, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5379078984260559, Class Loss=0.5379078984260559, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5714749097824097, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5714749097824097, Class Loss=0.5714749097824097, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.6578935384750366, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.6578935384750366, Class Loss=0.6578935384750366, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.6315553188323975, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.6315553188323975, Class Loss=0.6315553188323975, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.586309552192688, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.586309552192688, Class Loss=0.586309552192688, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.5471588969230652, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.5471588969230652, Class Loss=0.5471588969230652, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.539220929145813, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.539220929145813, Class Loss=0.539220929145813, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.5231043100357056, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.5231043100357056, Class Loss=0.5231043100357056, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.6721249222755432, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.6721249222755432, Class Loss=0.6721249222755432, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000777
Epoch 2, Class Loss=0.6272430419921875, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.6272430419921875, Class Loss=0.6272430419921875, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000736
Epoch 3, Class Loss=0.5950913429260254, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.5950913429260254, Class Loss=0.5950913429260254, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000694
Epoch 4, Class Loss=0.5641326308250427, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.5641326308250427, Class Loss=0.5641326308250427, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000652
Epoch 5, Class Loss=0.5354591608047485, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.5354591608047485, Class Loss=0.5354591608047485, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000610
Epoch 6, Class Loss=0.518299400806427, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.518299400806427, Class Loss=0.518299400806427, Reg Loss=0.0
Current Client Index:  7
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.07815829664468765, Reg Loss=0.0
Clinet index 7, End of Epoch 1/6, Average Loss=0.07815829664468765, Class Loss=0.07815829664468765, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.16351471841335297, Reg Loss=0.0
Clinet index 7, End of Epoch 2/6, Average Loss=0.16351471841335297, Class Loss=0.16351471841335297, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.3001512289047241, Reg Loss=0.0
Clinet index 7, End of Epoch 3/6, Average Loss=0.3001512289047241, Class Loss=0.3001512289047241, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.4306274652481079, Reg Loss=0.0
Clinet index 7, End of Epoch 4/6, Average Loss=0.4306274652481079, Class Loss=0.4306274652481079, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.534241795539856, Reg Loss=0.0
Clinet index 7, End of Epoch 5/6, Average Loss=0.534241795539856, Class Loss=0.534241795539856, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5872713923454285, Reg Loss=0.0
Clinet index 7, End of Epoch 6/6, Average Loss=0.5872713923454285, Class Loss=0.5872713923454285, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6080398559570312, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.854110
Mean Acc: 0.836703
FreqW Acc: 0.787681
Mean IoU: 0.627148
Class IoU:
	class 0: 0.82677954
	class 1: 0.7629934
	class 2: 0.33304268
	class 3: 0.72368777
	class 4: 0.5268535
	class 5: 0.6259142
	class 6: 0.90201956
	class 7: 0.8874227
	class 8: 0.82785255
	class 9: 0.4105578
	class 10: 0.648038
	class 11: 0.518432
	class 12: 0.77489173
	class 13: 0.7485836
	class 14: 0.78116477
	class 15: 0.80121356
	class 16: 0.18198122
	class 17: 0.48813716
	class 18: 0.14624247
Class Acc:
	class 0: 0.8404173
	class 1: 0.9626222
	class 2: 0.9362136
	class 3: 0.9340812
	class 4: 0.8502298
	class 5: 0.9550702
	class 6: 0.9858533
	class 7: 0.93531746
	class 8: 0.95583093
	class 9: 0.63868904
	class 10: 0.78305745
	class 11: 0.7673524
	class 12: 0.9624137
	class 13: 0.8695634
	class 14: 0.93742657
	class 15: 0.96232206
	class 16: 0.3443798
	class 17: 0.62585175
	class 18: 0.6506648

federated global round: 18, step: 3
select part of clients to conduct local training
[14, 4, 11, 21]
Current Client Index:  14
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.0654534250497818, Reg Loss=0.0
Clinet index 14, End of Epoch 1/6, Average Loss=0.0654534250497818, Class Loss=0.0654534250497818, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.14323510229587555, Reg Loss=0.0
Clinet index 14, End of Epoch 2/6, Average Loss=0.14323510229587555, Class Loss=0.14323510229587555, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.25994065403938293, Reg Loss=0.0
Clinet index 14, End of Epoch 3/6, Average Loss=0.25994065403938293, Class Loss=0.25994065403938293, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.37479814887046814, Reg Loss=0.0
Clinet index 14, End of Epoch 4/6, Average Loss=0.37479814887046814, Class Loss=0.37479814887046814, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4579751491546631, Reg Loss=0.0
Clinet index 14, End of Epoch 5/6, Average Loss=0.4579751491546631, Class Loss=0.4579751491546631, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5192233920097351, Reg Loss=0.0
Clinet index 14, End of Epoch 6/6, Average Loss=0.5192233920097351, Class Loss=0.5192233920097351, Reg Loss=0.0
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.08821848034858704, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.08821848034858704, Class Loss=0.08821848034858704, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.15655212104320526, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.15655212104320526, Class Loss=0.15655212104320526, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.2499999850988388, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.2499999850988388, Class Loss=0.2499999850988388, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.35750260949134827, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.35750260949134827, Class Loss=0.35750260949134827, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4457324743270874, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.4457324743270874, Class Loss=0.4457324743270874, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5017416477203369, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.5017416477203369, Class Loss=0.5017416477203369, Reg Loss=0.0
Current Client Index:  11
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.5596746802330017, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.5596746802330017, Class Loss=0.5596746802330017, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000714
Epoch 2, Class Loss=0.5428553223609924, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.5428553223609924, Class Loss=0.5428553223609924, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000655
Epoch 3, Class Loss=0.5316904187202454, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.5316904187202454, Class Loss=0.5316904187202454, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000596
Epoch 4, Class Loss=0.5123813152313232, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.5123813152313232, Class Loss=0.5123813152313232, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000536
Epoch 5, Class Loss=0.4896644353866577, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.4896644353866577, Class Loss=0.4896644353866577, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000475
Epoch 6, Class Loss=0.4755955934524536, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.4755955934524536, Class Loss=0.4755955934524536, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000568
Epoch 1, Class Loss=0.5622167587280273, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.5622167587280273, Class Loss=0.5622167587280273, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000525
Epoch 2, Class Loss=0.5293384790420532, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.5293384790420532, Class Loss=0.5293384790420532, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000482
Epoch 3, Class Loss=0.5191671252250671, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.5191671252250671, Class Loss=0.5191671252250671, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.5107476711273193, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.5107476711273193, Class Loss=0.5107476711273193, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000394
Epoch 5, Class Loss=0.48888856172561646, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.48888856172561646, Class Loss=0.48888856172561646, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000350
Epoch 6, Class Loss=0.4823501706123352, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.4823501706123352, Class Loss=0.4823501706123352, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.5872564315795898, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.850070
Mean Acc: 0.825938
FreqW Acc: 0.785159
Mean IoU: 0.623859
Class IoU:
	class 0: 0.82375044
	class 1: 0.7623731
	class 2: 0.33327776
	class 3: 0.7151813
	class 4: 0.53583735
	class 5: 0.6175358
	class 6: 0.90641224
	class 7: 0.88508916
	class 8: 0.8281842
	class 9: 0.41503066
	class 10: 0.6383104
	class 11: 0.52427316
	class 12: 0.78449595
	class 13: 0.7483223
	class 14: 0.78870636
	class 15: 0.80100495
	class 16: 0.16277088
	class 17: 0.44401383
	class 18: 0.13875197
Class Acc:
	class 0: 0.8367017
	class 1: 0.9595883
	class 2: 0.9297789
	class 3: 0.9333221
	class 4: 0.8477851
	class 5: 0.9554419
	class 6: 0.9849437
	class 7: 0.93034554
	class 8: 0.96071297
	class 9: 0.6405332
	class 10: 0.76058704
	class 11: 0.76732516
	class 12: 0.956786
	class 13: 0.869188
	class 14: 0.9313977
	class 15: 0.96257114
	class 16: 0.23748164
	class 17: 0.5263996
	class 18: 0.7019269

federated global round: 19, step: 3
select part of clients to conduct local training
[15, 12, 21, 16]
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.06010526046156883, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.06010526046156883, Class Loss=0.06010526046156883, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.1264631450176239, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.1264631450176239, Class Loss=0.1264631450176239, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2223808765411377, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.2223808765411377, Class Loss=0.2223808765411377, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3273032307624817, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.3273032307624817, Class Loss=0.3273032307624817, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.41127052903175354, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.41127052903175354, Class Loss=0.41127052903175354, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.48413392901420593, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.48413392901420593, Class Loss=0.48413392901420593, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.05497703701257706, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.05497703701257706, Class Loss=0.05497703701257706, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.13117550313472748, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.13117550313472748, Class Loss=0.13117550313472748, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2405293881893158, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.2405293881893158, Class Loss=0.2405293881893158, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3395497798919678, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.3395497798919678, Class Loss=0.3395497798919678, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4219995141029358, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.4219995141029358, Class Loss=0.4219995141029358, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.49502265453338623, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.49502265453338623, Class Loss=0.49502265453338623, Reg Loss=0.0
Current Client Index:  21
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000304
Epoch 1, Class Loss=0.5147858262062073, Reg Loss=0.0
Clinet index 21, End of Epoch 1/6, Average Loss=0.5147858262062073, Class Loss=0.5147858262062073, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000258
Epoch 2, Class Loss=0.49260181188583374, Reg Loss=0.0
Clinet index 21, End of Epoch 2/6, Average Loss=0.49260181188583374, Class Loss=0.49260181188583374, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000211
Epoch 3, Class Loss=0.4879065155982971, Reg Loss=0.0
Clinet index 21, End of Epoch 3/6, Average Loss=0.4879065155982971, Class Loss=0.4879065155982971, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000163
Epoch 4, Class Loss=0.48537197709083557, Reg Loss=0.0
Clinet index 21, End of Epoch 4/6, Average Loss=0.48537197709083557, Class Loss=0.48537197709083557, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000113
Epoch 5, Class Loss=0.4769498109817505, Reg Loss=0.0
Clinet index 21, End of Epoch 5/6, Average Loss=0.4769498109817505, Class Loss=0.4769498109817505, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000061
Epoch 6, Class Loss=0.47383517026901245, Reg Loss=0.0
Clinet index 21, End of Epoch 6/6, Average Loss=0.47383517026901245, Class Loss=0.47383517026901245, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.06910771876573563, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.06910771876573563, Class Loss=0.06910771876573563, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.12970027327537537, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.12970027327537537, Class Loss=0.12970027327537537, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.2225840985774994, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.2225840985774994, Class Loss=0.2225840985774994, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.3315891623497009, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.3315891623497009, Class Loss=0.3315891623497009, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4181050658226013, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.4181050658226013, Class Loss=0.4181050658226013, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.493402361869812, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.493402361869812, Class Loss=0.493402361869812, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.6515806317329407, Reg Loss=0.0 (without scaling)

Total samples: 1353.000000
Overall Acc: 0.822569
Mean Acc: 0.827222
FreqW Acc: 0.753848
Mean IoU: 0.603176
Class IoU:
	class 0: 0.78678495
	class 1: 0.71999633
	class 2: 0.30902758
	class 3: 0.67135465
	class 4: 0.51082426
	class 5: 0.58255434
	class 6: 0.897824
	class 7: 0.88040614
	class 8: 0.80905646
	class 9: 0.41238105
	class 10: 0.62075394
	class 11: 0.5136066
	class 12: 0.7709309
	class 13: 0.73126924
	class 14: 0.7687519
	class 15: 0.78173923
	class 16: 0.15747923
	class 17: 0.4173344
	class 18: 0.11826007
Class Acc:
	class 0: 0.79598045
	class 1: 0.9701941
	class 2: 0.9318638
	class 3: 0.93292874
	class 4: 0.85656005
	class 5: 0.9579371
	class 6: 0.98587257
	class 7: 0.93282
	class 8: 0.95919293
	class 9: 0.64538425
	class 10: 0.7516251
	class 11: 0.7680228
	class 12: 0.9551595
	class 13: 0.8695158
	class 14: 0.9298406
	class 15: 0.9656197
	class 16: 0.28288442
	class 17: 0.49458244
	class 18: 0.73124105

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 20, step: 4
select part of clients to conduct local training
[9, 12, 24, 8]
Current Client Index:  9
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03965228796005249, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.03965228796005249, Class Loss=0.03965228796005249, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.03506564721465111, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.03506564721465111, Class Loss=0.03506564721465111, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.12199956178665161, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.12199956178665161, Class Loss=0.12199956178665161, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4662281274795532, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.4662281274795532, Class Loss=0.4662281274795532, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9072939157485962, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.9072939157485962, Class Loss=0.9072939157485962, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.9678040146827698, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.9678040146827698, Class Loss=0.9678040146827698, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.01324392482638359, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.01324392482638359, Class Loss=0.01324392482638359, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.04867934435606003, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.04867934435606003, Class Loss=0.04867934435606003, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.15435296297073364, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.15435296297073364, Class Loss=0.15435296297073364, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.4804784059524536, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.4804784059524536, Class Loss=0.4804784059524536, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9158082604408264, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.9158082604408264, Class Loss=0.9158082604408264, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=1.0142934322357178, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=1.0142934322357178, Class Loss=1.0142934322357178, Reg Loss=0.0
Current Client Index:  24
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03296613693237305, Reg Loss=0.0
Clinet index 24, End of Epoch 1/6, Average Loss=0.03296613693237305, Class Loss=0.03296613693237305, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.0326528437435627, Reg Loss=0.0
Clinet index 24, End of Epoch 2/6, Average Loss=0.0326528437435627, Class Loss=0.0326528437435627, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.15132583677768707, Reg Loss=0.0
Clinet index 24, End of Epoch 3/6, Average Loss=0.15132583677768707, Class Loss=0.15132583677768707, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.470278799533844, Reg Loss=0.0
Clinet index 24, End of Epoch 4/6, Average Loss=0.470278799533844, Class Loss=0.470278799533844, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.909392237663269, Reg Loss=0.0
Clinet index 24, End of Epoch 5/6, Average Loss=0.909392237663269, Class Loss=0.909392237663269, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=1.005007028579712, Reg Loss=0.0
Clinet index 24, End of Epoch 6/6, Average Loss=1.005007028579712, Class Loss=1.005007028579712, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02256011590361595, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.02256011590361595, Class Loss=0.02256011590361595, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.03827159106731415, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.03827159106731415, Class Loss=0.03827159106731415, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.13721665740013123, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.13721665740013123, Class Loss=0.13721665740013123, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.44530946016311646, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.44530946016311646, Class Loss=0.44530946016311646, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.9505761861801147, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.9505761861801147, Class Loss=0.9505761861801147, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=1.0498102903366089, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=1.0498102903366089, Class Loss=1.0498102903366089, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.096051573753357, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.693667
Mean Acc: 0.727813
FreqW Acc: 0.609239
Mean IoU: 0.486383
Class IoU:
	class 0: 0.640688
	class 1: 0.61377484
	class 2: 0.26039702
	class 3: 0.6139069
	class 4: 0.4815587
	class 5: 0.5872964
	class 6: 0.7892837
	class 7: 0.73842305
	class 8: 0.75344265
	class 9: 0.19017701
	class 10: 0.47426715
	class 11: 0.38365376
	class 12: 0.62546283
	class 13: 0.57056475
	class 14: 0.67989916
	class 15: 0.59420854
	class 16: 0.089955665
	class 17: 0.3049713
	class 18: 0.049158968
	class 19: 0.28656358
Class Acc:
	class 0: 0.64774483
	class 1: 0.76663625
	class 2: 0.9026981
	class 3: 0.8118472
	class 4: 0.68937254
	class 5: 0.90048224
	class 6: 0.86295986
	class 7: 0.9025547
	class 8: 0.86636347
	class 9: 0.69569576
	class 10: 0.550365
	class 11: 0.7215895
	class 12: 0.87786037
	class 13: 0.73163325
	class 14: 0.8188538
	class 15: 0.9673421
	class 16: 0.24924316
	class 17: 0.36980206
	class 18: 0.4535453
	class 19: 0.76966643

federated global round: 21, step: 4
select part of clients to conduct local training
[5, 8, 0, 6]
Current Client Index:  5
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.019631402567029, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.019631402567029, Class Loss=0.019631402567029, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.023400219157338142, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.023400219157338142, Class Loss=0.023400219157338142, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.10043457895517349, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.10043457895517349, Class Loss=0.10043457895517349, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3449740707874298, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.3449740707874298, Class Loss=0.3449740707874298, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 5, Class Loss=0.6821947693824768, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.6821947693824768, Class Loss=0.6821947693824768, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.8362933397293091, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.8362933397293091, Class Loss=0.8362933397293091, Reg Loss=0.0
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.9826323986053467, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.9826323986053467, Class Loss=0.9826323986053467, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.8615702986717224, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.8615702986717224, Class Loss=0.8615702986717224, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.7212908267974854, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.7212908267974854, Class Loss=0.7212908267974854, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.6376112699508667, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.6376112699508667, Class Loss=0.6376112699508667, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5754120945930481, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5754120945930481, Class Loss=0.5754120945930481, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5211115479469299, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.5211115479469299, Class Loss=0.5211115479469299, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.020877327769994736, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.020877327769994736, Class Loss=0.020877327769994736, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.02085517905652523, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.02085517905652523, Class Loss=0.02085517905652523, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.09369776397943497, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.09369776397943497, Class Loss=0.09369776397943497, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3124780058860779, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.3124780058860779, Class Loss=0.3124780058860779, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6721743941307068, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.6721743941307068, Class Loss=0.6721743941307068, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.8067114949226379, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.8067114949226379, Class Loss=0.8067114949226379, Reg Loss=0.0
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.017326869070529938, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.017326869070529938, Class Loss=0.017326869070529938, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.02594226412475109, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.02594226412475109, Class Loss=0.02594226412475109, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.0965406596660614, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.0965406596660614, Class Loss=0.0965406596660614, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.3337360620498657, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.3337360620498657, Class Loss=0.3337360620498657, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.6564165353775024, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.6564165353775024, Class Loss=0.6564165353775024, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.7979980111122131, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.7979980111122131, Class Loss=0.7979980111122131, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.8626388907432556, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.806504
Mean Acc: 0.710866
FreqW Acc: 0.732481
Mean IoU: 0.534936
Class IoU:
	class 0: 0.7997034
	class 1: 0.616919
	class 2: 0.30928117
	class 3: 0.6936679
	class 4: 0.51365274
	class 5: 0.67614824
	class 6: 0.79552144
	class 7: 0.78673375
	class 8: 0.8009054
	class 9: 0.23111059
	class 10: 0.5117899
	class 11: 0.5063278
	class 12: 0.68865055
	class 13: 0.62257403
	class 14: 0.7062455
	class 15: 0.6456631
	class 16: 0.077921346
	class 17: 0.34359396
	class 18: 0.069772
	class 19: 0.3025335
Class Acc:
	class 0: 0.8194184
	class 1: 0.6881141
	class 2: 0.8727125
	class 3: 0.7712224
	class 4: 0.6733049
	class 5: 0.8581221
	class 6: 0.843497
	class 7: 0.9187789
	class 8: 0.85309875
	class 9: 0.66292465
	class 10: 0.5630809
	class 11: 0.68035233
	class 12: 0.8535559
	class 13: 0.7225591
	class 14: 0.7761451
	class 15: 0.96941555
	class 16: 0.12746531
	class 17: 0.41706663
	class 18: 0.30456167
	class 19: 0.8419291

federated global round: 22, step: 4
select part of clients to conduct local training
[8, 25, 22, 5]
Current Client Index:  8
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.7258569598197937, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.7258569598197937, Class Loss=0.7258569598197937, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000600
Epoch 2, Class Loss=0.6745120882987976, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.6745120882987976, Class Loss=0.6745120882987976, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.5904983282089233, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.5904983282089233, Class Loss=0.5904983282089233, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.5562635064125061, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.5562635064125061, Class Loss=0.5562635064125061, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000504
Epoch 5, Class Loss=0.5285731554031372, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.5285731554031372, Class Loss=0.5285731554031372, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000471
Epoch 6, Class Loss=0.4975315034389496, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.4975315034389496, Class Loss=0.4975315034389496, Reg Loss=0.0
Current Client Index:  25
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.015857389196753502, Reg Loss=0.0
Clinet index 25, End of Epoch 1/6, Average Loss=0.015857389196753502, Class Loss=0.015857389196753502, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.014673804864287376, Reg Loss=0.0
Clinet index 25, End of Epoch 2/6, Average Loss=0.014673804864287376, Class Loss=0.014673804864287376, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.07080481201410294, Reg Loss=0.0
Clinet index 25, End of Epoch 3/6, Average Loss=0.07080481201410294, Class Loss=0.07080481201410294, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.24244938790798187, Reg Loss=0.0
Clinet index 25, End of Epoch 4/6, Average Loss=0.24244938790798187, Class Loss=0.24244938790798187, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.5239465236663818, Reg Loss=0.0
Clinet index 25, End of Epoch 5/6, Average Loss=0.5239465236663818, Class Loss=0.5239465236663818, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.6579380631446838, Reg Loss=0.0
Clinet index 25, End of Epoch 6/6, Average Loss=0.6579380631446838, Class Loss=0.6579380631446838, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.013377388939261436, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.013377388939261436, Class Loss=0.013377388939261436, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.014746948145329952, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.014746948145329952, Class Loss=0.014746948145329952, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.07401514798402786, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.07401514798402786, Class Loss=0.07401514798402786, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.24108022451400757, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.24108022451400757, Class Loss=0.24108022451400757, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.506664514541626, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.506664514541626, Class Loss=0.506664514541626, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.6209127902984619, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.6209127902984619, Class Loss=0.6209127902984619, Reg Loss=0.0
Current Client Index:  5
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.7275872826576233, Reg Loss=0.0
Clinet index 5, End of Epoch 1/6, Average Loss=0.7275872826576233, Class Loss=0.7275872826576233, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.6698757410049438, Reg Loss=0.0
Clinet index 5, End of Epoch 2/6, Average Loss=0.6698757410049438, Class Loss=0.6698757410049438, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.6075985431671143, Reg Loss=0.0
Clinet index 5, End of Epoch 3/6, Average Loss=0.6075985431671143, Class Loss=0.6075985431671143, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000655
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.5629473924636841, Reg Loss=0.0
Clinet index 5, End of Epoch 4/6, Average Loss=0.5629473924636841, Class Loss=0.5629473924636841, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.5196706056594849, Reg Loss=0.0
Clinet index 5, End of Epoch 5/6, Average Loss=0.5196706056594849, Class Loss=0.5196706056594849, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.4897734522819519, Reg Loss=0.0
Clinet index 5, End of Epoch 6/6, Average Loss=0.4897734522819519, Class Loss=0.4897734522819519, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.7048695683479309, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.848478
Mean Acc: 0.695258
FreqW Acc: 0.774914
Mean IoU: 0.551388
Class IoU:
	class 0: 0.854641
	class 1: 0.66299987
	class 2: 0.33850947
	class 3: 0.7138352
	class 4: 0.5342111
	class 5: 0.68412894
	class 6: 0.80026096
	class 7: 0.81554294
	class 8: 0.7968496
	class 9: 0.2815697
	class 10: 0.53855276
	class 11: 0.5422187
	class 12: 0.714235
	class 13: 0.6441537
	class 14: 0.71289444
	class 15: 0.664805
	class 16: 0.058127243
	class 17: 0.28793952
	class 18: 0.07024292
	class 19: 0.3120332
Class Acc:
	class 0: 0.8869303
	class 1: 0.71997654
	class 2: 0.869265
	class 3: 0.7683817
	class 4: 0.6749449
	class 5: 0.83396804
	class 6: 0.8379326
	class 7: 0.92127776
	class 8: 0.8248612
	class 9: 0.5898408
	class 10: 0.58258003
	class 11: 0.66444075
	class 12: 0.84436655
	class 13: 0.7307788
	class 14: 0.76578104
	class 15: 0.97241616
	class 16: 0.07400705
	class 17: 0.31920934
	class 18: 0.17102237
	class 19: 0.85318595

federated global round: 23, step: 4
select part of clients to conduct local training
[3, 19, 1, 11]
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.008082334883511066, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.008082334883511066, Class Loss=0.008082334883511066, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.013315816409885883, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.013315816409885883, Class Loss=0.013315816409885883, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 3, Class Loss=0.04604469984769821, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.04604469984769821, Class Loss=0.04604469984769821, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.1833721548318863, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.1833721548318863, Class Loss=0.1833721548318863, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.420327365398407, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.420327365398407, Class Loss=0.420327365398407, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5299915671348572, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.5299915671348572, Class Loss=0.5299915671348572, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.005875244736671448, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.005875244736671448, Class Loss=0.005875244736671448, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.010289275087416172, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.010289275087416172, Class Loss=0.010289275087416172, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.04924413189291954, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.04924413189291954, Class Loss=0.04924413189291954, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.19333651661872864, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.19333651661872864, Class Loss=0.19333651661872864, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.4191336929798126, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.4191336929798126, Class Loss=0.4191336929798126, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5281314849853516, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.5281314849853516, Class Loss=0.5281314849853516, Reg Loss=0.0
Current Client Index:  1
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.01372286956757307, Reg Loss=0.0
Clinet index 1, End of Epoch 1/6, Average Loss=0.01372286956757307, Class Loss=0.01372286956757307, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.021162591874599457, Reg Loss=0.0
Clinet index 1, End of Epoch 2/6, Average Loss=0.021162591874599457, Class Loss=0.021162591874599457, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.058576516807079315, Reg Loss=0.0
Clinet index 1, End of Epoch 3/6, Average Loss=0.058576516807079315, Class Loss=0.058576516807079315, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.17550508677959442, Reg Loss=0.0
Clinet index 1, End of Epoch 4/6, Average Loss=0.17550508677959442, Class Loss=0.17550508677959442, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3922801911830902, Reg Loss=0.0
Clinet index 1, End of Epoch 5/6, Average Loss=0.3922801911830902, Class Loss=0.3922801911830902, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5200449824333191, Reg Loss=0.0
Clinet index 1, End of Epoch 6/6, Average Loss=0.5200449824333191, Class Loss=0.5200449824333191, Reg Loss=0.0
Current Client Index:  11
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.01264464296400547, Reg Loss=0.0
Clinet index 11, End of Epoch 1/6, Average Loss=0.01264464296400547, Class Loss=0.01264464296400547, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.017976120114326477, Reg Loss=0.0
Clinet index 11, End of Epoch 2/6, Average Loss=0.017976120114326477, Class Loss=0.017976120114326477, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.056394610553979874, Reg Loss=0.0
Clinet index 11, End of Epoch 3/6, Average Loss=0.056394610553979874, Class Loss=0.056394610553979874, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.1882086992263794, Reg Loss=0.0
Clinet index 11, End of Epoch 4/6, Average Loss=0.1882086992263794, Class Loss=0.1882086992263794, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.40642213821411133, Reg Loss=0.0
Clinet index 11, End of Epoch 5/6, Average Loss=0.40642213821411133, Class Loss=0.40642213821411133, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5332340002059937, Reg Loss=0.0
Clinet index 11, End of Epoch 6/6, Average Loss=0.5332340002059937, Class Loss=0.5332340002059937, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.750053882598877, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.833206
Mean Acc: 0.712891
FreqW Acc: 0.758838
Mean IoU: 0.552542
Class IoU:
	class 0: 0.83442765
	class 1: 0.67655647
	class 2: 0.3128093
	class 3: 0.71184427
	class 4: 0.5301069
	class 5: 0.6798636
	class 6: 0.8227121
	class 7: 0.8060013
	class 8: 0.7965161
	class 9: 0.27423933
	class 10: 0.5406359
	class 11: 0.5296699
	class 12: 0.7055069
	class 13: 0.65708727
	class 14: 0.6983075
	class 15: 0.6154035
	class 16: 0.10185148
	class 17: 0.3650579
	class 18: 0.090212196
	class 19: 0.30202344
Class Acc:
	class 0: 0.8572917
	class 1: 0.7545714
	class 2: 0.84996146
	class 3: 0.79707944
	class 4: 0.68201965
	class 5: 0.82680655
	class 6: 0.870662
	class 7: 0.91611165
	class 8: 0.8273375
	class 9: 0.56583345
	class 10: 0.5985275
	class 11: 0.6640749
	class 12: 0.83998144
	class 13: 0.76548785
	class 14: 0.7622838
	class 15: 0.9778751
	class 16: 0.14677295
	class 17: 0.42103624
	class 18: 0.25814375
	class 19: 0.87596476

federated global round: 24, step: 4
select part of clients to conduct local training
[4, 13, 18, 9]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.01356875617057085, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.01356875617057085, Class Loss=0.01356875617057085, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.020824722945690155, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.020824722945690155, Class Loss=0.020824722945690155, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.05979448929429054, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.05979448929429054, Class Loss=0.05979448929429054, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.19701449573040009, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.19701449573040009, Class Loss=0.19701449573040009, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.3909945487976074, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.3909945487976074, Class Loss=0.3909945487976074, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5304675698280334, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.5304675698280334, Class Loss=0.5304675698280334, Reg Loss=0.0
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.009714082814753056, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.009714082814753056, Class Loss=0.009714082814753056, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.014960805885493755, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.014960805885493755, Class Loss=0.014960805885493755, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.05784440413117409, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.05784440413117409, Class Loss=0.05784440413117409, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.18845583498477936, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.18845583498477936, Class Loss=0.18845583498477936, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.4155174791812897, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.4155174791812897, Class Loss=0.4155174791812897, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5402736663818359, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.5402736663818359, Class Loss=0.5402736663818359, Reg Loss=0.0
Current Client Index:  18
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.006788300815969706, Reg Loss=0.0
Clinet index 18, End of Epoch 1/6, Average Loss=0.006788300815969706, Class Loss=0.006788300815969706, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.012210631743073463, Reg Loss=0.0
Clinet index 18, End of Epoch 2/6, Average Loss=0.012210631743073463, Class Loss=0.012210631743073463, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.04846516251564026, Reg Loss=0.0
Clinet index 18, End of Epoch 3/6, Average Loss=0.04846516251564026, Class Loss=0.04846516251564026, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.1695042997598648, Reg Loss=0.0
Clinet index 18, End of Epoch 4/6, Average Loss=0.1695042997598648, Class Loss=0.1695042997598648, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.3928987383842468, Reg Loss=0.0
Clinet index 18, End of Epoch 5/6, Average Loss=0.3928987383842468, Class Loss=0.3928987383842468, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5320948362350464, Reg Loss=0.0
Clinet index 18, End of Epoch 6/6, Average Loss=0.5320948362350464, Class Loss=0.5320948362350464, Reg Loss=0.0
Current Client Index:  9
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.5661992430686951, Reg Loss=0.0
Clinet index 9, End of Epoch 1/6, Average Loss=0.5661992430686951, Class Loss=0.5661992430686951, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000694
Epoch 2, Class Loss=0.5146905183792114, Reg Loss=0.0
Clinet index 9, End of Epoch 2/6, Average Loss=0.5146905183792114, Class Loss=0.5146905183792114, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000568
Epoch 3, Class Loss=0.47779837250709534, Reg Loss=0.0
Clinet index 9, End of Epoch 3/6, Average Loss=0.47779837250709534, Class Loss=0.47779837250709534, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000438
Epoch 4, Class Loss=0.4622911512851715, Reg Loss=0.0
Clinet index 9, End of Epoch 4/6, Average Loss=0.4622911512851715, Class Loss=0.4622911512851715, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000304
Epoch 5, Class Loss=0.43684613704681396, Reg Loss=0.0
Clinet index 9, End of Epoch 5/6, Average Loss=0.43684613704681396, Class Loss=0.43684613704681396, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000163
Epoch 6, Class Loss=0.4440755844116211, Reg Loss=0.0
Clinet index 9, End of Epoch 6/6, Average Loss=0.4440755844116211, Class Loss=0.4440755844116211, Reg Loss=0.0
federated aggregation...
/data/zhangdz/CVPR2023/FISS/metrics/stream_metrics.py:132: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  fig, ax = plt.subplots()
Validation, Class Loss=0.7173064947128296, Reg Loss=0.0 (without scaling)

Total samples: 1421.000000
Overall Acc: 0.840320
Mean Acc: 0.711831
FreqW Acc: 0.767503
Mean IoU: 0.561095
Class IoU:
	class 0: 0.84259194
	class 1: 0.687656
	class 2: 0.32001698
	class 3: 0.7203157
	class 4: 0.53825444
	class 5: 0.69336367
	class 6: 0.8358935
	class 7: 0.814482
	class 8: 0.7883103
	class 9: 0.2926179
	class 10: 0.55745584
	class 11: 0.54013836
	class 12: 0.71941406
	class 13: 0.6691958
	class 14: 0.71066654
	class 15: 0.62907827
	class 16: 0.0878267
	class 17: 0.35537538
	class 18: 0.09708018
	class 19: 0.32216358
Class Acc:
	class 0: 0.8678775
	class 1: 0.7607587
	class 2: 0.8502811
	class 3: 0.7858151
	class 4: 0.6881981
	class 5: 0.82985514
	class 6: 0.887501
	class 7: 0.9192478
	class 8: 0.8121022
	class 9: 0.5211503
	class 10: 0.617266
	class 11: 0.6509441
	class 12: 0.8315595
	class 13: 0.7762175
	class 14: 0.7678053
	class 15: 0.9775213
	class 16: 0.120635465
	class 17: 0.40639406
	class 18: 0.30007365
	class 19: 0.8654179

Filtering images...
	0/1449 ...
	1000/1449 ...
federated global round: 25, step: 5
select part of clients to conduct local training
[29, 3, 8, 19]
Current Client Index:  29
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.0292119849473238, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.0292119849473238, Class Loss=0.0292119849473238, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.04336358979344368, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.04336358979344368, Class Loss=0.04336358979344368, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.0788041353225708, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.0788041353225708, Class Loss=0.0788041353225708, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.18827040493488312, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.18827040493488312, Class Loss=0.18827040493488312, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.43922629952430725, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.43922629952430725, Class Loss=0.43922629952430725, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6598438024520874, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.6598438024520874, Class Loss=0.6598438024520874, Reg Loss=0.0
Current Client Index:  3
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.028578903526067734, Reg Loss=0.0
Clinet index 3, End of Epoch 1/6, Average Loss=0.028578903526067734, Class Loss=0.028578903526067734, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.038213100284338, Reg Loss=0.0
Clinet index 3, End of Epoch 2/6, Average Loss=0.038213100284338, Class Loss=0.038213100284338, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.08216189593076706, Reg Loss=0.0
Clinet index 3, End of Epoch 3/6, Average Loss=0.08216189593076706, Class Loss=0.08216189593076706, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.21619559824466705, Reg Loss=0.0
Clinet index 3, End of Epoch 4/6, Average Loss=0.21619559824466705, Class Loss=0.21619559824466705, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.41703128814697266, Reg Loss=0.0
Clinet index 3, End of Epoch 5/6, Average Loss=0.41703128814697266, Class Loss=0.41703128814697266, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6595429182052612, Reg Loss=0.0
Clinet index 3, End of Epoch 6/6, Average Loss=0.6595429182052612, Class Loss=0.6595429182052612, Reg Loss=0.0
Current Client Index:  8
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.02220810391008854, Reg Loss=0.0
Clinet index 8, End of Epoch 1/6, Average Loss=0.02220810391008854, Class Loss=0.02220810391008854, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.02745000459253788, Reg Loss=0.0
Clinet index 8, End of Epoch 2/6, Average Loss=0.02745000459253788, Class Loss=0.02745000459253788, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.05636215955018997, Reg Loss=0.0
Clinet index 8, End of Epoch 3/6, Average Loss=0.05636215955018997, Class Loss=0.05636215955018997, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.14658276736736298, Reg Loss=0.0
Clinet index 8, End of Epoch 4/6, Average Loss=0.14658276736736298, Class Loss=0.14658276736736298, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.4146954119205475, Reg Loss=0.0
Clinet index 8, End of Epoch 5/6, Average Loss=0.4146954119205475, Class Loss=0.4146954119205475, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6538312435150146, Reg Loss=0.0
Clinet index 8, End of Epoch 6/6, Average Loss=0.6538312435150146, Class Loss=0.6538312435150146, Reg Loss=0.0
Current Client Index:  19
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 1, Class Loss=0.03260760381817818, Reg Loss=0.0
Clinet index 19, End of Epoch 1/6, Average Loss=0.03260760381817818, Class Loss=0.03260760381817818, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000970
Epoch 2, Class Loss=0.04147232323884964, Reg Loss=0.0
Clinet index 19, End of Epoch 2/6, Average Loss=0.04147232323884964, Class Loss=0.04147232323884964, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000940
Epoch 3, Class Loss=0.07934139668941498, Reg Loss=0.0
Clinet index 19, End of Epoch 3/6, Average Loss=0.07934139668941498, Class Loss=0.07934139668941498, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000910
Epoch 4, Class Loss=0.19624213874340057, Reg Loss=0.0
Clinet index 19, End of Epoch 4/6, Average Loss=0.19624213874340057, Class Loss=0.19624213874340057, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000879
Epoch 5, Class Loss=0.44589200615882874, Reg Loss=0.0
Clinet index 19, End of Epoch 5/6, Average Loss=0.44589200615882874, Class Loss=0.44589200615882874, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000849
Epoch 6, Class Loss=0.6896215677261353, Reg Loss=0.0
Clinet index 19, End of Epoch 6/6, Average Loss=0.6896215677261353, Class Loss=0.6896215677261353, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.2457808256149292, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.682556
Mean Acc: 0.727882
FreqW Acc: 0.590704
Mean IoU: 0.463221
Class IoU:
	class 0: 0.6203697
	class 1: 0.5613339
	class 2: 0.24023396
	class 3: 0.56218964
	class 4: 0.44275826
	class 5: 0.5998644
	class 6: 0.8097516
	class 7: 0.7022647
	class 8: 0.7106396
	class 9: 0.2914019
	class 10: 0.48818794
	class 11: 0.4945346
	class 12: 0.6441
	class 13: 0.49284244
	class 14: 0.6075853
	class 15: 0.6249879
	class 16: 0.13791539
	class 17: 0.43446055
	class 18: 0.08178587
	class 19: 0.17657034
	class 20: 0.0038718632
Class Acc:
	class 0: 0.62566555
	class 1: 0.8309641
	class 2: 0.8572735
	class 3: 0.7938403
	class 4: 0.7345372
	class 5: 0.863606
	class 6: 0.8528709
	class 7: 0.90764827
	class 8: 0.8643667
	class 9: 0.6064982
	class 10: 0.61952233
	class 11: 0.7028121
	class 12: 0.8867823
	class 13: 0.81961685
	class 14: 0.80447614
	class 15: 0.9759437
	class 16: 0.42784104
	class 17: 0.56710154
	class 18: 0.61912537
	class 19: 0.9210672
	class 20: 0.003964852

federated global round: 26, step: 5
select part of clients to conduct local training
[4, 0, 29, 20]
Current Client Index:  4
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02147090993821621, Reg Loss=0.0
Clinet index 4, End of Epoch 1/6, Average Loss=0.02147090993821621, Class Loss=0.02147090993821621, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.032193560153245926, Reg Loss=0.0
Clinet index 4, End of Epoch 2/6, Average Loss=0.032193560153245926, Class Loss=0.032193560153245926, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.05878075584769249, Reg Loss=0.0
Clinet index 4, End of Epoch 3/6, Average Loss=0.05878075584769249, Class Loss=0.05878075584769249, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.18793907761573792, Reg Loss=0.0
Clinet index 4, End of Epoch 4/6, Average Loss=0.18793907761573792, Class Loss=0.18793907761573792, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.3854132890701294, Reg Loss=0.0
Clinet index 4, End of Epoch 5/6, Average Loss=0.3854132890701294, Class Loss=0.3854132890701294, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6008349061012268, Reg Loss=0.0
Clinet index 4, End of Epoch 6/6, Average Loss=0.6008349061012268, Class Loss=0.6008349061012268, Reg Loss=0.0
Current Client Index:  0
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.027362452819943428, Reg Loss=0.0
Clinet index 0, End of Epoch 1/6, Average Loss=0.027362452819943428, Class Loss=0.027362452819943428, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.030878080055117607, Reg Loss=0.0
Clinet index 0, End of Epoch 2/6, Average Loss=0.030878080055117607, Class Loss=0.030878080055117607, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.06093882769346237, Reg Loss=0.0
Clinet index 0, End of Epoch 3/6, Average Loss=0.06093882769346237, Class Loss=0.06093882769346237, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.19172988831996918, Reg Loss=0.0
Clinet index 0, End of Epoch 4/6, Average Loss=0.19172988831996918, Class Loss=0.19172988831996918, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.36495479941368103, Reg Loss=0.0
Clinet index 0, End of Epoch 5/6, Average Loss=0.36495479941368103, Class Loss=0.36495479941368103, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.6337689161300659, Reg Loss=0.0
Clinet index 0, End of Epoch 6/6, Average Loss=0.6337689161300659, Class Loss=0.6337689161300659, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000818
Epoch 1, Class Loss=0.8556221723556519, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.8556221723556519, Class Loss=0.8556221723556519, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000787
Epoch 2, Class Loss=0.7701733708381653, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.7701733708381653, Class Loss=0.7701733708381653, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000756
Epoch 3, Class Loss=0.6766331195831299, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.6766331195831299, Class Loss=0.6766331195831299, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000725
Epoch 4, Class Loss=0.638557493686676, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.638557493686676, Class Loss=0.638557493686676, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.5939500331878662, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.5939500331878662, Class Loss=0.5939500331878662, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000663
Epoch 6, Class Loss=0.5724705457687378, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.5724705457687378, Class Loss=0.5724705457687378, Reg Loss=0.0
Current Client Index:  20
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.023449638858437538, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.023449638858437538, Class Loss=0.023449638858437538, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000962
Epoch 2, Class Loss=0.029529107734560966, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.029529107734560966, Class Loss=0.029529107734560966, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000925
Epoch 3, Class Loss=0.06152456998825073, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.06152456998825073, Class Loss=0.06152456998825073, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000887
Epoch 4, Class Loss=0.17153233289718628, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.17153233289718628, Class Loss=0.17153233289718628, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000849
Epoch 5, Class Loss=0.4051586389541626, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.4051586389541626, Class Loss=0.4051586389541626, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000810
Epoch 6, Class Loss=0.5918739438056946, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.5918739438056946, Class Loss=0.5918739438056946, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.0482264757156372, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.758337
Mean Acc: 0.733331
FreqW Acc: 0.667268
Mean IoU: 0.488586
Class IoU:
	class 0: 0.7226872
	class 1: 0.59791833
	class 2: 0.24720176
	class 3: 0.56949157
	class 4: 0.48125574
	class 5: 0.6168073
	class 6: 0.84645593
	class 7: 0.7322648
	class 8: 0.742818
	class 9: 0.30438113
	class 10: 0.5108166
	class 11: 0.51431966
	class 12: 0.640235
	class 13: 0.5291231
	class 14: 0.6185321
	class 15: 0.6228121
	class 16: 0.15270936
	class 17: 0.4445506
	class 18: 0.10012553
	class 19: 0.2658023
	class 20: 0.0
Class Acc:
	class 0: 0.73530674
	class 1: 0.8645189
	class 2: 0.8738026
	class 3: 0.81368405
	class 4: 0.74469906
	class 5: 0.8986722
	class 6: 0.90153307
	class 7: 0.9245276
	class 8: 0.88841563
	class 9: 0.6263742
	class 10: 0.63365716
	class 11: 0.7122391
	class 12: 0.8879205
	class 13: 0.8192855
	class 14: 0.79229903
	class 15: 0.9787898
	class 16: 0.35955155
	class 17: 0.551463
	class 18: 0.52654153
	class 19: 0.86667144
	class 20: 0.0

federated global round: 27, step: 5
select part of clients to conduct local training
[13, 12, 20, 15]
Current Client Index:  13
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.02321879379451275, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.02321879379451275, Class Loss=0.02321879379451275, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.03857314959168434, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.03857314959168434, Class Loss=0.03857314959168434, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.06683360040187836, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.06683360040187836, Class Loss=0.06683360040187836, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.15321660041809082, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.15321660041809082, Class Loss=0.15321660041809082, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.3349292576313019, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.3349292576313019, Class Loss=0.3349292576313019, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5425398349761963, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.5425398349761963, Class Loss=0.5425398349761963, Reg Loss=0.0
Current Client Index:  12
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03200213983654976, Reg Loss=0.0
Clinet index 12, End of Epoch 1/6, Average Loss=0.03200213983654976, Class Loss=0.03200213983654976, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Epoch 2, Class Loss=0.04422832280397415, Reg Loss=0.0
Clinet index 12, End of Epoch 2/6, Average Loss=0.04422832280397415, Class Loss=0.04422832280397415, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.06705327332019806, Reg Loss=0.0
Clinet index 12, End of Epoch 3/6, Average Loss=0.06705327332019806, Class Loss=0.06705327332019806, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.1399972289800644, Reg Loss=0.0
Clinet index 12, End of Epoch 4/6, Average Loss=0.1399972289800644, Class Loss=0.1399972289800644, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.32749563455581665, Reg Loss=0.0
Clinet index 12, End of Epoch 5/6, Average Loss=0.32749563455581665, Class Loss=0.32749563455581665, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.558329164981842, Reg Loss=0.0
Clinet index 12, End of Epoch 6/6, Average Loss=0.558329164981842, Class Loss=0.558329164981842, Reg Loss=0.0
Current Client Index:  20
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000772
Epoch 1, Class Loss=0.7379705905914307, Reg Loss=0.0
Clinet index 20, End of Epoch 1/6, Average Loss=0.7379705905914307, Class Loss=0.7379705905914307, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000733
Epoch 2, Class Loss=0.6684935688972473, Reg Loss=0.0
Clinet index 20, End of Epoch 2/6, Average Loss=0.6684935688972473, Class Loss=0.6684935688972473, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.6318829655647278, Reg Loss=0.0
Clinet index 20, End of Epoch 3/6, Average Loss=0.6318829655647278, Class Loss=0.6318829655647278, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000655
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.6062933802604675, Reg Loss=0.0
Clinet index 20, End of Epoch 4/6, Average Loss=0.6062933802604675, Class Loss=0.6062933802604675, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000616
Epoch 5, Class Loss=0.5989115238189697, Reg Loss=0.0
Clinet index 20, End of Epoch 5/6, Average Loss=0.5989115238189697, Class Loss=0.5989115238189697, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000576
Epoch 6, Class Loss=0.5559341311454773, Reg Loss=0.0
Clinet index 20, End of Epoch 6/6, Average Loss=0.5559341311454773, Class Loss=0.5559341311454773, Reg Loss=0.0
Current Client Index:  15
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.022782577201724052, Reg Loss=0.0
Clinet index 15, End of Epoch 1/6, Average Loss=0.022782577201724052, Class Loss=0.022782577201724052, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000950
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 2, Class Loss=0.032782915979623795, Reg Loss=0.0
Clinet index 15, End of Epoch 2/6, Average Loss=0.032782915979623795, Class Loss=0.032782915979623795, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000899
Epoch 3, Class Loss=0.05183522030711174, Reg Loss=0.0
Clinet index 15, End of Epoch 3/6, Average Loss=0.05183522030711174, Class Loss=0.05183522030711174, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000849
Epoch 4, Class Loss=0.13459539413452148, Reg Loss=0.0
Clinet index 15, End of Epoch 4/6, Average Loss=0.13459539413452148, Class Loss=0.13459539413452148, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000798
Epoch 5, Class Loss=0.30435657501220703, Reg Loss=0.0
Clinet index 15, End of Epoch 5/6, Average Loss=0.30435657501220703, Class Loss=0.30435657501220703, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000746
Epoch 6, Class Loss=0.5244596004486084, Reg Loss=0.0
Clinet index 15, End of Epoch 6/6, Average Loss=0.5244596004486084, Class Loss=0.5244596004486084, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=1.0006163120269775, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.772505
Mean Acc: 0.731491
FreqW Acc: 0.680889
Mean IoU: 0.490532
Class IoU:
	class 0: 0.74206346
	class 1: 0.5991672
	class 2: 0.24911135
	class 3: 0.5594963
	class 4: 0.4923813
	class 5: 0.6152687
	class 6: 0.84556067
	class 7: 0.74371314
	class 8: 0.7543734
	class 9: 0.29713666
	class 10: 0.5077653
	class 11: 0.5111345
	class 12: 0.6116575
	class 13: 0.5365101
	class 14: 0.63060886
	class 15: 0.6233361
	class 16: 0.1513035
	class 17: 0.4315068
	class 18: 0.103867665
	class 19: 0.29001004
	class 20: 0.005202997
Class Acc:
	class 0: 0.75650567
	class 1: 0.84926105
	class 2: 0.8748942
	class 3: 0.81713814
	class 4: 0.7325777
	class 5: 0.90851
	class 6: 0.91091686
	class 7: 0.9251979
	class 8: 0.90014833
	class 9: 0.6677908
	class 10: 0.6291802
	class 11: 0.72279567
	class 12: 0.9032788
	class 13: 0.8196293
	class 14: 0.78664535
	class 15: 0.9791142
	class 16: 0.33525488
	class 17: 0.5174354
	class 18: 0.46880525
	class 19: 0.85103106
	class 20: 0.005204173

federated global round: 28, step: 5
select part of clients to conduct local training
[6, 29, 13, 2]
Current Client Index:  6
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.018816817551851273, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.018816817551851273, Class Loss=0.018816817551851273, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.023577116429805756, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.023577116429805756, Class Loss=0.023577116429805756, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.050058815628290176, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.050058815628290176, Class Loss=0.050058815628290176, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.11790318042039871, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.11790318042039871, Class Loss=0.11790318042039871, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.33258265256881714, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.33258265256881714, Class Loss=0.33258265256881714, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5166589021682739, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.5166589021682739, Class Loss=0.5166589021682739, Reg Loss=0.0
Current Client Index:  29
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000631
Epoch 1, Class Loss=0.6990615129470825, Reg Loss=0.0
Clinet index 29, End of Epoch 1/6, Average Loss=0.6990615129470825, Class Loss=0.6990615129470825, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000584
Epoch 2, Class Loss=0.6779536008834839, Reg Loss=0.0
Clinet index 29, End of Epoch 2/6, Average Loss=0.6779536008834839, Class Loss=0.6779536008834839, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000536
Epoch 3, Class Loss=0.6352834701538086, Reg Loss=0.0
Clinet index 29, End of Epoch 3/6, Average Loss=0.6352834701538086, Class Loss=0.6352834701538086, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000487
Epoch 4, Class Loss=0.5905649662017822, Reg Loss=0.0
Clinet index 29, End of Epoch 4/6, Average Loss=0.5905649662017822, Class Loss=0.5905649662017822, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000438
Epoch 5, Class Loss=0.5700449347496033, Reg Loss=0.0
Clinet index 29, End of Epoch 5/6, Average Loss=0.5700449347496033, Class Loss=0.5700449347496033, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000389
Epoch 6, Class Loss=0.5685182213783264, Reg Loss=0.0
Clinet index 29, End of Epoch 6/6, Average Loss=0.5685182213783264, Class Loss=0.5685182213783264, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000694
Epoch 1, Class Loss=0.6895391941070557, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.6895391941070557, Class Loss=0.6895391941070557, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000642
Epoch 2, Class Loss=0.6792434453964233, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.6792434453964233, Class Loss=0.6792434453964233, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000589
Epoch 3, Class Loss=0.6360076069831848, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.6360076069831848, Class Loss=0.6360076069831848, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.6280910968780518, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.6280910968780518, Class Loss=0.6280910968780518, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000482
Epoch 5, Class Loss=0.5766977667808533, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.5766977667808533, Class Loss=0.5766977667808533, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000427
Epoch 6, Class Loss=0.5819705724716187, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.5819705724716187, Class Loss=0.5819705724716187, Reg Loss=0.0
Current Client Index:  2
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.025408975780010223, Reg Loss=0.0
Clinet index 2, End of Epoch 1/6, Average Loss=0.025408975780010223, Class Loss=0.025408975780010223, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000925
Epoch 2, Class Loss=0.031210191547870636, Reg Loss=0.0
Clinet index 2, End of Epoch 2/6, Average Loss=0.031210191547870636, Class Loss=0.031210191547870636, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000849
Epoch 3, Class Loss=0.06032839044928551, Reg Loss=0.0
Clinet index 2, End of Epoch 3/6, Average Loss=0.06032839044928551, Class Loss=0.06032839044928551, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000772
Epoch 4, Class Loss=0.14640112221240997, Reg Loss=0.0
Clinet index 2, End of Epoch 4/6, Average Loss=0.14640112221240997, Class Loss=0.14640112221240997, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000694
Epoch 5, Class Loss=0.3245404362678528, Reg Loss=0.0
Clinet index 2, End of Epoch 5/6, Average Loss=0.3245404362678528, Class Loss=0.3245404362678528, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000616
Epoch 6, Class Loss=0.5309127569198608, Reg Loss=0.0
Clinet index 2, End of Epoch 6/6, Average Loss=0.5309127569198608, Class Loss=0.5309127569198608, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.903694212436676, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.806074
Mean Acc: 0.718835
FreqW Acc: 0.718069
Mean IoU: 0.508917
Class IoU:
	class 0: 0.7907155
	class 1: 0.6372601
	class 2: 0.26473963
	class 3: 0.5907738
	class 4: 0.5148075
	class 5: 0.63696784
	class 6: 0.85163075
	class 7: 0.76685554
	class 8: 0.78542423
	class 9: 0.28413963
	class 10: 0.5163442
	class 11: 0.51885206
	class 12: 0.6328463
	class 13: 0.575302
	class 14: 0.64806855
	class 15: 0.5987609
	class 16: 0.14225823
	class 17: 0.42028543
	class 18: 0.10382256
	class 19: 0.34348193
	class 20: 0.06392777
Class Acc:
	class 0: 0.811799
	class 1: 0.83536124
	class 2: 0.8706017
	class 3: 0.80974406
	class 4: 0.7192174
	class 5: 0.9144551
	class 6: 0.91020566
	class 7: 0.9195436
	class 8: 0.891069
	class 9: 0.6776394
	class 10: 0.62415355
	class 11: 0.71397984
	class 12: 0.8832371
	class 13: 0.81315416
	class 14: 0.76038355
	class 15: 0.98243725
	class 16: 0.2513525
	class 17: 0.4852245
	class 18: 0.34278738
	class 19: 0.8138666
	class 20: 0.065326385

federated global round: 29, step: 5
select part of clients to conduct local training
[6, 16, 13, 22]
Current Client Index:  6
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000536
Epoch 1, Class Loss=0.6437110900878906, Reg Loss=0.0
Clinet index 6, End of Epoch 1/6, Average Loss=0.6437110900878906, Class Loss=0.6437110900878906, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000455
Epoch 2, Class Loss=0.6359215378761292, Reg Loss=0.0
Clinet index 6, End of Epoch 2/6, Average Loss=0.6359215378761292, Class Loss=0.6359215378761292, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000372
Epoch 3, Class Loss=0.6171765923500061, Reg Loss=0.0
Clinet index 6, End of Epoch 3/6, Average Loss=0.6171765923500061, Class Loss=0.6171765923500061, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000287
Epoch 4, Class Loss=0.5875682830810547, Reg Loss=0.0
Clinet index 6, End of Epoch 4/6, Average Loss=0.5875682830810547, Class Loss=0.5875682830810547, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000199
Epoch 5, Class Loss=0.5753408670425415, Reg Loss=0.0
Clinet index 6, End of Epoch 5/6, Average Loss=0.5753408670425415, Class Loss=0.5753408670425415, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000107
Epoch 6, Class Loss=0.5948149561882019, Reg Loss=0.0
Clinet index 6, End of Epoch 6/6, Average Loss=0.5948149561882019, Class Loss=0.5948149561882019, Reg Loss=0.0
Current Client Index:  16
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.03034752979874611, Reg Loss=0.0
Clinet index 16, End of Epoch 1/6, Average Loss=0.03034752979874611, Class Loss=0.03034752979874611, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.03853357955813408, Reg Loss=0.0
Clinet index 16, End of Epoch 2/6, Average Loss=0.03853357955813408, Class Loss=0.03853357955813408, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.05420178174972534, Reg Loss=0.0
Clinet index 16, End of Epoch 3/6, Average Loss=0.05420178174972534, Class Loss=0.05420178174972534, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Epoch 4, Class Loss=0.12262729555368423, Reg Loss=0.0
Clinet index 16, End of Epoch 4/6, Average Loss=0.12262729555368423, Class Loss=0.12262729555368423, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.28354907035827637, Reg Loss=0.0
Clinet index 16, End of Epoch 5/6, Average Loss=0.28354907035827637, Class Loss=0.28354907035827637, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.45997047424316406, Reg Loss=0.0
Clinet index 16, End of Epoch 6/6, Average Loss=0.45997047424316406, Class Loss=0.45997047424316406, Reg Loss=0.0
Current Client Index:  13
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.000372
Epoch 1, Class Loss=0.6474636197090149, Reg Loss=0.0
Clinet index 13, End of Epoch 1/6, Average Loss=0.6474636197090149, Class Loss=0.6474636197090149, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000316
Epoch 2, Class Loss=0.6391657590866089, Reg Loss=0.0
Clinet index 13, End of Epoch 2/6, Average Loss=0.6391657590866089, Class Loss=0.6391657590866089, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000258
Epoch 3, Class Loss=0.6172476410865784, Reg Loss=0.0
Clinet index 13, End of Epoch 3/6, Average Loss=0.6172476410865784, Class Loss=0.6172476410865784, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000199
Epoch 4, Class Loss=0.5903424024581909, Reg Loss=0.0
Clinet index 13, End of Epoch 4/6, Average Loss=0.5903424024581909, Class Loss=0.5903424024581909, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000138
Epoch 5, Class Loss=0.6028207540512085, Reg Loss=0.0
Clinet index 13, End of Epoch 5/6, Average Loss=0.6028207540512085, Class Loss=0.6028207540512085, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000074
Epoch 6, Class Loss=0.5959097146987915, Reg Loss=0.0
Clinet index 13, End of Epoch 6/6, Average Loss=0.5959097146987915, Class Loss=0.5959097146987915, Reg Loss=0.0
Current Client Index:  22
Filtering images...
	0/10582 ...
	1000/10582 ...
	2000/10582 ...
	3000/10582 ...
	4000/10582 ...
	5000/10582 ...
	6000/10582 ...
	7000/10582 ...
	8000/10582 ...
	9000/10582 ...
	10000/10582 ...
load old model
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Pseudo labeling is: entropy
Epoch 1, lr = 0.001000
Epoch 1, Class Loss=0.027415651828050613, Reg Loss=0.0
Clinet index 22, End of Epoch 1/6, Average Loss=0.027415651828050613, Class Loss=0.027415651828050613, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 2, lr = 0.000849
Epoch 2, Class Loss=0.032334573566913605, Reg Loss=0.0
Clinet index 22, End of Epoch 2/6, Average Loss=0.032334573566913605, Class Loss=0.032334573566913605, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 3, lr = 0.000694
Epoch 3, Class Loss=0.0565020926296711, Reg Loss=0.0
Clinet index 22, End of Epoch 3/6, Average Loss=0.0565020926296711, Class Loss=0.0565020926296711, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 4, lr = 0.000536
Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0
Epoch 4, Class Loss=0.1479935497045517, Reg Loss=0.0
Clinet index 22, End of Epoch 4/6, Average Loss=0.1479935497045517, Class Loss=0.1479935497045517, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 5, lr = 0.000372
Epoch 5, Class Loss=0.31819427013397217, Reg Loss=0.0
Clinet index 22, End of Epoch 5/6, Average Loss=0.31819427013397217, Class Loss=0.31819427013397217, Reg Loss=0.0
Pseudo labeling is: entropy
Epoch 6, lr = 0.000199
Epoch 6, Class Loss=0.5026586651802063, Reg Loss=0.0
Clinet index 22, End of Epoch 6/6, Average Loss=0.5026586651802063, Class Loss=0.5026586651802063, Reg Loss=0.0
federated aggregation...
Validation, Class Loss=0.8970173597335815, Reg Loss=0.0 (without scaling)

Total samples: 1449.000000
Overall Acc: 0.807488
Mean Acc: 0.720246
FreqW Acc: 0.719189
Mean IoU: 0.509347
Class IoU:
	class 0: 0.79243535
	class 1: 0.63745004
	class 2: 0.2630709
	class 3: 0.57541597
	class 4: 0.5168343
	class 5: 0.62925
	class 6: 0.8478464
	class 7: 0.76613945
	class 8: 0.7813319
	class 9: 0.28827667
	class 10: 0.51697904
	class 11: 0.52083576
	class 12: 0.6159184
	class 13: 0.5784828
	class 14: 0.6408122
	class 15: 0.605971
	class 16: 0.1457926
	class 17: 0.41222218
	class 18: 0.105462186
	class 19: 0.3428875
	class 20: 0.11287064
Class Acc:
	class 0: 0.8135085
	class 1: 0.8286767
	class 2: 0.8716919
	class 3: 0.81614274
	class 4: 0.7187548
	class 5: 0.9136999
	class 6: 0.905382
	class 7: 0.9205858
	class 8: 0.89389837
	class 9: 0.67669183
	class 10: 0.6265118
	class 11: 0.7187072
	class 12: 0.89279515
	class 13: 0.8046974
	class 14: 0.7484956
	class 15: 0.9821088
	class 16: 0.2502454
	class 17: 0.47320214
	class 18: 0.3344932
	class 19: 0.814357
	class 20: 0.12052718

voc_15-1_OURS-FSC On GPUs 0
Run in 29882s
